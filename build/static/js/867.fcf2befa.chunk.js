"use strict";(self.webpackChunksunbeth_portal_react_ts=self.webpackChunksunbeth_portal_react_ts||[]).push([[867],{2867:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var a=s(5043),n=s(579);const r=()=>{const[e,t]=(0,a.useState)(""),[s,r]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[d,l]=(0,a.useState)(""),[u,h]=(0,a.useState)("request"),[c,m]=(0,a.useState)(null),[p,w]=(0,a.useState)(!1);a.useEffect(()=>{const e=new URLSearchParams(window.location.search);e.get("email")&&t(e.get("email")),e.get("token")&&(r(e.get("token")),h("reset"))},[]);return"done"===u?(0,n.jsxs)("div",{className:"container",style:{maxWidth:400,margin:"0 auto",padding:32},children:[(0,n.jsx)("h2",{children:"Password Reset"}),(0,n.jsx)("div",{children:"Your password has been reset. You may now log in."}),(0,n.jsx)("a",{href:"/login",children:(0,n.jsx)("button",{className:"btn",style:{marginTop:16},children:"Go to Login"})})]}):(0,n.jsxs)("div",{className:"container",style:{maxWidth:400,margin:"0 auto",padding:32},children:[(0,n.jsx)("h2",{children:"request"===u?"Reset Password":"Set New Password"}),"request"===u?(0,n.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),m(null),w(!0);try{const t=await fetch("/api/external-users/request-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),s=await t.json();if(!t.ok)throw new Error(s.error||"Failed to send reset email");h("reset")}catch(t){m(t.message||"Failed to send reset email")}finally{w(!1)}},children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)("input",{type:"email",placeholder:"Email address",value:e,onChange:e=>t(e.target.value),required:!0,style:{width:"100%",padding:8},autoFocus:!0})}),c&&(0,n.jsx)("div",{style:{color:"red",marginBottom:12},children:c}),(0,n.jsx)("button",{className:"btn",type:"submit",disabled:p,style:{width:"100%"},children:p?"Sending...":"Send Reset Email"})]}):(0,n.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),m(null),i===d){w(!0);try{const t=await fetch("/api/external-users/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,token:s,password:i})}),a=await t.json();if(!t.ok)throw new Error(a.error||"Failed to reset password");h("done")}catch(t){m(t.message||"Failed to reset password")}finally{w(!1)}}else m("Passwords do not match")},children:[(0,n.jsx)("input",{type:"hidden",value:e}),(0,n.jsx)("input",{type:"hidden",value:s}),(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)("input",{type:"password",placeholder:"New password",value:i,onChange:e=>o(e.target.value),required:!0,minLength:8,style:{width:"100%",padding:8}})}),(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)("input",{type:"password",placeholder:"Confirm password",value:d,onChange:e=>l(e.target.value),required:!0,minLength:8,style:{width:"100%",padding:8}})}),c&&(0,n.jsx)("div",{style:{color:"red",marginBottom:12},children:c}),(0,n.jsx)("button",{className:"btn",type:"submit",disabled:p,style:{width:"100%"},children:p?"Resetting...":"Reset Password"})]})]})}}}]);
//# sourceMappingURL=867.fcf2befa.chunk.js.map