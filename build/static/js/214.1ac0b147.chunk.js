"use strict";(self.webpackChunksunbeth_portal_react_ts=self.webpackChunksunbeth_portal_react_ts||[]).push([[214],{157:(e,t,i)=>{i.d(t,{I:()=>n,z:()=>s});const n="https://graph.microsoft.com",s=new Set([n,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"])},214:(e,t,i)=>{i.d(t,{Providers:()=>n.b});var n=i(589)},372:(e,t,i)=>{i.d(t,{N:()=>s});var n=i(157);const s=e=>{try{const t=new URL(e).origin;if(n.z.has(t))return t}catch(t){return}}},421:(e,t,i)=>{i.d(t,{DH:()=>c,Gb:()=>n,HJ:()=>s});var n,s,r=i(372),a=i(157),o=i(841);class c{get isMultiAccountSupportedAndEnabled(){return!1}get approvedScopes(){return this._approvedScopes}set approvedScopes(e){this._approvedScopes=e.map(e=>e.toLowerCase())}hasAtLeastOneApprovedScope(e){return e.some(e=>this.approvedScopes.includes(e.toLowerCase().trim()))}hasAllOneApprovedScope(e){return e.some(e=>!this.approvedScopes.includes(e.toLowerCase().trim()))}needsAdditionalScopes(e){const t=[];return e.length&&!this.hasAtLeastOneApprovedScope(e)&&t.push(e[0].trim()),t}set baseURL(e){if(!(0,r.N)(e))throw new Error("".concat(e," is not a valid Graph URL endpoint."));this._baseURL=e}get baseURL(){return this._baseURL}set customHosts(e){this._customHosts=e}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new o.Q,this._activeAccountChangedDispatcher=new o.Q,this._baseURL=a.I,this._approvedScopes=[],this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=s.Loading}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.getAccessToken({scopes:t})}}!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(n||(n={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(s||(s={}))},589:(e,t,i)=>{i.d(t,{b:()=>o});var n,s=i(841),r=i(421),a=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{c(n.next(e))}catch(t){r(t)}}function o(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}c((n=n.apply(e,t||[])).next())})};class o{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.isMultiAccountSupportedAndEnabled&&e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(n.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return a(this,void 0,void 0,function*(){try{const e=yield this.client.api("me").get();if(null===e||void 0===e?void 0:e.id)return e}catch(e){}return null})}static getCacheId(){var e;return a(this,void 0,void 0,function*(){if(this._cacheId)return this._cacheId;if((null===(e=o.globalProvider)||void 0===e?void 0:e.state)===r.HJ.SignedIn&&!this._cacheId){if(this.client)try{this._cacheId=yield this.createCacheId()}catch(t){}}return this._cacheId})}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return a(this,void 0,void 0,function*(){if(o.globalProvider.isMultiAccountSupportedAndEnabled){const e=this.createCacheIdWithAccountDetails();if(e)return e}return yield this.createCacheIdWithUserDetails()})}static createCacheIdWithUserDetails(){return a(this,void 0,void 0,function*(){const e=yield this.me();return(null===e||void 0===e?void 0:e.id)?e.id+"-"+e.userPrincipalName:null})}static createCacheIdWithAccountDetails(){const e=o.globalProvider.getActiveAccount();return e.tenantId&&e.id?e.tenantId+e.id:null}static get client(){return o.globalProvider&&o.globalProvider.state===r.HJ.SignedIn?o.globalProvider.graph.client:null}}o._eventDispatcher=new s.Q,o._activeAccountChangedDispatcher=new s.Q,o.handleProviderStateChanged=()=>{o.globalProvider&&o.globalProvider.state===r.HJ.SignedIn||(o._mePromise=null),o._eventDispatcher.fire(n.ProviderStateChanged)},o.handleActiveAccountChanged=()=>{o.unsetCacheId(),o._activeAccountChangedDispatcher.fire(null)},function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(n||(n={}))},841:(e,t,i)=>{i.d(t,{Q:()=>n});class n{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}}}]);
//# sourceMappingURL=214.1ac0b147.chunk.js.map