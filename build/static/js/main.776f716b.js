/*! For license information please see main.776f716b.js.LICENSE.txt */
(()=>{var __webpack_modules__={89:(e,t,n)=>{"use strict";n.d(t,{$u:()=>y,Al:()=>o,CC:()=>l,Ct:()=>s,G8:()=>b,H3:()=>u,JD:()=>i,JE:()=>A,L$:()=>S,P3:()=>C,Q1:()=>a,T$:()=>f,WJ:()=>w,X8:()=>p,_p:()=>c,dh:()=>d,f7:()=>v,jb:()=>g,nN:()=>_,sA:()=>h,uq:()=>m});var r=n(4388);const a={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},i={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},s={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},o={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},l={GET:"GET",POST:"POST"},c={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},d={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},u={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},h={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var p;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(p||(p={}));const f={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},m={scopes:r.aZ},g="jwk",v={React:"@azure/msal-react",Angular:"@azure/msal-angular"},y="msal.db",b=1,w="".concat(y,".keys"),_={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},A=[_.Default,_.Skip,_.RefreshTokenAndNetwork],S="msal.browser.log.level",C="msal.browser.log.pii"},183:(e,t,n)=>{var r=n(1756);e.exports=function(e,t,n){return n(r(e,t))},e.exports.__esModule=!0,e.exports.default=e.exports},493:(e,t,n)=>{"use strict";n.d(t,{dg:()=>a,jE:()=>i,xz:()=>r});const r="storage_not_supported",a="stubbed_public_client_application_called",i="in_mem_redirect_unavailable"},776:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(2555),a=n(9950),i=n(2935),s=n(1298),o=n(6142),l=n(4414);const c=["daily","weekly","monthly","quarterly","semiannual","annual","custom"],d=()=>{const e=(0,i.Gi)()||"",{account:t}=(0,o.As)(),n=((null===t||void 0===t?void 0:t.username)||"").trim(),[d,u]=(0,a.useState)([]),[h,p]=(0,a.useState)(!1),[f,m]=(0,a.useState)(!1),[g,v]=(0,a.useState)(""),[y,b]=(0,a.useState)([]),[w,_]=(0,a.useState)({frequency:"annual",required:!0,active:!0,dueInDays:30,graceDays:0,fileIds:[]}),A=(0,a.useMemo)(()=>{const e=g.trim().toLowerCase();return e?d.filter(t=>t.name.toLowerCase().includes(e)):d},[g,d]),S=(0,a.useMemo)(()=>{if(!n)return{};try{const t=e||"";if(!/^https?:\/\//i.test(t))return{"X-Admin-Email":n};return"undefined"!==typeof window&&t.startsWith(window.location.origin)?{"X-Admin-Email":n}:{}}catch(t){return{}}},[e,n]),C=async()=>{p(!0);try{const t="".concat(e,"/api/admin/policies").concat(n?"?adminEmail=".concat(encodeURIComponent(n)):""),r=await fetch(t,{cache:"no-store",headers:Object.keys(S).length?S:void 0}),a=await r.json();u(Array.isArray(null===a||void 0===a?void 0:a.policies)?a.policies:[])}catch(t){u([])}finally{p(!1)}};(0,a.useEffect)(()=>{e&&C()},[e,n]);(0,a.useEffect)(()=>{e&&(async()=>{try{const t=await fetch("".concat(e,"/api/library/list?limit=200"),{cache:"no-store"}),n=await t.json(),r=Array.isArray(null===n||void 0===n?void 0:n.files)?n.files:[];b(r.map(t=>({id:Number(t.id),name:String(t.name||"file"),url:"".concat(e).concat(t.url),size:Number(t.size)||void 0,sha256:t.sha256})))}catch(t){b([])}})()},[e]);return(0,l.jsxs)("div",{className:"card",style:{padding:16},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{style:{margin:0,fontSize:16},children:"Policies (Recurring Acknowledgements)"}),(0,l.jsx)("div",{className:"small muted",children:"Define mandatory annual (or other) acknowledgements per document; applies to all employees by default."})]}),(0,l.jsx)("input",{placeholder:"Search policies...",value:g,onChange:e=>v(e.target.value)})]}),(0,l.jsxs)("div",{className:"card",style:{marginTop:12,padding:12},children:[(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"policyName",children:"Policy Name"}),(0,l.jsx)("input",{id:"policyName",value:w.name||"",onChange:e=>_((0,r.A)((0,r.A)({},w),{},{name:e.target.value})),placeholder:"Code of Conduct (Annual)"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"policyFreq",children:"Frequency"}),(0,l.jsx)("select",{id:"policyFreq",value:String(w.frequency||"annual"),onChange:e=>_((0,r.A)((0,r.A)({},w),{},{frequency:e.target.value})),children:c.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),"custom"===w.frequency&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"intervalDays",children:"Interval (days)"}),(0,l.jsx)("input",{id:"intervalDays",type:"number",value:Number(w.intervalDays||0),onChange:e=>_((0,r.A)((0,r.A)({},w),{},{intervalDays:Number(e.target.value)||0}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"small",children:"Required"}),(0,l.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,l.jsx)("input",{type:"checkbox",checked:!1!==w.required,onChange:e=>_((0,r.A)((0,r.A)({},w),{},{required:e.target.checked}))})," Required for all employees"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"startOn",children:"Start On (optional)"}),(0,l.jsx)("input",{id:"startOn",type:"date",value:w.startOn||"",onChange:e=>_((0,r.A)((0,r.A)({},w),{},{startOn:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"dueDays",children:"Due Window (days)"}),(0,l.jsx)("input",{id:"dueDays",type:"number",value:Number(w.dueInDays||30),onChange:e=>_((0,r.A)((0,r.A)({},w),{},{dueInDays:Number(e.target.value)||0}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"small",htmlFor:"graceDays",children:"Grace (days)"}),(0,l.jsx)("input",{id:"graceDays",type:"number",value:Number(w.graceDays||0),onChange:e=>_((0,r.A)((0,r.A)({},w),{},{graceDays:Number(e.target.value)||0}))})]})]}),(0,l.jsxs)("div",{style:{marginTop:12},children:[(0,l.jsx)("div",{className:"small muted",style:{marginBottom:6},children:"Select document(s) from Library"}),(0,l.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,maxHeight:180,overflowY:"auto"},children:y.map(e=>{const t=Array.isArray(w.fileIds)?w.fileIds.includes(e.id):w.fileId===e.id;return(0,l.jsxs)("label",{className:"small",style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:8,alignItems:"center",padding:"6px 8px",border:"1px solid #f0f0f0",borderRadius:6},children:[(0,l.jsx)("input",{type:"checkbox",checked:!!t,onChange:t=>{const n=new Set(Array.isArray(w.fileIds)?w.fileIds:w.fileId?[w.fileId]:[]);t.target.checked?n.add(e.id):n.delete(e.id),_((0,r.A)((0,r.A)({},w),{},{fileIds:Array.from(n)}))}}),(0,l.jsxs)("div",{style:{minWidth:0},children:[(0,l.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,l.jsxs)("div",{className:"muted",style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.size?(0,l.jsxs)("span",{children:[(e.size/1024/1024).toFixed(1)," MB"]}):null,(0,l.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:"Preview \u2197"})]})]}),(0,l.jsxs)("span",{className:"badge",children:["file #",e.id]})]},e.id)})}),(0,l.jsxs)("div",{className:"small",style:{marginTop:6},children:["Selected: ",(0,l.jsx)("strong",{children:Array.isArray(w.fileIds)?w.fileIds.length:w.fileId?1:0})]})]}),(0,l.jsx)("div",{style:{marginTop:12,textAlign:"right"},children:(0,l.jsx)("button",{className:"btn",onClick:async()=>{const t=Array.isArray(w.fileIds)?w.fileIds:w.fileId?[w.fileId]:[];if(w.name&&0!==t.length){m(!0);try{const a="".concat(e,"/api/admin/policies").concat(n?"?adminEmail=".concat(encodeURIComponent(n)):""),i=await fetch(a,{method:"POST",headers:(0,r.A)({"Content-Type":"application/json"},S),body:JSON.stringify({name:w.name,description:w.description||null,frequency:w.frequency||"annual",intervalDays:"custom"===w.frequency?w.intervalDays||0:null,required:!!w.required,fileIds:t,startOn:w.startOn||null,dueInDays:w.dueInDays||30,graceDays:w.graceDays||0,active:!1!==w.active})});if(!i.ok)throw new Error(await(async(e,t)=>{try{if((e.headers.get("content-type")||"").includes("application/json")){const n=await e.json().catch(()=>null);return n&&"object"===typeof n&&"error"in n&&n.error?"".concat(t," (").concat(n.error,")"):t}const n=await e.text().catch(()=>"");return n?"".concat(t," (").concat(n.substring(0,140),")"):t}catch(n){return t}})(i,"Failed to save policy"));_({frequency:"annual",required:!0,active:!0,dueInDays:30,graceDays:0,fileIds:[]}),await C(),(0,s.P0)("Policy saved","success")}catch(a){(0,s.P0)(String((null===a||void 0===a?void 0:a.message)||"Failed to save policy"),"error")}finally{m(!1)}}else(0,s.P0)("Name and at least one file are required","warning")},disabled:f,children:"Save Policy"})})]}),(0,l.jsxs)("div",{className:"card",style:{marginTop:12,padding:12},children:[(0,l.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"Existing Policies"}),h?(0,l.jsx)("div",{className:"small muted",children:"Loading..."}):0===A.length?(0,l.jsx)("div",{className:"small muted",children:"No policies found."}):(0,l.jsx)("div",{style:{display:"grid",gap:8},children:A.map(t=>{var r;return(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center",border:"1px solid #f0f0f0",borderRadius:6,padding:8},children:[(0,l.jsxs)("div",{style:{minWidth:0},children:[(0,l.jsx)("div",{style:{fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),(0,l.jsxs)("div",{className:"small muted",style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,l.jsxs)("span",{children:["freq: ",t.frequency,"custom"===t.frequency&&t.intervalDays?" (".concat(t.intervalDays," days)"):""]}),(0,l.jsxs)("span",{children:["required: ",t.required?"yes":"no"]}),(0,l.jsxs)("span",{children:["active: ",t.active?"yes":"no"]}),t.startOn?(0,l.jsxs)("span",{children:["start: ",t.startOn]}):null,(0,l.jsxs)("span",{children:["due: ",null!==(r=t.dueInDays)&&void 0!==r?r:30,"d"]}),t.graceDays?(0,l.jsxs)("span",{children:["grace: ",t.graceDays,"d"]}):null,(0,l.jsxs)("span",{children:["files: ",Array.isArray(t.fileIds)?t.fileIds.length:t.fileId?1:0]}),(Array.isArray(t.fileIds)?t.fileIds:t.fileId?[t.fileId]:[]).slice(0,1).map(t=>(0,l.jsx)("a",{href:"".concat(e,"/api/files/").concat(t),target:"_blank",rel:"noreferrer",children:"first file \u2197"},t))]})]}),(0,l.jsx)("div",{style:{display:"flex",gap:8},children:(0,l.jsx)("button",{className:"btn ghost sm",onClick:()=>(async t=>{try{const r="".concat(e,"/api/admin/policies/").concat(t).concat(n?"?adminEmail=".concat(encodeURIComponent(n)):"");if(!(await fetch(r,{method:"DELETE",headers:Object.keys(S).length?S:void 0})).ok)throw new Error("delete_failed");await C(),(0,s.P0)("Policy deleted","success")}catch(r){(0,s.P0)("Delete failed","error")}})(t.id),children:"Delete"})})]},t.id)})})]})]})}},1018:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var a;n.d(t,{AO:()=>u,Gh:()=>M,HS:()=>F,Oi:()=>o,Rr:()=>h,pX:()=>U,pb:()=>I,rc:()=>a,tH:()=>B,ue:()=>m,yD:()=>O,zR:()=>s}),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));const i="popstate";function s(e){return void 0===e&&(e={}),p(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return d("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:u(t)},null,e)}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,n,a){return void 0===n&&(n=null),r({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?h(t):t,{state:n,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function u(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function h(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function p(e,t,n,s){void 0===s&&(s={});let{window:l=document.defaultView,v5Compat:h=!1}=s,p=l.history,f=a.Pop,m=null,g=v();function v(){return(p.state||{idx:null}).idx}function y(){f=a.Pop;let e=v(),t=null==e?null:e-g;g=e,m&&m({action:f,location:w.location,delta:t})}function b(e){let t="null"!==l.location.origin?l.location.origin:l.location.href,n="string"===typeof e?e:u(e);return n=n.replace(/ $/,"%20"),o(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,p.replaceState(r({},p.state,{idx:g}),""));let w={get action(){return f},get location(){return e(l,p)},listen(e){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(i,y),m=e,()=>{l.removeEventListener(i,y),m=null}},createHref:e=>t(l,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){f=a.Push;let r=d(w.location,e,t);n&&n(r,e),g=v()+1;let i=c(r,g),s=w.createHref(r);try{p.pushState(i,"",s)}catch(o){if(o instanceof DOMException&&"DataCloneError"===o.name)throw o;l.location.assign(s)}h&&m&&m({action:f,location:w.location,delta:1})},replace:function(e,t){f=a.Replace;let r=d(w.location,e,t);n&&n(r,e),g=v();let i=c(r,g),s=w.createHref(r);p.replaceState(i,"",s),h&&m&&m({action:f,location:w.location,delta:0})},go:e=>p.go(e)};return w}var f;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(f||(f={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,n){return void 0===n&&(n="/"),g(e,t,n,!1)}function g(e,t,n,r){let a=I(("string"===typeof t?h(t):t).pathname||"/",n);if(null==a)return null;let i=v(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=P(a);s=T(i[o],e,r)}return s}function v(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,i)=>{let s={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(o(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let l=F([r,s.relativePath]),c=n.concat(s);e.children&&e.children.length>0&&(o(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),v(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:E(l,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of y(e.path))a(e,t,r);else a(e,t)}),t}function y(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let s=y(r.join("/")),o=[];return o.push(...s.map(e=>""===e?i:[i,e].join("/"))),a&&o.push(...s),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const b=/^:[\w-]+$/,w=3,_=2,A=1,S=10,C=-2,x=e=>"*"===e;function E(e,t){let n=e.split("/"),r=n.length;return n.some(x)&&(r+=C),t&&(r+=_),n.filter(e=>!x(e)).reduce((e,t)=>e+(b.test(t)?w:""===t?A:S),r)}function T(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},i="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",d=k({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=k({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),s.push({params:a,pathname:F([i,d.pathname]),pathnameBase:D(F([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=F([i,d.pathnameBase]))}return s}function k(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);l("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:s,pattern:e}}function P(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return l(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function R(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function N(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function O(e,t){let n=N(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function M(e,t,n,a){let i;void 0===a&&(a=!1),"string"===typeof e?i=h(e):(i=r({},e),o(!i.pathname||!i.pathname.includes("?"),R("?","pathname","search",i)),o(!i.pathname||!i.pathname.includes("#"),R("#","pathname","hash",i)),o(!i.search||!i.search.includes("#"),R("#","search","hash",i)));let s,l=""===e||""===i.pathname,c=l?"/":i.pathname;if(null==c)s=n;else{let e=t.length-1;if(!a&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?h(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:L(r),hash:j(a)}}(i,s),u=c&&"/"!==c&&c.endsWith("/"),p=(l||"."===c)&&n.endsWith("/");return d.pathname.endsWith("/")||!u&&!p||(d.pathname+="/"),d}const F=e=>e.join("/").replace(/\/\/+/g,"/"),D=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class B extends Error{}function U(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const G=["post","put","patch","delete"],H=(new Set(G),["get",...G]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred")},1261:(e,t,n)=>{"use strict";n.d(t,{B:()=>r});const r={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"}},1298:(e,t,n)=>{"use strict";n.d(t,{$z:()=>p,Ay:()=>m,P0:()=>f,Q$:()=>l,Z2:()=>c,ZD:()=>h,p_:()=>d,vc:()=>u});var r=n(2555),a=n(4695),i=n.n(a);const s=i().mixin({buttonsStyling:!1,customClass:{popup:"swal2-sunbeth",title:"swal2-sunbeth-title",htmlContainer:"swal2-sunbeth-body",confirmButton:"btn",cancelButton:"btn ghost",denyButton:"btn ghost",actions:"swal2-sunbeth-actions"},showClass:{popup:"swal2-animate-in"},hideClass:{popup:"swal2-animate-out"}}),o=i().mixin({toast:!0,position:"bottom-end",timer:3600,timerProgressBar:!0,showConfirmButton:!1,showCloseButton:!0,buttonsStyling:!1,customClass:{popup:"swal2-sunbeth swal2-toast-sunbeth",title:"swal2-sunbeth-title",htmlContainer:"swal2-sunbeth-body"},showClass:{popup:"swal2-animate-in"},hideClass:{popup:"swal2-animate-out"}});async function l(e,t,n){return s.fire((0,r.A)({icon:"success",title:e,html:t},n))}async function c(e,t,n){return s.fire((0,r.A)({icon:"error",title:e,html:t},n))}async function d(e,t,n){return s.fire((0,r.A)({icon:"info",title:e,html:t},n))}async function u(e,t,n){return s.fire((0,r.A)({icon:"warning",title:e,html:t},n))}async function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Confirm",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Cancel",i=arguments.length>4?arguments[4]:void 0;return!!(await s.fire((0,r.A)({icon:"warning",title:e,html:t,showCancelButton:!0,confirmButtonText:n,cancelButtonText:a},i))).isConfirmed}async function p(e,t,n,a,i,o){const l=await s.fire((0,r.A)({icon:"info",title:e,html:t,showCancelButton:!0,showDenyButton:!!i,confirmButtonText:n,cancelButtonText:a,denyButtonText:i},o));return l.isConfirmed?"confirm":l.isDenied?"deny":"cancel"}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return o.fire({icon:t,title:e})}const m={success:l,error:c,info:d,warning:u,confirm:h,tripleDialog:p,toast:f,toastHtml:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return o.fire({icon:t,html:e})}}},1352:(e,t,n)=>{"use strict";var r=n(7119);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},1756:e=>{e.exports=function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")},e.exports.__esModule=!0,e.exports.default=e.exports},1761:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>i(l,n))c<a&&0>i(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function _(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,O(A);else{var t=r(d);null!==t&&M(_,t.startTime-e)}}function A(e,n){m=!1,g&&(g=!1,y(E),E=-1),f=!0;var i=p;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!P());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&a(c),w(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&M(_,u.startTime-n),l=!1}return l}finally{h=null,p=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,C=!1,x=null,E=-1,T=5,k=-1;function P(){return!(t.unstable_now()-k<T)}function I(){if(null!==x){var e=t.unstable_now();k=e;var n=!0;try{n=x(!0,e)}finally{n?S():(C=!1,x=null)}}else C=!1}if("function"===typeof b)S=function(){b(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,N=R.port2;R.port1.onmessage=I,S=function(){N.postMessage(null)}}else S=function(){v(I,0)};function O(e){x=e,C||(C=!0,S())}function M(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(A))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(d,e),null===r(c)&&e===r(d)&&(g?(y(E),E=-1):g=!0,M(_,i-s))):(e.sortIndex=o,n(c,e),m||f||(m=!0,O(A))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},1815:()=>{},1942:(e,t,n)=>{e.exports=n(3488)()},2049:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var _=Array.isArray,A=Object.prototype.hasOwnProperty,S={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)A.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===i?"."+k(l,0):i,_(s)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),P(s,t,a,"",function(e){return e})):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",_(e))for(var c=0;c<e.length;c++){var d=i+k(o=e[c],c);l+=P(o,t,a,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=P(o=o.value,t,a,d=i+k(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var r=[],a=0;return P(e,r,"","",function(e){return t.call(n,e,a++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},O={transition:null},M={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=F,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)A.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.3.1"},2074:(e,t,n)=>{"use strict";var r,a;n.d(t,{Kd:()=>f,N_:()=>v,Zp:()=>o.Zp,ok:()=>w});var i=n(9950),s=n(7119),o=n(8429),l=n(1018);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function u(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const h=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(_){}new Map;const p=(r||(r=n.t(i,2))).startTransition;(a||(a=n.t(s,2))).flushSync,(r||(r=n.t(i,2))).useId;function f(e){let{basename:t,children:n,future:r,window:a}=e,s=i.useRef();null==s.current&&(s.current=(0,l.zR)({window:a,v5Compat:!0}));let c=s.current,[d,u]=i.useState({action:c.action,location:c.location}),{v7_startTransition:h}=r||{},f=i.useCallback(e=>{h&&p?p(()=>u(e)):u(e)},[u,h]);return i.useLayoutEffect(()=>c.listen(f),[c,f]),i.useEffect(()=>(0,o.V8)(r),[r]),i.createElement(o.Ix,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:c,future:r})}const m="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,g=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v=i.forwardRef(function(e,t){let n,{onClick:r,relative:a,reloadDocument:s,replace:u,state:p,target:f,to:v,preventScrollReset:y,viewTransition:b}=e,w=d(e,h),{basename:A}=i.useContext(o.jb),S=!1;if("string"===typeof v&&g.test(v)&&(n=v,m))try{let e=new URL(window.location.href),t=v.startsWith("//")?new URL(e.protocol+v):new URL(v),n=(0,l.pb)(t.pathname,A);t.origin===e.origin&&null!=n?v=n+t.search+t.hash:S=!0}catch(_){}let C=(0,o.$P)(v,{relative:a}),x=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:s,relative:c,viewTransition:d}=void 0===t?{}:t,u=(0,o.Zp)(),h=(0,o.zy)(),p=(0,o.x$)(e,{relative:c});return i.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:(0,l.AO)(h)===(0,l.AO)(p);u(e,{replace:n,state:a,preventScrollReset:s,relative:c,viewTransition:d})}},[h,u,p,r,a,n,e,s,c,d])}(v,{replace:u,state:p,target:f,preventScrollReset:y,relative:a,viewTransition:b});return i.createElement("a",c({},w,{href:n||C,onClick:S||s?r:function(e){r&&r(e),e.defaultPrevented||x(e)},ref:t,target:f}))});var y,b;function w(e){let t=i.useRef(u(e)),n=i.useRef(!1),r=(0,o.zy)(),a=i.useMemo(()=>function(e,t){let n=u(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),s=(0,o.Zp)(),l=i.useCallback((e,t)=>{const r=u("function"===typeof e?e(a):e);n.current=!0,s("?"+r,t)},[s,a]);return[a,l]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(y||(y={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(b||(b={}))},2241:e=>{"use strict";var t=function(){};e.exports=t},2459:(e,t,n)=>{var r=n(7101);e.exports=function(e,t,n){r(e,t),t.set(e,n)},e.exports.__esModule=!0,e.exports.default=e.exports},2555:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>o})},2654:(e,t,n)=>{"use strict";var r=n(9950),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},2746:(e,t,n)=>{"use strict";n.d(t,{R8:()=>s,b:()=>r,pq:()=>i,z3:()=>o});const r=()=>{window.__sunbethLogs||(window.__sunbethLogs=[])},a=(e,t,n)=>{try{const a={ts:(new Date).toISOString(),level:e,msg:t,meta:n};"error"===e?console.error("[sunbeth]",t,n):"warn"===e?console.warn("[sunbeth]",t,n):console.log("[sunbeth]",t,n);const i=window;i.__sunbethLogs||r(),i.__sunbethLogs.push(a),i.__sunbethLogs.length>200&&i.__sunbethLogs.shift()}catch(a){}},i=(e,t)=>a("info",e,t),s=(e,t)=>a("warn",e,t),o=(e,t)=>a("error",e,t)},2787:()=>{},2897:(e,t,n)=>{var r=n(3693);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2932:(e,t,n)=>{"use strict";n.d(t,{$P:()=>l,Al:()=>d,Vg:()=>o,mu:()=>c});var r=n(2555),a=n(2935);const i=(()=>{try{return((0,a.Gi)()||"").replace(/\/$/,"")}catch(e){return""}})(),s=e=>{const t=e.startsWith("/")?e:"/".concat(e);return i?"".concat(i).concat(t):t};async function o(e,t){const n=await fetch(s(e),(0,r.A)({method:"GET"},t||{}));if(!n.ok)throw new Error("GET ".concat(e," failed: ").concat(n.status));return await n.json()}async function l(e,t,n){const a=await fetch(s(e),(0,r.A)({method:"POST",headers:(0,r.A)({"Content-Type":"application/json"},(null===n||void 0===n?void 0:n.headers)||{}),body:void 0!==t?JSON.stringify(t):void 0},n));if(!a.ok)throw new Error("POST ".concat(e," failed: ").concat(a.status));return await a.json()}async function c(e,t,n){const a=await fetch(s(e),(0,r.A)({method:"PUT",headers:(0,r.A)({"Content-Type":"application/json"},(null===n||void 0===n?void 0:n.headers)||{}),body:void 0!==t?JSON.stringify(t):void 0},n));if(!a.ok)throw new Error("PUT ".concat(e," failed: ").concat(a.status));return await a.json()}async function d(e,t){const n=await fetch(s(e),(0,r.A)({method:"DELETE"},t||{}));if(!n.ok)throw new Error("DELETE ".concat(e," failed: ").concat(n.status));return await n.json()}},2935:(e,t,n)=>{"use strict";n.d(t,{EO:()=>f,G8:()=>u,Gi:()=>d,JH:()=>a,KB:()=>l,Kr:()=>r,MV:()=>i,O2:()=>o,_V:()=>c,fp:()=>p,g2:()=>m,pU:()=>s,s8:()=>h,yQ:()=>g});const r=()=>!0,a=()=>"Sunbeth Document Acknowledgement Portal",i=()=>"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",s=()=>"#0a3d33",o=()=>{const e="oluwatoba.ogunsakin@sunbeth.net".trim();return e?e.split(",").map(e=>e.trim()).filter(Boolean):[]},l=()=>{const e=({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_COMPLETION_CC||"").trim();return e?e.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean):[]},c=()=>{const e=({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_COMPLETION_BCC||"").trim();return e?e.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean):[]},d=()=>{const e="https://sunbeth-ack-portal-backend.vercel.app/".trim();return e?e.replace(/\/$/,""):null},u=()=>"true"==="false".toLowerCase(),h=()=>"true"==="true".toLowerCase(),p=()=>"a8337154-a8a8-400d-8817-c03ade433449",f=()=>"3493b8fa-b849-45bc-b23e-7d0384e4fa46",m=()=>{const e=Number({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_BUSY_DELAY_SECS);if(Number.isFinite(e)&&e>=0)return Math.round(1e3*e);const t=Number({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_BUSY_DELAY_MS);return Number.isFinite(t)&&t>=0?Math.round(t):150},g=()=>{const e=Number({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_BUSY_MIN_VISIBLE_SECS);if(Number.isFinite(e)&&e>=0)return Math.round(1e3*e);const t=Number({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_BUSY_MIN_VISIBLE_MS);return Number.isFinite(t)&&t>=0?Math.round(t):600}},3114:(module,__unused_webpack_exports,__webpack_require__)=>{var _objectSpread=__webpack_require__(2897).default,_classPrivateGetter=__webpack_require__(183).default,_defineProperty=__webpack_require__(3693).default,_classPrivateMethodInitSpec=__webpack_require__(3312).default,_assertClassBrand=__webpack_require__(1756).default,_classPrivateFieldInitSpec=__webpack_require__(2459).default,_classPrivateFieldGet=__webpack_require__(6668).default,_classPrivateFieldSet=__webpack_require__(7088).default,root,factory;root=globalThis,factory=()=>(()=>{"use strict";var __webpack_modules__=[,(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=function(e,t){e||o(t)},t.bytesToString=d,t.createValidAbsoluteUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;try{if(n&&"string"===typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null===t||void 0===t?void 0:t.length)>=2&&(e="http://".concat(e))}if(n.tryConvertEncoding)try{e=f(e)}catch(r){}}const a=t?new URL(e,t):new URL(e);if(function(e){switch(null===e||void 0===e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(a))return a}catch(a){}return null},t.getModificationDate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getUuid=function(){var e,t;if("undefined"!==typeof crypto&&"function"===typeof(null===(e=crypto)||void 0===e?void 0:e.randomUUID))return crypto.randomUUID();const n=new Uint8Array(32);if("undefined"!==typeof crypto&&"function"===typeof(null===(t=crypto)||void 0===t?void 0:t.getRandomValues))crypto.getRandomValues(n);else for(let r=0;r<32;r++)n[r]=Math.floor(255*Math.random());return d(n)},t.getVerbosityLevel=function(){return i},t.info=function(e){i>=a.INFOS&&console.log("Info: ".concat(e))},t.isArrayBuffer=function(e){return"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.byteLength)},t.isArrayEqual=function(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0},t.isNodeJS=void 0,t.normalizeUnicode=function(e){return g||(g=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,v=new Map([["\ufb05","\u017ft"]])),e.replaceAll(g,(e,t,n)=>t?t.normalize("NFKC"):v.get(n))},t.objectFromMap=function(e){const t=Object.create(null);for(const[n,r]of e)t[n]=r;return t},t.objectSize=function(e){return Object.keys(e).length},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(i=e)},t.shadow=l,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=u,t.stringToPDFString=function(e){if(e[0]>="\xef"){let t;if("\xfe"===e[0]&&"\xff"===e[1]?t="utf-16be":"\xff"===e[0]&&"\xfe"===e[1]?t="utf-16le":"\xef"===e[0]&&"\xbb"===e[1]&&"\xbf"===e[2]&&(t="utf-8"),t)try{const n=new TextDecoder(t,{fatal:!0}),r=u(e);return n.decode(r)}catch(n){s('stringToPDFString: "'.concat(n,'".'))}}const t=[];for(let r=0,a=e.length;r<a;r++){const n=p[e.charCodeAt(r)];t.push(n?String.fromCharCode(n):e.charAt(r))}return t.join("")},t.stringToUTF8String=f,t.unreachable=o,t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=s;const n="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=n,t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.MAX_IMAGE_SIZE_TO_CACHE=1e7,t.LINE_FACTOR=1.35,t.LINE_DESCENT_FACTOR=.35;const r=.35/1.35;t.BASELINE_FACTOR=r,t.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},t.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},t.AnnotationEditorPrefix="pdfjs_internal_editor_",t.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15},t.AnnotationEditorParamsType={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},t.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},t.PageActionEventType={O:"PageOpen",C:"PageClose"};const a={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=a,t.CMapCompressionType={NONE:0,BINARY:1},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let i=a.WARNINGS;function s(e){i>=a.WARNINGS&&console.log("Warning: ".concat(e))}function o(e){throw new Error(e)}function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!0,writable:!1}),n}const c=function(){function e(t,n){this.constructor===e&&o("Cannot initialize BaseException."),this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();function d(e){"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.length)||o("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const r=[];for(let a=0;a<t;a+=n){const i=Math.min(a+n,t),s=e.subarray(a,i);r.push(String.fromCharCode.apply(null,s))}return r.join("")}function u(e){"string"!==typeof e&&o("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n}t.BaseException=c,t.PasswordException=class extends c{constructor(e,t){super(e,"PasswordException"),this.code=t}},t.UnknownErrorException=class extends c{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},t.InvalidPDFException=class extends c{constructor(e){super(e,"InvalidPDFException")}},t.MissingPDFException=class extends c{constructor(e){super(e,"MissingPDFException")}},t.UnexpectedResponseException=class extends c{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},t.FormatError=class extends c{constructor(e){super(e,"FormatError")}},t.AbortException=class extends c{constructor(e){super(e,"AbortException")}},t.FeatureTest=class{static get isLittleEndian(){return l(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return l(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}static get isOffscreenCanvasSupported(){return l(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get platform(){return"undefined"===typeof navigator?l(this,"platform",{isWin:!1,isMac:!1}):l(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var e,t;return l(this,"isCSSRoundSupported",null===(e=globalThis.CSS)||void 0===e||null===(t=e.supports)||void 0===t?void 0:t.call(e,"width: round(1.5px, 1px)"))}};const h=[...Array(256).keys()].map(e=>e.toString(16).padStart(2,"0"));t.Util=class{static makeHexColor(e,t,n){return"#".concat(h[e]).concat(h[t]).concat(h[n])}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[0],t[1]*=e[0],e[3]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[2],t[2]=n,n=t[1],t[1]=t[3],t[3]=n,e[1]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[2],t[1]*=e[2]),t[0]+=e[4],t[1]+=e[4],t[2]+=e[5],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),i=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],a[0],i[0]),Math.min(n[1],r[1],a[1],i[1]),Math.max(n[0],r[0],a[0],i[0]),Math.max(n[1],r[1],a[1],i[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],i=e[2]*t[1]+e[3]*t[3],s=(n+i)/2,o=Math.sqrt((n+i)**2-4*(n*i-a*r))/2,l=s+o||1,c=s-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),i=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>i?null:[n,a,r,i]}static bezierBoundingBox(e,t,n,r,a,i,s,o){const l=[],c=[[],[]];let d,u,h,p,f,m,g,v;for(let _=0;_<2;++_)if(0===_?(u=6*e-12*n+6*a,d=-3*e+9*n-9*a+3*s,h=3*n-3*e):(u=6*t-12*r+6*i,d=-3*t+9*r-9*i+3*o,h=3*r-3*t),Math.abs(d)<1e-12){if(Math.abs(u)<1e-12)continue;p=-h/u,0<p&&p<1&&l.push(p)}else g=u*u-4*h*d,v=Math.sqrt(g),g<0||(f=(-u+v)/(2*d),0<f&&f<1&&l.push(f),m=(-u-v)/(2*d),0<m&&m<1&&l.push(m));let y,b=l.length;const w=b;for(;b--;)p=l[b],y=1-p,c[0][b]=y*y*y*e+3*y*y*p*n+3*y*p*p*a+p*p*p*s,c[1][b]=y*y*y*t+3*y*y*p*r+3*y*p*p*i+p*p*p*o;return c[0][w]=e,c[1][w]=t,c[0][w+1]=s,c[1][w+1]=o,c[0].length=c[1].length=w+2,[Math.min(...c[0]),Math.min(...c[1]),Math.max(...c[0]),Math.max(...c[1])]}};const p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function f(e){return decodeURIComponent(escape(e))}var m=new WeakMap;t.PromiseCapability=class{constructor(){_classPrivateFieldInitSpec(this,m,!1),this.promise=new Promise((e,t)=>{this.resolve=t=>{_classPrivateFieldSet(m,this,!0),e(t)},this.reject=e=>{_classPrivateFieldSet(m,this,!0),t(e)}})}get settled(){return _classPrivateFieldGet(m,this)}};let g=null,v=null;t.AnnotationPrefix="pdfjs_internal_id_"},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;function getDocument(e){var t,n;if("string"===typeof e||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),"object"!==typeof e)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const r=new PDFDocumentLoadingTask,{docId:a}=r,i=e.url?getUrlProp(e.url):null,s=e.data?getDataProp(e.data):null,o=e.httpHeaders||null,l=!0===e.withCredentials,c=null!==(t=e.password)&&void 0!==t?t:null,d=e.range instanceof PDFDataRangeTransport?e.range:null,u=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let h=e.worker instanceof PDFWorker?e.worker:null;const p=e.verbosity,f="string"!==typeof e.docBaseUrl||(0,_display_utils.isDataScheme)(e.docBaseUrl)?null:e.docBaseUrl,m="string"===typeof e.cMapUrl?e.cMapUrl:null,g=!1!==e.cMapPacked,v=e.CMapReaderFactory||DefaultCMapReaderFactory,y="string"===typeof e.standardFontDataUrl?e.standardFontDataUrl:null,b=e.StandardFontDataFactory||DefaultStandardFontDataFactory,w=!0!==e.stopAtErrors,_=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,A=!1!==e.isEvalSupported,S="boolean"===typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!_util.isNodeJS,C=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,x="boolean"===typeof e.disableFontFace?e.disableFontFace:_util.isNodeJS,E=!0===e.fontExtraProperties,T=!0===e.enableXfa,k=e.ownerDocument||globalThis.document,P=!0===e.disableRange,I=!0===e.disableStream,R=!0===e.disableAutoFetch,N=!0===e.pdfBug,O=d?d.length:null!==(n=e.length)&&void 0!==n?n:NaN,M="boolean"===typeof e.useSystemFonts?e.useSystemFonts:!_util.isNodeJS&&!x,F="boolean"===typeof e.useWorkerFetch?e.useWorkerFetch:v===_display_utils.DOMCMapReaderFactory&&b===_display_utils.DOMStandardFontDataFactory&&m&&y&&(0,_display_utils.isValidFetchUrl)(m,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(y,document.baseURI),D=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:k}),L=e.filterFactory||new DefaultFilterFactory({docId:a,ownerDocument:k});(0,_util.setVerbosityLevel)(p);const j={canvasFactory:D,filterFactory:L};if(F||(j.cMapReaderFactory=new v({baseUrl:m,isCompressed:g}),j.standardFontDataFactory=new b({baseUrl:y})),!h){const e={verbosity:p,port:_worker_options.GlobalWorkerOptions.workerPort};h=e.port?PDFWorker.fromPort(e):new PDFWorker(e),r._worker=h}const B={docId:a,apiVersion:"3.11.174",data:s,password:c,disableAutoFetch:R,rangeChunkSize:u,length:O,docBaseUrl:f,enableXfa:T,evaluatorOptions:{maxImageSize:_,disableFontFace:x,ignoreErrors:w,isEvalSupported:A,isOffscreenCanvasSupported:S,canvasMaxAreaInBytes:C,fontExtraProperties:E,useSystemFonts:M,cMapUrl:F?m:null,standardFontDataUrl:F?y:null}},U={ignoreErrors:w,isEvalSupported:A,disableFontFace:x,fontExtraProperties:E,enableXfa:T,ownerDocument:k,disableAutoFetch:R,pdfBug:N,styleElement:null};return h.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(h,B),t=new Promise(function(e){let t;var n;d?t=new _transport_stream.PDFDataTransportStream({length:O,initialData:d.initialData,progressiveDone:d.progressiveDone,contentDispositionFilename:d.contentDispositionFilename,disableRange:P,disableStream:I},d):s||(n={url:i,length:O,httpHeaders:o,withCredentials:l,rangeChunkSize:u,disableRange:P,disableStream:I},t=_util.isNodeJS?new _displayNode_stream.PDFNodeStream(n):(0,_display_utils.isValidFetchUrl)(n.url)?new _displayFetch_stream.PDFFetchStream(n):new _displayNetwork.PDFNetworkStream(n)),e(t)});return Promise.all([e,t]).then(function(e){let[t,n]=e;if(r.destroyed)throw new Error("Loading aborted");const i=new _message_handler.MessageHandler(a,t,h.port),s=new WorkerTransport(i,r,n,U,j);r._transport=s,i.send("Ready",null)})}).catch(r._capability.reject),r}async function _fetchDocument(e,t){if(e.destroyed)throw new Error("Worker was destroyed");const n=await e.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(e.destroyed)throw new Error("Worker was destroyed");return n}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch(t){if(_util.isNodeJS&&"string"===typeof e)return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_util.isNodeJS&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return(0,_util.stringToBytes)(e);if("object"===typeof e&&!isNaN(null===e||void 0===e?void 0:e.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;class PDFDocumentLoadingTask{constructor(){var e,t;this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId="d".concat((_docId._=(e=_docId._,t=e++,e),t)),this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{var e,t;null!==(e=this._worker)&&void 0!==e&&e.port&&(this._worker._pendingDestroy=!0),await(null===(t=this._transport)||void 0===t?void 0:t.destroy())}catch(r){var n;throw null!==(n=this._worker)&&void 0!==n&&n.port&&delete this._worker._pendingDestroy,r}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}var _docId={_:0};exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(e=>{if(!e)return e;const t=[];for(const n in e)t.push(...e[n]);return t}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;var _delayedCleanupTimeout=new WeakMap,_pendingCleanup=new WeakMap,_PDFPageProxy_brand=new WeakSet;class PDFPageProxy{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classPrivateMethodInitSpec(this,_PDFPageProxy_brand),_classPrivateFieldInitSpec(this,_delayedCleanupTimeout,null),_classPrivateFieldInitSpec(this,_pendingCleanup,!1),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:a})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null===(e=this._transport._htmlForXfa)||void 0===e?void 0:e.children[this._pageIndex])||null}render(e){var t,n;let{canvasContext:r,viewport:a,intent:i="display",annotationMode:s=_util.AnnotationMode.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:d=null,pageColors:u=null,printAnnotationStorage:h=null}=e;null===(t=this._stats)||void 0===t||t.time("Overall");const p=this._transport.getRenderingIntent(i,s,h);_classPrivateFieldSet(_pendingCleanup,this,!1),_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),c||(c=this._transport.getOptionalContentConfig());let f=this._intentStates.get(p.cacheKey);f||(f=Object.create(null),this._intentStates.set(p.cacheKey,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const m=!!(p.renderingIntent&_util.RenderingIntentFlag.PRINT);var g;f.displayReadyCapability||(f.displayReadyCapability=new _util.PromiseCapability,f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(g=this._stats)||void 0===g||g.time("Page Request"),this._pumpOperatorList(p));const v=e=>{var t,n;f.renderTasks.delete(y),(this._maybeCleanupAfterRender||m)&&_classPrivateFieldSet(_pendingCleanup,this,!0),_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!m),e?(y.capability.reject(e),this._abortOperatorList({intentState:f,reason:e instanceof Error?e:new Error(e)})):y.capability.resolve(),null===(t=this._stats)||void 0===t||t.timeEnd("Rendering"),null===(n=this._stats)||void 0===n||n.timeEnd("Overall")},y=new InternalRenderTask({callback:v,params:{canvasContext:r,viewport:a,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:u});((n=f).renderTasks||(n.renderTasks=new Set)).add(y);const b=y.task;return Promise.all([f.displayReadyCapability.promise,c]).then(e=>{var t;let[n,r]=e;this.destroyed?v():(null===(t=this._stats)||void 0===t||t.time("Rendering"),y.initializeGraphics({transparency:n,optionalContentConfig:r}),y.operatorListChanged())}).catch(v),b}getOperatorList(){let{intent:e="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this._transport.getRenderingIntent(e,t,n,!0);let a,i=this._intentStates.get(r.cacheKey);var s,o;return i||(i=Object.create(null),this._intentStates.set(r.cacheKey,i)),i.opListReadCapability||(a=Object.create(null),a.operatorListChanged=function(){i.operatorList.lastChunk&&(i.opListReadCapability.resolve(i.operatorList),i.renderTasks.delete(a))},i.opListReadCapability=new _util.PromiseCapability,((s=i).renderTasks||(s.renderTasks=new Set)).add(a),i.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(o=this._stats)||void 0===o||o.time("Page Request"),this._pumpOperatorList(r)),i.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const r=t.getReader(),a={items:[],styles:Object.create(null)};!function t(){r.read().then(function(n){let{value:r,done:i}=n;i?e(a):(Object.assign(a.styles,r.styles),a.items.push(...r.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),_classPrivateFieldSet(_pendingCleanup,this,!1),_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classPrivateFieldSet(_pendingCleanup,this,!0);const t=_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!1);return e&&t&&this._stats&&(this._stats=new _display_utils.StatTimer),t}_startRenderPage(e,t){var n,r;const a=this._intentStates.get(t);a&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(r=a.displayReadyCapability)||void 0===r||r.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!0)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:n,annotationStorageSerializable:r}=e;const{map:a,transfers:i}=r,s=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:a},i).getReader(),o=this._intentStates.get(n);o.streamReader=s;const l=()=>{s.read().then(e=>{let{value:t,done:n}=e;n?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),l())},e=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const e of o.renderTasks)e.operatorListChanged();_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(e);else{if(!o.opListReadCapability)throw e;o.opListReadCapability.reject(e)}}})};l()}_abortOperatorList(e){let{intentState:t,reason:n,force:r=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!r){if(t.renderTasks.size>0)return;if(n instanceof _display_utils.RenderingCancelledException){let e=RENDERING_CANCELLED_TIMEOUT;return n.extraDelay>0&&n.extraDelay<1e3&&(e+=n.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},e))}}if(t.streamReader.cancel(new _util.AbortException(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function _tryCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),!_classPrivateFieldGet(_pendingCleanup,this)||this.destroyed)return!1;if(e)return _classPrivateFieldSet(_delayedCleanupTimeout,this,setTimeout(()=>{_classPrivateFieldSet(_delayedCleanupTimeout,this,null),_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_classPrivateFieldSet(_pendingCleanup,this,!1),!0}function _abortDelayedCleanup(){_classPrivateFieldGet(_delayedCleanupTimeout,this)&&(clearTimeout(_classPrivateFieldGet(_delayedCleanupTimeout,this)),_classPrivateFieldSet(_delayedCleanupTimeout,this,null))}exports.PDFPageProxy=PDFPageProxy;var _listeners=new WeakMap,_deferred=new WeakMap;class LoopbackPort{constructor(){_classPrivateFieldInitSpec(this,_listeners,new Set),_classPrivateFieldInitSpec(this,_deferred,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};_classPrivateFieldGet(_deferred,this).then(()=>{for(const e of _classPrivateFieldGet(_listeners,this))e.call(this,n)})}addEventListener(e,t){_classPrivateFieldGet(_listeners,this).add(t)}removeEventListener(e,t){_classPrivateFieldGet(_listeners,this).delete(t)}terminate(){_classPrivateFieldGet(_listeners,this).clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_util.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"===typeof document){var _document;const e=null===(_document=document)||void 0===_document||null===(_document=_document.currentScript)||void 0===_document?void 0:_document.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let n;try{if(n=new URL(e),!n.origin||"null"===n.origin)return!1}catch(a){return!1}const r=new URL(t,n);return n.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t='importScripts("'.concat(e,'");');return URL.createObjectURL(new Blob([t]))};class PDFWorker{constructor(){let{name:e=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){var r;if(null!==(r=_workerPorts._)&&void 0!==r&&r.has(t))throw new Error("Cannot use more than one PDFWorker per port.");return(_workerPorts._||(_workerPorts._=new WeakMap)).set(t,this),void this._initializeFromPort(t)}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:t}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,t)||(t=PDFWorkerUtil.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t),n=new _message_handler.MessageHandler("main","worker",e),r=()=>{e.removeEventListener("error",a),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||r()};e.addEventListener("error",a),n.on("test",t=>{e.removeEventListener("error",a),this.destroyed?r():t?(this._messageHandler=n,this._port=e,this._webWorker=e,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),e.terminate())}),n.on("ready",t=>{if(e.removeEventListener("error",a),this.destroyed)r();else try{i()}catch(n){this._setupFakeWorker()}});const i=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void i()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const n="fake".concat(PDFWorkerUtil.fakeWorkerId++),r=new _message_handler.MessageHandler(n+"_worker",n,t);e.setup(r,t);const a=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}destroy(){var e;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),null===(e=_workerPorts._)||void 0===e||e.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){var t;if(null===e||void 0===e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const n=null===(t=_assertClassBrand(PDFWorker,this,_workerPorts)._)||void 0===t?void 0:t.get(e.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{var e;return(null===(e=globalThis.pdfjsWorker)||void 0===e?void 0:e.WorkerMessageHandler)||null}catch(t){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}var _workerPorts={_:void 0};exports.PDFWorker=PDFWorker;var _methodPromises=new WeakMap,_pageCache=new WeakMap,_pagePromises=new WeakMap,_passwordCapability=new WeakMap,_WorkerTransport_brand=new WeakSet;class WorkerTransport{constructor(e,t,n,r,a){_classPrivateMethodInitSpec(this,_WorkerTransport_brand),_classPrivateFieldInitSpec(this,_methodPromises,new Map),_classPrivateFieldInitSpec(this,_pageCache,new Map),_classPrivateFieldInitSpec(this,_pagePromises,new Map),_classPrivateFieldInitSpec(this,_passwordCapability,null),this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_util.AnnotationMode.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=_util.RenderingIntentFlag.DISPLAY,i=_annotation_storage.SerializableEmpty;switch(e){case"any":a=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":a=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)("getRenderingIntent - invalid intent: ".concat(e))}switch(t){case _util.AnnotationMode.DISABLE:a+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:a+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:a+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,i=(a&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)("getRenderingIntent - invalid annotationMode: ".concat(t))}return r&&(a+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:a,cacheKey:"".concat(a,"_").concat(i.hash),annotationStorageSerializable:i}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,null===(e=_classPrivateFieldGet(_passwordCapability,this))||void 0===e||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of _classPrivateFieldGet(_pageCache,this).values())t.push(r._destroy());_classPrivateFieldGet(_pageCache,this).clear(),_classPrivateFieldGet(_pagePromises,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e;this.commonObjs.clear(),this.fontLoader.clear(),_classPrivateFieldGet(_methodPromises,this).clear(),this.filterFactory.destroy(),null===(e=this._networkStream)||void 0===e||e.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function(e){let{value:n,done:r}=e;r?t.close():((0,_util.assert)(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",e=>{const n=new _util.PromiseCapability,r=this._fullReader;return r.headersReady.then(()=>{var e;r.isStreamingSupported&&r.isRangeSupported||(this._lastProgress&&(null===(e=t.onProgress)||void 0===e||e.call(t,this._lastProgress)),r.onProgress=e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})});n.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},n.reject),n.promise}),e.on("GetRangeReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function(e){let{value:n,done:r}=e;r?t.close():((0,_util.assert)(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",e=>{let{pdfInfo:n}=e;this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",function(e){let n;switch(e.name){case"PasswordException":n=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":n=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":n=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":n=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":n=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(n)}),e.on("PasswordRequest",e=>{if(_classPrivateFieldSet(_passwordCapability,this,new _util.PromiseCapability),t.onPassword){const r=e=>{e instanceof Error?_classPrivateFieldGet(_passwordCapability,this).reject(e):_classPrivateFieldGet(_passwordCapability,this).resolve({password:e})};try{t.onPassword(r,e.code)}catch(n){_classPrivateFieldGet(_passwordCapability,this).reject(n)}}else _classPrivateFieldGet(_passwordCapability,this).reject(new _util.PasswordException(e.message,e.code));return _classPrivateFieldGet(_passwordCapability,this).promise}),e.on("DataLoaded",e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{this.destroyed||_classPrivateFieldGet(_pageCache,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",t=>{var n;let[r,a,i]=t;if(!this.destroyed&&!this.commonObjs.has(r))switch(a){case"Font":const t=this._params;if("error"in i){const e=i.error;(0,_util.warn)("Error during font loading: ".concat(e)),this.commonObjs.resolve(r,e);break}const s=t.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,o=new _font_loader.FontFaceObject(i,{isEvalSupported:t.isEvalSupported,disableFontFace:t.disableFontFace,ignoreErrors:t.ignoreErrors,inspectFont:s});this.fontLoader.bind(o).catch(t=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!t.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(r,o)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,i);break;default:throw new Error("Got unknown common object type ".concat(a))}}),e.on("obj",e=>{let[t,n,r,a]=e;if(this.destroyed)return;const i=_classPrivateFieldGet(_pageCache,this).get(n);if(!i.objs.has(t))switch(r){case"Image":if(i.objs.resolve(t,a),a){let e;if(a.bitmap){const{width:t,height:n}=a;e=t*n*4}else{var s;e=(null===(s=a.data)||void 0===s?void 0:s.length)||0}e>_util.MAX_IMAGE_SIZE_TO_CACHE&&(i._maybeCleanupAfterRender=!0)}break;case"Pattern":i.objs.resolve(t,a);break;default:throw new Error("Got unknown object type ".concat(r))}}),e.on("DocProgress",e=>{var n;this.destroyed||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}),e.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e,t;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfers:r}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(e=null===(t=this._fullReader)||void 0===t?void 0:t.filename)&&void 0!==e?e:null},r).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=_classPrivateFieldGet(_pagePromises,this).get(t);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(e=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(t,e,this,this._params.pdfBug);return _classPrivateFieldGet(_pageCache,this).set(t,n),n});return _classPrivateFieldGet(_pagePromises,this).set(t,r),r}getPageIndex(e){return"object"!==typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"GetFieldObjects")}hasJSActions(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=_classPrivateFieldGet(_methodPromises,this).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n,r,a;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:null!==(t=null===(n=this._fullReader)||void 0===n?void 0:n.filename)&&void 0!==t?t:null,contentLength:null!==(r=null===(a=this._fullReader)||void 0===a?void 0:a.contentLength)&&void 0!==r?r:null}});return _classPrivateFieldGet(_methodPromises,this).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of _classPrivateFieldGet(_pageCache,this).values())if(!e.cleanup())throw new Error("startCleanup: Page ".concat(e.pageNumber," is currently rendering."));this.commonObjs.clear(),e||this.fontLoader.clear(),_classPrivateFieldGet(_methodPromises,this).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:t}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:t})}}function _cacheSimpleMethod(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=_classPrivateFieldGet(_methodPromises,this).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return _classPrivateFieldGet(_methodPromises,this).set(e,r),r}var _objs=new WeakMap,_PDFObjects_brand=new WeakSet;class PDFObjects{constructor(){_classPrivateMethodInitSpec(this,_PDFObjects_brand),_classPrivateFieldInitSpec(this,_objs,Object.create(null))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const n=_assertClassBrand(_PDFObjects_brand,this,_ensureObj).call(this,e);return n.capability.promise.then(()=>t(n.data)),null}const n=_classPrivateFieldGet(_objs,this)[e];if(null===n||void 0===n||!n.capability.settled)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}has(e){const t=_classPrivateFieldGet(_objs,this)[e];return(null===t||void 0===t?void 0:t.capability.settled)||!1}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=_assertClassBrand(_PDFObjects_brand,this,_ensureObj).call(this,e);n.data=t,n.capability.resolve()}clear(){for(const t in _classPrivateFieldGet(_objs,this)){var e;const{data:n}=_classPrivateFieldGet(_objs,this)[t];null===n||void 0===n||null===(e=n.bitmap)||void 0===e||e.close()}_classPrivateFieldSet(_objs,this,Object.create(null))}}function _ensureObj(e){var t;return(t=_classPrivateFieldGet(_objs,this))[e]||(t[e]={capability:new _util.PromiseCapability,data:null})}var _internalRenderTask=new WeakMap;class RenderTask{constructor(e){_classPrivateFieldInitSpec(this,_internalRenderTask,null),_classPrivateFieldSet(_internalRenderTask,this,e),this.onContinue=null}get promise(){return _classPrivateFieldGet(_internalRenderTask,this).capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;_classPrivateFieldGet(_internalRenderTask,this).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=_classPrivateFieldGet(_internalRenderTask,this).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=_classPrivateFieldGet(_internalRenderTask,this);return e.form||e.canvas&&(null===t||void 0===t?void 0:t.size)>0}}exports.RenderTask=RenderTask;class InternalRenderTask{constructor(e){let{callback:t,params:n,objs:r,commonObjs:a,annotationCanvasMap:i,operatorList:s,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:h=null}=e;this.callback=t,this.params=n,this.objs=r,this.commonObjs=a,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!==typeof window,this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(e){var t,n;let{transparency:r=!1,optionalContentConfig:a}=e;if(this.cancelled)return;if(this._canvas){if(_canvasInUse._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_canvasInUse._.add(this._canvas)}this._pdfBug&&null!==(t=globalThis.StepperManager)&&void 0!==t&&t.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:o,background:l}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:a},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:s,transparency:r,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(e=this.gfx)||void 0===e||e.endDrawing(),_canvasInUse._.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException("Rendering cancelled, page ".concat(this._pageIndex+1),n))}operatorListChanged(){var e;this.graphicsReady?(null===(e=this.stepper)||void 0===e||e.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),_canvasInUse._.delete(this._canvas),this.callback())))}}var _canvasInUse={_:new WeakSet};const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var r=n(1),a=n(4),i=n(8);const s=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=s;var o=new WeakMap,l=new WeakMap,c=new WeakSet;class d{constructor(){_classPrivateMethodInitSpec(this,c),_classPrivateFieldInitSpec(this,o,!1),_classPrivateFieldInitSpec(this,l,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=_classPrivateFieldGet(l,this).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return _classPrivateFieldGet(l,this).get(e)}remove(e){if(_classPrivateFieldGet(l,this).delete(e),0===_classPrivateFieldGet(l,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const e of _classPrivateFieldGet(l,this).values())if(e instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=_classPrivateFieldGet(l,this).get(e);let r=!1;if(void 0!==n)for(const[a,i]of Object.entries(t))n[a]!==i&&(r=!0,n[a]=i);else r=!0,_classPrivateFieldGet(l,this).set(e,t);r&&_assertClassBrand(c,this,u).call(this),t instanceof a.AnnotationEditor&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return _classPrivateFieldGet(l,this).has(e)}getAll(){return _classPrivateFieldGet(l,this).size>0?(0,r.objectFromMap)(_classPrivateFieldGet(l,this)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return _classPrivateFieldGet(l,this).size}resetModified(){_classPrivateFieldGet(o,this)&&(_classPrivateFieldSet(o,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new p(this)}get serializable(){if(0===_classPrivateFieldGet(l,this).size)return s;const e=new Map,t=new i.MurmurHash3_64,n=[],r=Object.create(null);let o=!1;for(const[i,s]of _classPrivateFieldGet(l,this)){const n=s instanceof a.AnnotationEditor?s.serialize(!1,r):s;n&&(e.set(i,n),t.update("".concat(i,":").concat(JSON.stringify(n))),o||(o=!!n.bitmap))}if(o)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfers:n}:s}}function u(){_classPrivateFieldGet(o,this)||(_classPrivateFieldSet(o,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}t.AnnotationStorage=d;var h=new WeakMap;class p extends d{constructor(e){super(),_classPrivateFieldInitSpec(this,h,void 0);const{map:t,hash:n,transfers:r}=e.serializable,a=structuredClone(t,r?{transfer:r}:null);_classPrivateFieldSet(h,this,{map:a,hash:n,transfers:r})}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return _classPrivateFieldGet(h,this)}}t.PrintAnnotationStorage=p},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var a=n(5),i=n(1),s=n(6),o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,b=new WeakMap,w=new WeakMap,_=new WeakSet;class A{constructor(e){_classPrivateMethodInitSpec(this,_),_classPrivateFieldInitSpec(this,o,""),_classPrivateFieldInitSpec(this,l,!1),_classPrivateFieldInitSpec(this,c,null),_classPrivateFieldInitSpec(this,d,null),_classPrivateFieldInitSpec(this,u,null),_classPrivateFieldInitSpec(this,h,!1),_classPrivateFieldInitSpec(this,p,null),_classPrivateFieldInitSpec(this,f,this.focusin.bind(this)),_classPrivateFieldInitSpec(this,m,this.focusout.bind(this)),_classPrivateFieldInitSpec(this,g,!1),_classPrivateFieldInitSpec(this,v,!1),_classPrivateFieldInitSpec(this,y,!1),_defineProperty(this,"_initialOptions",Object.create(null)),_defineProperty(this,"_uiManager",null),_defineProperty(this,"_focusEventsAllowed",!0),_defineProperty(this,"_l10nPromise",null),_classPrivateFieldInitSpec(this,b,!1),_classPrivateFieldInitSpec(this,w,A._zIndex++),this.constructor===A&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:s}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[a,s];const[S,C]=this.parentDimensions;this.x=e.x/S,this.y=e.y/C,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new N({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(A._l10nPromise||(A._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(t=>[t,e.get(t)]))),null!==t&&void 0!==t&&t.strings)for(const r of t.strings)A._l10nPromise.set(r,e.get(r));if(-1!==A._borderLineWidth)return;const n=getComputedStyle(document.documentElement);A._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return _classPrivateFieldGet(b,this)}set _isDraggable(e){var t;_classPrivateFieldSet(b,this,e),null===(t=this.div)||void 0===t||t.classList.toggle("draggable",e)}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=_classPrivateFieldGet(w,this)}setParent(e){null!==e&&(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions),this.parent=e}focusin(e){this._focusEventsAllowed&&(_classPrivateFieldGet(g,this)?_classPrivateFieldSet(g,this,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(e.preventDefault(),null!==(t=this.parent)&&void 0!==t&&t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[a,i]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/a,this.y=(t+r)/i,this.fixAndSetPosition()}translate(e,t){_assertClassBrand(_,this,S).call(this,this.parentDimensions,e,t)}translateInPage(e,t){_assertClassBrand(_,this,S).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){const[n,r]=this.parentDimensions;if(this.x+=e/n,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:i}=this;const[s,o]=_assertClassBrand(_,this,C).call(this);a+=s,i+=o,this.div.style.left="".concat((100*a).toFixed(2),"%"),this.div.style.top="".concat((100*i).toFixed(2),"%"),this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[e,t]=this.pageDimensions;let{x:n,y:r,width:a,height:i}=this;switch(a*=e,i*=t,n*=e,r*=t,this.rotation){case 0:n=Math.max(0,Math.min(e-a,n)),r=Math.max(0,Math.min(t-i,r));break;case 90:n=Math.max(0,Math.min(e-i,n)),r=Math.min(t,Math.max(a,r));break;case 180:n=Math.min(e,Math.max(a,n)),r=Math.min(t,Math.max(i,r));break;case 270:n=Math.min(e,Math.max(i,n)),r=Math.max(0,Math.min(t-a,r))}this.x=n/=e,this.y=r/=t;const[s,o]=_assertClassBrand(_,this,C).call(this);n+=s,r+=o;const{style:l}=this.div;l.left="".concat((100*n).toFixed(2),"%"),l.top="".concat((100*r).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(e,t){return x.call(A,e,t,this.parentRotation)}pageTranslationToScreen(e,t){return x.call(A,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this,r=t*e,a=n*e;return i.FeatureTest.isCSSRoundSupported?[Math.round(r),Math.round(a)]:[r,a]}setDims(e,t){var n;const[r,a]=this.parentDimensions;this.div.style.width="".concat((100*e/r).toFixed(2),"%"),_classPrivateFieldGet(h,this)||(this.div.style.height="".concat((100*t/a).toFixed(2),"%")),null===(n=_classPrivateFieldGet(c,this))||void 0===n||n.classList.toggle("small",e<A.SMALL_EDITOR_SIZE||t<A.SMALL_EDITOR_SIZE)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),a=!_classPrivateFieldGet(h,this)&&t.endsWith("%");if(r&&a)return;const[i,s]=this.parentDimensions;r||(e.width="".concat((100*parseFloat(n)/i).toFixed(2),"%")),_classPrivateFieldGet(h,this)||a||(e.height="".concat((100*parseFloat(t)/s).toFixed(2),"%"))}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(_classPrivateFieldGet(c,this))return;const e=_classPrivateFieldSet(c,this,document.createElement("button"));e.className="altText";const t=await A._l10nPromise.get("editor_alt_text_button_label");if(e.textContent=t,e.setAttribute("aria-label",t),e.tabIndex="0",e.addEventListener("contextmenu",s.noContextMenu),e.addEventListener("pointerdown",e=>e.stopPropagation()),e.addEventListener("click",e=>{e.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(t.preventDefault(),this._uiManager.editAltText(this))}),_assertClassBrand(_,this,I).call(this),this.div.append(e),!A.SMALL_EDITOR_SIZE){const t=40;A.SMALL_EDITOR_SIZE=Math.min(128,Math.round(e.getBoundingClientRect().width*(1+t/100)))}}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:_classPrivateFieldGet(o,this),decorative:_classPrivateFieldGet(l,this)}}set altTextData(e){let{altText:t,decorative:n}=e;_classPrivateFieldGet(o,this)===t&&_classPrivateFieldGet(l,this)===n||(_classPrivateFieldSet(o,this,t),_classPrivateFieldSet(l,this,n),_assertClassBrand(_,this,I).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",_classPrivateFieldGet(f,this)),this.div.addEventListener("focusout",_classPrivateFieldGet(m,this));const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth="".concat((100*t/e).toFixed(2),"%"),this.div.style.maxHeight="".concat((100*e/t).toFixed(2),"%"));const[n,r]=this.getInitialTranslation();return this.translate(n,r),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=i.FeatureTest.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(_classPrivateFieldSet(g,this,!0),_assertClassBrand(_,this,R).call(this,e))}moveInDOM(){var e;null===(e=this.parent)||void 0===e||e.moveEditorInDOM(this)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t){const n=this.parentScale,[r,a]=this.pageDimensions,[i,s]=this.pageTranslation,o=e/n,l=t/n,c=this.x*r,d=this.y*a,u=this.width*r,h=this.height*a;switch(this.rotation){case 0:return[c+o+i,a-d-l-h+s,c+o+u+i,a-d-l+s];case 90:return[c+l+i,a-d+o+s,c+l+h+i,a-d+o+u+s];case 180:return[c-o-u+i,a-d+l+s,c-o+i,a-d+l+h+s];case 270:return[c-l-h+i,a-d-o-u+s,c-l+i,a-d-o+s];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,a,i]=e,s=a-n,o=i-r;switch(this.rotation){case 0:return[n,t-i,s,o];case 90:return[n,t-r,o,s];case 180:return[a,t-r,s,o];case 270:return[a,t-i,o,s];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){_classPrivateFieldSet(y,this,!0)}disableEditMode(){_classPrivateFieldSet(y,this,!1)}isInEditMode(){return _classPrivateFieldGet(y,this)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var e,t;null===(e=this.div)||void 0===e||e.addEventListener("focusin",_classPrivateFieldGet(f,this)),null===(t=this.div)||void 0===t||t.addEventListener("focusout",_classPrivateFieldGet(m,this))}serialize(){(0,i.unreachable)("An editor must be serializable")}static deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation;const[a,i]=r.pageDimensions,[s,o,l,c]=r.getRectInCurrentCoords(e.rect,i);return r.x=s/a,r.y=o/i,r.width=l/a,r.height=c/i,r}remove(){var e;this.div.removeEventListener("focusin",_classPrivateFieldGet(f,this)),this.div.removeEventListener("focusout",_classPrivateFieldGet(m,this)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),null===(e=_classPrivateFieldGet(c,this))||void 0===e||e.remove(),_classPrivateFieldSet(c,this,null),_classPrivateFieldSet(d,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_assertClassBrand(_,this,T).call(this),_classPrivateFieldGet(p,this).classList.remove("hidden"))}select(){var e;this.makeResizable(),null===(e=this.div)||void 0===e||e.classList.add("selectedEditor")}unselect(){var e,t,n;null===(e=_classPrivateFieldGet(p,this))||void 0===e||e.classList.add("hidden"),null===(t=this.div)||void 0===t||t.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(e,t){}disableEditing(){_classPrivateFieldGet(c,this)&&(_classPrivateFieldGet(c,this).hidden=!0)}enableEditing(){_classPrivateFieldGet(c,this)&&(_classPrivateFieldGet(c,this).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return _classPrivateFieldGet(v,this)}set isEditing(e){_classPrivateFieldSet(v,this,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){_classPrivateFieldSet(h,this,!0);const n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}}function S(e,t,n){let[r,a]=e;[t,n]=this.screenToPageTranslation(t,n),this.x+=t/r,this.y+=n/a,this.fixAndSetPosition()}function C(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=r,a=n/e,i=n/t;switch(this.rotation){case 90:return[-a,i];case 180:return[a,i];case 270:return[a,-i];default:return[-a,-i]}}function x(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}function E(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}function T(){if(_classPrivateFieldGet(p,this))return;_classPrivateFieldSet(p,this,document.createElement("div")),_classPrivateFieldGet(p,this).classList.add("resizers");const e=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||e.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of e){const e=document.createElement("div");_classPrivateFieldGet(p,this).append(e),e.classList.add("resizer",t),e.addEventListener("pointerdown",_assertClassBrand(_,this,k).bind(this,t)),e.addEventListener("contextmenu",s.noContextMenu)}this.div.prepend(_classPrivateFieldGet(p,this))}function k(e,t){t.preventDefault();const{isMac:n}=i.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&n)return;const r=_assertClassBrand(_,this,P).bind(this,e),a=this._isDraggable;this._isDraggable=!1;const s={passive:!0,capture:!0};window.addEventListener("pointermove",r,s);const o=this.x,l=this.y,c=this.width,d=this.height,u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{this._isDraggable=a,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",r,s),this.parent.div.style.cursor=u,this.div.style.cursor=h;const e=this.x,t=this.y,n=this.width,i=this.height;e===o&&t===l&&n===c&&i===d||this.addCommands({cmd:()=>{this.width=n,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*n,a*i),this.fixAndSetPosition()},undo:()=>{this.width=c,this.height=d,this.x=o,this.y=l;const[e,t]=this.parentDimensions;this.setDims(e*c,t*d),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}function P(e,t){const[n,a]=this.parentDimensions,i=this.x,s=this.y,o=this.width,l=this.height,c=r.MIN_SIZE/n,d=r.MIN_SIZE/a,u=e=>Math.round(1e4*e)/1e4,h=_assertClassBrand(_,this,E).call(this,this.rotation),p=(e,t)=>[h[0]*e+h[2]*t,h[1]*e+h[3]*t],f=_assertClassBrand(_,this,E).call(this,360-this.rotation);let m,g,v=!1,y=!1;switch(e){case"topLeft":v=!0,m=(e,t)=>[0,0],g=(e,t)=>[e,t];break;case"topMiddle":m=(e,t)=>[e/2,0],g=(e,t)=>[e/2,t];break;case"topRight":v=!0,m=(e,t)=>[e,0],g=(e,t)=>[0,t];break;case"middleRight":y=!0,m=(e,t)=>[e,t/2],g=(e,t)=>[0,t/2];break;case"bottomRight":v=!0,m=(e,t)=>[e,t],g=(e,t)=>[0,0];break;case"bottomMiddle":m=(e,t)=>[e/2,t],g=(e,t)=>[e/2,0];break;case"bottomLeft":v=!0,m=(e,t)=>[0,t],g=(e,t)=>[e,0];break;case"middleLeft":y=!0,m=(e,t)=>[0,t/2],g=(e,t)=>[e,t/2]}const b=m(o,l),w=g(o,l);let A=p(...w);const S=u(i+A[0]),C=u(s+A[1]);let x=1,T=1,[k,P]=this.screenToPageTranslation(t.movementX,t.movementY);var I,R;if([k,P]=(I=k/n,R=P/a,[f[0]*I+f[2]*R,f[1]*I+f[3]*R]),v){const e=Math.hypot(o,l);x=T=Math.max(Math.min(Math.hypot(w[0]-b[0]-k,w[1]-b[1]-P)/e,1/o,1/l),c/o,d/l)}else y?x=Math.max(c,Math.min(1,Math.abs(w[0]-b[0]-k)))/o:T=Math.max(d,Math.min(1,Math.abs(w[1]-b[1]-P)))/l;const N=u(o*x),O=u(l*T);A=p(...g(N,O));const M=S-A[0],F=C-A[1];this.width=N,this.height=O,this.x=M,this.y=F,this.setDims(n*N,a*O),this.fixAndSetPosition()}async function I(){const e=_classPrivateFieldGet(c,this);if(!e)return;var t;if(!_classPrivateFieldGet(o,this)&&!_classPrivateFieldGet(l,this))return e.classList.remove("done"),void(null===(t=_classPrivateFieldGet(d,this))||void 0===t||t.remove());r._l10nPromise.get("editor_alt_text_edit_button_label").then(t=>{e.setAttribute("aria-label",t)});let n=_classPrivateFieldGet(d,this);if(!n){_classPrivateFieldSet(d,this,n=document.createElement("span")),n.className="tooltip",n.setAttribute("role","tooltip");const t=n.id="alt-text-tooltip-".concat(this.id);e.setAttribute("aria-describedby",t);const r=100;e.addEventListener("mouseenter",()=>{_classPrivateFieldSet(u,this,setTimeout(()=>{_classPrivateFieldSet(u,this,null),_classPrivateFieldGet(d,this).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},r))}),e.addEventListener("mouseleave",()=>{var e;clearTimeout(_classPrivateFieldGet(u,this)),_classPrivateFieldSet(u,this,null),null===(e=_classPrivateFieldGet(d,this))||void 0===e||e.classList.remove("show")})}e.classList.add("done"),n.innerText=_classPrivateFieldGet(l,this)?await r._l10nPromise.get("editor_alt_text_decorative_tooltip"):_classPrivateFieldGet(o,this),n.parentNode||e.append(n)}function R(e){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);let n,r;this._uiManager.setUpDragSession(),t&&(n={passive:!0,capture:!0},r=e=>{const[t,n]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(t,n)},window.addEventListener("pointermove",r,n));const a=()=>{if(window.removeEventListener("pointerup",a),window.removeEventListener("blur",a),t&&window.removeEventListener("pointermove",r,n),_classPrivateFieldSet(g,this,!1),!this._uiManager.endDragSession()){const{isMac:t}=i.FeatureTest.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",a),window.addEventListener("blur",a)}r=A,_defineProperty(A,"_borderLineWidth",-1),_defineProperty(A,"_colorManager",new a.ColorManager),_defineProperty(A,"_zIndex",1),_defineProperty(A,"SMALL_EDITOR_SIZE",0),t.AnnotationEditor=A;class N extends A{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=function(e,t,n){for(const r of n)t.addEventListener(r,e[r].bind(e))},t.opacityToHex=function(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")};var a=n(1),i=n(6),s=new WeakMap;class o{constructor(){_classPrivateFieldInitSpec(this,s,0)}getId(){var e,t;return"".concat(a.AnnotationEditorPrefix).concat((_classPrivateFieldSet(s,this,(e=_classPrivateFieldGet(s,this),t=e++,e)),t))}}var l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakSet;class h{constructor(){_classPrivateMethodInitSpec(this,u),_classPrivateFieldInitSpec(this,l,(0,a.getUuid)()),_classPrivateFieldInitSpec(this,c,0),_classPrivateFieldInitSpec(this,d,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d"),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';const n=t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]));return(0,a.shadow)(this,"_isSVGFittingCanvas",n)}async getFromFile(e){const{lastModified:t,name:n,size:r,type:a}=e;return _assertClassBrand(u,this,p).call(this,"".concat(t,"_").concat(n,"_").concat(r,"_").concat(a),e)}async getFromUrl(e){return _assertClassBrand(u,this,p).call(this,e,e)}async getFromId(e){_classPrivateFieldGet(d,this)||_classPrivateFieldSet(d,this,new Map);const t=_classPrivateFieldGet(d,this).get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null}getSvgUrl(e){const t=_classPrivateFieldGet(d,this).get(e);return null!==t&&void 0!==t&&t.isSvg?t.svgUrl:null}deleteId(e){_classPrivateFieldGet(d,this)||_classPrivateFieldSet(d,this,new Map);const t=_classPrivateFieldGet(d,this).get(e);t&&(t.refCounter-=1,0===t.refCounter&&(t.bitmap=null))}isValidId(e){return e.startsWith("image_".concat(_classPrivateFieldGet(l,this),"_"))}}async function p(e,t){var n;_classPrivateFieldGet(d,this)||_classPrivateFieldSet(d,this,new Map);let a=_classPrivateFieldGet(d,this).get(e);if(null===a)return null;if(null!==(n=a)&&void 0!==n&&n.bitmap)return a.refCounter+=1,a;try{var i,s;let e;if(a||(a={bitmap:null,id:"image_".concat(_classPrivateFieldGet(l,this),"_").concat((_classPrivateFieldSet(c,this,(i=_classPrivateFieldGet(c,this),s=i++,i)),s)),refCounter:0,isSvg:!1}),"string"===typeof t){a.url=t;const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);e=await n.blob()}else e=a.file=t;if("image/svg+xml"===e.type){const t=r._isSVGFittingCanvas,n=new FileReader,i=new Image,s=new Promise((e,r)=>{i.onload=()=>{a.bitmap=i,a.isSvg=!0,e()},n.onload=async()=>{const e=a.svgUrl=n.result;i.src=await t?"".concat(e,"#svgView(preserveAspectRatio(none))"):e},i.onerror=n.onerror=r});n.readAsDataURL(e),await s}else a.bitmap=await createImageBitmap(e);a.refCounter=1}catch(o){console.error(o),a=null}return _classPrivateFieldGet(d,this).set(e,a),a&&_classPrivateFieldGet(d,this).set(a.id,a),a}r=h;var f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap;class y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;_classPrivateFieldInitSpec(this,f,[]),_classPrivateFieldInitSpec(this,m,!1),_classPrivateFieldInitSpec(this,g,void 0),_classPrivateFieldInitSpec(this,v,-1),_classPrivateFieldSet(g,this,e)}add(e){let{cmd:t,undo:n,mustExec:r,type:a=NaN,overwriteIfSameType:i=!1,keepUndo:s=!1}=e;if(r&&t(),_classPrivateFieldGet(m,this))return;const o={cmd:t,undo:n,type:a};if(-1===_classPrivateFieldGet(v,this))return _classPrivateFieldGet(f,this).length>0&&(_classPrivateFieldGet(f,this).length=0),_classPrivateFieldSet(v,this,0),void _classPrivateFieldGet(f,this).push(o);if(i&&_classPrivateFieldGet(f,this)[_classPrivateFieldGet(v,this)].type===a)return s&&(o.undo=_classPrivateFieldGet(f,this)[_classPrivateFieldGet(v,this)].undo),void(_classPrivateFieldGet(f,this)[_classPrivateFieldGet(v,this)]=o);const l=_classPrivateFieldGet(v,this)+1;l===_classPrivateFieldGet(g,this)?_classPrivateFieldGet(f,this).splice(0,1):(_classPrivateFieldSet(v,this,l),l<_classPrivateFieldGet(f,this).length&&_classPrivateFieldGet(f,this).splice(l)),_classPrivateFieldGet(f,this).push(o)}undo(){-1!==_classPrivateFieldGet(v,this)&&(_classPrivateFieldSet(m,this,!0),_classPrivateFieldGet(f,this)[_classPrivateFieldGet(v,this)].undo(),_classPrivateFieldSet(m,this,!1),_classPrivateFieldSet(v,this,_classPrivateFieldGet(v,this)-1))}redo(){_classPrivateFieldGet(v,this)<_classPrivateFieldGet(f,this).length-1&&(_classPrivateFieldSet(v,this,_classPrivateFieldGet(v,this)+1),_classPrivateFieldSet(m,this,!0),_classPrivateFieldGet(f,this)[_classPrivateFieldGet(v,this)].cmd(),_classPrivateFieldSet(m,this,!1))}hasSomethingToUndo(){return-1!==_classPrivateFieldGet(v,this)}hasSomethingToRedo(){return _classPrivateFieldGet(v,this)<_classPrivateFieldGet(f,this).length-1}destroy(){_classPrivateFieldSet(f,this,null)}}t.CommandManager=y;var b=new WeakSet;class w{constructor(e){_classPrivateMethodInitSpec(this,b),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=a.FeatureTest.platform;for(const[n,r,a={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:r,options:a}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:r,options:a}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(_assertClassBrand(b,this,_).call(this,t));if(!n)return;const{callback:r,options:{bubbles:a=!1,args:i=[],checker:s=null}}=n;s&&!s(e,t)||(r.bind(e,...i)(),a||(t.stopPropagation(),t.preventDefault()))}}function _(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}t.KeyboardManager=w;class A{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(e),(0,a.shadow)(this,"_colors",e)}convert(e){const t=(0,i.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,r]of this._colors)if(r.every((e,n)=>e===t[n]))return A._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?a.Util.makeHexColor(...t):e}}_defineProperty(A,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),t.ColorManager=A;var S=new WeakMap,C=new WeakMap,x=new WeakMap,E=new WeakMap,T=new WeakMap,k=new WeakMap,P=new WeakMap,I=new WeakMap,R=new WeakMap,N=new WeakMap,O=new WeakMap,M=new WeakMap,F=new WeakMap,D=new WeakMap,L=new WeakMap,j=new WeakMap,B=new WeakMap,U=new WeakMap,G=new WeakMap,H=new WeakMap,z=new WeakMap,W=new WeakMap,q=new WeakMap,V=new WeakMap,K=new WeakMap,Y=new WeakMap,X=new WeakMap,Q=new WeakMap,$=new WeakMap,J=new WeakMap,Z=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakSet;class ae{static get _keyboardManager(){const e=ae.prototype,t=e=>{const{activeElement:t}=document;return t&&_classPrivateFieldGet(te,e).contains(t)&&e.hasSomethingToControl()},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new w([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,n,r,s,l){_classPrivateMethodInitSpec(this,re),_classPrivateFieldInitSpec(this,S,null),_classPrivateFieldInitSpec(this,C,new Map),_classPrivateFieldInitSpec(this,x,new Map),_classPrivateFieldInitSpec(this,E,null),_classPrivateFieldInitSpec(this,T,null),_classPrivateFieldInitSpec(this,k,new y),_classPrivateFieldInitSpec(this,P,0),_classPrivateFieldInitSpec(this,I,new Set),_classPrivateFieldInitSpec(this,R,null),_classPrivateFieldInitSpec(this,N,null),_classPrivateFieldInitSpec(this,O,new Set),_classPrivateFieldInitSpec(this,M,null),_classPrivateFieldInitSpec(this,F,new o),_classPrivateFieldInitSpec(this,D,!1),_classPrivateFieldInitSpec(this,L,!1),_classPrivateFieldInitSpec(this,j,null),_classPrivateFieldInitSpec(this,B,a.AnnotationEditorType.NONE),_classPrivateFieldInitSpec(this,U,new Set),_classPrivateFieldInitSpec(this,G,null),_classPrivateFieldInitSpec(this,H,this.blur.bind(this)),_classPrivateFieldInitSpec(this,z,this.focus.bind(this)),_classPrivateFieldInitSpec(this,W,this.copy.bind(this)),_classPrivateFieldInitSpec(this,q,this.cut.bind(this)),_classPrivateFieldInitSpec(this,V,this.paste.bind(this)),_classPrivateFieldInitSpec(this,K,this.keydown.bind(this)),_classPrivateFieldInitSpec(this,Y,this.onEditingAction.bind(this)),_classPrivateFieldInitSpec(this,X,this.onPageChanging.bind(this)),_classPrivateFieldInitSpec(this,Q,this.onScaleChanging.bind(this)),_classPrivateFieldInitSpec(this,$,this.onRotationChanging.bind(this)),_classPrivateFieldInitSpec(this,J,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}),_classPrivateFieldInitSpec(this,Z,[0,0]),_classPrivateFieldInitSpec(this,ee,null),_classPrivateFieldInitSpec(this,te,null),_classPrivateFieldInitSpec(this,ne,null),_classPrivateFieldSet(te,this,e),_classPrivateFieldSet(ne,this,t),_classPrivateFieldSet(E,this,n),this._eventBus=r,this._eventBus._on("editingaction",_classPrivateFieldGet(Y,this)),this._eventBus._on("pagechanging",_classPrivateFieldGet(X,this)),this._eventBus._on("scalechanging",_classPrivateFieldGet(Q,this)),this._eventBus._on("rotationchanging",_classPrivateFieldGet($,this)),_classPrivateFieldSet(T,this,s.annotationStorage),_classPrivateFieldSet(M,this,s.filterFactory),_classPrivateFieldSet(G,this,l),this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){_assertClassBrand(re,this,le).call(this),_assertClassBrand(re,this,se).call(this),this._eventBus._off("editingaction",_classPrivateFieldGet(Y,this)),this._eventBus._off("pagechanging",_classPrivateFieldGet(X,this)),this._eventBus._off("scalechanging",_classPrivateFieldGet(Q,this)),this._eventBus._off("rotationchanging",_classPrivateFieldGet($,this));for(const e of _classPrivateFieldGet(x,this).values())e.destroy();_classPrivateFieldGet(x,this).clear(),_classPrivateFieldGet(C,this).clear(),_classPrivateFieldGet(O,this).clear(),_classPrivateFieldSet(S,this,null),_classPrivateFieldGet(U,this).clear(),_classPrivateFieldGet(k,this).destroy(),_classPrivateFieldGet(E,this).destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",_classPrivateFieldGet(G,this)?_classPrivateFieldGet(M,this).addHCMFilter(_classPrivateFieldGet(G,this).foreground,_classPrivateFieldGet(G,this).background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(_classPrivateFieldGet(te,this)).direction)}editAltText(e){var t;null===(t=_classPrivateFieldGet(E,this))||void 0===t||t.editAltText(this,e)}onPageChanging(e){let{pageNumber:t}=e;_classPrivateFieldSet(P,this,t-1)}focusMainContainer(){_classPrivateFieldGet(te,this).focus()}findParent(e,t){for(const n of _classPrivateFieldGet(x,this).values()){const{x:r,y:a,width:i,height:s}=n.div.getBoundingClientRect();if(e>=r&&e<=r+i&&t>=a&&t<=a+s)return n}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classPrivateFieldGet(ne,this).classList.toggle("noUserSelect",e)}addShouldRescale(e){_classPrivateFieldGet(O,this).add(e)}removeShouldRescale(e){_classPrivateFieldGet(O,this).delete(e)}onScaleChanging(e){let{scale:t}=e;this.commitOrRemove(),this.viewParameters.realScale=t*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const n of _classPrivateFieldGet(O,this))n.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}addToAnnotationStorage(e){e.isEmpty()||!_classPrivateFieldGet(T,this)||_classPrivateFieldGet(T,this).has(e.id)||_classPrivateFieldGet(T,this).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const t of _classPrivateFieldGet(U,this))if(t.div.contains(e)){_classPrivateFieldSet(j,this,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!_classPrivateFieldGet(j,this))return;const[e,t]=_classPrivateFieldGet(j,this);_classPrivateFieldSet(j,this,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),t.focus()}addEditListeners(){_assertClassBrand(re,this,oe).call(this),_assertClassBrand(re,this,ce).call(this)}removeEditListeners(){_assertClassBrand(re,this,le).call(this),_assertClassBrand(re,this,de).call(this)}copy(e){var t;if(e.preventDefault(),null===(t=_classPrivateFieldGet(S,this))||void 0===t||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const r of _classPrivateFieldGet(U,this)){const e=r.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const e of _classPrivateFieldGet(N,this))if(e.isHandlingMimeForPasting(a.type))return void e.paste(a,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){return void(0,a.warn)('paste: "'.concat(i.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const e=[];for(const i of n){const t=r.deserialize(i);if(!t)return;e.push(t)}const t=()=>{for(const t of e)_assertClassBrand(re,this,me).call(this,t);_assertClassBrand(re,this,ve).call(this,e)},a=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:a,mustExec:!0})}catch(i){(0,a.warn)('paste: "'.concat(i.message,'".'))}}keydown(e){var t;null!==(t=this.getActive())&&void 0!==t&&t.shouldGetKeyboardEvents()||ae._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(_assertClassBrand(re,this,ie).call(this),_assertClassBrand(re,this,oe).call(this),_assertClassBrand(re,this,ce).call(this),_assertClassBrand(re,this,ue).call(this,{isEditing:_classPrivateFieldGet(B,this)!==a.AnnotationEditorType.NONE,isEmpty:_assertClassBrand(re,this,ge).call(this),hasSomethingToUndo:_classPrivateFieldGet(k,this).hasSomethingToUndo(),hasSomethingToRedo:_classPrivateFieldGet(k,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(_assertClassBrand(re,this,se).call(this),_assertClassBrand(re,this,le).call(this),_assertClassBrand(re,this,de).call(this),_assertClassBrand(re,this,ue).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!_classPrivateFieldGet(N,this)){_classPrivateFieldSet(N,this,e);for(const e of _classPrivateFieldGet(N,this))_assertClassBrand(re,this,he).call(this,e.defaultPropertiesToUpdate)}}getId(){return _classPrivateFieldGet(F,this).getId()}get currentLayer(){return _classPrivateFieldGet(x,this).get(_classPrivateFieldGet(P,this))}getLayer(e){return _classPrivateFieldGet(x,this).get(e)}get currentPageIndex(){return _classPrivateFieldGet(P,this)}addLayer(e){_classPrivateFieldGet(x,this).set(e.pageIndex,e),_classPrivateFieldGet(D,this)?e.enable():e.disable()}removeLayer(e){_classPrivateFieldGet(x,this).delete(e.pageIndex)}updateMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(_classPrivateFieldGet(B,this)!==e){if(_classPrivateFieldSet(B,this,e),e===a.AnnotationEditorType.NONE)return this.setEditingState(!1),void _assertClassBrand(re,this,fe).call(this);this.setEditingState(!0),_assertClassBrand(re,this,pe).call(this),this.unselectAll();for(const t of _classPrivateFieldGet(x,this).values())t.updateMode(e);if(t)for(const e of _classPrivateFieldGet(C,this).values())if(e.annotationElementId===t){this.setSelected(e),e.enterInEditMode();break}}}updateToolbar(e){e!==_classPrivateFieldGet(B,this)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(_classPrivateFieldGet(N,this))if(e!==a.AnnotationEditorParamsType.CREATE){for(const n of _classPrivateFieldGet(U,this))n.updateParams(e,t);for(const n of _classPrivateFieldGet(N,this))n.updateDefaultParams(e,t)}else this.currentLayer.addNewEditor(e)}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(_classPrivateFieldGet(L,this)!==e){_classPrivateFieldSet(L,this,e);for(const t of _classPrivateFieldGet(x,this).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of _classPrivateFieldGet(C,this).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return _classPrivateFieldGet(C,this).get(e)}addEditor(e){_classPrivateFieldGet(C,this).set(e.id,e)}removeEditor(e){var t;_classPrivateFieldGet(C,this).delete(e.id),this.unselect(e),e.annotationElementId&&_classPrivateFieldGet(I,this).has(e.annotationElementId)||null===(t=_classPrivateFieldGet(T,this))||void 0===t||t.remove(e.id)}addDeletedAnnotationElement(e){_classPrivateFieldGet(I,this).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return _classPrivateFieldGet(I,this).has(e)}removeDeletedAnnotationElement(e){_classPrivateFieldGet(I,this).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){_classPrivateFieldGet(S,this)!==e&&(_classPrivateFieldSet(S,this,e),e&&_assertClassBrand(re,this,he).call(this,e.propertiesToUpdate))}toggleSelected(e){if(_classPrivateFieldGet(U,this).has(e))return _classPrivateFieldGet(U,this).delete(e),e.unselect(),void _assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:this.hasSelection});_classPrivateFieldGet(U,this).add(e),e.select(),_assertClassBrand(re,this,he).call(this,e.propertiesToUpdate),_assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const t of _classPrivateFieldGet(U,this))t!==e&&t.unselect();_classPrivateFieldGet(U,this).clear(),_classPrivateFieldGet(U,this).add(e),e.select(),_assertClassBrand(re,this,he).call(this,e.propertiesToUpdate),_assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:!0})}isSelected(e){return _classPrivateFieldGet(U,this).has(e)}unselect(e){e.unselect(),_classPrivateFieldGet(U,this).delete(e),_assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==_classPrivateFieldGet(U,this).size}undo(){_classPrivateFieldGet(k,this).undo(),_assertClassBrand(re,this,ue).call(this,{hasSomethingToUndo:_classPrivateFieldGet(k,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_assertClassBrand(re,this,ge).call(this)})}redo(){_classPrivateFieldGet(k,this).redo(),_assertClassBrand(re,this,ue).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:_classPrivateFieldGet(k,this).hasSomethingToRedo(),isEmpty:_assertClassBrand(re,this,ge).call(this)})}addCommands(e){_classPrivateFieldGet(k,this).add(e),_assertClassBrand(re,this,ue).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_assertClassBrand(re,this,ge).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[..._classPrivateFieldGet(U,this)];this.addCommands({cmd:()=>{for(const t of e)t.remove()},undo:()=>{for(const t of e)_assertClassBrand(re,this,me).call(this,t)},mustExec:!0})}commitOrRemove(){var e;null===(e=_classPrivateFieldGet(S,this))||void 0===e||e.commitOrRemove()}hasSomethingToControl(){return _classPrivateFieldGet(S,this)||this.hasSelection}selectAll(){for(const e of _classPrivateFieldGet(U,this))e.commit();_assertClassBrand(re,this,ve).call(this,_classPrivateFieldGet(C,this).values())}unselectAll(){if(_classPrivateFieldGet(S,this))_classPrivateFieldGet(S,this).commitOrRemove();else if(this.hasSelection){for(const e of _classPrivateFieldGet(U,this))e.unselect();_classPrivateFieldGet(U,this).clear(),_assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;_classPrivateFieldGet(Z,this)[0]+=e,_classPrivateFieldGet(Z,this)[1]+=t;const[n,r]=_classPrivateFieldGet(Z,this),a=[..._classPrivateFieldGet(U,this)];_classPrivateFieldGet(ee,this)&&clearTimeout(_classPrivateFieldGet(ee,this)),_classPrivateFieldSet(ee,this,setTimeout(()=>{_classPrivateFieldSet(ee,this,null),_classPrivateFieldGet(Z,this)[0]=_classPrivateFieldGet(Z,this)[1]=0,this.addCommands({cmd:()=>{for(const e of a)_classPrivateFieldGet(C,this).has(e.id)&&e.translateInPage(n,r)},undo:()=>{for(const e of a)_classPrivateFieldGet(C,this).has(e.id)&&e.translateInPage(-n,-r)},mustExec:!1})},1e3));for(const i of a)i.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_classPrivateFieldSet(R,this,new Map);for(const e of _classPrivateFieldGet(U,this))_classPrivateFieldGet(R,this).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!_classPrivateFieldGet(R,this))return!1;this.disableUserSelect(!1);const e=_classPrivateFieldGet(R,this);_classPrivateFieldSet(R,this,null);let t=!1;for(const[{x:r,y:a,pageIndex:i},s]of e)s.newX=r,s.newY=a,s.newPageIndex=i,t||(t=r!==s.savedX||a!==s.savedY||i!==s.savedPageIndex);if(!t)return!1;const n=(e,t,n,r)=>{if(_classPrivateFieldGet(C,this).has(e.id)){const a=_classPrivateFieldGet(x,this).get(r);a?e._setParentAndPosition(a,t,n):(e.pageIndex=r,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:r,newY:a,newPageIndex:i}]of e)n(t,r,a,i)},undo:()=>{for(const[t,{savedX:r,savedY:a,savedPageIndex:i}]of e)n(t,r,a,i)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(_classPrivateFieldGet(R,this))for(const n of _classPrivateFieldGet(R,this).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return _classPrivateFieldGet(S,this)===e}getActive(){return _classPrivateFieldGet(S,this)}getMode(){return _classPrivateFieldGet(B,this)}get imageManager(){return(0,a.shadow)(this,"imageManager",new h)}}function ie(){window.addEventListener("focus",_classPrivateFieldGet(z,this)),window.addEventListener("blur",_classPrivateFieldGet(H,this))}function se(){window.removeEventListener("focus",_classPrivateFieldGet(z,this)),window.removeEventListener("blur",_classPrivateFieldGet(H,this))}function oe(){window.addEventListener("keydown",_classPrivateFieldGet(K,this),{capture:!0})}function le(){window.removeEventListener("keydown",_classPrivateFieldGet(K,this),{capture:!0})}function ce(){document.addEventListener("copy",_classPrivateFieldGet(W,this)),document.addEventListener("cut",_classPrivateFieldGet(q,this)),document.addEventListener("paste",_classPrivateFieldGet(V,this))}function de(){document.removeEventListener("copy",_classPrivateFieldGet(W,this)),document.removeEventListener("cut",_classPrivateFieldGet(q,this)),document.removeEventListener("paste",_classPrivateFieldGet(V,this))}function ue(e){Object.entries(e).some(e=>{let[t,n]=e;return _classPrivateFieldGet(J,this)[t]!==n})&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_classPrivateFieldGet(J,this),e)})}function he(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}function pe(){if(!_classPrivateFieldGet(D,this)){_classPrivateFieldSet(D,this,!0);for(const e of _classPrivateFieldGet(x,this).values())e.enable()}}function fe(){if(this.unselectAll(),_classPrivateFieldGet(D,this)){_classPrivateFieldSet(D,this,!1);for(const e of _classPrivateFieldGet(x,this).values())e.disable()}}function me(e){const t=_classPrivateFieldGet(x,this).get(e.pageIndex);t?t.addOrRebuild(e):this.addEditor(e)}function ge(){if(0===_classPrivateFieldGet(C,this).size)return!0;if(1===_classPrivateFieldGet(C,this).size)for(const e of _classPrivateFieldGet(C,this).values())return e.isEmpty();return!1}function ve(e){_classPrivateFieldGet(U,this).clear();for(const t of e)t.isEmpty()||(_classPrivateFieldGet(U,this).add(t),t.select());_assertClassBrand(re,this,ue).call(this,{hasSelectedEditor:!0})}_defineProperty(ae,"TRANSLATE_SMALL",1),_defineProperty(ae,"TRANSLATE_BIG",10),t.AnnotationEditorUIManager=ae},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getColorValues=function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const n of e.keys()){t.style.color=n;const r=window.getComputedStyle(t).color;e.set(n,j(r))}t.remove()},t.getCurrentTransform=function(e){const{a:t,b:n,c:r,d:a,e:i,f:s}=e.getTransform();return[t,n,r,a,i,s]},t.getCurrentTransformInverse=function(e){const{a:t,b:n,c:r,d:a,e:i,f:s}=e.getTransform().invertSelf();return[t,n,r,a,i,s]},t.getFilenameFromUrl=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||([e]=e.split(/[#?]/,1)),e.substring(e.lastIndexOf("/")+1)},t.getPdfFilenameFromUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(F(e))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let a=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(a&&(a=a[0],a.includes("%")))try{a=n.exec(decodeURIComponent(a))[0]}catch(s){}return a||t},t.getRGB=j,t.getXfaPageViewport=function(e,t){let{scale:n=1,rotation:r=0}=t;const{width:a,height:i}=e.attributes.style,s=[0,0,parseInt(a),parseInt(i)];return new O({viewBox:s,scale:n,rotation:r})},t.isDataScheme=F,t.isPdfFile=function(e){return"string"===typeof e&&/\.pdf$/i.test(e)},t.isValidFetchUrl=D,t.loadScript=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((n,r)=>{const a=document.createElement("script");a.src=e,a.onload=function(e){t&&a.remove(),n(e)},a.onerror=function(){r(new Error("Cannot load script at: ".concat(a.src)))},(document.head||document.documentElement).append(a)})},t.noContextMenu=function(e){e.preventDefault()},t.setLayerDimensions=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof O){const{pageWidth:r,pageHeight:a}=t.rawDims,{style:s}=e,o=i.FeatureTest.isCSSRoundSupported,l="var(--scale-factor) * ".concat(r,"px"),c="var(--scale-factor) * ".concat(a,"px"),d=o?"round(".concat(l,", 1px)"):"calc(".concat(l,")"),u=o?"round(".concat(c,", 1px)"):"calc(".concat(c,")");n&&t.rotation%180!==0?(s.width=u,s.height=d):(s.width=d,s.height=u)}r&&e.setAttribute("data-main-rotation",t.rotation)};var a=n(7),i=n(1);const s="http://www.w3.org/2000/svg";class o{}r=o,_defineProperty(o,"CSS",96),_defineProperty(o,"PDF",72),_defineProperty(o,"PDF_TO_CSS_UNITS",r.CSS/r.PDF),t.PixelsPerInch=o;var l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,b=new WeakSet;class w extends a.BaseFilterFactory{constructor(){let{docId:e,ownerDocument:t=globalThis.document}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),_classPrivateMethodInitSpec(this,b),_classPrivateFieldInitSpec(this,l,void 0),_classPrivateFieldInitSpec(this,c,void 0),_classPrivateFieldInitSpec(this,d,void 0),_classPrivateFieldInitSpec(this,u,void 0),_classPrivateFieldInitSpec(this,h,void 0),_classPrivateFieldInitSpec(this,p,void 0),_classPrivateFieldInitSpec(this,f,void 0),_classPrivateFieldInitSpec(this,m,void 0),_classPrivateFieldInitSpec(this,g,void 0),_classPrivateFieldInitSpec(this,v,void 0),_classPrivateFieldInitSpec(this,y,0),_classPrivateFieldSet(d,this,e),_classPrivateFieldSet(u,this,t)}addFilter(e){var t,n;if(!e)return"none";let r,a,i,s,o=_classPrivateGetter(b,this,_).get(e);if(o)return o;if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;s=r=a=i=n.join(",")}else{const[t,n,o]=e,l=new Array(256),c=new Array(256),d=new Array(256);for(let e=0;e<256;e++)l[e]=t[e]/255,c[e]=n[e]/255,d[e]=o[e]/255;r=l.join(","),a=c.join(","),i=d.join(","),s="".concat(r).concat(a).concat(i)}if(o=_classPrivateGetter(b,this,_).get(s),o)return _classPrivateGetter(b,this,_).set(e,o),o;const l="g_".concat(_classPrivateFieldGet(d,this),"_transfer_map_").concat((_classPrivateFieldSet(y,this,(t=_classPrivateFieldGet(y,this),n=t++,t)),n)),c="url(#".concat(l,")");_classPrivateGetter(b,this,_).set(e,c),_classPrivateGetter(b,this,_).set(s,c);const u=_assertClassBrand(b,this,C).call(this,l);return _assertClassBrand(b,this,E).call(this,r,a,i,u),c}addHCMFilter(e,t){var n;const r="".concat(e,"-").concat(t);if(_classPrivateFieldGet(p,this)===r)return _classPrivateFieldGet(f,this);if(_classPrivateFieldSet(p,this,r),_classPrivateFieldSet(f,this,"none"),null===(n=_classPrivateFieldGet(h,this))||void 0===n||n.remove(),!e||!t)return _classPrivateFieldGet(f,this);const a=_assertClassBrand(b,this,T).call(this,e);e=i.Util.makeHexColor(...a);const s=_assertClassBrand(b,this,T).call(this,t);if(t=i.Util.makeHexColor(...s),_classPrivateGetter(b,this,A).style.color="","#000000"===e&&"#ffffff"===t||e===t)return _classPrivateFieldGet(f,this);const o=new Array(256);for(let i=0;i<=255;i++){const e=i/255;o[i]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=o.join(","),c="g_".concat(_classPrivateFieldGet(d,this),"_hcm_filter"),u=_classPrivateFieldSet(m,this,_assertClassBrand(b,this,C).call(this,c));_assertClassBrand(b,this,E).call(this,l,l,l,u),_assertClassBrand(b,this,S).call(this,u);const g=(e,t)=>{const n=a[e]/255,r=s[e]/255,i=new Array(t+1);for(let a=0;a<=t;a++)i[a]=n+a/t*(r-n);return i.join(",")};return _assertClassBrand(b,this,E).call(this,g(0,5),g(1,5),g(2,5),u),_classPrivateFieldSet(f,this,"url(#".concat(c,")")),_classPrivateFieldGet(f,this)}addHighlightHCMFilter(e,t,n,r){var a;const i="".concat(e,"-").concat(t,"-").concat(n,"-").concat(r);if(_classPrivateFieldGet(g,this)===i)return _classPrivateFieldGet(v,this);if(_classPrivateFieldSet(g,this,i),_classPrivateFieldSet(v,this,"none"),null===(a=_classPrivateFieldGet(m,this))||void 0===a||a.remove(),!e||!t)return _classPrivateFieldGet(v,this);const[s,o]=[e,t].map(_assertClassBrand(b,this,T).bind(this));let l=Math.round(.2126*s[0]+.7152*s[1]+.0722*s[2]),c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),[u,h]=[n,r].map(_assertClassBrand(b,this,T).bind(this));c<l&&([l,c,u,h]=[c,l,h,u]),_classPrivateGetter(b,this,A).style.color="";const p=(e,t,n)=>{const r=new Array(256),a=(c-l)/n,i=e/255,s=(t-e)/(255*n);let o=0;for(let c=0;c<=n;c++){const e=Math.round(l+c*a),t=i+c*s;for(let n=o;n<=e;n++)r[n]=t;o=e+1}for(let l=o;l<256;l++)r[l]=r[o-1];return r.join(",")},f="g_".concat(_classPrivateFieldGet(d,this),"_hcm_highlight_filter"),y=_classPrivateFieldSet(m,this,_assertClassBrand(b,this,C).call(this,f));return _assertClassBrand(b,this,S).call(this,y),_assertClassBrand(b,this,E).call(this,p(u[0],h[0],5),p(u[1],h[1],5),p(u[2],h[2],5),y),_classPrivateFieldSet(v,this,"url(#".concat(f,")")),_classPrivateFieldGet(v,this)}destroy(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(_classPrivateFieldGet(f,this)||_classPrivateFieldGet(v,this))||(_classPrivateFieldGet(c,this)&&(_classPrivateFieldGet(c,this).parentNode.parentNode.remove(),_classPrivateFieldSet(c,this,null)),_classPrivateFieldGet(l,this)&&(_classPrivateFieldGet(l,this).clear(),_classPrivateFieldSet(l,this,null)),_classPrivateFieldSet(y,this,0))}}function _(e){return _classPrivateFieldGet(l,e)||_classPrivateFieldSet(l,e,new Map)}function A(e){if(!_classPrivateFieldGet(c,e)){const t=_classPrivateFieldGet(u,e).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const r=_classPrivateFieldGet(u,e).createElementNS(s,"svg");r.setAttribute("width",0),r.setAttribute("height",0),_classPrivateFieldSet(c,e,_classPrivateFieldGet(u,e).createElementNS(s,"defs")),t.append(r),r.append(_classPrivateFieldGet(c,e)),_classPrivateFieldGet(u,e).body.append(t)}return _classPrivateFieldGet(c,e)}function S(e){const t=_classPrivateFieldGet(u,this).createElementNS(s,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}function C(e){const t=_classPrivateFieldGet(u,this).createElementNS(s,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),_classPrivateGetter(b,this,A).append(t),t}function x(e,t,n){const r=_classPrivateFieldGet(u,this).createElementNS(s,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)}function E(e,t,n,r){const a=_classPrivateFieldGet(u,this).createElementNS(s,"feComponentTransfer");r.append(a),_assertClassBrand(b,this,x).call(this,a,"feFuncR",e),_assertClassBrand(b,this,x).call(this,a,"feFuncG",t),_assertClassBrand(b,this,x).call(this,a,"feFuncB",n)}function T(e){return _classPrivateGetter(b,this,A).style.color=e,j(getComputedStyle(_classPrivateGetter(b,this,A)).getPropertyValue("color"))}t.DOMFilterFactory=w;class k extends a.BaseCanvasFactory{constructor(){let{ownerDocument:e=globalThis.document}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}async function P(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(D(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);return t?new Uint8Array(await n.arrayBuffer()):(0,i.stringToBytes)(await n.text())}return new Promise((n,r)=>{const a=new XMLHttpRequest;a.open("GET",e,!0),t&&(a.responseType="arraybuffer"),a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(200===a.status||0===a.status){let e;if(t&&a.response?e=new Uint8Array(a.response):!t&&a.responseText&&(e=(0,i.stringToBytes)(a.responseText)),e)return void n(e)}r(new Error(a.statusText))}},a.send(null)})}t.DOMCanvasFactory=k;class I extends a.BaseCMapReaderFactory{_fetchData(e,t){return P(e,this.isCompressed).then(e=>({cMapData:e,compressionType:t}))}}t.DOMCMapReaderFactory=I;class R extends a.BaseStandardFontDataFactory{_fetchData(e){return P(e,!0)}}t.DOMStandardFontDataFactory=R;class N extends a.BaseSVGFactory{_createSVG(e){return document.createElementNS(s,e)}}t.DOMSVGFactory=N;class O{constructor(e){let{viewBox:t,scale:n,rotation:r,offsetX:a=0,offsetY:i=0,dontFlip:s=!1}=e;this.viewBox=t,this.scale=n,this.rotation=r,this.offsetX=a,this.offsetY=i;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,d,u,h,p,f,m,g;switch(r%=360,r<0&&(r+=360),r){case 180:c=-1,d=0,u=0,h=1;break;case 90:c=0,d=1,u=1,h=0;break;case 270:c=0,d=-1,u=-1,h=0;break;case 0:c=1,d=0,u=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(u=-u,h=-h),0===c?(p=Math.abs(l-t[1])*n+a,f=Math.abs(o-t[0])*n+i,m=(t[3]-t[1])*n,g=(t[2]-t[0])*n):(p=Math.abs(o-t[0])*n+a,f=Math.abs(l-t[1])*n+i,m=(t[2]-t[0])*n,g=(t[3]-t[1])*n),this.transform=[c*n,d*n,u*n,h*n,p-c*n*o-u*n*l,f-d*n*o-h*n*l],this.width=m,this.height=g}get rawDims(){const{viewBox:e}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new O({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:a})}convertToViewportPoint(e,t){return i.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=i.Util.applyTransform([e[0],e[1]],this.transform),n=i.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return i.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=O;class M extends i.BaseException{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function F(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function D(e,t){try{const{protocol:n}=t?new URL(e,t):new URL(e);return"http:"===n||"https:"===n}catch(n){return!1}}let L;function j(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):((0,i.warn)('Not a valid color format: "'.concat(e,'"')),[0,0,0])}t.RenderingCancelledException=M,t.StatTimer=class{constructor(){_defineProperty(this,"started",Object.create(null)),_defineProperty(this,"times",[])}time(e){e in this.started&&(0,i.warn)("Timer is already running for ".concat(e)),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,i.warn)("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:r,end:a}of this.times)e.push("".concat(n.padEnd(t)," ").concat(a-r,"ms\n"));return e.join("")}},t.PDFDateString=class{static toDateObject(e){if(!e||"string"!==typeof e)return null;L||(L=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=L.exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let i=parseInt(t[4],10);i=i>=0&&i<=23?i:0;let s=parseInt(t[5],10);s=s>=0&&s<=59?s:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(i+=c,s+=d):"+"===l&&(i-=c,s-=d),new Date(Date.UTC(n,r,a,i,s,o))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var r=n(1);class a{constructor(){this.constructor===a&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addHighlightHCMFilter(e,t,n,r){return"none"}destroy(){}}t.BaseFilterFactory=a;class i{constructor(){this.constructor===i&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d")}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=i;class s{constructor(e){let{baseUrl:t=null,isCompressed:n=!0}=e;this.constructor===s&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=n}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const n=this.baseUrl+t+(this.isCompressed?".bcmap":""),a=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(n,a).catch(e=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))})}_fetchData(e,t){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=s;class o{constructor(e){let{baseUrl:t=null}=e;this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetchData(n).catch(e=>{throw new Error("Unable to load font data at: ".concat(n))})}_fetchData(e){(0,r.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=o;class l{constructor(){this.constructor===l&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width","".concat(e,"px")),r.setAttribute("height","".concat(t,"px"))),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),r}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){(0,r.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var r=n(1);const a=3285377520,i=4294901760,s=65535;t.MurmurHash3_64=class{constructor(e){this.h1=e?4294967295&e:a,this.h2=e?4294967295&e:a}update(e){let t,n;if("string"===typeof e){t=new Uint8Array(2*e.length),n=0;for(let r=0,a=e.length;r<a;r++){const a=e.charCodeAt(r);a<=255?t[n++]=a:(t[n++]=a>>>8,t[n++]=255&a)}}else{if(!(0,r.isArrayBuffer)(e))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");t=e.slice(),n=t.byteLength}const a=n>>2,o=n-4*a,l=new Uint32Array(t.buffer,0,a);let c=0,d=0,u=this.h1,h=this.h2;const p=3432918353,f=461845907,m=11601,g=13715;for(let r=0;r<a;r++)1&r?(c=l[r],c=c*p&i|c*m&s,c=c<<15|c>>>17,c=c*f&i|c*g&s,u^=c,u=u<<13|u>>>19,u=5*u+3864292196):(d=l[r],d=d*p&i|d*m&s,d=d<<15|d>>>17,d=d*f&i|d*g&s,h^=d,h=h<<13|h>>>19,h=5*h+3864292196);switch(c=0,o){case 3:c^=t[4*a+2]<<16;case 2:c^=t[4*a+1]<<8;case 1:c^=t[4*a],c=c*p&i|c*m&s,c=c<<15|c>>>17,c=c*f&i|c*g&s,1&a?u^=c:h^=c}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&i|36045*e&s,t=4283543511*t&i|(2950163797*(t<<16|e>>>16)&i)>>>16,e^=t>>>1,e=444984403*e&i|60499*e&s,t=3301882366*t&i|(3120437893*(t<<16|e>>>16)&i)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var r=n(1),a=new WeakMap;t.FontLoader=class{constructor(e){let{ownerDocument:t=globalThis.document,styleElement:n=null}=e;_classPrivateFieldInitSpec(this,a,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),_classPrivateFieldGet(a,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){if(e&&!_classPrivateFieldGet(a,this).has(e.loadedName)){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=e,o=new FontFace(n,i,s);this.addNativeFontFace(o);try{await o.load(),_classPrivateFieldGet(a,this).add(n)}catch(t){(0,r.warn)("Cannot load system font: ".concat(e.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(o)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e.systemFontInfo);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw(0,r.warn)("Failed to load font '".concat(t.family,"': '").concat(n,"'.")),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;const t=!(null===(e=this._document)||void 0===e||!e.fonts);return(0,r.shadow)(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let e=!1;return(r.isNodeJS||"undefined"!==typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for((0,r.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function a(e,t,n,r){return e.substring(0,t)+r+e.substring(t+n)}let i,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;const d="lt".concat(Date.now()).concat(this.loadTestFontId++);let u=this._loadTestFont;u=a(u,976,d.length,d);const h=1482184792;let p=n(u,16);for(i=0,s=d.length-3;i<s;i+=4)p=p-h+n(d,i)|0;i<d.length&&(p=p-h+n(d+"XXX",i)|0),u=a(u,16,4,(0,r.string32)(p));const f="url(data:font/opentype;base64,".concat(btoa(u),");"),m='@font-face {font-family:"'.concat(d,'";src:').concat(f,"}");this.insertRule(m);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const r of[e.loadedName,d]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=r,g.append(e)}this._document.body.append(g),function e(t,n){if(++c>30)return(0,r.warn)("Load test font never loaded."),void n();l.font="30px "+t,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(d,()=>{g.remove(),t.complete()})}},t.FontFaceObject=class{constructor(e,t){let{isEvalSupported:n=!0,disableFontFace:r=!1,ignoreErrors:a=!1,inspectFont:i=null}=t;this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.isEvalSupported=!1!==n,this.disableFontFace=!0===r,this.ignoreErrors=!0===a,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null===(e=this._inspectFont)||void 0===e||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t=(0,r.bytesToString)(this.data),n="url(data:".concat(this.mimetype,";base64,").concat(btoa(t),");");let a;if(this.cssFontInfo){let e="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(e+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),a='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(e,"src:").concat(n,"}")}else a='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(n,"}");return null===(e=this._inspectFont)||void 0===e||e.call(this,this,n),a}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(a){if(!this.ignoreErrors)throw a;return(0,r.warn)('getPathGenerator - ignoring character: "'.concat(a,'".')),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const e=[];for(const t of n){const n=void 0!==t.args?t.args.join(","):"";e.push("c.",t.cmd,"(",n,");\n")}return this.compiledGlyphs[t]=new Function("c","size",e.join(""))}return this.compiledGlyphs[t]=function(e,t){for(const r of n)"scale"===r.cmd&&(r.args=[t,-t]),e[r.cmd].apply(e,r.args)}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var r=n(7);n(1);const a=function(e){return new Promise((t,n)=>{__webpack_require__(3237).readFile(e,(e,r)=>{!e&&r?t(new Uint8Array(r)):n(new Error(e))})})};class i extends r.BaseFilterFactory{}t.NodeFilterFactory=i;class s extends r.BaseCanvasFactory{_createCanvas(e,t){return __webpack_require__(7640).createCanvas(e,t)}}t.NodeCanvasFactory=s;class o extends r.BaseCMapReaderFactory{_fetchData(e,t){return a(e).then(e=>({cMapData:e,compressionType:t}))}}t.NodeCMapReaderFactory=o;class l extends r.BaseStandardFontDataFactory{_fetchData(e){return a(e)}}t.NodeStandardFontDataFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var r=n(1),a=n(6),i=n(12),s=n(13);const o=4096,l=16;class c{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return void 0!==this.cache[e]?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function d(e,t,n,r,i,s,o,l,c,d){const[u,h,p,f,m,g]=(0,a.getCurrentTransform)(e);if(0===h&&0===p){const a=o*u+m,v=Math.round(a),y=l*f+g,b=Math.round(y),w=(o+c)*u+m,_=Math.abs(Math.round(w)-v)||1,A=(l+d)*f+g,S=Math.abs(Math.round(A)-b)||1;return e.setTransform(Math.sign(u),0,0,Math.sign(f),v,b),e.drawImage(t,n,r,i,s,0,0,_,S),e.setTransform(u,h,p,f,m,g),[_,S]}if(0===u&&0===f){const a=l*p+m,v=Math.round(a),y=o*h+g,b=Math.round(y),w=(l+d)*p+m,_=Math.abs(Math.round(w)-v)||1,A=(o+c)*h+g,S=Math.abs(Math.round(A)-b)||1;return e.setTransform(0,Math.sign(h),Math.sign(p),0,v,b),e.drawImage(t,n,r,i,s,0,0,S,_),e.setTransform(u,h,p,f,m,g),[S,_]}return e.drawImage(t,n,r,i,s,o,l,c,d),[Math.hypot(u,h)*c,Math.hypot(p,f)*d]}class u{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=r.Util.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=r.Util.applyTransform(t,e),a=r.Util.applyTransform(t.slice(2),e);this.minX=Math.min(this.minX,n[0],a[0]),this.minY=Math.min(this.minY,n[1],a[1]),this.maxX=Math.max(this.maxX,n[0],a[0]),this.maxY=Math.max(this.maxY,n[1],a[1])}updateScalingPathMinMax(e,t){r.Util.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.maxX=Math.max(this.maxX,t[1]),this.minY=Math.min(this.minY,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,a,i,s,o,l,c,d){const u=r.Util.bezierBoundingBox(t,n,a,i,s,o,l,c);if(d)return d[0]=Math.min(d[0],u[0],u[2]),d[1]=Math.max(d[1],u[0],u[2]),d[2]=Math.min(d[2],u[1],u[3]),void(d[3]=Math.max(d[3],u[1],u[3]));this.updateRectMinMax(e,u)}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.PathType.FILL,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===i.PathType.STROKE){t||(0,r.unreachable)("Stroke bounding box must include transform.");const e=r.Util.singularValueDecompose2dScale(t),a=e[0]*this.lineWidth/2,i=e[1]*this.lineWidth/2;n[0]-=a,n[1]-=i,n[2]+=a,n[3]+=i}return n}updateClipFromPath(){const e=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.PathType.FILL,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.Util.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function h(e,t){if("undefined"!==typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,a=t.width,i=n%l,s=(n-i)/l,o=0===i?s:s+1,c=e.createImageData(a,l);let d,u=0;const h=t.data,p=c.data;let f,m,g,v;if(t.kind===r.ImageKind.GRAYSCALE_1BPP){const t=h.byteLength,n=new Uint32Array(p.buffer,0,p.byteLength>>2),v=n.length,y=a+7>>3,b=4294967295,w=r.FeatureTest.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(g=f<s?l:i,d=0,m=0;m<g;m++){const e=t-u;let r=0;const i=e>y?a:8*e-7,s=-8&i;let o=0,l=0;for(;r<s;r+=8)l=h[u++],n[d++]=128&l?b:w,n[d++]=64&l?b:w,n[d++]=32&l?b:w,n[d++]=16&l?b:w,n[d++]=8&l?b:w,n[d++]=4&l?b:w,n[d++]=2&l?b:w,n[d++]=1&l?b:w;for(;r<i;r++)0===o&&(l=h[u++],o=128),n[d++]=l&o?b:w,o>>=1}for(;d<v;)n[d++]=0;e.putImageData(c,0,f*l)}}else if(t.kind===r.ImageKind.RGBA_32BPP){for(m=0,v=a*l*4,f=0;f<s;f++)p.set(h.subarray(u,u+v)),u+=v,e.putImageData(c,0,m),m+=l;f<o&&(v=a*i*4,p.set(h.subarray(u,u+v)),e.putImageData(c,0,m))}else{if(t.kind!==r.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(g=l,v=a*g,f=0;f<o;f++){for(f>=s&&(g=i,v=a*g),d=0,m=v;m--;)p[d++]=h[u++],p[d++]=h[u++],p[d++]=h[u++],p[d++]=255;e.putImageData(c,0,f*l)}}}function p(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,r=t.width,a=n%l,i=(n-a)/l,o=0===a?i:i+1,c=e.createImageData(r,l);let d=0;const u=t.data,h=c.data;for(let p=0;p<o;p++){const t=p<i?l:a;({srcPos:d}=(0,s.convertBlackAndWhiteToRGBA)({src:u,srcPos:d,dest:h,width:r,height:t,nonBlackColor:0})),e.putImageData(c,0,p*l)}}function f(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of n)void 0!==e[r]&&(t[r]=e[r]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function m(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0),!r.isNodeJS){const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}}function g(e,t,n,r){const a=e.length;for(let i=3;i<a;i+=4){const a=e[i];if(0===a)e[i-3]=t,e[i-2]=n,e[i-1]=r;else if(a<255){const s=255-a;e[i-3]=e[i-3]*a+t*s>>8,e[i-2]=e[i-2]*a+n*s>>8,e[i-1]=e[i-1]*a+r*s>>8}}}function v(e,t,n){const r=e.length,a=1/255;for(let i=3;i<r;i+=4){const r=n?n[e[i]]:e[i];t[i]=t[i]*r*a|0}}function y(e,t,n){const r=e.length;for(let a=3;a<r;a+=4){const r=77*e[a-3]+152*e[a-2]+28*e[a-1];t[a]=n?t[a]*n[r>>8]>>8:t[a]*r>>16}}function b(e,t,n,r){const a=r[0],i=r[1],s=r[2]-a,o=r[3]-i;0!==s&&0!==o&&(function(e,t,n,r,a,i,s,o,l,c,d){const u=!!i,h=u?i[0]:0,p=u?i[1]:0,f=u?i[2]:0,m="Luminosity"===a?y:v,b=Math.min(r,Math.ceil(1048576/n));for(let v=0;v<r;v+=b){const a=Math.min(b,r-v),i=e.getImageData(o-c,v+(l-d),n,a),y=t.getImageData(o,v+l,n,a);u&&g(i.data,h,p,f),m(i.data,y.data,s),t.putImageData(y,o,v+l)}}(t.context,n,s,o,t.subtype,t.backdrop,t.transferMap,a,i,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}function w(e,t){const n=r.Util.singularValueDecompose2dScale(e);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*a.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==t?t:n[0]<=i||n[1]<=i}const _=["butt","round","square"],A=["miter","round","bevel"],S={},C={};var x=new WeakSet;class E{constructor(e,t,n,r,a,i,s,o){let{optionalContentConfig:l,markedContentStack:d=null}=i;_classPrivateMethodInitSpec(this,x),this.ctx=e,this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=l,this.cachedCanvases=new c(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=s,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=o,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing(e){let{transform:t,viewport:n,transparency:r=!1,background:i=null}=e;const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,r){const e=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...(0,a.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),m(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,a.getCurrentTransform)(this.ctx)}executeOperatorList(e,t,n,a){const i=e.argsArray,s=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const c=l-o>10&&"function"===typeof n,d=c?Date.now()+15:0;let u=0;const h=this.commonObjs,p=this.objs;let f;for(;;){if(void 0!==a&&o===a.nextBreakPoint)return a.breakIt(o,n),o;if(f=s[o],f!==r.OPS.dependency)this[f].apply(this,i[o]);else for(const e of i[o]){const t=e.startsWith("g_")?h:p;if(!t.has(e))return t.get(e,n),o}if(o++,o===l)return o;if(c&&++u>10){if(Date.now()>d)return n(),o;u=0}}}endDrawing(){_assertClassBrand(x,this,T).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),_assertClassBrand(x,this,k).call(this)}_scaleImage(e,t){const n=e.width,r=e.height;let a,i,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=n,c=r,d="prescale1";for(;s>2&&l>1||o>2&&c>1;){let t=l,n=c;s>2&&l>1&&(t=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/t),o>2&&c>1&&(n=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/n),a=this.cachedCanvases.getCanvas(d,t,n),i=a.context,i.clearRect(0,0,t,n),i.drawImage(e,0,0,l,c,0,0,t,n),e=a.canvas,l=t,c=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,o=this.current.fillColor,l=this.current.patternFill,c=(0,a.getCurrentTransform)(t);let u,h,f,m;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),o]),u=this._cachedBitmapsMap.get(t),u||(u=new Map,this._cachedBitmapsMap.set(t,u));const n=u.get(h);if(n&&!l)return{canvas:n,offsetX:Math.round(Math.min(c[0],c[2])+c[4]),offsetY:Math.round(Math.min(c[1],c[3])+c[5])};f=n}f||(m=this.cachedCanvases.getCanvas("maskCanvas",n,s),p(m.context,e));let g=r.Util.transform(c,[1/n,0,0,-1/s,0,0]);g=r.Util.transform(g,[1,0,0,1,0,-s]);const v=r.Util.applyTransform([0,0],g),y=r.Util.applyTransform([n,s],g),b=r.Util.normalizeRect([v[0],v[1],y[0],y[1]]),_=Math.round(b[2]-b[0])||1,A=Math.round(b[3]-b[1])||1,S=this.cachedCanvases.getCanvas("fillCanvas",_,A),C=S.context,x=Math.min(v[0],y[0]),E=Math.min(v[1],y[1]);C.translate(-x,-E),C.transform(...g),f||(f=this._scaleImage(m.canvas,(0,a.getCurrentTransformInverse)(C)),f=f.img,u&&l&&u.set(h,f)),C.imageSmoothingEnabled=w((0,a.getCurrentTransform)(C),e.interpolate),d(C,f,0,0,f.width,f.height,0,0,n,s),C.globalCompositeOperation="source-in";const T=r.Util.transform((0,a.getCurrentTransformInverse)(C),[1,0,0,1,-x,-E]);return C.fillStyle=l?o.getPattern(t,this,T,i.PathType.FILL):o,C.fillRect(0,0,n,s),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,S.canvas)),{canvas:S.canvas,offsetX:Math.round(x),offsetY:Math.round(E)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=_[e]}setLineJoin(e){this.ctx.lineJoin=A[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const i=this.ctx;i.setTransform(...(0,a.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,i),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,r,a,i,s){t.transform(e,n,r,a,i,s),this.__originalTransform(e,n,r,a,i,s)},e.setTransform=function(e,n,r,a,i,s){t.setTransform(e,n,r,a,i,s),this.__originalSetTransform(e,n,r,a,i,s)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,r,a,i,s){t.bezierCurveTo(e,n,r,a,i,s),this.__originalBezierCurveTo(e,n,r,a,i,s)},e.rect=function(e,n,r,a){t.rect(e,n,r,a),this.__originalRect(e,n,r,a)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask;b(this.suspendedCtx,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,a,i){this.ctx.transform(e,t,n,r,a,i),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const i=this.ctx,s=this.current;let o,l,c=s.x,d=s.y;const u=(0,a.getCurrentTransform)(i),h=0===u[0]&&0===u[3]||0===u[1]&&0===u[2],p=h?n.slice(0):null;for(let a=0,f=0,m=e.length;a<m;a++)switch(0|e[a]){case r.OPS.rectangle:c=t[f++],d=t[f++];const e=t[f++],n=t[f++],a=c+e,m=d+n;i.moveTo(c,d),0===e||0===n?i.lineTo(a,m):(i.lineTo(a,d),i.lineTo(a,m),i.lineTo(c,m)),h||s.updateRectMinMax(u,[c,d,a,m]),i.closePath();break;case r.OPS.moveTo:c=t[f++],d=t[f++],i.moveTo(c,d),h||s.updatePathMinMax(u,c,d);break;case r.OPS.lineTo:c=t[f++],d=t[f++],i.lineTo(c,d),h||s.updatePathMinMax(u,c,d);break;case r.OPS.curveTo:o=c,l=d,c=t[f+4],d=t[f+5],i.bezierCurveTo(t[f],t[f+1],t[f+2],t[f+3],c,d),s.updateCurvePathMinMax(u,o,l,t[f],t[f+1],t[f+2],t[f+3],c,d,p),f+=6;break;case r.OPS.curveTo2:o=c,l=d,i.bezierCurveTo(c,d,t[f],t[f+1],t[f+2],t[f+3]),s.updateCurvePathMinMax(u,o,l,c,d,t[f],t[f+1],t[f+2],t[f+3],p),c=t[f+2],d=t[f+3],f+=4;break;case r.OPS.curveTo3:o=c,l=d,c=t[f+2],d=t[f+3],i.bezierCurveTo(t[f],t[f+1],c,d,c,d),s.updateCurvePathMinMax(u,o,l,t[f],t[f+1],c,d,c,d,p),f+=4;break;case r.OPS.closePath:i.closePath()}h&&s.updateScalingPathMinMax(u,p),s.setCurrentPoint(c,d)}closePath(){this.ctx.closePath()}stroke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"===typeof n&&null!==n&&void 0!==n&&n.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,n=this.current.fillColor;let r=!1;this.current.patternFill&&(t.save(),t.fillStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.FILL),r=!0);const s=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==s&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(s)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=S}eoClip(){this.pendingClip=C}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(const n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var n;const a=this.commonObjs.get(e),i=this.current;if(!a)throw new Error("Can't find font for ".concat(e));if(i.fontMatrix=a.fontMatrix||r.FONT_IDENTITY_MATRIX,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,r.warn)("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=a,this.current.fontSize=t,a.isType3Font)return;const s=a.loadedName||"sans-serif",o=(null===(n=a.systemFontInfo)||void 0===n?void 0:n.css)||'"'.concat(s,'", ').concat(a.fallbackName);let l="normal";a.black?l="900":a.bold&&(l="bold");const c=a.italic?"italic":"normal";let d=t;t<16?d=16:t>100&&(d=100),this.current.fontSizeScale=t/d,this.ctx.font="".concat(c," ").concat(l," ").concat(d,"px ").concat(o)}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,a,i){this.current.textMatrix=[e,t,n,r,a,i],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i){const s=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,u=c&r.TextRenderingMode.FILL_STROKE_MASK,h=!!(c&r.TextRenderingMode.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile;let f;(l.disableFontFace||h||p)&&(f=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p?(s.save(),s.translate(t,n),s.beginPath(),f(s,d),i&&s.setTransform(...i),u!==r.TextRenderingMode.FILL&&u!==r.TextRenderingMode.FILL_STROKE||s.fill(),u!==r.TextRenderingMode.STROKE&&u!==r.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(u!==r.TextRenderingMode.FILL&&u!==r.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n),u!==r.TextRenderingMode.STROKE&&u!==r.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,a.getCurrentTransform)(s),x:t,y:n,fontSize:d,addToPath:f})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(0===s)return;const o=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,p=e.length,f=n.vertical,m=f?1:-1,g=n.defaultVMetrics,v=s*t.fontMatrix[0],y=t.textRenderingMode===r.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;let b;if(o.save(),o.transform(...t.textMatrix),o.translate(t.x,t.y+t.textRise),u>0?o.scale(h,-1):o.scale(h,1),t.patternFill){o.save();const e=t.fillColor.getPattern(o,this,(0,a.getCurrentTransformInverse)(o),i.PathType.FILL);b=(0,a.getCurrentTransform)(o),o.restore(),o.fillStyle=e}let w=t.lineWidth;const _=t.textMatrixScale;if(0===_||0===w){const e=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;e!==r.TextRenderingMode.STROKE&&e!==r.TextRenderingMode.FILL_STROKE||(w=this.getSinglePixelWidth())}else w/=_;if(1!==l&&(o.scale(l,l),w/=l),o.lineWidth=w,n.isInvalidPDFjsFont){const n=[];let r=0;for(const t of e)n.push(t.unicode),r+=t.width;return o.fillText(n.join(""),0,0),t.x+=r*v*h,o.restore(),void this.compose()}let A,S=0;for(A=0;A<p;++A){const t=e[A];if("number"===typeof t){S+=m*t*s/1e3;continue}let r=!1;const a=(t.isSpace?d:0)+c,i=t.fontChar,h=t.accent;let p,w,_=t.width;if(f){const e=t.vmetric||g,n=-(t.vmetric?e[1]:.5*_)*v,r=e[2]*v;_=e?-e[0]:_,p=n/l,w=(S+r)/l}else p=S/l,w=0;if(n.remeasure&&_>0){const e=1e3*o.measureText(i).width/s*l;if(_<e&&this.isFontSubpixelAAEnabled){const t=_/e;r=!0,o.save(),o.scale(t,1),p/=t}else _!==e&&(p+=(_-e)/2e3*s/l)}if(this.contentVisible&&(t.isInFont||n.missingFile))if(y&&!h)o.fillText(i,p,w);else if(this.paintChar(i,p,w,b),h){const e=p+s*h.offset.x/l,t=w-s*h.offset.y/l;this.paintChar(h.fontChar,e,t,b)}S+=f?_*v-a*u:_*v+a*u,r&&o.restore()}f?t.y-=S:t.x+=S*h,o.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,a=n.font,i=n.fontSize,s=n.fontDirection,o=a.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,d=n.textHScale*s,u=n.fontMatrix||r.FONT_IDENTITY_MATRIX,h=e.length;let p,f,m,g;if(n.textRenderingMode!==r.TextRenderingMode.INVISIBLE&&0!==i){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(d,s),p=0;p<h;++p){if(f=e[p],"number"===typeof f){g=o*f*i/1e3,this.ctx.translate(g,0),n.x+=g*d;continue}const s=(f.isSpace?c:0)+l,h=a.charProcOperatorList[f.operatorListId];h?(this.contentVisible&&(this.processingType3=f,this.save(),t.scale(i,i),t.transform(...u),this.executeOperatorList(h),this.restore()),m=r.Util.applyTransform([f.width,0],u)[0]*i+s,t.translate(m,0),n.x+=m*d):(0,r.warn)('Type3 character "'.concat(f.operatorListId,'" is not available.'))}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,a,i){this.ctx.rect(n,r,a-n,i-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const n=e[1],r=this.baseTransform||(0,a.getCurrentTransform)(this.ctx),s={createCanvasGraphics:e=>new E(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new i.TilingPattern(e,n,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){const a=r.Util.makeHexColor(e,t,n);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(e,t,n){const a=r.Util.makeHexColor(e,t,n);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(e)?t=this.cachedPatterns.get(e):(t=(0,i.getShadingPattern)(this.getObject(e)),this.cachedPatterns.set(e,t)),n&&(t.matrix=n),t}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,(0,a.getCurrentTransformInverse)(t),i.PathType.SHADING);const s=(0,a.getCurrentTransformInverse)(t);if(s){const{width:e,height:n}=t.canvas,[a,i,o,l]=r.Util.getAxialAlignedBoundingBox([0,0,e,n],s);this.ctx.fillRect(a,i,o-a,l-i)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform(...e),this.baseTransform=(0,a.getCurrentTransform)(this.ctx),t)){const e=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],e,n),this.current.updateRectMinMax((0,a.getCurrentTransform)(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||(0,r.info)("TODO: Support non-isolated groups."),e.knockout&&(0,r.warn)("Knockout groups not supported.");const n=(0,a.getCurrentTransform)(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=r.Util.getAxialAlignedBoundingBox(e.bbox,(0,a.getCurrentTransform)(t));const s=[0,0,t.canvas.width,t.canvas.height];i=r.Util.intersect(i,s)||[0,0,0,0];const l=Math.floor(i[0]),c=Math.floor(i[1]);let d=Math.max(Math.ceil(i[2])-l,1),u=Math.max(Math.ceil(i[3])-c,1),h=1,p=1;d>o&&(h=d/o,d=o),u>o&&(p=u/o,u=o),this.current.startNewPathAndClipBox([0,0,d,u]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(m,d,u),v=g.context;v.scale(1/h,1/p),v.translate(-l,-c),v.transform(...n),e.smask?this.smaskStack.push({canvas:g.canvas,context:v,offsetX:l,offsetY:c,scaleX:h,scaleY:p,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.scale(h,p),t.save()),f(t,v),this.ctx=v,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=(0,a.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const n=r.Util.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,s){if(_assertClassBrand(x,this,T).call(this),m(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(t)&&4===t.length){const i=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){(n=n.slice())[4]-=t[0],n[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=i,t[3]=o;const[s,l]=r.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(this.ctx)),{viewportScale:c}=this,d=Math.ceil(i*this.outputScaleX*c),u=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,u);const{canvas:h,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(s,0,0,-l,0,o*l),m(this.ctx)}else m(this.ctx),this.ctx.rect(t[0],t[1],i,o),this.ctx.clip(),this.endPath()}this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_assertClassBrand(x,this,k).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const n=this.ctx,r=this.processingType3;if(r&&(void 0===r.compiled&&(r.compiled=function(e){const{width:t,height:n}=e;if(t>1e3||n>1e3)return null;const r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=t+1;let i,s,o,l=new Uint8Array(a*(n+1));const c=t+7&-8;let d=new Uint8Array(c*n),u=0;for(const m of e.data){let e=128;for(;e>0;)d[u++]=m&e?0:255,e>>=1}let h=0;for(u=0,0!==d[u]&&(l[0]=1,++h),s=1;s<t;s++)d[u]!==d[u+1]&&(l[s]=d[u]?2:1,++h),u++;for(0!==d[u]&&(l[s]=2,++h),i=1;i<n;i++){u=i*c,o=i*a,d[u-c]!==d[u]&&(l[o]=d[u]?1:8,++h);let e=(d[u]?4:0)+(d[u-c]?8:0);for(s=1;s<t;s++)e=(e>>2)+(d[u+1]?4:0)+(d[u-c+1]?8:0),r[e]&&(l[o+s]=r[e],++h),u++;if(d[u-c]!==d[u]&&(l[o+s]=d[u]?2:4,++h),h>1e3)return null}for(u=c*(n-1),o=i*a,0!==d[u]&&(l[o]=8,++h),s=1;s<t;s++)d[u]!==d[u+1]&&(l[o+s]=d[u]?4:8,++h),u++;if(0!==d[u]&&(l[o+s]=4,++h),h>1e3)return null;const p=new Int32Array([0,a,-1,0,-a,0,0,0,1]),f=new Path2D;for(i=0;h&&i<=n;i++){let e=i*a;const n=e+t;for(;e<n&&!l[e];)e++;if(e===n)continue;f.moveTo(e%a,i);const r=e;let s=l[e];do{const t=p[s];do{e+=t}while(!l[e]);const n=l[e];5!==n&&10!==n?(s=n,l[e]=0):(s=n&51*s>>4,l[e]&=s>>2|s<<2),f.lineTo(e%a,e/a|0),l[e]||--h}while(r!==e);--i}return d=null,l=null,function(e){e.save(),e.scale(1/t,-1/n),e.translate(0,-n),e.fill(f),e.beginPath(),e.restore()}}(e)),r.compiled))return void r.compiled(n);const a=this._createMaskCanvas(e),i=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(i,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=(0,a.getCurrentTransform)(l);l.transform(t,n,i,s,0,0);const d=this._createMaskCanvas(e);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]);for(let a=0,u=o.length;a<u;a+=2){const e=r.Util.transform(c,[t,n,i,s,o[a],o[a+1]]),[u,h]=r.Util.applyTransform([0,0],e);l.drawImage(d.canvas,u,h)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(const s of e){const{data:e,width:o,height:l,transform:c}=s,u=this.cachedCanvases.getCanvas("maskCanvas",o,l),h=u.context;h.save(),p(h,this.getObject(e,s)),h.globalCompositeOperation="source-in",h.fillStyle=r?n.getPattern(h,this,(0,a.getCurrentTransformInverse)(t),i.PathType.FILL):n,h.fillRect(0,0,o,l),h.restore(),t.save(),t.transform(...c),t.scale(1,-1),d(t,u.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,r.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,a){if(!this.contentVisible)return;const i=this.getObject(e);if(!i)return void(0,r.warn)("Dependent image isn't ready yet");const s=i.width,o=i.height,l=[];for(let r=0,c=a.length;r<c;r+=2)l.push({transform:[t,0,0,n,a[r],a[r+1]],x:0,y:0,w:s,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:r}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,r),i=a.context;return i.filter=this.current.transferMaps,i.drawImage(t,0,0),i.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;if(this.save(),!r.isNodeJS){const{filter:e}=i;"none"!==e&&""!==e&&(i.filter="none")}let s;if(i.scale(1/t,-1/n),e.bitmap)s=this.applyTransferMapsToBitmap(e);else if("function"===typeof HTMLElement&&e instanceof HTMLElement||!e.data)s=e;else{const r=this.cachedCanvases.getCanvas("inlineImage",t,n).context;h(r,e),s=this.applyTransferMapsToCanvas(r)}const o=this._scaleImage(s,(0,a.getCurrentTransformInverse)(i));i.imageSmoothingEnabled=w((0,a.getCurrentTransform)(i),e.interpolate),d(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const t=e.width,n=e.height,a=this.cachedCanvases.getCanvas("inlineImage",t,n).context;h(a,e),r=this.applyTransferMapsToCanvas(a)}for(const a of t)n.save(),n.transform(...a.transform),n.scale(1,-1),d(n,r,a.x,a.y,a.w,a.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===C?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,a.getCurrentTransform)(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:a}=this.ctx.getTransform();let i,s;if(0===n&&0===r){const n=Math.abs(t),r=Math.abs(a);if(n===r)if(0===e)i=s=1/n;else{const t=n*e;i=s=t<1?1/t:1}else if(0===e)i=1/n,s=1/r;else{const t=n*e,a=r*e;i=t<1?1/t:1,s=a<1?1/a:1}}else{const o=Math.abs(t*a-n*r),l=Math.hypot(t,n),c=Math.hypot(r,a);if(0===e)i=c/o,s=l/o;else{const t=e*o;i=c>t?c/t:1,s=l>t?l/t:1}}this._cachedScaleForStroking[0]=i,this._cachedScaleForStroking[1]=s}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[r,a]=this.getScaleForStroking();if(t.lineWidth=n||1,1===r&&1===a)return void t.stroke();const i=t.getLineDash();if(e&&t.save(),t.scale(r,a),i.length>0){const e=Math.max(r,a);t.setLineDash(i.map(t=>t/e)),t.lineDashOffset/=e}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function T(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function k(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}t.CanvasGraphics=E;for(const P in r.OPS)void 0!==E.prototype[P]&&(E.prototype[r.OPS[P]]=E.prototype[P])},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=function(e){switch(e[0]){case"RadialAxial":return new l(e);case"Mesh":return new u(e);case"Dummy":return new h}throw new Error("Unknown IR type: ".concat(e[0]))};var r=n(1),a=n(6);const i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function s(e,t){if(!t)return;const n=t[2]-t[0],r=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],n,r),e.clip(a)}t.PathType=i;class o{constructor(){this.constructor===o&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class l extends o{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,o){let l;if(o===i.STROKE||o===i.FILL){const i=t.current.getClippedPathBoundingBox(o,(0,a.getCurrentTransform)(e))||[0,0,0,0],c=Math.ceil(i[2]-i[0])||1,d=Math.ceil(i[3]-i[1])||1,u=t.cachedCanvases.getCanvas("pattern",c,d,!0),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-i[0],-i[1]),n=r.Util.transform(n,[1,0,0,1,i[0],i[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),s(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),l=e.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(n);l.setTransform(p)}else s(e,this._bbox),l=this._createGradient(e);return l}}function c(e,t,n,r,a,i,s,o){const l=t.coords,c=t.colors,d=e.data,u=4*e.width;let h;l[n+1]>l[r+1]&&(h=n,n=r,r=h,h=i,i=s,s=h),l[r+1]>l[a+1]&&(h=r,r=a,a=h,h=s,s=o,o=h),l[n+1]>l[r+1]&&(h=n,n=r,r=h,h=i,i=s,s=h);const p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,m=(l[r]+t.offsetX)*t.scaleX,g=(l[r+1]+t.offsetY)*t.scaleY,v=(l[a]+t.offsetX)*t.scaleX,y=(l[a+1]+t.offsetY)*t.scaleY;if(f>=y)return;const b=c[i],w=c[i+1],_=c[i+2],A=c[s],S=c[s+1],C=c[s+2],x=c[o],E=c[o+1],T=c[o+2],k=Math.round(f),P=Math.round(y);let I,R,N,O,M,F,D,L;for(let j=k;j<=P;j++){if(j<g){const e=j<f?0:(f-j)/(f-g);I=p-(p-m)*e,R=b-(b-A)*e,N=w-(w-S)*e,O=_-(_-C)*e}else{let e;e=j>y?1:g===y?0:(g-j)/(g-y),I=m-(m-v)*e,R=A-(A-x)*e,N=S-(S-E)*e,O=C-(C-T)*e}let e;e=j<f?0:j>y?1:(f-j)/(f-y),M=p-(p-v)*e,F=b-(b-x)*e,D=w-(w-E)*e,L=_-(_-T)*e;const t=Math.round(Math.min(I,M)),n=Math.round(Math.max(I,M));let r=u*j+4*t;for(let a=t;a<=n;a++)e=(I-a)/(I-M),e<0?e=0:e>1&&(e=1),d[r++]=R-(R-F)*e|0,d[r++]=N-(N-D)*e|0,d[r++]=O-(O-L)*e|0,d[r++]=255}}function d(e,t,n){const r=t.coords,a=t.colors;let i,s;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(r.length/o)-1,d=o-1;for(i=0;i<l;i++){let t=i*o;for(let i=0;i<d;i++,t++)c(e,n,r[t],r[t+1],r[t+o],a[t],a[t+1],a[t+o]),c(e,n,r[t+o+1],r[t+1],r[t+o],a[t+o+1],a[t+1],a[t+o])}break;case"triangles":for(i=0,s=r.length;i<s;i+=3)c(e,n,r[i],r[i+1],r[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}class u extends o{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const r=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),i=Math.ceil(this._bounds[2])-r,s=Math.ceil(this._bounds[3])-a,o=Math.min(Math.ceil(Math.abs(i*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(s*e[1]*1.1)),3e3),c=i/o,u=s/l,h={coords:this._coords,colors:this._colors,offsetX:-r,offsetY:-a,scaleX:1/c,scaleY:1/u},p=o+4,f=l+4,m=n.getCanvas("mesh",p,f,!1),g=m.context,v=g.createImageData(o,l);if(t){const e=v.data;for(let n=0,r=e.length;n<r;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const y of this._figures)d(v,y,h);return g.putImageData(v,2,2),{canvas:m.canvas,offsetX:r-2*c,offsetY:a-2*u,scaleX:c,scaleY:u}}getPattern(e,t,n,o){let l;if(s(e,this._bbox),o===i.SHADING)l=r.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(e));else if(l=r.Util.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=r.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*e[0],l[1]*e[1]]}const c=this._createMeshCanvas(l,o===i.SHADING?null:this._background,t.cachedCanvases);return o!==i.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class h extends o{getPattern(){return"hotpink"}}const p=1,f=2;class m{constructor(e,t,n,r,a){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=a}createPatternCanvas(e){const t=this.operatorList,n=this.bbox,i=this.xstep,s=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,d=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+l);const u=n[0],h=n[1],p=n[2],f=n[3],m=r.Util.singularValueDecompose2dScale(this.matrix),g=r.Util.singularValueDecompose2dScale(this.baseTransform),v=[m[0]*g[0],m[1]*g[1]],y=this.getSizeAndScale(i,this.ctx.canvas.width,v[0]),b=this.getSizeAndScale(s,this.ctx.canvas.height,v[1]),w=e.cachedCanvases.getCanvas("pattern",y.size,b.size,!0),_=w.context,A=d.createCanvasGraphics(_);A.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(A,o,c);let S=u,C=h,x=p,E=f;return u<0&&(S=0,x+=Math.abs(u)),h<0&&(C=0,E+=Math.abs(h)),_.translate(-y.scale*S,-b.scale*C),A.transform(y.scale,0,0,b.scale,0,0),_.save(),this.clipBbox(A,S,C,x,E),A.baseTransform=(0,a.getCurrentTransform)(A.ctx),A.executeOperatorList(t),A.endDrawing(),{canvas:w.canvas,scaleX:y.scale,scaleY:b.scale,offsetX:S,offsetY:C}}getSizeAndScale(e,t,n){e=Math.abs(e);const r=Math.max(m.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=r?a=r:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,r,i){const s=r-t,o=i-n;e.ctx.rect(t,n,s,o),e.current.updateRectMinMax((0,a.getCurrentTransform)(e.ctx),[t,n,r,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const a=e.ctx,i=e.current;switch(t){case p:const e=this.ctx;a.fillStyle=e.fillStyle,a.strokeStyle=e.strokeStyle,i.fillColor=e.fillStyle,i.strokeColor=e.strokeStyle;break;case f:const s=r.Util.makeHexColor(n[0],n[1],n[2]);a.fillStyle=s,a.strokeStyle=s,i.fillColor=s,i.strokeColor=s;break;default:throw new r.FormatError("Unsupported paint type: ".concat(t))}}getPattern(e,t,n,a){let s=n;a!==i.SHADING&&(s=r.Util.transform(s,t.baseTransform),this.matrix&&(s=r.Util.transform(s,this.matrix)));const o=this.createPatternCanvas(t);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(l),c}}_defineProperty(m,"MAX_PATTERN_SIZE",3e3),t.TilingPattern=m},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=a,t.convertToRGBA=function(e){switch(e.kind){case r.ImageKind.GRAYSCALE_1BPP:return a(e);case r.ImageKind.RGB_24BPP:return function(e){let{src:t,srcPos:n=0,dest:a,destPos:i=0,width:s,height:o}=e,l=0;const c=t.length>>2,d=new Uint32Array(t.buffer,n,c);if(r.FeatureTest.isLittleEndian){for(;l<c-2;l+=3,i+=4){const e=d[l],t=d[l+1],n=d[l+2];a[i]=4278190080|e,a[i+1]=e>>>24|t<<8|4278190080,a[i+2]=t>>>16|n<<16|4278190080,a[i+3]=n>>>8|4278190080}for(let e=4*l,n=t.length;e<n;e+=3)a[i++]=t[e]|t[e+1]<<8|t[e+2]<<16|4278190080}else{for(;l<c-2;l+=3,i+=4){const e=d[l],t=d[l+1],n=d[l+2];a[i]=255|e,a[i+1]=e<<24|t>>>8|255,a[i+2]=t<<16|n>>>16|255,a[i+3]=n<<8|255}for(let e=4*l,n=t.length;e<n;e+=3)a[i++]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|255}return{srcPos:n,destPos:i}}(e)}return null},t.grayToRGBA=function(e,t){if(r.FeatureTest.isLittleEndian)for(let n=0,r=e.length;n<r;n++)t[n]=65793*e[n]|4278190080;else for(let n=0,r=e.length;n<r;n++)t[n]=16843008*e[n]|255};var r=n(1);function a(e){let{src:t,srcPos:n=0,dest:a,width:i,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}=e;const c=r.FeatureTest.isLittleEndian?4278190080:255,[d,u]=l?[o,c]:[c,o],h=i>>3,p=7&i,f=t.length;a=new Uint32Array(a.buffer);let m=0;for(let r=0;r<s;r++){for(const r=n+h;n<r;n++){const e=n<f?t[n]:255;a[m++]=128&e?u:d,a[m++]=64&e?u:d,a[m++]=32&e?u:d,a[m++]=16&e?u:d,a[m++]=8&e?u:d,a[m++]=4&e?u:d,a[m++]=2&e?u:d,a[m++]=1&e?u:d}if(0===p)continue;const e=n<f?t[n++]:255;for(let t=0;t<p;t++)a[m++]=e&1<<7-t?u:d}return{srcPos:n,destPos:m}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const n=Object.create(null);t.GlobalWorkerOptions=n,n.workerPort=null,n.workerSrc=""},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var r=n(1);const a=1,i=2,s=1,o=2,l=3,c=4,d=5,u=6,h=7,p=8;function f(e){switch(e instanceof Error||"object"===typeof e&&null!==e||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new r.AbortException(e.message);case"MissingPDFException":return new r.MissingPDFException(e.message);case"PasswordException":return new r.PasswordException(e.message,e.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new r.UnknownErrorException(e.message,e.details);default:return new r.UnknownErrorException(e.message,e.toString())}}var m=new WeakSet;function g(e){const t=e.streamId,n=this.sourceName,a=e.sourceName,i=this.comObj,s=this,o=this.actionHandler[e.action],u={enqueue(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=s,l>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:a,stream:c,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:l,streamId:t}),delete s.streamSinks[t])},error(e){(0,r.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:d,streamId:t,reason:f(e)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[t]=u,new Promise(function(t){t(o(e.data,u))}).then(function(){i.postMessage({sourceName:n,targetName:a,stream:p,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:a,stream:p,streamId:t,reason:f(e)})})}function v(e){const t=e.streamId,n=this.sourceName,a=e.sourceName,i=this.comObj,g=this.streamControllers[t],v=this.streamSinks[t];switch(e.stream){case p:e.success?g.startCall.resolve():g.startCall.reject(f(e.reason));break;case h:e.success?g.pullCall.resolve():g.pullCall.reject(f(e.reason));break;case u:if(!v){i.postMessage({sourceName:n,targetName:a,stream:h,streamId:t,success:!0});break}v.desiredSize<=0&&e.desiredSize>0&&v.sinkCapability.resolve(),v.desiredSize=e.desiredSize,new Promise(function(e){var t;e(null===(t=v.onPull)||void 0===t?void 0:t.call(v))}).then(function(){i.postMessage({sourceName:n,targetName:a,stream:h,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:a,stream:h,streamId:t,reason:f(e)})});break;case c:if((0,r.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(e.chunk);break;case l:if((0,r.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),_assertClassBrand(m,this,y).call(this,g,t);break;case d:(0,r.assert)(g,"error should have stream controller"),g.controller.error(f(e.reason)),_assertClassBrand(m,this,y).call(this,g,t);break;case o:e.success?g.cancelCall.resolve():g.cancelCall.reject(f(e.reason)),_assertClassBrand(m,this,y).call(this,g,t);break;case s:if(!v)break;new Promise(function(t){var n;t(null===(n=v.onCancel)||void 0===n?void 0:n.call(v,f(e.reason)))}).then(function(){i.postMessage({sourceName:n,targetName:a,stream:o,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:a,stream:o,streamId:t,reason:f(e)})}),v.sinkCapability.reject(f(e.reason)),v.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async function y(e,t){var n,r,a;await Promise.allSettled([null===(n=e.startCall)||void 0===n?void 0:n.promise,null===(r=e.pullCall)||void 0===r?void 0:r.promise,null===(a=e.cancelCall)||void 0===a?void 0:a.promise]),delete this.streamControllers[t]}t.MessageHandler=class{constructor(e,t,n){_classPrivateMethodInitSpec(this,m),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void _assertClassBrand(m,this,v).call(this,t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback ".concat(e));if(delete this.callbackCapabilities[e],t.callback===a)n.resolve(t.data);else{if(t.callback!==i)throw new Error("Unexpected callback case");n.reject(f(t.reason))}return}const r=this.actionHandler[t.action];if(!r)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){const e=this.sourceName,s=t.sourceName;return void new Promise(function(e){e(r(t.data))}).then(function(r){n.postMessage({sourceName:e,targetName:s,callback:a,callbackId:t.callbackId,data:r})},function(r){n.postMessage({sourceName:e,targetName:s,callback:i,callbackId:t.callbackId,reason:f(r)})})}t.streamId?_assertClassBrand(m,this,g).call(this,t):r(t.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const a=this.callbackId++,i=new r.PromiseCapability;this.callbackCapabilities[a]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:a,data:t},n)}catch(s){i.reject(s)}return i.promise}sendWithStream(e,t,n,a){const i=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:n=>{const s=new r.PromiseCapability;return this.streamControllers[i]={controller:n,startCall:s,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:i,data:t,desiredSize:n.desiredSize},a),s.promise},pull:e=>{const t=new r.PromiseCapability;return this.streamControllers[i].pullCall=t,c.postMessage({sourceName:o,targetName:l,stream:u,streamId:i,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,r.assert)(e instanceof Error,"cancel must have a valid reason");const t=new r.PromiseCapability;return this.streamControllers[i].cancelCall=t,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:s,streamId:i,reason:f(e)}),t.promise}},n)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=n(1),a=new WeakMap,i=new WeakMap;t.Metadata=class{constructor(e){let{parsedData:t,rawData:n}=e;_classPrivateFieldInitSpec(this,a,void 0),_classPrivateFieldInitSpec(this,i,void 0),_classPrivateFieldSet(a,this,t),_classPrivateFieldSet(i,this,n)}getRaw(){return _classPrivateFieldGet(i,this)}get(e){var t;return null!==(t=_classPrivateFieldGet(a,this).get(e))&&void 0!==t?t:null}getAll(){return(0,r.objectFromMap)(_classPrivateFieldGet(a,this))}has(e){return _classPrivateFieldGet(a,this).has(e)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var r=n(1),a=n(8);const i=Symbol("INTERNAL");var s=new WeakMap;class o{constructor(e,t){_classPrivateFieldInitSpec(this,s,!0),this.name=e,this.intent=t}get visible(){return _classPrivateFieldGet(s,this)}_setVisible(e,t){e!==i&&(0,r.unreachable)("Internal method `_setVisible` called."),_classPrivateFieldSet(s,this,t)}}var l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakSet;function p(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let a=1;a<t;a++){const t=e[a];let i;if(Array.isArray(t))i=_assertClassBrand(h,this,p).call(this,t);else{if(!_classPrivateFieldGet(c,this).has(t))return(0,r.warn)("Optional content group not found: ".concat(t)),!0;i=_classPrivateFieldGet(c,this).get(t).visible}switch(n){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return"And"===n}t.OptionalContentConfig=class{constructor(e){if(_classPrivateMethodInitSpec(this,h),_classPrivateFieldInitSpec(this,l,null),_classPrivateFieldInitSpec(this,c,new Map),_classPrivateFieldInitSpec(this,d,null),_classPrivateFieldInitSpec(this,u,null),this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,_classPrivateFieldSet(u,this,e.order);for(const t of e.groups)_classPrivateFieldGet(c,this).set(t.id,new o(t.name,t.intent));if("OFF"===e.baseState)for(const e of _classPrivateFieldGet(c,this).values())e._setVisible(i,!1);for(const t of e.on)_classPrivateFieldGet(c,this).get(t)._setVisible(i,!0);for(const t of e.off)_classPrivateFieldGet(c,this).get(t)._setVisible(i,!1);_classPrivateFieldSet(d,this,this.getHash())}}isVisible(e){if(0===_classPrivateFieldGet(c,this).size)return!0;if(!e)return(0,r.warn)("Optional content group not defined."),!0;if("OCG"===e.type)return _classPrivateFieldGet(c,this).has(e.id)?_classPrivateFieldGet(c,this).get(e.id).visible:((0,r.warn)("Optional content group not found: ".concat(e.id)),!0);if("OCMD"===e.type){if(e.expression)return _assertClassBrand(h,this,p).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!_classPrivateFieldGet(c,this).has(t))return(0,r.warn)("Optional content group not found: ".concat(t)),!0;if(_classPrivateFieldGet(c,this).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!_classPrivateFieldGet(c,this).has(t))return(0,r.warn)("Optional content group not found: ".concat(t)),!0;if(!_classPrivateFieldGet(c,this).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!_classPrivateFieldGet(c,this).has(t))return(0,r.warn)("Optional content group not found: ".concat(t)),!0;if(!_classPrivateFieldGet(c,this).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!_classPrivateFieldGet(c,this).has(t))return(0,r.warn)("Optional content group not found: ".concat(t)),!0;if(_classPrivateFieldGet(c,this).get(t).visible)return!1}return!0}return(0,r.warn)("Unknown optional content policy ".concat(e.policy,".")),!0}return(0,r.warn)("Unknown group type ".concat(e.type,".")),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_classPrivateFieldGet(c,this).has(e)?(_classPrivateFieldGet(c,this).get(e)._setVisible(i,!!t),_classPrivateFieldSet(l,this,null)):(0,r.warn)("Optional content group not found: ".concat(e))}get hasInitialVisibility(){return null===_classPrivateFieldGet(d,this)||this.getHash()===_classPrivateFieldGet(d,this)}getOrder(){return _classPrivateFieldGet(c,this).size?_classPrivateFieldGet(u,this)?_classPrivateFieldGet(u,this).slice():[..._classPrivateFieldGet(c,this).keys()]:null}getGroups(){return _classPrivateFieldGet(c,this).size>0?(0,r.objectFromMap)(_classPrivateFieldGet(c,this)):null}getGroup(e){return _classPrivateFieldGet(c,this).get(e)||null}getHash(){if(null!==_classPrivateFieldGet(l,this))return _classPrivateFieldGet(l,this);const e=new a.MurmurHash3_64;for(const[t,n]of _classPrivateFieldGet(c,this))e.update("".concat(t,":").concat(n.visible));return _classPrivateFieldSet(l,this,e.hexdigest())}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var r=n(1),a=n(6);t.PDFDataTransportStream=class{constructor(e,t){let{length:n,initialData:a,progressiveDone:i=!1,contentDispositionFilename:s=null,disableRange:o=!1,disableStream:l=!1}=e;if((0,r.assert)(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=i,this._contentDispositionFilename=s,(null===a||void 0===a?void 0:a.length)>0){const e=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!l,this._isRangeSupported=!o,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),this._pdfDataRangeTransport.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(e){let{begin:t,chunk:n}=e;const a=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const e=this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(a),!0)});(0,r.assert)(e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}_onProgress(e){var t,n,r,a;void 0===e.total?null===(t=this._rangeReaders[0])||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded}):null===(r=this._fullRequestReader)||void 0===r||null===(a=r.onProgress)||void 0===a||a.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;null===(e=this._fullRequestReader)||void 0===e||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new i(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new s(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}};class i{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=n||!1,this._filename=(0,a.isPdfFile)(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class s{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var r=n(1),a=n(20);function i(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function s(e){const t=new Headers;for(const n in e){const r=e[n];void 0!==r&&t.append(n,r)}return t}function o(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:((0,r.warn)("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new c(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}};class l{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=new r.PromiseCapability,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=s(this._stream.httpHeaders);const n=t.url;fetch(n,i(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,n);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:i,suggestedLength:s}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=s||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class c{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const o=e.source;this._withCredentials=o.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=s(this._stream.httpHeaders),this._headers.append("Range","bytes=".concat(t,"-").concat(n-1));const l=o.url;fetch(l,i(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,l);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded}),{value:o(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+t+'".'):new r.UnexpectedResponseException("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,a.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(n){}if((0,i.isPdfFile)(e))return e}return null},t.validateRangeRequestCapabilities=function(e){let{getResponseHeader:t,isHttp:n,rangeChunkSize:r,disableRange:a}=e;const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t("Content-Length"),10);return Number.isInteger(s)?(i.suggestedLength=s,s<=2*r||a||!n||"bytes"!==t("Accept-Ranges")||"identity"!==(t("Content-Encoding")||"identity")||(i.allowRangeRequests=!0),i):i},t.validateResponseStatus=function(e){return 200===e||206===e};var r=n(1),a=n(21),i=n(6)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,n=a("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=l(e),e=c(e),s(e)}if(n=function(e){const t=[];let n;const r=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(e));){let[,e,r,a]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[r,a]}const i=[];for(let a=0;a<t.length&&a in t;++a){let[e,n]=t[a];n=o(n),e&&(n=unescape(n),0===a&&(n=l(n))),i.push(n)}return i.join("")}(e),n)return s(c(n));if(n=a("filename","i").exec(e),n){n=n[1];let e=o(n);return e=c(e),s(e)}function a(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function i(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const a=new TextDecoder(e,{fatal:!0}),i=(0,r.stringToBytes)(n);n=a.decode(i),t=!1}catch(a){}}return n}function s(e){return t&&/[\x80-\xff]/.test(e)&&(e=i("utf-8",e),t&&(e=i("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function l(e){const t=e.indexOf("'");return-1===t?e:i(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,r){if("q"===n||"Q"===n)return i(t,r=(r=r.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{r=atob(r)}catch(a){}return i(t,r)})}return""};var r=n(1)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var r=n(1),a=n(20);class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){const r={begin:e,end:t};for(const a in n)r[a]=n[a];return this.request(r)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const a in this.httpHeaders){const e=this.httpHeaders[a];void 0!==e&&t.setRequestHeader(a,e)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),r.expectedStatus=206):r.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var n;const r=this.pendingRequests[e];r&&(null===(n=r.onProgress)||void 0===n||n.call(r,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const a=n.xhr;if(a.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==a.readyState)return;if(!(e in this.pendingRequests))return;var i;if(delete this.pendingRequests[e],0===a.status&&this.isHttp)return void(null===(i=n.onError)||void 0===i||i.call(n,a.status));const s=a.status||200;var o;if((200!==s||206!==n.expectedStatus)&&s!==n.expectedStatus)return void(null===(o=n.onError)||void 0===o||o.call(n,a.status));const l=function(e){const t=e.response;return"string"!==typeof t?t:(0,r.stringToBytes)(t).buffer}(a);if(206===s){const e=a.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);n.onDone({begin:parseInt(t[1],10),chunk:l})}else if(l)n.onDone({begin:0,chunk:l});else{var c;null===(c=n.onError)||void 0===c||c.call(n,a.status)}}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new i(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new s(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new o(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}};class s{constructor(e,t){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=e=>t.getResponseHeader(e),{allowRangeRequests:r,suggestedLength:i}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=i||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class o{constructor(e,t,n){this._manager=e;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var e;null===(e=this.onClosed)||void 0===e||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new r.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var r=n(1),a=n(20);const i=/^file:\/\/\/[a-zA-Z]:\//;t.PDFNodeStream=class{constructor(e){this.source=e,this.url=function(e){const t=__webpack_require__(6671),n=t.parse(e);return"file:"===n.protocol||n.host?n:/^[a-z]:[/\\]/i.test(e)?t.parse("file:///".concat(e)):(n.host||(n.protocol="file:"),n)}(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new u(this):new c(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new h(this,e,t):new d(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}};class s{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class o{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class c extends s{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new r.MissingPDFException('Missing PDF "'.concat(this._url,'".'));return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const n=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:i,suggestedLength:s}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=s||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n)};if(this._request=null,"http:"===this._url.protocol){const n=__webpack_require__(7492);this._request=n.request(l(this._url,e.httpHeaders),t)}else{const n=__webpack_require__(1815);this._request=n.request(l(this._url,e.httpHeaders),t)}this._request.on("error",e=>{this._storedError=e,this._headersCapability.reject(e)}),this._request.end()}}class d extends o{constructor(e,t,n){super(e),this._httpHeaders={};for(const r in e.httpHeaders){const t=e.httpHeaders[r];void 0!==t&&(this._httpHeaders[r]=t)}this._httpHeaders.Range="bytes=".concat(t,"-").concat(n-1);const a=e=>{if(404===e.statusCode){const e=new r.MissingPDFException('Missing PDF "'.concat(this._url,'".'));return void(this._storedError=e)}this._setReadableStream(e)};if(this._request=null,"http:"===this._url.protocol){const e=__webpack_require__(7492);this._request=e.request(l(this._url,this._httpHeaders),a)}else{const e=__webpack_require__(1815);this._request=e.request(l(this._url,this._httpHeaders),a)}this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class u extends s{constructor(e){super(e);let t=decodeURIComponent(this._url.path);i.test(this._url.href)&&(t=t.replace(/^\//,""));const n=__webpack_require__(3237);n.lstat(t,(e,a)=>{if(e)return"ENOENT"===e.code&&(e=new r.MissingPDFException('Missing PDF "'.concat(t,'".'))),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=a.size,this._setReadableStream(n.createReadStream(t)),this._headersCapability.resolve()})}}class h extends o{constructor(e,t,n){super(e);let r=decodeURIComponent(this._url.path);i.test(this._url.href)&&(r=r.replace(/^\//,""));const a=__webpack_require__(3237);this._setReadableStream(a.createReadStream(r,{start:t,end:n-1}))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var r=n(6),a=n(1);const i="normal",s="normal",o="#000000",l=["butt","round","square"],c=["miter","round","bevel"],d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(URL.createObjectURL&&"undefined"!==typeof Blob&&!n)return URL.createObjectURL(new Blob([e],{type:t}));const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a="data:".concat(t,";base64,");for(let i=0,s=e.length;i<s;i+=3){const t=255&e[i],n=255&e[i+1],o=255&e[i+2];a+=r[t>>2]+r[(3&t)<<4|n>>4]+r[i+1<s?(15&n)<<2|o>>6:64]+r[i+2<s?63&o:64]}return a},u=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let a=0;a<256;a++){let e=a;for(let t=0;t<8;t++)e=1&e?3988292384^e>>1&2147483647:e>>1&2147483647;t[a]=e}function n(e,n,r,a){let i=a;const s=n.length;r[i]=s>>24&255,r[i+1]=s>>16&255,r[i+2]=s>>8&255,r[i+3]=255&s,i+=4,r[i]=255&e.charCodeAt(0),r[i+1]=255&e.charCodeAt(1),r[i+2]=255&e.charCodeAt(2),r[i+3]=255&e.charCodeAt(3),i+=4,r.set(n,i),i+=n.length;const o=function(e,n,r){let a=-1;for(let i=n;i<r;i++){const n=255&(a^e[i]);a=a>>>8^t[n]}return-1^a}(r,a+4,i);r[i]=o>>24&255,r[i+1]=o>>16&255,r[i+2]=o>>8&255,r[i+3]=255&o}function r(e){let t=e.length;const n=65535,r=Math.ceil(t/n),a=new Uint8Array(2+t+5*r+4);let i=0;a[i++]=120,a[i++]=156;let s=0;for(;t>n;)a[i++]=0,a[i++]=255,a[i++]=255,a[i++]=0,a[i++]=0,a.set(e.subarray(s,s+n),i),i+=n,s+=n,t-=n;a[i++]=1,a[i++]=255&t,a[i++]=t>>8&255,a[i++]=255&~t,a[i++]=(65535&~t)>>8&255,a.set(e.subarray(s),i),i+=e.length-s;const o=function(e,t,n){let r=1,a=0;for(let i=t;i<n;++i)r=(r+(255&e[i]))%65521,a=(a+r)%65521;return a<<16|r}(e,0,e.length);return a[i++]=o>>24&255,a[i++]=o>>16&255,a[i++]=o>>8&255,a[i++]=255&o,a}function i(t,i,s,o){const l=t.width,c=t.height;let u,h,p;const f=t.data;switch(i){case a.ImageKind.GRAYSCALE_1BPP:h=0,u=1,p=l+7>>3;break;case a.ImageKind.RGB_24BPP:h=2,u=8,p=3*l;break;case a.ImageKind.RGBA_32BPP:h=6,u=8,p=4*l;break;default:throw new Error("invalid format")}const m=new Uint8Array((1+p)*c);let g=0,v=0;for(let e=0;e<c;++e)m[g++]=0,m.set(f.subarray(v,v+p),g),v+=p,g+=p;if(i===a.ImageKind.GRAYSCALE_1BPP&&o){g=0;for(let e=0;e<c;e++){g++;for(let e=0;e<p;e++)m[g++]^=255}}const y=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,c>>24&255,c>>16&255,c>>8&255,255&c,u,h,0,0,0]),b=function(e){if(!a.isNodeJS)return r(e);try{const t=parseInt(process.versions.node)>=8?e:Buffer.from(e),n=__webpack_require__(2787).deflateSync(t,{level:9});return n instanceof Uint8Array?n:new Uint8Array(n)}catch(t){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return r(e)}(m),w=e.length+36+y.length+b.length,_=new Uint8Array(w);let A=0;return _.set(e,A),A+=e.length,n("IHDR",y,_,A),A+=12+y.length,n("IDATA",b,_,A),A+=12+b.length,n("IEND",new Uint8Array(0),_,A),d(_,"image/png",s)}return function(e,t,n){return i(e,void 0===e.kind?a.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=s,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function p(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function f(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale(".concat(p(e[0])," ").concat(p(e[3]),")");if(e[0]===e[3]&&e[1]===-e[2]){const t=180*Math.acos(e[0])/Math.PI;return"rotate(".concat(p(t),")")}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate(".concat(p(e[4])," ").concat(p(e[5]),")");return"matrix(".concat(p(e[0])," ").concat(p(e[1])," ").concat(p(e[2])," ").concat(p(e[3])," ").concat(p(e[4])," ")+"".concat(p(e[5]),")")}let m=0,g=0,v=0;t.SVGGraphics=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new h,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const r in a.OPS)this._operatorIdMapping[a.OPS[r]]=r}getObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,n=e.argsArray;for(let r=0,i=t.length;r<i;r++)if(t[r]===a.OPS.dependency)for(const e of n[r]){const t=e.startsWith("g_")?this.commonObjs:this.objs,n=new Promise(n=>{t.get(e,n)});this.current.dependencies.push(n)}return Promise.all(this.current.dependencies)}transform(e,t,n,r,i,s){const o=[e,t,n,r,i,s];this.transformMatrix=a.Util.transform(this.transformMatrix,o),this.tgrp=null}getSVG(e,t){this.viewport=t;const n=this._initialize(t);return this.loadDependencies(e).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),n))}convertOpList(e){const t=this._operatorIdMapping,n=e.argsArray,r=e.fnArray,a=[];for(let i=0,s=r.length;i<s;i++){const e=r[i];a.push({fnId:e,fn:t[e],args:n[i]})}return function(e){let t=[];const n=[];for(const r of e)"save"!==r.fn?"restore"===r.fn?t=n.pop():t.push(r):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t.at(-1).items);return t}(a)}executeOpTree(e){for(const t of e){const e=t.fn,n=t.fnId,r=t.args;switch(0|n){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(r);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(r[0],r[1]);break;case a.OPS.setFont:this.setFont(r);break;case a.OPS.showText:case a.OPS.showSpacedText:this.showText(r[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(r[0],r[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(r[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(r[0]);break;case a.OPS.setHScale:this.setHScale(r[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(r[0],r[1],r[2],r[3],r[4],r[5]);break;case a.OPS.setTextRise:this.setTextRise(r[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(r[0]);break;case a.OPS.setLineWidth:this.setLineWidth(r[0]);break;case a.OPS.setLineJoin:this.setLineJoin(r[0]);break;case a.OPS.setLineCap:this.setLineCap(r[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(r[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(r[0],r[1],r[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(r[0],r[1],r[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(r);break;case a.OPS.setFillColorN:this.setFillColorN(r);break;case a.OPS.shadingFill:this.shadingFill(r[0]);break;case a.OPS.setDash:this.setDash(r[0],r[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(r[0]);break;case a.OPS.setFlatness:this.setFlatness(r[0]);break;case a.OPS.setGState:this.setGState(r[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(r[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(r[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(r[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(r[0],r[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(r[0],r[1],r[2],r[3],r[4],r[5]);break;case a.OPS.constructPath:this.constructPath(r[0],r[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,a.warn)("Unimplemented operator ".concat(e))}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,n,r,a,i){const s=this.current;s.textMatrix=s.lineMatrix=[e,t,n,r,a,i],s.textMatrixScale=Math.hypot(e,t),s.x=s.lineX=0,s.y=s.lineY=0,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size","".concat(p(s.fontSize),"px")),s.tspan.setAttributeNS(null,"y",p(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.append(s.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=a.IDENTITY_MATRIX,e.lineMatrix=a.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size","".concat(p(n.fontSize),"px")),n.tspan.setAttributeNS(null,"y",p(-n.y))}showText(e){const t=this.current,n=t.font,r=t.fontSize;if(0===r)return;const l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,m=n.vertical,g=m?1:-1,v=n.defaultVMetrics,y=r*t.fontMatrix[0];let b=0;for(const a of e){if(null===a){b+=u*d;continue}if("number"===typeof a){b+=g*a*r/1e3;continue}const e=(a.isSpace?d:0)+c,i=a.fontChar;let s,o,h=a.width;if(m){let e;const t=a.vmetric||v;e=a.vmetric?t[1]:.5*h,e=-e*y;const n=t[2]*y;h=t?-t[0]:h,s=e/l,o=(b+n)/l}else s=b/l,o=0;(a.isInFont||n.missingFile)&&(t.xcoords.push(t.x+s),m&&t.ycoords.push(-t.y+o),t.tspan.textContent+=i),b+=m?h*y-e*u:h*y+e*u}t.tspan.setAttributeNS(null,"x",t.xcoords.map(p).join(" ")),m?t.tspan.setAttributeNS(null,"y",t.ycoords.map(p).join(" ")):t.tspan.setAttributeNS(null,"y",p(-t.y)),m?t.y-=b:t.x+=b*h,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size","".concat(p(t.fontSize),"px")),t.fontStyle!==i&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==s&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const w=t.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(w===a.TextRenderingMode.FILL||w===a.TextRenderingMode.FILL_STROKE?(t.fillColor!==o&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),w===a.TextRenderingMode.STROKE||w===a.TextRenderingMode.FILL_STROKE){const e=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,e)}let _=t.textMatrix;0!==t.textRise&&(_=_.slice(),_[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform","".concat(f(_)," scale(").concat(p(h),", -1)")),t.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=d(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(e.loadedName,'";')+" src: url(".concat(t,"); }\n")}setFont(e){const t=this.current,n=this.commonObjs.get(e[0]);let r=e[1];t.font=n,!this.embedFonts||n.missingFile||this.embeddedFonts[n.loadedName]||(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix||a.FONT_IDENTITY_MATRIX;let i="normal";n.black?i="900":n.bold&&(i="bold");const s=n.italic?"italic":"normal";r<0?(r=-r,t.fontDirection=-1):t.fontDirection=1,t.fontSize=r,t.fontFamily=n.loadedName,t.fontWeight=i,t.fontStyle=s,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",p(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){var e;const t=this.current;t.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&null!==(e=t.txtElement)&&void 0!==e&&e.hasChildNodes()&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=l[e]}setLineJoin(e){this.current.lineJoin=c[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,n){this.current.strokeColor=a.Util.makeHexColor(e,t,n)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,n){this.current.fillColor=a.Util.makeHexColor(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const{width:t,height:n}=this.viewport,r=a.Util.inverseTransform(this.transformMatrix),[i,s,o,l]=a.Util.getAxialAlignedBoundingBox([0,0,t,n],r),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",i),c.setAttributeNS(null,"y",s),c.setAttributeNS(null,"width",o-i),c.setAttributeNS(null,"height",l-s),c.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&c.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(c)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],n=e[2],r=e[3]||a.IDENTITY_MATRIX,[i,s,o,l]=e[4],c=e[5],d=e[6],u=e[7],h="shading".concat(v++),[p,f,m,g]=a.Util.normalizeRect([...a.Util.applyTransform([i,s],r),...a.Util.applyTransform([o,l],r)]),[y,b]=a.Util.singularValueDecompose2dScale(r),w=c*y,_=d*b,A=this.svgFactory.createElement("svg:pattern");A.setAttributeNS(null,"id",h),A.setAttributeNS(null,"patternUnits","userSpaceOnUse"),A.setAttributeNS(null,"width",w),A.setAttributeNS(null,"height",_),A.setAttributeNS(null,"x","".concat(p)),A.setAttributeNS(null,"y","".concat(f));const S=this.svg,C=this.transformMatrix,x=this.current.fillColor,E=this.current.strokeColor,T=this.svgFactory.create(m-p,g-f);if(this.svg=T,this.transformMatrix=r,2===u){const e=a.Util.makeHexColor(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(n)),this.svg=S,this.transformMatrix=C,this.current.fillColor=x,this.current.strokeColor=E,A.append(T.childNodes[0]),this.defs.append(A),"url(#".concat(h,")")}_makeShadingPattern(e){switch("string"===typeof e&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const t="shading".concat(v++),n=e[3];let r;switch(e[1]){case"axial":const n=e[4],a=e[5];r=this.svgFactory.createElement("svg:linearGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"x1",n[0]),r.setAttributeNS(null,"y1",n[1]),r.setAttributeNS(null,"x2",a[0]),r.setAttributeNS(null,"y2",a[1]);break;case"radial":const i=e[4],s=e[5],o=e[6],l=e[7];r=this.svgFactory.createElement("svg:radialGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"cx",s[0]),r.setAttributeNS(null,"cy",s[1]),r.setAttributeNS(null,"r",l),r.setAttributeNS(null,"fx",i[0]),r.setAttributeNS(null,"fy",i[1]),r.setAttributeNS(null,"fr",o);break;default:throw new Error("Unknown RadialAxial type: ".concat(e[1]))}for(const e of n){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),r.append(t)}return this.defs.append(r),"url(#".concat(t,")");case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(e[0]))}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const n=this.current;let r=n.x,i=n.y,s=[],o=0;for(const l of e)switch(0|l){case a.OPS.rectangle:r=t[o++],i=t[o++];const e=r+t[o++],n=i+t[o++];s.push("M",p(r),p(i),"L",p(e),p(i),"L",p(e),p(n),"L",p(r),p(n),"Z");break;case a.OPS.moveTo:r=t[o++],i=t[o++],s.push("M",p(r),p(i));break;case a.OPS.lineTo:r=t[o++],i=t[o++],s.push("L",p(r),p(i));break;case a.OPS.curveTo:r=t[o+4],i=t[o+5],s.push("C",p(t[o]),p(t[o+1]),p(t[o+2]),p(t[o+3]),p(r),p(i)),o+=6;break;case a.OPS.curveTo2:s.push("C",p(r),p(i),p(t[o]),p(t[o+1]),p(t[o+2]),p(t[o+3])),r=t[o+2],i=t[o+3],o+=4;break;case a.OPS.curveTo3:r=t[o+2],i=t[o+3],s.push("C",p(t[o]),p(t[o+1]),p(r),p(i),p(r),p(i)),o+=4;break;case a.OPS.closePath:s.push("Z")}s=s.join(" "),n.path&&e.length>0&&e[0]!==a.OPS.rectangle&&e[0]!==a.OPS.moveTo?s=n.path.getAttributeNS(null,"d")+s:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",s),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(r,i)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath".concat(m++),n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",f(this.transformMatrix));const r=e.element.cloneNode(!0);if("evenodd"===this.pendingClip?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(r),this.defs.append(n),e.activeClipUrl){e.clipGroup=null;for(const e of this.extraStack)e.clipGroup=null;n.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl="url(#".concat(t,")"),this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t="".concat(e.path.getAttributeNS(null,"d"),"Z");e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,a.warn)("Unimplemented graphic state operator ".concat(t))}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=this.current;let r=n.dashArray;1!==t&&r.length>0&&(r=r.map(function(e){return t*e})),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",p(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",p(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",r.map(p).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",p(t*n.dashPhase)+"px")}eoFill(){var e;null===(e=this.current.element)||void 0===e||e.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var e;null===(e=this.current.element)||void 0===e||e.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,a.warn)("Dependent image with object ID ".concat(e," is not ready yet"))}paintInlineImageXObject(e,t){const n=e.width,r=e.height,a=u(e,this.forceDataSchema,!!t),i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width",p(n)),i.setAttributeNS(null,"height",p(r)),this.current.element=i,this.clip("nonzero");const s=this.svgFactory.createElement("svg:image");s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",p(-r)),s.setAttributeNS(null,"width",p(n)+"px"),s.setAttributeNS(null,"height",p(r)+"px"),s.setAttributeNS(null,"transform","scale(".concat(p(1/n)," ").concat(p(-1/r),")")),t?t.append(s):this._ensureTransformGroup().append(s)}paintImageMaskXObject(e){const t=this.getObject(e.data,e);if(t.bitmap)return void(0,a.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");const n=this.current,r=t.width,i=t.height,s=n.fillColor;n.maskId="mask".concat(g++);const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",n.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",p(r)),l.setAttributeNS(null,"height",p(i)),l.setAttributeNS(null,"fill",s),l.setAttributeNS(null,"mask","url(#".concat(n.maskId,")")),this.defs.append(o),this._ensureTransformGroup().append(l),this.paintInlineImageXObject(t,o)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],n=t[3]-t[1],r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x",t[0]),r.setAttributeNS(null,"y",t[1]),r.setAttributeNS(null,"width",p(e)),r.setAttributeNS(null,"height",p(n)),this.current.element=r,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.append(n),this.defs=n;const r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",f(e.transform)),t.append(r),this.svg=r,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class n{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};return function e(r){var a;if(!r)return;let i=null;const s=r.name;if("#text"===s)i=r.value;else{if(!n.shouldBuildText(s))return;null!==r&&void 0!==r&&null!==(a=r.attributes)&&void 0!==a&&a.textContent?i=r.attributes.textContent:r.value&&(i=r.value)}if(null!==i&&t.push({str:i}),r.children)for(const t of r.children)e(t)}(e),r}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}t.XfaText=n},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=function(e){e.textContentSource||!e.textContent&&!e.textContentStream||((0,a.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),e.textContentSource=e.textContent||e.textContentStream);const{container:t,viewport:n}=e,r=getComputedStyle(t),i=r.getPropertyValue("visibility"),s=parseFloat(r.getPropertyValue("--scale-factor"));"visible"===i&&(!s||Math.abs(s-n.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new d(e);return o._render(),o},t.updateTextLayer=function(e){let{container:t,viewport:n,textDivs:r,textDivProperties:i,isOffscreenCanvasSupported:s,mustRotate:l=!0,mustRescale:d=!0}=e;if(l&&(0,a.setLayerDimensions)(t,{rotation:n.rotation}),d){const e=o(0,s),t={prevFontSize:null,prevFontFamily:null,div:null,scale:n.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:e};for(const n of r)t.properties=i.get(n),t.div=n,c(t)}};var r=n(1),a=n(6);const i=30,s=new Map;function o(e,t){let n;if(t&&r.FeatureTest.isOffscreenCanvasSupported)n=new OffscreenCanvas(e,e).getContext("2d",{alpha:!1});else{const t=document.createElement("canvas");t.width=t.height=e,n=t.getContext("2d",{alpha:!1})}return n}function l(e,t,n){const a=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};e._textDivs.push(a);const c=r.Util.transform(e._transform,t.transform);let d=Math.atan2(c[1],c[0]);const u=n[t.fontName];u.vertical&&(d+=Math.PI/2);const h=Math.hypot(c[2],c[3]),p=h*function(e,t){const n=s.get(e);if(n)return n;const r=o(i,t);r.font="".concat(i,"px ").concat(e);const a=r.measureText("");let l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);if(l){const t=l/(l+c);return s.set(e,t),r.canvas.width=r.canvas.height=0,t}r.strokeStyle="red",r.clearRect(0,0,i,i),r.strokeText("g",0,0);let d=r.getImageData(0,0,i,i).data;c=0;for(let s=d.length-1-3;s>=0;s-=4)if(d[s]>0){c=Math.ceil(s/4/i);break}r.clearRect(0,0,i,i),r.strokeText("A",0,i),d=r.getImageData(0,0,i,i).data,l=0;for(let s=0,o=d.length;s<o;s+=4)if(d[s]>0){l=i-Math.floor(s/4/i);break}if(r.canvas.width=r.canvas.height=0,l){const t=l/(l+c);return s.set(e,t),t}return s.set(e,.8),.8}(u.fontFamily,e._isOffscreenCanvasSupported);let f,m;0===d?(f=c[4],m=c[5]-p):(f=c[4]+p*Math.sin(d),m=c[5]-p*Math.cos(d));const g="calc(var(--scale-factor)*",v=a.style;e._container===e._rootContainer?(v.left="".concat((100*f/e._pageWidth).toFixed(2),"%"),v.top="".concat((100*m/e._pageHeight).toFixed(2),"%")):(v.left="".concat(g).concat(f.toFixed(2),"px)"),v.top="".concat(g).concat(m.toFixed(2),"px)")),v.fontSize="".concat(g).concat(h.toFixed(2),"px)"),v.fontFamily=u.fontFamily,l.fontSize=h,a.setAttribute("role","presentation"),a.textContent=t.str,a.dir=t.dir,e._fontInspectorEnabled&&(a.dataset.fontName=t.fontName),0!==d&&(l.angle=d*(180/Math.PI));let y=!1;if(t.str.length>1)y=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(y=!0)}y&&(l.canvasWidth=u.vertical?t.height:t.width),e._textDivProperties.set(a,l),e._isReadableStream&&e._layoutText(a)}function c(e){const{div:t,scale:n,properties:r,ctx:a,prevFontSize:i,prevFontFamily:s}=e,{style:o}=t;let l="";if(0!==r.canvasWidth&&r.hasText){const{fontFamily:c}=o,{canvasWidth:d,fontSize:u}=r;i===u&&s===c||(a.font="".concat(u*n,"px ").concat(c),e.prevFontSize=u,e.prevFontFamily=c);const{width:h}=a.measureText(t.textContent);h>0&&(l="scaleX(".concat(d*n/h,")"))}0!==r.angle&&(l="rotate(".concat(r.angle,"deg) ").concat(l)),l.length>0&&(o.transform=l)}class d{constructor(e){var t;let{textContentSource:n,container:i,viewport:s,textDivs:l,textDivProperties:c,textContentItemsStr:d,isOffscreenCanvasSupported:u}=e;this._textContentSource=n,this._isReadableStream=n instanceof ReadableStream,this._container=this._rootContainer=i,this._textDivs=l||[],this._textContentItemsStr=d||[],this._isOffscreenCanvasSupported=u,this._fontInspectorEnabled=!(null===(t=globalThis.FontInspector)||void 0===t||!t.enabled),this._reader=null,this._textDivProperties=c||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:s.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:o(0,u)};const{pageWidth:h,pageHeight:p,pageX:f,pageY:m}=s.rawDims;this._transform=[1,0,0,-1,-f,m+p],this._pageWidth=h,this._pageHeight=p,(0,a.setLayerDimensions)(i,s),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(e,t){for(const n of e)if(void 0!==n.str)this._textContentItemsStr.push(n.str),l(this,n,t);else if("beginMarkedContentProps"===n.type||"beginMarkedContent"===n.type){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==n.id&&this._container.setAttribute("id","".concat(n.id)),e.append(this._container)}else"endMarkedContent"===n.type&&(this._container=this._container.parentNode)}_layoutText(e){const t=this._layoutTextParams.properties=this._textDivProperties.get(e);if(this._layoutTextParams.div=e,c(this._layoutTextParams),t.hasText&&this._container.append(e),t.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(){const e=new r.PromiseCapability;let t=Object.create(null);if(this._isReadableStream){const n=()=>{this._reader.read().then(r=>{let{value:a,done:i}=r;i?e.resolve():(Object.assign(t,a.styles),this._processItems(a.items,t),n())},e.reject)};this._reader=this._textContentSource.getReader(),n()}else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');{const{items:t,styles:n}=this._textContentSource;this._processItems(t,n),e.resolve()}}e.promise.then(()=>{t=null,function(e){if(e._canceled)return;const t=e._textDivs,n=e._capability;if(t.length>1e5)n.resolve();else{if(!e._isReadableStream)for(const n of t)e._layoutText(n);n.resolve()}}(this)},this._capability.reject)}}t.TextLayerRenderTask=d},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var r=n(1),a=n(4),i=n(28),s=n(33),o=n(6),l=n(34),c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,b=new WeakSet;class w{constructor(e){let{uiManager:t,pageIndex:n,div:r,accessibilityManager:a,annotationLayer:o,viewport:_,l10n:A}=e;_classPrivateMethodInitSpec(this,b),_classPrivateFieldInitSpec(this,c,void 0),_classPrivateFieldInitSpec(this,d,!1),_classPrivateFieldInitSpec(this,u,null),_classPrivateFieldInitSpec(this,h,this.pointerup.bind(this)),_classPrivateFieldInitSpec(this,p,this.pointerdown.bind(this)),_classPrivateFieldInitSpec(this,f,new Map),_classPrivateFieldInitSpec(this,m,!1),_classPrivateFieldInitSpec(this,g,!1),_classPrivateFieldInitSpec(this,v,!1),_classPrivateFieldInitSpec(this,y,void 0);const S=[i.FreeTextEditor,s.InkEditor,l.StampEditor];if(!w._initialized){w._initialized=!0;for(const e of S)e.initialize(A)}t.registerEditorTypes(S),_classPrivateFieldSet(y,this,t),this.pageIndex=n,this.div=r,_classPrivateFieldSet(c,this,a),_classPrivateFieldSet(u,this,o),this.viewport=_,_classPrivateFieldGet(y,this).addLayer(this)}get isEmpty(){return 0===_classPrivateFieldGet(f,this).size}updateToolbar(e){_classPrivateFieldGet(y,this).updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_classPrivateFieldGet(y,this).getMode();_assertClassBrand(b,this,C).call(this),e===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),e!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",e===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",e===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(e){if(e||_classPrivateFieldGet(y,this).getMode()===r.AnnotationEditorType.INK){if(!e)for(const e of _classPrivateFieldGet(f,this).values())if(e.isEmpty())return void e.setInBackground();_assertClassBrand(b,this,A).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(e){_classPrivateFieldGet(y,this).setEditingState(e)}addCommands(e){_classPrivateFieldGet(y,this).addCommands(e)}enable(){this.div.style.pointerEvents="auto";const e=new Set;for(const n of _classPrivateFieldGet(f,this).values())n.enableEditing(),n.annotationElementId&&e.add(n.annotationElementId);if(!_classPrivateFieldGet(u,this))return;const t=_classPrivateFieldGet(u,this).getEditableAnnotations();for(const n of t){if(n.hide(),_classPrivateFieldGet(y,this).isDeletedAnnotationElement(n.data.id))continue;if(e.has(n.data.id))continue;const t=this.deserialize(n);t&&(this.addOrRebuild(t),t.enableEditing())}}disable(){_classPrivateFieldSet(v,this,!0),this.div.style.pointerEvents="none";const e=new Set;for(const n of _classPrivateFieldGet(f,this).values()){var t;n.disableEditing(),n.annotationElementId&&null===n.serialize()?(null===(t=this.getEditableAnnotation(n.annotationElementId))||void 0===t||t.show(),n.remove()):e.add(n.annotationElementId)}if(_classPrivateFieldGet(u,this)){const t=_classPrivateFieldGet(u,this).getEditableAnnotations();for(const n of t){const{id:t}=n.data;e.has(t)||_classPrivateFieldGet(y,this).isDeletedAnnotationElement(t)||n.show()}}_assertClassBrand(b,this,C).call(this),this.isEmpty&&(this.div.hidden=!0),_classPrivateFieldSet(v,this,!1)}getEditableAnnotation(e){var t;return(null===(t=_classPrivateFieldGet(u,this))||void 0===t?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){_classPrivateFieldGet(y,this).getActive()!==e&&_classPrivateFieldGet(y,this).setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",_classPrivateFieldGet(p,this)),this.div.addEventListener("pointerup",_classPrivateFieldGet(h,this))}disableClick(){this.div.removeEventListener("pointerdown",_classPrivateFieldGet(p,this)),this.div.removeEventListener("pointerup",_classPrivateFieldGet(h,this))}attach(e){_classPrivateFieldGet(f,this).set(e.id,e);const{annotationElementId:t}=e;t&&_classPrivateFieldGet(y,this).isDeletedAnnotationElement(t)&&_classPrivateFieldGet(y,this).removeDeletedAnnotationElement(e)}detach(e){var t;_classPrivateFieldGet(f,this).delete(e.id),null===(t=_classPrivateFieldGet(c,this))||void 0===t||t.removePointerInTextLayer(e.contentDiv),!_classPrivateFieldGet(v,this)&&e.annotationElementId&&_classPrivateFieldGet(y,this).addDeletedAnnotationElement(e)}remove(e){this.detach(e),_classPrivateFieldGet(y,this).removeEditor(e),e.div.contains(document.activeElement)&&setTimeout(()=>{_classPrivateFieldGet(y,this).focusMainContainer()},0),e.div.remove(),e.isAttachedToDOM=!1,_classPrivateFieldGet(g,this)||this.addInkEditorIfNeeded(!1)}changeParent(e){var t;e.parent!==this&&(e.annotationElementId&&(_classPrivateFieldGet(y,this).addDeletedAnnotationElement(e.annotationElementId),a.AnnotationEditor.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null===(t=e.parent)||void 0===t||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(this.changeParent(e),_classPrivateFieldGet(y,this).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),_classPrivateFieldGet(y,this).addToAnnotationStorage(e)}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&(e._focusEventsAllowed=!1,setTimeout(()=>{e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),n.focus())},0)),e._structTreeParentId=null===(t=_classPrivateFieldGet(c,this))||void 0===t?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return _classPrivateFieldGet(y,this).getId()}pasteEditor(e,t){_classPrivateFieldGet(y,this).updateToolbar(e),_classPrivateFieldGet(y,this).updateMode(e);const{offsetX:n,offsetY:r}=_assertClassBrand(b,this,S).call(this),a=this.getNextId(),i=_assertClassBrand(b,this,_).call(this,_objectSpread({parent:this,id:a,x:n,y:r,uiManager:_classPrivateFieldGet(y,this),isCentered:!0},t));i&&this.add(i)}deserialize(e){var t;switch(null!==(t=e.annotationType)&&void 0!==t?t:e.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return i.FreeTextEditor.deserialize(e,this,_classPrivateFieldGet(y,this));case r.AnnotationEditorType.INK:return s.InkEditor.deserialize(e,this,_classPrivateFieldGet(y,this));case r.AnnotationEditorType.STAMP:return l.StampEditor.deserialize(e,this,_classPrivateFieldGet(y,this))}return null}addNewEditor(){_assertClassBrand(b,this,A).call(this,_assertClassBrand(b,this,S).call(this),!0)}setSelected(e){_classPrivateFieldGet(y,this).setSelected(e)}toggleSelected(e){_classPrivateFieldGet(y,this).toggleSelected(e)}isSelected(e){return _classPrivateFieldGet(y,this).isSelected(e)}unselect(e){_classPrivateFieldGet(y,this).unselect(e)}pointerup(e){const{isMac:t}=r.FeatureTest.platform;0!==e.button||e.ctrlKey&&t||e.target===this.div&&_classPrivateFieldGet(m,this)&&(_classPrivateFieldSet(m,this,!1),_classPrivateFieldGet(d,this)?_classPrivateFieldGet(y,this).getMode()!==r.AnnotationEditorType.STAMP?_assertClassBrand(b,this,A).call(this,e,!1):_classPrivateFieldGet(y,this).unselectAll():_classPrivateFieldSet(d,this,!0))}pointerdown(e){if(_classPrivateFieldGet(m,this))return void _classPrivateFieldSet(m,this,!1);const{isMac:t}=r.FeatureTest.platform;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;_classPrivateFieldSet(m,this,!0);const n=_classPrivateFieldGet(y,this).getActive();_classPrivateFieldSet(d,this,!n||n.isEmpty())}findNewParent(e,t,n){const r=_classPrivateFieldGet(y,this).findParent(t,n);return null!==r&&r!==this&&(r.changeParent(e),!0)}destroy(){var e;(null===(e=_classPrivateFieldGet(y,this).getActive())||void 0===e?void 0:e.parent)===this&&(_classPrivateFieldGet(y,this).commitOrRemove(),_classPrivateFieldGet(y,this).setActiveEditor(null));for(const n of _classPrivateFieldGet(f,this).values()){var t;null===(t=_classPrivateFieldGet(c,this))||void 0===t||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,_classPrivateFieldGet(f,this).clear(),_classPrivateFieldGet(y,this).removeLayer(this)}render(e){let{viewport:t}=e;this.viewport=t,(0,o.setLayerDimensions)(this.div,t);for(const n of _classPrivateFieldGet(y,this).getEditors(this.pageIndex))this.add(n);this.updateMode()}update(e){let{viewport:t}=e;_classPrivateFieldGet(y,this).commitOrRemove(),this.viewport=t,(0,o.setLayerDimensions)(this.div,{rotation:t.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}}function _(e){switch(_classPrivateFieldGet(y,this).getMode()){case r.AnnotationEditorType.FREETEXT:return new i.FreeTextEditor(e);case r.AnnotationEditorType.INK:return new s.InkEditor(e);case r.AnnotationEditorType.STAMP:return new l.StampEditor(e)}return null}function A(e,t){const n=this.getNextId(),r=_assertClassBrand(b,this,_).call(this,{parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:_classPrivateFieldGet(y,this),isCentered:t});return r&&this.add(r),r}function S(){const{x:e,y:t,width:n,height:r}=this.div.getBoundingClientRect(),a=Math.max(0,e),i=Math.max(0,t),s=(a+Math.min(window.innerWidth,e+n))/2-e,o=(i+Math.min(window.innerHeight,t+r))/2-t,[l,c]=this.viewport.rotation%180===0?[s,o]:[o,s];return{offsetX:l,offsetY:c}}function C(){_classPrivateFieldSet(g,this,!0);for(const e of _classPrivateFieldGet(f,this).values())e.isEmpty()&&e.remove();_classPrivateFieldSet(g,this,!1)}_defineProperty(w,"_initialized",!1),t.AnnotationEditorLayer=w},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var a=n(1),i=n(5),s=n(4),o=n(29),l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakSet;class y extends s.AnnotationEditor{static get _keyboardManager(){const e=y.prototype,t=e=>e.isEmpty(),n=i.AnnotationEditorUIManager.TRANSLATE_SMALL,r=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}constructor(e){super(_objectSpread(_objectSpread({},e),{},{name:"freeTextEditor"})),_classPrivateMethodInitSpec(this,v),_classPrivateFieldInitSpec(this,l,this.editorDivBlur.bind(this)),_classPrivateFieldInitSpec(this,c,this.editorDivFocus.bind(this)),_classPrivateFieldInitSpec(this,d,this.editorDivInput.bind(this)),_classPrivateFieldInitSpec(this,u,this.editorDivKeydown.bind(this)),_classPrivateFieldInitSpec(this,h,void 0),_classPrivateFieldInitSpec(this,p,""),_classPrivateFieldInitSpec(this,f,"".concat(this.id,"-editor")),_classPrivateFieldInitSpec(this,m,void 0),_classPrivateFieldInitSpec(this,g,null),_classPrivateFieldSet(h,this,e.color||y._defaultColor||s.AnnotationEditor._defaultLineColor),_classPrivateFieldSet(m,this,e.fontSize||y._defaultFontSize)}static initialize(e){s.AnnotationEditor.initialize(e,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case a.AnnotationEditorParamsType.FREETEXT_SIZE:y._defaultFontSize=t;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:y._defaultColor=t}}updateParams(e,t){switch(e){case a.AnnotationEditorParamsType.FREETEXT_SIZE:_assertClassBrand(v,this,b).call(this,t);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:_assertClassBrand(v,this,w).call(this,t)}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,y._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,y._defaultColor||s.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,_classPrivateFieldGet(m,this)],[a.AnnotationEditorParamsType.FREETEXT_COLOR,_classPrivateFieldGet(h,this)]]}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-y._internalPadding*e,-(y._internalPadding+_classPrivateFieldGet(m,this))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",_classPrivateFieldGet(u,this)),this.editorDiv.addEventListener("focus",_classPrivateFieldGet(c,this)),this.editorDiv.addEventListener("blur",_classPrivateFieldGet(l,this)),this.editorDiv.addEventListener("input",_classPrivateFieldGet(d,this)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",_classPrivateFieldGet(f,this)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",_classPrivateFieldGet(u,this)),this.editorDiv.removeEventListener("focus",_classPrivateFieldGet(c,this)),this.editorDiv.removeEventListener("blur",_classPrivateFieldGet(l,this)),this.editorDiv.removeEventListener("input",_classPrivateFieldGet(d,this)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width?_assertClassBrand(v,this,x).call(this):(this.enableEditMode(),this.editorDiv.focus(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=_classPrivateFieldGet(p,this),t=_classPrivateFieldSet(p,this,_assertClassBrand(v,this,_).call(this).trimEnd());if(e===t)return;const n=e=>{_classPrivateFieldSet(p,this,e),e?(_assertClassBrand(v,this,S).call(this),this._uiManager.rebuild(this),_assertClassBrand(v,this,A).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),_assertClassBrand(v,this,A).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){y._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",_classPrivateFieldGet(f,this)),this.enableEditing(),s.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(e=>{var t;return null===(t=this.editorDiv)||void 0===t?void 0:t.setAttribute("aria-label",e)}),s.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(e=>{var t;return null===(t=this.editorDiv)||void 0===t?void 0:t.setAttribute("default-content",e)}),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(_classPrivateFieldGet(m,this),"px * var(--scale-factor))"),n.color=_classPrivateFieldGet(h,this),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=_classPrivateFieldGet(g,this);let[i,s]=this.getInitialTranslation();[i,s]=this.pageTranslationToScreen(i,s);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let u,h;switch(this.rotation){case 0:u=e+(a[0]-c)/o,h=t+this.height-(a[1]-d)/l;break;case 90:u=e+(a[0]-c)/o,h=t-(a[1]-d)/l,[i,s]=[s,-i];break;case 180:u=e-this.width+(a[0]-c)/o,h=t-(a[1]-d)/l,[i,s]=[-i,-s];break;case 270:u=e+(a[0]-c-this.height*l)/o,h=t+(a[1]-d-this.width*o)/l,[i,s]=[-s,i]}this.setAt(u*n,h*r,i,s)}else this.setAt(e*n,t*r,this.width*n,this.height*r);_assertClassBrand(v,this,S).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){let r=null;if(e instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:i,rotation:s,id:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=e;if(!l||0===l.length)return null;r=e={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:t,value:l.join("\n"),position:c,pageIndex:d-1,rect:i,rotation:s,id:o,deleted:!1}}const i=super.deserialize(e,t,n);return _classPrivateFieldSet(m,i,e.fontSize),_classPrivateFieldSet(h,i,a.Util.makeHexColor(...e.color)),_classPrivateFieldSet(p,i,e.value),i.annotationElementId=e.id||null,_classPrivateFieldSet(g,i,r),i}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=y._internalPadding*this.parentScale,n=this.getRect(t,t),r=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:_classPrivateFieldGet(h,this)),i={annotationType:a.AnnotationEditorType.FREETEXT,color:r,fontSize:_classPrivateFieldGet(m,this),value:_classPrivateFieldGet(p,this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?i:this.annotationElementId&&!_assertClassBrand(v,this,C).call(this,i)?null:(i.id=this.annotationElementId,i)}}function b(e){const t=e=>{this.editorDiv.style.fontSize="calc(".concat(e,"px * var(--scale-factor))"),this.translate(0,-(e-_classPrivateFieldGet(m,this))*this.parentScale),_classPrivateFieldSet(m,this,e),_assertClassBrand(v,this,A).call(this)},n=_classPrivateFieldGet(m,this);this.addCommands({cmd:()=>{t(e)},undo:()=>{t(n)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function w(e){const t=_classPrivateFieldGet(h,this);this.addCommands({cmd:()=>{_classPrivateFieldSet(h,this,this.editorDiv.style.color=e)},undo:()=>{_classPrivateFieldSet(h,this,this.editorDiv.style.color=t)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function _(){const e=this.editorDiv.getElementsByTagName("div");if(0===e.length)return this.editorDiv.innerText;const t=[];for(const n of e)t.push(n.innerText.replace(/\r\n?|\n/,""));return t.join("\n")}function A(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,r=t.style.display;t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=r}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}function S(){if(this.editorDiv.replaceChildren(),_classPrivateFieldGet(p,this))for(const e of _classPrivateFieldGet(p,this).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}function C(e){const{value:t,fontSize:n,color:r,rect:a,pageIndex:i}=_classPrivateFieldGet(g,this);return e.value!==t||e.fontSize!==n||e.rect.some((e,t)=>Math.abs(e-a[t])>=1)||e.color.some((e,t)=>e!==r[t])||e.pageIndex!==i}function x(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.annotationElementId)return;if(_assertClassBrand(v,this,A).call(this),!e&&(0===this.width||0===this.height))return void setTimeout(()=>_assertClassBrand(v,this,x).call(this,!0),0);const t=r._internalPadding*this.parentScale;_classPrivateFieldGet(g,this).rect=this.getRect(t,t)}r=y,_defineProperty(y,"_freeTextDefaultContent",""),_defineProperty(y,"_internalPadding",0),_defineProperty(y,"_defaultColor",null),_defineProperty(y,"_defaultFontSize",10),_defineProperty(y,"_type","freetext"),t.FreeTextEditor=y},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var r=n(1),a=n(6),i=n(3),s=n(30),o=n(31),l=n(32);const c=1e3,d=new WeakSet;function u(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class h{static create(e){switch(e.data.annotationType){case r.AnnotationType.LINK:return new g(e);case r.AnnotationType.TEXT:return new b(e);case r.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new _(e);case"Btn":return e.data.radioButton?new C(e):e.data.checkBox?new S(e):new x(e);case"Ch":return new E(e);case"Sig":return new A(e)}return new w(e);case r.AnnotationType.POPUP:return new T(e);case r.AnnotationType.FREETEXT:return new $(e);case r.AnnotationType.LINE:return new Z(e);case r.AnnotationType.SQUARE:return new te(e);case r.AnnotationType.CIRCLE:return new re(e);case r.AnnotationType.POLYLINE:return new ie(e);case r.AnnotationType.CARET:return new oe(e);case r.AnnotationType.INK:return new ce(e);case r.AnnotationType.POLYGON:return new se(e);case r.AnnotationType.HIGHLIGHT:return new de(e);case r.AnnotationType.UNDERLINE:return new ue(e);case r.AnnotationType.SQUIGGLY:return new he(e);case r.AnnotationType.STRIKEOUT:return new pe(e);case r.AnnotationType.STAMP:return new fe(e);case r.AnnotationType.FILEATTACHMENT:return new ve(e);default:return new f(e)}}}var p=new WeakMap;class f{constructor(e){let{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classPrivateFieldInitSpec(this,p,!1),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData(e){let{titleObj:t,contentsObj:n,richText:r}=e;return!!(null!==t&&void 0!==t&&t.str||null!==n&&void 0!==n&&n.str||null!==r&&void 0!==r&&r.str)}get hasPopupData(){return f._hasPopupData(this.data)}_createContainer(e){const{data:t,parent:{page:n,viewport:a}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof w||(i.tabIndex=c),i.style.zIndex=this.parent.zIndex++,this.data.popupRef&&i.setAttribute("aria-haspopup","dialog"),t.noRotate&&i.classList.add("norotate");const{pageWidth:s,pageHeight:o,pageX:l,pageY:d}=a.rawDims;if(!t.rect||this instanceof T){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,i),i}const{width:h,height:f}=u(t.rect),m=r.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(!e&&t.borderStyle.width>0){i.style.borderWidth="".concat(t.borderStyle.width,"px");const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t="calc(".concat(e,"px * var(--scale-factor)) / calc(").concat(n,"px * var(--scale-factor))");i.style.borderRadius=t}else if(this instanceof C){const e="calc(".concat(h,"px * var(--scale-factor)) / calc(").concat(f,"px * var(--scale-factor))");i.style.borderRadius=e}switch(t.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:i.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:i.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:i.style.borderBottomStyle="solid"}const a=t.borderColor||null;a?(_classPrivateFieldSet(p,this,!0),i.style.borderColor=r.Util.makeHexColor(0|a[0],0|a[1],0|a[2])):i.style.borderWidth=0}i.style.left="".concat(100*(m[0]-l)/s,"%"),i.style.top="".concat(100*(m[1]-d)/o,"%");const{rotation:g}=t;return t.hasOwnCanvas||0===g?(i.style.width="".concat(100*h/s,"%"),i.style.height="".concat(100*f/o,"%")):this.setRotation(g,i),i}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:a,height:i}=u(this.data.rect);let s,o;e%180===0?(s=100*a/n,o=100*i/r):(s=100*i/n,o=100*a/r),t.style.width="".concat(s,"%"),t.style.height="".concat(o,"%"),t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const r=n.detail[e],a=r[0],i=r.slice(1);n.target.style[t]=s.ColorConverters["".concat(a,"_HTML")](i),this.annotationStorage.setValue(this.data.id,{[t]:s.ColorConverters["".concat(a,"_rgb")](i)})};return(0,r.shadow)(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail)){const a=e[r]||n[r];null===a||void 0===a||a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,a]of Object.entries(t)){const i=n[r];i&&(i({detail:{[r]:a},target:e}),delete t[r])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,a]=this.data.rect;if(1===e.length){const[,{x:i,y:s},{x:o,y:l}]=e[0];if(r===i&&a===s&&t===o&&n===l)return}const{style:i}=this.container;let s;if(_classPrivateFieldGet(p,this)){const{borderColor:e,borderWidth:t}=i;i.borderWidth=0,s=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(e,'" stroke-width="').concat(t,'">')],this.container.classList.add("hasBorder")}const o=r-t,l=a-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const u=c.createElement("defs");d.append(u);const h=c.createElement("clipPath"),f="clippath_".concat(this.data.id);h.setAttribute("id",f),h.setAttribute("clipPathUnits","objectBoundingBox"),u.append(h);for(const[,{x:p,y:g},{x:v,y:y}]of e){var m;const e=c.createElement("rect"),n=(v-t)/o,r=(a-g)/l,i=(p-v)/o,d=(g-y)/l;e.setAttribute("x",n),e.setAttribute("y",r),e.setAttribute("width",i),e.setAttribute("height",d),h.append(e),null===(m=s)||void 0===m||m.push('<rect vector-effect="non-scaling-stroke" x="'.concat(n,'" y="').concat(r,'" width="').concat(i,'" height="').concat(d,'"/>'))}_classPrivateFieldGet(p,this)&&(s.push("</g></svg>')"),i.backgroundImage=s.join("")),this.container.append(d),this.container.style.clipPath="url(#".concat(f,")")}_createPopup(){const{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");const n=new T({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(n.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const a=this._fieldObjects[e];if(a)for(const{page:e,id:i,exportValues:s}of a){if(-1===e)continue;if(i===t)continue;const a="string"===typeof s?s:null,o=document.querySelector('[data-element-id="'.concat(i,'"]'));!o||d.has(o)?n.push({id:i,exportValue:a,domElement:o}):(0,r.warn)("_getElementsByName - element not allowed: ".concat(i))}return n}for(const r of document.getElementsByName(e)){const{exportValue:e}=r,a=r.getAttribute("data-element-id");a!==t&&d.has(r)&&n.push({id:a,exportValue:e,domElement:r})}return n}show(){var e;this.container&&(this.container.hidden=!1),null===(e=this.popup)||void 0===e||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null===(e=this.popup)||void 0===e||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}var m=new WeakSet;class g extends f{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!(null===t||void 0===t||!t.ignoreBorder),createQuadrilaterals:!0}),_classPrivateMethodInitSpec(this,m),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(this._bindAttachment(n,e.attachment),r=!0):e.setOCGState?(_assertClassBrand(m,this,y).call(this,n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&_assertClassBrand(m,this,v).call(this)}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),_assertClassBrand(m,this,v).call(this)}_bindAttachment(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var e;return null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.container,t.content,t.filename),!1},_assertClassBrand(m,this,v).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const a=n.get(r);a&&(e[a]=()=>{var e;return null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1})}e.onclick||(e.onclick=()=>!1),_assertClassBrand(m,this,v).call(this)}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),_assertClassBrand(m,this,v).call(this),!this._fieldObjects)return(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{null===n||void 0===n||n();const{fields:e,refs:a,include:i}=t,s=[];if(0!==e.length||0!==a.length){const t=new Set(a);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===i&&s.push(n)}else for(const t of Object.values(this._fieldObjects))s.push(...t);const o=this.annotationStorage,l=[];for(const t of s){const{id:e}=t;switch(l.push(e),t.type){case"text":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;o.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";o.setValue(e,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(e,'"]'));n&&(d.has(n)?n.dispatchEvent(new Event("resetform")):(0,r.warn)("_bindResetFormAction - element not allowed: ".concat(e)))}var c;return this.enableScripting&&(null===(c=this.linkService.eventBus)||void 0===c||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}})),!1}}}function v(){this.container.setAttribute("data-internal-link","")}function y(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),_assertClassBrand(m,this,v).call(this)}class b extends f{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class w extends f{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null===(t=e.previousSibling)||void 0===t?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:t,isMac:n}=r.FeatureTest.platform;return t&&e.ctrlKey||n&&e.metaKey}_setEventListener(e,t,n,r,a){n.includes("mouse")?e.addEventListener(n,e=>{var t;null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var i;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}a&&(null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(e)}}))})}_setEventListeners(e,t,n,r){for(const[o,l]of n){var a,i,s;("Action"===l||null!==(a=this.data.actions)&&void 0!==a&&a[l])&&("Focus"!==l&&"Blur"!==l||t||(t={focused:!1}),this._setEventListener(e,t,o,l,r),"Focus"!==l||null!==(i=this.data.actions)&&void 0!==i&&i.Blur?"Blur"!==l||null!==(s=this.data.actions)&&void 0!==s&&s.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":r.Util.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||9,i=e.style;let s;const o=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(r.LINE_FACTOR*a))||1);s=Math.min(a,o(t/r.LINE_FACTOR))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);s=Math.min(a,o(e/r.LINE_FACTOR))}i.fontSize="calc(".concat(s,"px * var(--scale-factor))"),i.color=r.Util.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class _ extends w{constructor(e){super(e,{isRenderable:e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,r){const a=this.annotationStorage;for(const i of this._getElementsByName(e.name,e.id))i.domElement&&(i.domElement[t]=n),a.setValue(i.id,{[r]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var r;const i=e.getValue(t,{value:this.data.fieldValue});let s=i.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let l=i.formattedValue||(null===(r=this.data.textContent)||void 0===r?void 0:r.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:s,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",null!==l&&void 0!==l?l:s),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),d.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=c,this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",r=>{e.setValue(t,{value:r.target.value}),this.setPropertyOnSiblings(n,"value",r.target.value,"value"),u.formattedValue=null}),n.addEventListener("resetform",e=>{var t;const r=null!==(t=this.data.defaultFieldValue)&&void 0!==t?t:"";n.value=u.userValue=r,u.formattedValue=null});let h=e=>{const{formattedValue:t}=u;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var a;n.addEventListener("focus",e=>{if(u.focused)return;const{target:t}=e;u.userValue&&(t.value=u.userValue),u.lastCommittedValue=t.value,u.commitKey=1,u.focused=!0}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const r={value(n){var r;u.userValue=null!==(r=n.detail.value)&&void 0!==r?r:"",e.setValue(t,{value:u.userValue.toString()}),n.target.value=u.userValue},formattedValue(n){const{formattedValue:r}=n.detail;u.formattedValue=r,null!==r&&void 0!==r&&n.target!==document.activeElement&&(n.target.value=r),e.setValue(t,{formattedValue:r})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{var r;const{charLimit:a}=n.detail,{target:i}=n;if(0===a)return void i.removeAttribute("maxLength");i.setAttribute("maxLength",a);let s=u.userValue;!s||s.length<=a||(s=s.slice(0,a),i.value=u.userValue=s,e.setValue(t,{value:s}),null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:1,selStart:i.selectionStart,selEnd:i.selectionEnd}}))}};this._dispatchEventFromSandbox(r,n)}),n.addEventListener("keydown",e=>{var n;u.commitKey=1;let r=-1;if("Escape"===e.key?r=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(u.commitKey=3):r=2,-1===r)return;const{value:a}=e.target;u.lastCommittedValue!==a&&(u.lastCommittedValue=a,u.userValue=a,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,willCommit:!0,commitKey:r,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const r=h;h=null,n.addEventListener("blur",e=>{if(!u.focused||!e.relatedTarget)return;u.focused=!1;const{value:n}=e.target;var a;u.userValue=n,u.lastCommittedValue!==n&&(null===(a=this.linkService.eventBus)||void 0===a||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:n,willCommit:!0,commitKey:u.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}})),r(e)}),null!==(a=this.data.actions)&&void 0!==a&&a.Keystroke&&n.addEventListener("beforeinput",e=>{var n;u.lastCommittedValue=null;const{data:r,target:a}=e,{value:i,selectionStart:s,selectionEnd:o}=a;let l=s,c=o;switch(e.inputType){case"deleteWordBackward":{const e=i.substring(0,s).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=i.substring(s).match(/^[^\w]*\w*/);e&&(c+=e[0].length);break}case"deleteContentBackward":s===o&&(l-=1);break;case"deleteContentForward":s===o&&(c+=1)}e.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,change:r||"",willCommit:!1,selStart:l,selEnd:c}})}),this._setEventListeners(n,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(h&&n.addEventListener("blur",h),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(e,"px * var(--scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class A extends w{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class S extends w{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"===typeof r&&(r="Off"!==r,e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return d.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=c,a.addEventListener("change",r=>{const{name:a,checked:i}=r.target;for(const s of this._getElementsByName(a,n)){const n=i&&s.exportValue===t.exportValue;s.domElement&&(s.domElement.checked=n),e.setValue(s.id,{value:n})}e.setValue(n,{value:i})}),a.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",t=>{const r={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(r,t)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class C extends w{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;"string"===typeof r&&(r=r!==t.buttonValue,e.setValue(n,{value:r}));const a=document.createElement("input");if(d.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=c,a.addEventListener("change",t=>{const{name:r,checked:a}=t.target;for(const i of this._getElementsByName(r,n))e.setValue(i.id,{value:!1});e.setValue(n,{value:a})}),a.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!==n&&void 0!==n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const r=t.buttonValue;a.addEventListener("updatefromsandbox",t=>{const a={value:t=>{const a=r===t.detail.value;for(const r of this._getElementsByName(t.target.name)){const t=a&&r.id===n;r.domElement&&(r.domElement.checked=t),e.setValue(r.id,{value:t})}}};this._dispatchEventFromSandbox(a,t)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class x extends g{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class E extends w{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");d.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=c;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of r.options)n.selected=n.value===t});for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,n.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),a=!1),r.append(e)}let i=null;if(a){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),r.prepend(e),i=()=>{e.remove(),r.removeEventListener("input",i),i=null},r.addEventListener("input",i)}const s=e=>{const t=e?"value":"textContent",{options:n,multiple:a}=r;return a?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let o=s(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",n=>{const a={value(n){var a;null===(a=i)||void 0===a||a();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const e of r.options)e.selected=c.has(e.value);e.setValue(t,{value:s(!0)}),o=s(!1)},multipleSelection(e){r.multiple=!0},remove(n){const a=r.options,i=n.detail.remove;a[i].selected=!1,r.remove(i),a.length>0&&-1===Array.prototype.findIndex.call(a,e=>e.selected)&&(a[0].selected=!0),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},clear(n){for(;0!==r.length;)r.remove(0);e.setValue(t,{value:null,items:[]}),o=s(!1)},insert(n){const{index:a,displayValue:i,exportValue:c}=n.detail.insert,d=r.children[a],u=document.createElement("option");u.textContent=i,u.value=c,d?d.before(u):r.append(u),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},items(n){const{items:a}=n.detail;for(;0!==r.length;)r.remove(0);for(const e of a){const{displayValue:t,exportValue:n}=e,a=document.createElement("option");a.textContent=t,a.value=n,r.append(a)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:s(!0),items:l(n)}),o=s(!1)},indices(n){const r=new Set(n.detail.indices);for(const e of n.target.options)e.selected=r.has(e.index);e.setValue(t,{value:s(!0)}),o=s(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(a,n)}),r.addEventListener("input",n=>{var r;const a=s(!0);e.setValue(t,{value:a}),n.preventDefault(),null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,changeEx:a,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):r.addEventListener("input",function(n){e.setValue(t,{value:s(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class T extends f{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:f._hasPopupData(t)}),this.elements=n}render(){this.container.classList.add("popupAnnotation");const e=new V({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(e=>"".concat(r.AnnotationPrefix).concat(e)).join(",")),this.container}}var k=new WeakMap,P=new WeakMap,I=new WeakMap,R=new WeakMap,N=new WeakMap,O=new WeakMap,M=new WeakMap,F=new WeakMap,D=new WeakMap,L=new WeakMap,j=new WeakMap,B=new WeakMap,U=new WeakMap,G=new WeakMap,H=new WeakMap,z=new WeakMap,W=new WeakMap,q=new WeakSet;class V{constructor(e){let{container:t,color:n,elements:r,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:c,rect:d,parentRect:u,open:h}=e;_classPrivateMethodInitSpec(this,q),_classPrivateFieldInitSpec(this,k,null),_classPrivateFieldInitSpec(this,P,_assertClassBrand(q,this,K).bind(this)),_classPrivateFieldInitSpec(this,I,_assertClassBrand(q,this,Q).bind(this)),_classPrivateFieldInitSpec(this,R,_assertClassBrand(q,this,X).bind(this)),_classPrivateFieldInitSpec(this,N,_assertClassBrand(q,this,Y).bind(this)),_classPrivateFieldInitSpec(this,O,null),_classPrivateFieldInitSpec(this,M,null),_classPrivateFieldInitSpec(this,F,null),_classPrivateFieldInitSpec(this,D,null),_classPrivateFieldInitSpec(this,L,null),_classPrivateFieldInitSpec(this,j,null),_classPrivateFieldInitSpec(this,B,!1),_classPrivateFieldInitSpec(this,U,null),_classPrivateFieldInitSpec(this,G,null),_classPrivateFieldInitSpec(this,H,null),_classPrivateFieldInitSpec(this,z,null),_classPrivateFieldInitSpec(this,W,!1),_classPrivateFieldSet(M,this,t),_classPrivateFieldSet(z,this,i),_classPrivateFieldSet(F,this,o),_classPrivateFieldSet(H,this,l),_classPrivateFieldSet(L,this,c),_classPrivateFieldSet(O,this,n),_classPrivateFieldSet(G,this,d),_classPrivateFieldSet(j,this,u),_classPrivateFieldSet(D,this,r);const p=a.PDFDateString.toDateObject(s);p&&_classPrivateFieldSet(k,this,c.l10n.get("annotation_date_string",{date:p.toLocaleDateString(),time:p.toLocaleTimeString()})),this.trigger=r.flatMap(e=>e.getElementsToTriggerPopup());for(const a of this.trigger)a.addEventListener("click",_classPrivateFieldGet(N,this)),a.addEventListener("mouseenter",_classPrivateFieldGet(R,this)),a.addEventListener("mouseleave",_classPrivateFieldGet(I,this)),a.classList.add("popupTriggerArea");for(const a of r){var f;null===(f=a.container)||void 0===f||f.addEventListener("keydown",_classPrivateFieldGet(P,this))}_classPrivateFieldGet(M,this).hidden=!0,h&&_assertClassBrand(q,this,Y).call(this)}render(){if(_classPrivateFieldGet(U,this))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:a,pageY:i}}}=_classPrivateFieldGet(L,this),s=_classPrivateFieldSet(U,this,document.createElement("div"));if(s.className="popup",_classPrivateFieldGet(O,this)){const e=s.style.outlineColor=r.Util.makeHexColor(..._classPrivateFieldGet(O,this));if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))s.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)");else{const e=.7;s.style.backgroundColor=r.Util.makeHexColor(..._classPrivateFieldGet(O,this).map(t=>Math.floor(e*(255-t)+t)))}}const o=document.createElement("span");o.className="header";const c=document.createElement("h1");if(o.append(c),({dir:c.dir,str:c.textContent}=_classPrivateFieldGet(z,this)),s.append(o),_classPrivateFieldGet(k,this)){const e=document.createElement("span");e.classList.add("popupDate"),_classPrivateFieldGet(k,this).then(t=>{e.textContent=t}),o.append(e)}const d=_classPrivateFieldGet(F,this),u=_classPrivateFieldGet(H,this);if(null===u||void 0===u||!u.str||null!==d&&void 0!==d&&d.str&&d.str!==u.str){const e=this._formatContents(d);s.append(e)}else l.XfaLayer.render({xfaHtml:u.html,intent:"richText",div:s}),s.lastChild.classList.add("richText","popupContent");let h=!!_classPrivateFieldGet(j,this),p=_classPrivateFieldGet(h?j:G,this);for(const l of _classPrivateFieldGet(D,this))if(!p||null!==r.Util.intersect(l.data.rect,p)){p=l.data.rect,h=!0;break}const f=r.Util.normalizeRect([p[0],e[3]-p[1]+e[1],p[2],e[3]-p[3]+e[1]]),m=h?p[2]-p[0]+5:0,g=f[0]+m,v=f[1],{style:y}=_classPrivateFieldGet(M,this);y.left="".concat(100*(g-a)/t,"%"),y.top="".concat(100*(v-i)/n,"%"),_classPrivateFieldGet(M,this).append(s)}_formatContents(e){let{str:t,dir:n}=e;const r=document.createElement("p");r.classList.add("popupContent"),r.dir=n;const a=t.split(/(?:\r\n?|\n)/);for(let i=0,s=a.length;i<s;++i){const e=a[i];r.append(document.createTextNode(e)),i<s-1&&r.append(document.createElement("br"))}return r}forceHide(){_classPrivateFieldSet(W,this,this.isVisible),_classPrivateFieldGet(W,this)&&(_classPrivateFieldGet(M,this).hidden=!0)}maybeShow(){_classPrivateFieldGet(W,this)&&(_classPrivateFieldSet(W,this,!1),_classPrivateFieldGet(M,this).hidden=!1)}get isVisible(){return!1===_classPrivateFieldGet(M,this).hidden}}function K(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&_classPrivateFieldGet(B,this))&&_assertClassBrand(q,this,Y).call(this)}function Y(){_classPrivateFieldSet(B,this,!_classPrivateFieldGet(B,this)),_classPrivateFieldGet(B,this)?(_assertClassBrand(q,this,X).call(this),_classPrivateFieldGet(M,this).addEventListener("click",_classPrivateFieldGet(N,this)),_classPrivateFieldGet(M,this).addEventListener("keydown",_classPrivateFieldGet(P,this))):(_assertClassBrand(q,this,Q).call(this),_classPrivateFieldGet(M,this).removeEventListener("click",_classPrivateFieldGet(N,this)),_classPrivateFieldGet(M,this).removeEventListener("keydown",_classPrivateFieldGet(P,this)))}function X(){_classPrivateFieldGet(U,this)||this.render(),this.isVisible?_classPrivateFieldGet(B,this)&&_classPrivateFieldGet(M,this).classList.add("focused"):(_classPrivateFieldGet(M,this).hidden=!1,_classPrivateFieldGet(M,this).style.zIndex=parseInt(_classPrivateFieldGet(M,this).style.zIndex)+1e3)}function Q(){_classPrivateFieldGet(M,this).classList.remove("focused"),!_classPrivateFieldGet(B,this)&&this.isVisible&&(_classPrivateFieldGet(M,this).hidden=!0,_classPrivateFieldGet(M,this).style.zIndex=parseInt(_classPrivateFieldGet(M,this).style.zIndex)-1e3)}class $ extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=$;var J=new WeakMap;class Z extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,J,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:n}=u(e.rect),r=this.svgFactory.create(t,n,!0),a=_classPrivateFieldSet(J,this,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(J,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var ee=new WeakMap;class te extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,ee,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:n}=u(e.rect),r=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,i=_classPrivateFieldSet(ee,this,this.svgFactory.createElement("svg:rect"));return i.setAttribute("x",a/2),i.setAttribute("y",a/2),i.setAttribute("width",t-a),i.setAttribute("height",n-a),i.setAttribute("stroke-width",a||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(ee,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var ne=new WeakMap;class re extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,ne,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:n}=u(e.rect),r=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,i=_classPrivateFieldSet(ne,this,this.svgFactory.createElement("svg:ellipse"));return i.setAttribute("cx",t/2),i.setAttribute("cy",n/2),i.setAttribute("rx",t/2-a/2),i.setAttribute("ry",n/2-a/2),i.setAttribute("stroke-width",a||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(ne,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var ae=new WeakMap;class ie extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,ae,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=u(e.rect),r=this.svgFactory.create(t,n,!0);let a=[];for(const s of e.vertices){const t=s.x-e.rect[0],n=e.rect[3]-s.y;a.push(t+","+n)}a=a.join(" ");const i=_classPrivateFieldSet(ae,this,this.svgFactory.createElement(this.svgElementName));return i.setAttribute("points",a),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(ae,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class se extends ie{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class oe extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var le=new WeakMap;class ce extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,le,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=u(e.rect),r=this.svgFactory.create(t,n,!0);for(const a of e.inkLists){let t=[];for(const r of a){const n=r.x-e.rect[0],a=e.rect[3]-r.y;t.push("".concat(n,",").concat(a))}t=t.join(" ");const n=this.svgFactory.createElement(this.svgElementName);_classPrivateFieldGet(le,this).push(n),n.setAttribute("points",t),n.setAttribute("stroke-width",e.borderStyle.width||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),r.append(n)}return this.container.append(r),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(le,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=ce;class de extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ue extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class he extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class pe extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class fe extends f{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=fe;var me=new WeakMap,ge=new WeakSet;class ve extends f{constructor(e){var t;super(e,{isRenderable:!0}),_classPrivateMethodInitSpec(this,ge),_classPrivateFieldInitSpec(this,me,null);const{filename:n,content:r}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(n,!0),this.content=r,null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("fileattachmentannotation",{source:this,filename:n,content:r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(t.name)?"paperclip":"pushpin",".svg"),t.fillAlpha&&t.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*t.fillAlpha),"%);"))),n.addEventListener("dblclick",_assertClassBrand(ge,this,ye).bind(this)),_classPrivateFieldSet(me,this,n);const{isMac:a}=r.FeatureTest.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(a?e.metaKey:e.ctrlKey)&&_assertClassBrand(ge,this,ye).call(this)}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return _classPrivateFieldGet(me,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function ye(){var e;null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.container,this.content,this.filename)}var be=new WeakMap,we=new WeakMap,_e=new WeakMap,Ae=new WeakSet;function Se(e,t){var n;const a=e.firstChild||e;a.id="".concat(r.AnnotationPrefix).concat(t),this.div.append(e),null===(n=_classPrivateFieldGet(be,this))||void 0===n||n.moveElementInDOM(this.div,e,a,!1)}function Ce(){if(!_classPrivateFieldGet(we,this))return;const e=this.div;for(const[t,n]of _classPrivateFieldGet(we,this)){const r=e.querySelector('[data-annotation-id="'.concat(t,'"]'));if(!r)continue;const{firstChild:a}=r;a?"CANVAS"===a.nodeName?a.replaceWith(n):a.before(n):r.append(n)}_classPrivateFieldGet(we,this).clear()}t.AnnotationLayer=class{constructor(e){let{div:t,accessibilityManager:n,annotationCanvasMap:r,l10n:a,page:i,viewport:s}=e;_classPrivateMethodInitSpec(this,Ae),_classPrivateFieldInitSpec(this,be,null),_classPrivateFieldInitSpec(this,we,null),_classPrivateFieldInitSpec(this,_e,new Map),this.div=t,_classPrivateFieldSet(be,this,n),_classPrivateFieldSet(we,this,r),this.l10n=a,this.page=i,this.viewport=s,this.zIndex=0,this.l10n||(this.l10n=o.NullL10n)}async render(e){const{annotations:t}=e,n=this.div;(0,a.setLayerDimensions)(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new a.DOMSVGFactory,annotationStorage:e.annotationStorage||new i.AnnotationStorage,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const e=a.annotationType===r.AnnotationType.POPUP;if(e){const e=s.get(a.id);if(!e)continue;o.elements=e}else{const{width:e,height:t}=u(a.rect);if(e<=0||t<=0)continue}o.data=a;const t=h.create(o);if(!t.isRenderable)continue;if(!e&&a.popupRef){const e=s.get(a.popupRef);e?e.push(t):s.set(a.popupRef,[t])}t.annotationEditorType>0&&_classPrivateFieldGet(_e,this).set(t.data.id,t);const n=t.render();a.hidden&&(n.style.visibility="hidden"),_assertClassBrand(Ae,this,Se).call(this,n,a.id)}_assertClassBrand(Ae,this,Ce).call(this),await this.l10n.translate(n)}update(e){let{viewport:t}=e;const n=this.div;this.viewport=t,(0,a.setLayerDimensions)(n,{rotation:t.rotation}),_assertClassBrand(Ae,this,Ce).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(_classPrivateFieldGet(_e,this).values())}getEditableAnnotation(e){return _classPrivateFieldGet(_e,this).get(e)}}},(e,t)=>{function n(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function r(e){return Math.max(0,Math.min(255,255*e))}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0,t.ColorConverters=class{static CMYK_G(e){let[t,n,r,a]=e;return["G",1-Math.min(1,.3*t+.59*r+.11*n+a)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=r(t),[t,t,t]}static G_HTML(e){let[t]=e;const r=n(t);return"#".concat(r).concat(r).concat(r)}static RGB_G(e){let[t,n,r]=e;return["G",.3*t+.59*n+.11*r]}static RGB_rgb(e){return e.map(r)}static RGB_HTML(e){return"#".concat(e.map(n).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,n,r,a]=e;return["RGB",1-Math.min(1,t+a),1-Math.min(1,r+a),1-Math.min(1,n+a)]}static CMYK_rgb(e){let[t,n,a,i]=e;return[r(1-Math.min(1,t+i)),r(1-Math.min(1,a+i)),r(1-Math.min(1,n+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,n,r]=e;const a=1-t,i=1-n,s=1-r;return["CMYK",a,i,s,Math.min(a,i,s)]}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=r;const n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xd7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xd7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing\u2026",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};function r(e,t){switch(e){case"find_match_count":e="find_match_count[".concat(1===t.total?"one":"other","]");break;case"find_match_count_limit":e="find_match_count_limit[".concat(1===t.limit?"one":"other","]")}return n[e]||""}n.print_progress_percent="{{progress}}%";const a={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){return t?e.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(e,n)=>n in t?t[n]:"{{"+n+"}}"):e}(arguments.length>2&&void 0!==arguments[2]?arguments[2]:r(e,t),t)},async translate(e){}};t.NullL10n=a},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var r=n(25);t.XfaLayer=class{static setupStorage(e,t,n,r,a){const i=r.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==i.value&&(e.textContent=i.value),"print"===a)break;e.addEventListener("input",e=>{r.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(i.value===n.attributes.xfaOn?e.setAttribute("checked",!0):i.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===a)break;e.addEventListener("change",e=>{r.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==i.value&&e.setAttribute("value",i.value),"print"===a)break;e.addEventListener("input",e=>{r.setValue(t,{value:e.target.value})})}break;case"select":if(null!==i.value){e.setAttribute("value",i.value);for(const e of n.children)e.attributes.value===i.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,a=-1===n.selectedIndex?"":n[n.selectedIndex].value;r.setValue(t,{value:a})})}}static setAttributes(e){let{html:t,element:n,storage:r=null,intent:a,linkService:i}=e;const{attributes:s}=n,o=t instanceof HTMLAnchorElement;"radio"===s.type&&(s.name="".concat(s.name,"-").concat(a));for(const[l,c]of Object.entries(s))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}o&&i.addLinkAttributes(t,s.href,s.newWindow),r&&s.dataId&&this.setupStorage(t,s.dataId,n,r)}static render(e){const t=e.annotationStorage,n=e.linkService,a=e.xfaHtml,i=e.intent||"display",s=document.createElement(a.name);a.attributes&&this.setAttributes({html:s,element:a,intent:i,linkService:n});const o=[[a,-1,s]],l=e.div;if(l.append(s),e.viewport){const t="matrix(".concat(e.viewport.transform.join(","),")");l.style.transform=t}"richText"!==i&&l.setAttribute("class","xfaLayer xfaFont");const c=[];for(;o.length>0;){var d;const[e,a,s]=o.at(-1);if(a+1===e.children.length){o.pop();continue}const l=e.children[++o.at(-1)[1]];if(null===l)continue;const{name:u}=l;if("#text"===u){const e=document.createTextNode(l.value);c.push(e),s.append(e);continue}const h=null!==l&&void 0!==l&&null!==(d=l.attributes)&&void 0!==d&&d.xmlns?document.createElementNS(l.attributes.xmlns,u):document.createElement(u);if(s.append(h),l.attributes&&this.setAttributes({html:h,element:l,storage:t,intent:i,linkService:n}),l.children&&l.children.length>0)o.push([l,-1,h]);else if(l.value){const e=document.createTextNode(l.value);r.XfaText.shouldBuildText(u)&&c.push(e),h.append(e)}}for(const r of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))r.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t="matrix(".concat(e.viewport.transform.join(","),")");e.div.style.transform=t,e.div.hidden=!1}}},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var a=n(1),i=n(4),s=n(29),o=n(6),l=n(5),c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,b=new WeakMap,w=new WeakMap,_=new WeakMap,A=new WeakMap,S=new WeakSet;class C extends i.AnnotationEditor{constructor(e){super(_objectSpread(_objectSpread({},e),{},{name:"inkEditor"})),_classPrivateMethodInitSpec(this,S),_classPrivateFieldInitSpec(this,c,0),_classPrivateFieldInitSpec(this,d,0),_classPrivateFieldInitSpec(this,u,this.canvasPointermove.bind(this)),_classPrivateFieldInitSpec(this,h,this.canvasPointerleave.bind(this)),_classPrivateFieldInitSpec(this,p,this.canvasPointerup.bind(this)),_classPrivateFieldInitSpec(this,f,this.canvasPointerdown.bind(this)),_classPrivateFieldInitSpec(this,m,new Path2D),_classPrivateFieldInitSpec(this,g,!1),_classPrivateFieldInitSpec(this,v,!1),_classPrivateFieldInitSpec(this,y,!1),_classPrivateFieldInitSpec(this,b,null),_classPrivateFieldInitSpec(this,w,0),_classPrivateFieldInitSpec(this,_,0),_classPrivateFieldInitSpec(this,A,null),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e){i.AnnotationEditor.initialize(e,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(e,t){switch(e){case a.AnnotationEditorParamsType.INK_THICKNESS:C._defaultThickness=t;break;case a.AnnotationEditorParamsType.INK_COLOR:C._defaultColor=t;break;case a.AnnotationEditorParamsType.INK_OPACITY:C._defaultOpacity=t/100}}updateParams(e,t){switch(e){case a.AnnotationEditorParamsType.INK_THICKNESS:_assertClassBrand(S,this,x).call(this,t);break;case a.AnnotationEditorParamsType.INK_COLOR:_assertClassBrand(S,this,E).call(this,t);break;case a.AnnotationEditorParamsType.INK_OPACITY:_assertClassBrand(S,this,T).call(this,t)}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,C._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,C._defaultColor||i.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*C._defaultOpacity)]]}get propertiesToUpdate(){var e;return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||C._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||C._defaultColor||i.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(null!==(e=this.opacity)&&void 0!==e?e:C._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(_assertClassBrand(S,this,B).call(this),_assertClassBrand(S,this,U).call(this)),this.isAttachedToDOM||(this.parent.add(this),_assertClassBrand(S,this,G).call(this)),_assertClassBrand(S,this,Q).call(this)))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,_classPrivateFieldGet(b,this).disconnect(),_classPrivateFieldSet(b,this,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&null===e&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,t]=this.parentDimensions,n=this.width*e,r=this.height*t;this.setDimensions(n,r)}enableEditMode(){_classPrivateFieldGet(g,this)||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",_classPrivateFieldGet(f,this)))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",_classPrivateFieldGet(f,this)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}commit(){_classPrivateFieldGet(g,this)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_classPrivateFieldSet(g,this,!0),this.div.classList.add("disabled"),_assertClassBrand(S,this,Q).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){0===e.button&&this.isInEditMode()&&!_classPrivateFieldGet(g,this)&&(this.setInForeground(),e.preventDefault(),"mouse"!==e.type&&this.div.focus(),_assertClassBrand(S,this,I).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),_assertClassBrand(S,this,R).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),_assertClassBrand(S,this,j).call(this,e)}canvasPointerleave(e){_assertClassBrand(S,this,j).call(this,e)}get isResizable(){return!this.isEmpty()&&_classPrivateFieldGet(g,this)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(e=>{var t;return null===(t=this.div)||void 0===t?void 0:t.setAttribute("aria-label",e)});const[n,r,a,s]=_assertClassBrand(S,this,k).call(this);if(this.setAt(n,r,0,0),this.setDims(a,s),_assertClassBrand(S,this,B).call(this),this.width){const[n,r]=this.parentDimensions;this.setAspectRatio(this.width*n,this.height*r),this.setAt(e*n,t*r,this.width*n,this.height*r),_classPrivateFieldSet(y,this,!0),_assertClassBrand(S,this,G).call(this),this.setDims(this.width*n,this.height*r),_assertClassBrand(S,this,L).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return _assertClassBrand(S,this,U).call(this),this.div}setDimensions(e,t){const n=Math.round(e),r=Math.round(t);if(_classPrivateFieldGet(w,this)===n&&_classPrivateFieldGet(_,this)===r)return;_classPrivateFieldSet(w,this,n),_classPrivateFieldSet(_,this,r),this.canvas.style.visibility="hidden";const[a,i]=this.parentDimensions;this.width=e/a,this.height=t/i,this.fixAndSetPosition(),_classPrivateFieldGet(g,this)&&_assertClassBrand(S,this,H).call(this,e,t),_assertClassBrand(S,this,G).call(this),_assertClassBrand(S,this,L).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,t,n){if(e instanceof s.InkAnnotationElement)return null;const r=super.deserialize(e,t,n);r.thickness=e.thickness,r.color=a.Util.makeHexColor(...e.color),r.opacity=e.opacity;const[o,l]=r.pageDimensions,u=r.width*o,h=r.height*l,p=r.parentScale,f=e.thickness/2;_classPrivateFieldSet(g,r,!0),_classPrivateFieldSet(w,r,Math.round(u)),_classPrivateFieldSet(_,r,Math.round(h));const{paths:m,rect:v,rotation:y}=e;for(let{bezier:a}of m){a=V.call(C,a,v,y);const e=[];r.paths.push(e);let t=p*(a[0]-f),n=p*(a[1]-f);for(let r=2,s=a.length;r<s;r+=6){const i=p*(a[r]-f),s=p*(a[r+1]-f),o=p*(a[r+2]-f),l=p*(a[r+3]-f),c=p*(a[r+4]-f),d=p*(a[r+5]-f);e.push([[t,n],[i,s],[o,l],[c,d]]),t=c,n=d}const i=_assertClassBrand(C,this,W).call(this,e);r.bezierPath2D.push(i)}const b=_assertClassBrand(S,r,Y).call(r);return _classPrivateFieldSet(d,r,Math.max(i.AnnotationEditor.MIN_SIZE,b[2]-b[0])),_classPrivateFieldSet(c,r,Math.max(i.AnnotationEditor.MIN_SIZE,b[3]-b[1])),_assertClassBrand(S,r,H).call(r,u,h),r}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:_assertClassBrand(S,this,K).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}function x(e){const t=this.thickness;this.addCommands({cmd:()=>{this.thickness=e,_assertClassBrand(S,this,Q).call(this)},undo:()=>{this.thickness=t,_assertClassBrand(S,this,Q).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function E(e){const t=this.color;this.addCommands({cmd:()=>{this.color=e,_assertClassBrand(S,this,L).call(this)},undo:()=>{this.color=t,_assertClassBrand(S,this,L).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function T(e){e/=100;const t=this.opacity;this.addCommands({cmd:()=>{this.opacity=e,_assertClassBrand(S,this,L).call(this)},undo:()=>{this.opacity=t,_assertClassBrand(S,this,L).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function k(){const{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}function P(){const{ctx:e,color:t,opacity:n,thickness:r,parentScale:a,scaleFactor:i}=this;e.lineWidth=r*a/i,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle="".concat(t).concat((0,l.opacityToHex)(n))}function I(e,t){var n;this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",_classPrivateFieldGet(h,this)),this.canvas.addEventListener("pointermove",_classPrivateFieldGet(u,this)),this.canvas.addEventListener("pointerup",_classPrivateFieldGet(p,this)),this.canvas.removeEventListener("pointerdown",_classPrivateFieldGet(f,this)),this.isEditing=!0,_classPrivateFieldGet(y,this)||(_classPrivateFieldSet(y,this,!0),_assertClassBrand(S,this,G).call(this),this.thickness||(this.thickness=r._defaultThickness),this.color||(this.color=r._defaultColor||i.AnnotationEditor._defaultLineColor),null!==(n=this.opacity)&&void 0!==n||(this.opacity=r._defaultOpacity)),this.currentPath.push([e,t]),_classPrivateFieldSet(v,this,!1),_assertClassBrand(S,this,P).call(this),_classPrivateFieldSet(A,this,()=>{_assertClassBrand(S,this,M).call(this),_classPrivateFieldGet(A,this)&&window.requestAnimationFrame(_classPrivateFieldGet(A,this))}),window.requestAnimationFrame(_classPrivateFieldGet(A,this))}function R(e,t){const[n,r]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===r)return;const a=this.currentPath;let i=_classPrivateFieldGet(m,this);if(a.push([e,t]),_classPrivateFieldSet(v,this,!0),a.length<=2)return i.moveTo(...a[0]),void i.lineTo(e,t);3===a.length&&(_classPrivateFieldSet(m,this,i=new Path2D),i.moveTo(...a[0])),_assertClassBrand(S,this,F).call(this,i,...a.at(-3),...a.at(-2),e,t)}function N(){if(0===this.currentPath.length)return;const e=this.currentPath.at(-1);_classPrivateFieldGet(m,this).lineTo(...e)}function O(e,t){let n;if(_classPrivateFieldSet(A,this,null),e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),_assertClassBrand(S,this,R).call(this,e,t),_assertClassBrand(S,this,N).call(this),1!==this.currentPath.length)n=_assertClassBrand(S,this,D).call(this);else{const r=[e,t];n=[[r,r.slice(),r.slice(),r]]}const r=_classPrivateFieldGet(m,this),a=this.currentPath;this.currentPath=[],_classPrivateFieldSet(m,this,new Path2D),this.addCommands({cmd:()=>{this.allRawPaths.push(a),this.paths.push(n),this.bezierPath2D.push(r),this.rebuild()},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(_assertClassBrand(S,this,B).call(this),_assertClassBrand(S,this,U).call(this)),_assertClassBrand(S,this,Q).call(this))},mustExec:!0})}function M(){if(!_classPrivateFieldGet(v,this))return;_classPrivateFieldSet(v,this,!1);Math.ceil(this.thickness*this.parentScale);const e=this.currentPath.slice(-3),t=e.map(e=>e[0]),n=e.map(e=>e[1]),{ctx:r}=(Math.min(...t),Math.max(...t),Math.min(...n),Math.max(...n),this);r.save(),r.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)r.stroke(a);r.stroke(_classPrivateFieldGet(m,this)),r.restore()}function F(e,t,n,r,a,i,s){const o=(t+r)/2,l=(n+a)/2,c=(r+i)/2,d=(a+s)/2;e.bezierCurveTo(o+2*(r-o)/3,l+2*(a-l)/3,c+2*(r-c)/3,d+2*(a-d)/3,c,d)}function D(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const t=[];let n,[r,a]=e[0];for(n=1;n<e.length-2;n++){const[i,s]=e[n],[o,l]=e[n+1],c=(i+o)/2,d=(s+l)/2,u=[r+2*(i-r)/3,a+2*(s-a)/3],h=[c+2*(i-c)/3,d+2*(s-d)/3];t.push([[r,a],u,h,[c,d]]),[r,a]=[c,d]}const[i,s]=e[n],[o,l]=e[n+1],c=[r+2*(i-r)/3,a+2*(s-a)/3],d=[o+2*(i-o)/3,l+2*(s-l)/3];return t.push([[r,a],c,d,[o,l]]),t}function L(){if(this.isEmpty())return void _assertClassBrand(S,this,z).call(this);_assertClassBrand(S,this,P).call(this);const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),_assertClassBrand(S,this,z).call(this);for(const n of this.bezierPath2D)t.stroke(n)}function j(e){this.canvas.removeEventListener("pointerleave",_classPrivateFieldGet(h,this)),this.canvas.removeEventListener("pointermove",_classPrivateFieldGet(u,this)),this.canvas.removeEventListener("pointerup",_classPrivateFieldGet(p,this)),this.canvas.addEventListener("pointerdown",_classPrivateFieldGet(f,this)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)},10),_assertClassBrand(S,this,O).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}function B(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(e=>{var t;return null===(t=this.canvas)||void 0===t?void 0:t.setAttribute("aria-label",e)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function U(){_classPrivateFieldSet(b,this,new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)})),_classPrivateFieldGet(b,this).observe(this.div)}function G(){if(!_classPrivateFieldGet(y,this))return;const[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),_assertClassBrand(S,this,z).call(this)}function H(e,t){const n=_assertClassBrand(S,this,X).call(this),r=(e-n)/_classPrivateFieldGet(d,this),a=(t-n)/_classPrivateFieldGet(c,this);this.scaleFactor=Math.min(r,a)}function z(){const e=_assertClassBrand(S,this,X).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}function W(e){const t=new Path2D;for(let n=0,r=e.length;n<r;n++){const[r,a,i,s]=e[n];0===n&&t.moveTo(...r),t.bezierCurveTo(a[0],a[1],i[0],i[1],s[0],s[1])}return t}function q(e,t,n){const[r,a,i,s]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]+=r,e[t+1]=s-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]+r,e[t+1]=n+a}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=i-e[t],e[t+1]+=a;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=i-e[t+1],e[t+1]=s-n}break;default:throw new Error("Invalid rotation")}return e}function V(e,t,n){const[r,a,i,s]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]-=r,e[t+1]=s-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]-a,e[t+1]=n-r}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=i-e[t],e[t+1]-=a;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=s-e[t+1],e[t+1]=i-n}break;default:throw new Error("Invalid rotation")}return e}function K(e,t,n,a){const i=[],s=this.thickness/2,o=e*t+s,l=e*n+s;for(const c of this.paths){const t=[],n=[];for(let r=0,a=c.length;r<a;r++){const[i,s,d,u]=c[r],h=e*i[0]+o,p=e*i[1]+l,f=e*s[0]+o,m=e*s[1]+l,g=e*d[0]+o,v=e*d[1]+l,y=e*u[0]+o,b=e*u[1]+l;0===r&&(t.push(h,p),n.push(h,p)),t.push(f,m,g,v,y,b),n.push(f,m),r===a-1&&n.push(y,b)}i.push({bezier:q.call(r,t,a,this.rotation),points:q.call(r,n,a,this.rotation)})}return i}function Y(){let e=1/0,t=-1/0,n=1/0,r=-1/0;for(const i of this.paths)for(const[s,o,l,c]of i){const i=a.Util.bezierBoundingBox(...s,...o,...l,...c);e=Math.min(e,i[0]),n=Math.min(n,i[1]),t=Math.max(t,i[2]),r=Math.max(r,i[3])}return[e,n,t,r]}function X(){return _classPrivateFieldGet(g,this)?Math.ceil(this.thickness*this.parentScale):0}function Q(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return;if(!_classPrivateFieldGet(g,this))return void _assertClassBrand(S,this,L).call(this);const t=_assertClassBrand(S,this,Y).call(this),n=_assertClassBrand(S,this,X).call(this);_classPrivateFieldSet(d,this,Math.max(i.AnnotationEditor.MIN_SIZE,t[2]-t[0])),_classPrivateFieldSet(c,this,Math.max(i.AnnotationEditor.MIN_SIZE,t[3]-t[1]));const r=Math.ceil(n+_classPrivateFieldGet(d,this)*this.scaleFactor),a=Math.ceil(n+_classPrivateFieldGet(c,this)*this.scaleFactor),[s,o]=this.parentDimensions;this.width=r/s,this.height=a/o,this.setAspectRatio(r,a);const l=this.translationX,u=this.translationY;this.translationX=-t[0],this.translationY=-t[1],_assertClassBrand(S,this,G).call(this),_assertClassBrand(S,this,L).call(this),_classPrivateFieldSet(w,this,r),_classPrivateFieldSet(_,this,a),this.setDims(r,a);const h=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-h,u-this.translationY-h)}r=C,_defineProperty(C,"_defaultColor",null),_defineProperty(C,"_defaultOpacity",1),_defineProperty(C,"_defaultThickness",1),_defineProperty(C,"_type","ink"),t.InkEditor=C},(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var a=n(1),i=n(4),s=n(6),o=n(29),l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakSet;class b extends i.AnnotationEditor{constructor(e){super(_objectSpread(_objectSpread({},e),{},{name:"stampEditor"})),_classPrivateMethodInitSpec(this,y),_classPrivateFieldInitSpec(this,l,null),_classPrivateFieldInitSpec(this,c,null),_classPrivateFieldInitSpec(this,d,null),_classPrivateFieldInitSpec(this,u,null),_classPrivateFieldInitSpec(this,h,null),_classPrivateFieldInitSpec(this,p,null),_classPrivateFieldInitSpec(this,f,null),_classPrivateFieldInitSpec(this,m,null),_classPrivateFieldInitSpec(this,g,!1),_classPrivateFieldInitSpec(this,v,!1),_classPrivateFieldSet(u,this,e.bitmapUrl),_classPrivateFieldSet(h,this,e.bitmapFile)}static initialize(e){i.AnnotationEditor.initialize(e)}static get supportedTypes(){return(0,a.shadow)(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>"image/".concat(e)))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,t;_classPrivateFieldGet(c,this)&&(_classPrivateFieldSet(l,this,null),this._uiManager.imageManager.deleteId(_classPrivateFieldGet(c,this)),null===(e=_classPrivateFieldGet(p,this))||void 0===e||e.remove(),_classPrivateFieldSet(p,this,null),null===(t=_classPrivateFieldGet(f,this))||void 0===t||t.disconnect(),_classPrivateFieldSet(f,this,null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(_classPrivateFieldGet(c,this)&&_assertClassBrand(y,this,A).call(this),this.isAttachedToDOM||this.parent.add(this))):_classPrivateFieldGet(c,this)&&_assertClassBrand(y,this,A).call(this)}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(_classPrivateFieldGet(d,this)||_classPrivateFieldGet(l,this)||_classPrivateFieldGet(u,this)||_classPrivateFieldGet(h,this))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,_classPrivateFieldGet(l,this)?_assertClassBrand(y,this,S).call(this):_assertClassBrand(y,this,A).call(this),this.width){const[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r)}return this.div}static deserialize(e,t,n){if(e instanceof o.StampAnnotationElement)return null;const r=super.deserialize(e,t,n),{rect:a,bitmapUrl:i,bitmapId:s,isSvg:l,accessibilityData:d}=e;s&&n.imageManager.isValidId(s)?_classPrivateFieldSet(c,r,s):_classPrivateFieldSet(u,r,i),_classPrivateFieldSet(g,r,l);const[h,p]=r.pageDimensions;return r.width=(a[2]-a[0])/h,r.height=(a[3]-a[1])/p,d&&(r.altTextData=d),r}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;const n={annotationType:a.AnnotationEditorType.STAMP,bitmapId:_classPrivateFieldGet(c,this),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:_classPrivateFieldGet(g,this),structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=_assertClassBrand(y,this,T).call(this,!0),n.accessibilityData=this.altTextData,n;const{decorative:r,altText:i}=this.altTextData;if(!r&&i&&(n.accessibilityData={type:"Figure",alt:i}),null===t)return n;t.stamps||(t.stamps=new Map);const s=_classPrivateFieldGet(g,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(_classPrivateFieldGet(c,this))){if(_classPrivateFieldGet(g,this)){const e=t.stamps.get(_classPrivateFieldGet(c,this));s>e.area&&(e.area=s,e.serialized.bitmap.close(),e.serialized.bitmap=_assertClassBrand(y,this,T).call(this,!1))}}else t.stamps.set(_classPrivateFieldGet(c,this),{area:s,serialized:n}),n.bitmap=_assertClassBrand(y,this,T).call(this,!1);return n}}function w(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(_classPrivateFieldSet(l,this,e.bitmap),t||(_classPrivateFieldSet(c,this,e.id),_classPrivateFieldSet(g,this,e.isSvg)),_assertClassBrand(y,this,S).call(this)):this.remove()}function _(){_classPrivateFieldSet(d,this,null),this._uiManager.enableWaiting(!1),_classPrivateFieldGet(p,this)&&this.div.focus()}function A(){if(_classPrivateFieldGet(c,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(_classPrivateFieldGet(c,this)).then(e=>_assertClassBrand(y,this,w).call(this,e,!0)).finally(()=>_assertClassBrand(y,this,_).call(this));if(_classPrivateFieldGet(u,this)){const e=_classPrivateFieldGet(u,this);return _classPrivateFieldSet(u,this,null),this._uiManager.enableWaiting(!0),void _classPrivateFieldSet(d,this,this._uiManager.imageManager.getFromUrl(e).then(e=>_assertClassBrand(y,this,w).call(this,e)).finally(()=>_assertClassBrand(y,this,_).call(this)))}if(_classPrivateFieldGet(h,this)){const e=_classPrivateFieldGet(h,this);return _classPrivateFieldSet(h,this,null),this._uiManager.enableWaiting(!0),void _classPrivateFieldSet(d,this,this._uiManager.imageManager.getFromFile(e).then(e=>_assertClassBrand(y,this,w).call(this,e)).finally(()=>_assertClassBrand(y,this,_).call(this)))}const e=document.createElement("input");e.type="file",e.accept=r.supportedTypesStr,_classPrivateFieldSet(d,this,new Promise(t=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);_assertClassBrand(y,this,w).call(this,t)}else this.remove();t()}),e.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>_assertClassBrand(y,this,_).call(this))),e.click()}function S(){const{div:e}=this;let{width:t,height:n}=_classPrivateFieldGet(l,this);const[r,a]=this.pageDimensions,i=.75;if(this.width)t=this.width*r,n=this.height*a;else if(t>i*r||n>i*a){const e=Math.min(i*r/t,i*a/n);t*=e,n*=e}const[s,o]=this.parentDimensions;this.setDims(t*s/r,n*o/a),this._uiManager.enableWaiting(!1);const c=_classPrivateFieldSet(p,this,document.createElement("canvas"));e.append(c),e.hidden=!1,_assertClassBrand(y,this,E).call(this,t,n),_assertClassBrand(y,this,k).call(this),_classPrivateFieldGet(v,this)||(this.parent.addUndoableEditor(this),_classPrivateFieldSet(v,this,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}function C(e,t){var n;const[r,a]=this.parentDimensions;this.width=e/r,this.height=t/a,this.setDims(e,t),null!==(n=this._initialOptions)&&void 0!==n&&n.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==_classPrivateFieldGet(m,this)&&clearTimeout(_classPrivateFieldGet(m,this)),_classPrivateFieldSet(m,this,setTimeout(()=>{_classPrivateFieldSet(m,this,null),_assertClassBrand(y,this,E).call(this,e,t)},200))}function x(e,t){const{width:n,height:r}=_classPrivateFieldGet(l,this);let a=n,i=r,s=_classPrivateFieldGet(l,this);for(;a>2*e||i>2*t;){const n=a,r=i;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),i>2*t&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2));const o=new OffscreenCanvas(a,i);o.getContext("2d").drawImage(s,0,0,n,r,0,0,a,i),s=o.transferToImageBitmap()}return s}function E(e,t){e=Math.ceil(e),t=Math.ceil(t);const n=_classPrivateFieldGet(p,this);if(!n||n.width===e&&n.height===t)return;n.width=e,n.height=t;const r=_classPrivateFieldGet(g,this)?_classPrivateFieldGet(l,this):_assertClassBrand(y,this,x).call(this,e,t),a=n.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(r,0,0,r.width,r.height,0,0,e,t)}function T(e){if(e){if(_classPrivateFieldGet(g,this)){const e=this._uiManager.imageManager.getSvgUrl(_classPrivateFieldGet(c,this));if(e)return e}const e=document.createElement("canvas");return({width:e.width,height:e.height}=_classPrivateFieldGet(l,this)),e.getContext("2d").drawImage(_classPrivateFieldGet(l,this),0,0),e.toDataURL()}if(_classPrivateFieldGet(g,this)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*s.PixelsPerInch.PDF_TO_CSS_UNITS),r=Math.round(this.height*t*s.PixelsPerInch.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(_classPrivateFieldGet(l,this),0,0,_classPrivateFieldGet(l,this).width,_classPrivateFieldGet(l,this).height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(_classPrivateFieldGet(l,this))}function k(){_classPrivateFieldSet(f,this,new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&_assertClassBrand(y,this,C).call(this,t.width,t.height)})),_classPrivateFieldGet(f,this).observe(this.div)}r=b,_defineProperty(b,"_type","stamp"),t.StampEditor=b}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__w_pdfjs_require__),n.exports}var __nested_webpack_exports__={};return(()=>{var e=__nested_webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return s.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return l.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return n.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return n.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return c.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return n.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return n.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return a.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return a.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return n.version}});var t=__w_pdfjs_require__(1),n=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),a=__w_pdfjs_require__(26),i=__w_pdfjs_require__(27),s=__w_pdfjs_require__(5),o=__w_pdfjs_require__(29),l=__w_pdfjs_require__(14),c=__w_pdfjs_require__(32)})(),__nested_webpack_exports__})(),module.exports=root.pdfjsLib=factory()},3237:()=>{},3312:(e,t,n)=>{var r=n(7101);e.exports=function(e,t){r(e,t),t.add(e)},e.exports.__esModule=!0,e.exports.default=e.exports},3488:(e,t,n)=>{"use strict";var r=n(3959);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,s){if(s!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3959:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4239:(e,t,n)=>{"use strict";n.d(t,{PQ:()=>i,R8:()=>o,aE:()=>d,bn:()=>s,sR:()=>c,ug:()=>l});var r=n(2935);const a=()=>(0,r.Gi)().replace(/\/$/,"");async function i(){const e=await fetch("".concat(a(),"/api/rbac/permissions"),{cache:"no-store"});if(!e.ok)throw new Error("perm_catalog_failed");return e.json()}async function s(e){const t=e?"".concat(a(),"/api/rbac/role-permissions?role=").concat(encodeURIComponent(e)):"".concat(a(),"/api/rbac/role-permissions"),n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error("role_perms_failed");return n.json()}async function o(e,t){if(!(await fetch("".concat(a(),"/api/rbac/role-permissions"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:e,mapping:t})})).ok)throw new Error("role_perms_update_failed")}async function l(e){const t=e?"".concat(a(),"/api/rbac/user-permissions?email=").concat(encodeURIComponent(e)):"".concat(a(),"/api/rbac/user-permissions"),n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error("user_perms_failed");return n.json()}async function c(e,t){if(!(await fetch("".concat(a(),"/api/rbac/user-permissions"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,mapping:t})})).ok)throw new Error("user_perms_update_failed")}async function d(e){const t=await fetch("".concat(a(),"/api/rbac/effective?email=").concat(encodeURIComponent(e)),{cache:"no-store"});if(!t.ok)throw new Error("effective_perms_failed");return t.json()}},4388:(e,t,n)=>{"use strict";n.d(t,{$x:()=>g,E_:()=>C,F0:()=>F,Fq:()=>u,GU:()=>w,Gd:()=>c,I:()=>k,IO:()=>E,JR:()=>_,Kk:()=>I,LR:()=>y,Lz:()=>M,OK:()=>l,Qd:()=>v,Rv:()=>O,Tq:()=>P,Xw:()=>T,YM:()=>a,_2:()=>N,_A:()=>o,_M:()=>h,aG:()=>b,aZ:()=>s,gT:()=>x,hB:()=>A,iF:()=>p,jZ:()=>R,p:()=>m,t3:()=>i,u0:()=>S,v2:()=>d,zL:()=>f});var r=n(2555);const a={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},i={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},s=[a.OPENID_SCOPE,a.PROFILE_SCOPE,a.OFFLINE_ACCESS_SCOPE],o=[...s,a.EMAIL_SCOPE],l={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},c={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},d={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},u={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},h={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},p={PLAIN:"plain",S256:"S256"},f={QUERY:"query",FRAGMENT:"fragment"},m=(0,r.A)((0,r.A)({},f),{},{FORM_POST:"form_post"}),g={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},v={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},y={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},b={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},w="appmetadata",_="client_info",A="1",S={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},C={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},x={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},E={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},T={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},k={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},P={username:"username",password:"password"},I={httpSuccess:200,httpBadRequest:400},R={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},N={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},O={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},M={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},F=300},4414:(e,t,n)=>{"use strict";e.exports=n(2654)},4641:(e,t,n)=>{"use strict";n.d(t,{AK:()=>u,DC:()=>o,EO:()=>m,G4:()=>h,LM:()=>d,O0:()=>p,Pg:()=>s,Xr:()=>c,_L:()=>l,d6:()=>a,getDocumentsByBatch:()=>i,rd:()=>f});var r=n(2932);const a=async(e,t)=>{const n=t?"?email=".concat(encodeURIComponent(t)):"";try{return await(0,r.Vg)("/api/batches".concat(n))}catch(a){return[]}},i=async(e,t)=>{try{return await(0,r.Vg)("/api/batches/".concat(encodeURIComponent(e),"/documents"))}catch(n){return[]}},s=async(e,t,n,a)=>{const i=a?"?email=".concat(encodeURIComponent(a)):"";try{return await(0,r.Vg)("/api/batches/".concat(encodeURIComponent(e),"/progress").concat(i))}catch(s){return{acknowledged:0,total:0,percent:0}}},o=async(e,t,n)=>{const a=n?"?email=".concat(encodeURIComponent(n)):"";try{const t=await(0,r.Vg)("/api/batches/".concat(encodeURIComponent(e),"/acks").concat(a));return Array.isArray(null===t||void 0===t?void 0:t.ids)?t.ids:[]}catch(i){return[]}},l=async e=>{try{return await(0,r.Vg)("/api/documents/".concat(encodeURIComponent(e)))}catch(t){return null}},c=async e=>{try{return await(0,r.Vg)("/api/businesses")}catch(t){return[]}},d=async(e,t)=>await(0,r.$P)("/api/businesses",e),u=async(e,t,n)=>await(0,r.mu)("/api/businesses/".concat(e),t),h=async(e,t)=>await(0,r.Al)("/api/businesses/".concat(e)),p=async()=>{try{const e=await(0,r.Vg)("/api/roles");return Array.isArray(e)?e:[]}catch(e){return[]}},f=async(e,t)=>await(0,r.$P)("/api/roles",{email:e,role:t}),m=async e=>{await(0,r.Al)("/api/roles/".concat(e))}},4695:function(e){e.exports=function(){"use strict";function e(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n(t,n){return t.get(e(t,n))}function r(e,n,r){t(e,n),n.set(e,r)}function a(t,n,r){return t.set(e(t,n),r),r}const i=100,s={},o=()=>{s.previousActiveElement instanceof HTMLElement?(s.previousActiveElement.focus(),s.previousActiveElement=null):document.body&&document.body.focus()},l=e=>new Promise(t=>{if(!e)return t();const n=window.scrollX,r=window.scrollY;s.restoreFocusTimeout=setTimeout(()=>{o(),t()},i),window.scrollTo(n,r)}),c="swal2-",d=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce((e,t)=>(e[t]=c+t,e),{}),u=["success","warning","info","question","error"].reduce((e,t)=>(e[t]=c+t,e),{}),h="SweetAlert2:",p=e=>e.charAt(0).toUpperCase()+e.slice(1),f=e=>{console.warn("".concat(h," ").concat("object"===typeof e?e.join(" "):e))},m=e=>{console.error("".concat(h," ").concat(e))},g=[],v=e=>{g.includes(e)||(g.push(e),f(e))},y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;v('"'.concat(e,'" is deprecated and will be removed in the next major release.').concat(t?' Use "'.concat(t,'" instead.'):""))},b=e=>"function"===typeof e?e():e,w=e=>e&&"function"===typeof e.toPromise,_=e=>w(e)?e.toPromise():Promise.resolve(e),A=e=>e&&Promise.resolve(e)===e,S=()=>document.body.querySelector(".".concat(d.container)),C=e=>{const t=S();return t?t.querySelector(e):null},x=e=>C(".".concat(e)),E=()=>x(d.popup),T=()=>x(d.icon),k=()=>x(d["icon-content"]),P=()=>x(d.title),I=()=>x(d["html-container"]),R=()=>x(d.image),N=()=>x(d["progress-steps"]),O=()=>x(d["validation-message"]),M=()=>C(".".concat(d.actions," .").concat(d.confirm)),F=()=>C(".".concat(d.actions," .").concat(d.cancel)),D=()=>C(".".concat(d.actions," .").concat(d.deny)),L=()=>x(d["input-label"]),j=()=>C(".".concat(d.loader)),B=()=>x(d.actions),U=()=>x(d.footer),G=()=>x(d["timer-progress-bar"]),H=()=>x(d.close),z='\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n',W=()=>{const e=E();if(!e)return[];const t=e.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(t).sort((e,t)=>{const n=parseInt(e.getAttribute("tabindex")||"0"),r=parseInt(t.getAttribute("tabindex")||"0");return n>r?1:n<r?-1:0}),r=e.querySelectorAll(z),a=Array.from(r).filter(e=>"-1"!==e.getAttribute("tabindex"));return[...new Set(n.concat(a))].filter(e=>de(e))},q=()=>X(document.body,d.shown)&&!X(document.body,d["toast-shown"])&&!X(document.body,d["no-backdrop"]),V=()=>{const e=E();return!!e&&X(e,d.toast)},K=()=>{const e=E();return!!e&&e.hasAttribute("data-loading")},Y=(e,t)=>{if(e.textContent="",t){const n=(new DOMParser).parseFromString(t,"text/html"),r=n.querySelector("head");r&&Array.from(r.childNodes).forEach(t=>{e.appendChild(t)});const a=n.querySelector("body");a&&Array.from(a.childNodes).forEach(t=>{t instanceof HTMLVideoElement||t instanceof HTMLAudioElement?e.appendChild(t.cloneNode(!0)):e.appendChild(t)})}},X=(e,t)=>{if(!t)return!1;const n=t.split(/\s+/);for(let r=0;r<n.length;r++)if(!e.classList.contains(n[r]))return!1;return!0},Q=(e,t)=>{Array.from(e.classList).forEach(n=>{Object.values(d).includes(n)||Object.values(u).includes(n)||Object.values(t.showClass||{}).includes(n)||e.classList.remove(n)})},$=(e,t,n)=>{if(Q(e,t),!t.customClass)return;const r=t.customClass[n];r&&("string"===typeof r||r.forEach?te(e,r):f("Invalid type of customClass.".concat(n,'! Expected string or iterable object, got "').concat(typeof r,'"')))},J=(e,t)=>{if(!t)return null;switch(t){case"select":case"textarea":case"file":return e.querySelector(".".concat(d.popup," > .").concat(d[t]));case"checkbox":return e.querySelector(".".concat(d.popup," > .").concat(d.checkbox," input"));case"radio":return e.querySelector(".".concat(d.popup," > .").concat(d.radio," input:checked"))||e.querySelector(".".concat(d.popup," > .").concat(d.radio," input:first-child"));case"range":return e.querySelector(".".concat(d.popup," > .").concat(d.range," input"));default:return e.querySelector(".".concat(d.popup," > .").concat(d.input))}},Z=e=>{if(e.focus(),"file"!==e.type){const t=e.value;e.value="",e.value=t}},ee=(e,t,n)=>{e&&t&&("string"===typeof t&&(t=t.split(/\s+/).filter(Boolean)),t.forEach(t=>{Array.isArray(e)?e.forEach(e=>{n?e.classList.add(t):e.classList.remove(t)}):n?e.classList.add(t):e.classList.remove(t)}))},te=(e,t)=>{ee(e,t,!0)},ne=(e,t)=>{ee(e,t,!1)},re=(e,t)=>{const n=Array.from(e.children);for(let r=0;r<n.length;r++){const e=n[r];if(e instanceof HTMLElement&&X(e,t))return e}},ae=(e,t,n)=>{n==="".concat(parseInt("".concat(n)))&&(n=parseInt(n)),n||0===parseInt("".concat(n))?e.style.setProperty(t,"number"===typeof n?"".concat(n,"px"):n):e.style.removeProperty(t)},ie=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex";e&&(e.style.display=t)},se=e=>{e&&(e.style.display="none")},oe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";e&&new MutationObserver(()=>{ce(e,e.innerHTML,t)}).observe(e,{childList:!0,subtree:!0})},le=(e,t,n,r)=>{const a=e.querySelector(t);a&&a.style.setProperty(n,r)},ce=function(e,t){t?ie(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):se(e)},de=e=>!(!e||!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),ue=()=>!de(M())&&!de(D())&&!de(F()),he=e=>!!(e.scrollHeight>e.clientHeight),pe=(e,t)=>{let n=e;for(;n&&n!==t;){if(he(n))return!0;n=n.parentElement}return!1},fe=e=>{const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("animation-duration")||"0"),r=parseFloat(t.getPropertyValue("transition-duration")||"0");return n>0||r>0},me=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=G();n&&de(n)&&(t&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition="width ".concat(e/1e3,"s linear"),n.style.width="0%"},10))},ge=()=>{const e=G();if(!e)return;const t=parseInt(window.getComputedStyle(e).width);e.style.removeProperty("transition"),e.style.width="100%";const n=t/parseInt(window.getComputedStyle(e).width)*100;e.style.width="".concat(n,"%")},ve=()=>"undefined"===typeof window||"undefined"===typeof document,ye='\n <div aria-labelledby="'.concat(d.title,'" aria-describedby="').concat(d["html-container"],'" class="').concat(d.popup,'" tabindex="-1">\n   <button type="button" class="').concat(d.close,'"></button>\n   <ul class="').concat(d["progress-steps"],'"></ul>\n   <div class="').concat(d.icon,'"></div>\n   <img class="').concat(d.image,'" />\n   <h2 class="').concat(d.title,'" id="').concat(d.title,'"></h2>\n   <div class="').concat(d["html-container"],'" id="').concat(d["html-container"],'"></div>\n   <input class="').concat(d.input,'" id="').concat(d.input,'" />\n   <input type="file" class="').concat(d.file,'" />\n   <div class="').concat(d.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(d.select,'" id="').concat(d.select,'"></select>\n   <div class="').concat(d.radio,'"></div>\n   <label class="').concat(d.checkbox,'">\n     <input type="checkbox" id="').concat(d.checkbox,'" />\n     <span class="').concat(d.label,'"></span>\n   </label>\n   <textarea class="').concat(d.textarea,'" id="').concat(d.textarea,'"></textarea>\n   <div class="').concat(d["validation-message"],'" id="').concat(d["validation-message"],'"></div>\n   <div class="').concat(d.actions,'">\n     <div class="').concat(d.loader,'"></div>\n     <button type="button" class="').concat(d.confirm,'"></button>\n     <button type="button" class="').concat(d.deny,'"></button>\n     <button type="button" class="').concat(d.cancel,'"></button>\n   </div>\n   <div class="').concat(d.footer,'"></div>\n   <div class="').concat(d["timer-progress-bar-container"],'">\n     <div class="').concat(d["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),be=()=>{const e=S();return!!e&&(e.remove(),ne([document.documentElement,document.body],[d["no-backdrop"],d["toast-shown"],d["has-column"]]),!0)},we=()=>{s.currentInstance.resetValidationMessage()},_e=()=>{const e=E(),t=re(e,d.input),n=re(e,d.file),r=e.querySelector(".".concat(d.range," input")),a=e.querySelector(".".concat(d.range," output")),i=re(e,d.select),s=e.querySelector(".".concat(d.checkbox," input")),o=re(e,d.textarea);t.oninput=we,n.onchange=we,i.onchange=we,s.onchange=we,o.oninput=we,r.oninput=()=>{we(),a.value=r.value},r.onchange=()=>{we(),a.value=r.value}},Ae=e=>"string"===typeof e?document.querySelector(e):e,Se=e=>{const t=E();t.setAttribute("role",e.toast?"alert":"dialog"),t.setAttribute("aria-live",e.toast?"polite":"assertive"),e.toast||t.setAttribute("aria-modal","true")},Ce=e=>{"rtl"===window.getComputedStyle(e).direction&&te(S(),d.rtl)},xe=e=>{const t=be();if(ve())return void m("SweetAlert2 requires document to initialize");const n=document.createElement("div");n.className=d.container,t&&te(n,d["no-transition"]),Y(n,ye),n.dataset.swal2Theme=e.theme;const r=Ae(e.target);r.appendChild(n),e.topLayer&&(n.setAttribute("popover",""),n.showPopover()),Se(e),Ce(r),_e()},Ee=(e,t)=>{e instanceof HTMLElement?t.appendChild(e):"object"===typeof e?Te(e,t):e&&Y(t,e)},Te=(e,t)=>{e.jquery?ke(t,e):Y(t,e.toString())},ke=(e,t)=>{if(e.textContent="",0 in t)for(let n=0;n in t;n++)e.appendChild(t[n].cloneNode(!0));else e.appendChild(t.cloneNode(!0))},Pe=(e,t)=>{const n=B(),r=j();n&&r&&(t.showConfirmButton||t.showDenyButton||t.showCancelButton?ie(n):se(n),$(n,t,"actions"),Ie(n,r,t),Y(r,t.loaderHtml||""),$(r,t,"loader"))};function Ie(e,t,n){const r=M(),a=D(),i=F();r&&a&&i&&(Oe(r,"confirm",n),Oe(a,"deny",n),Oe(i,"cancel",n),Re(r,a,i,n),n.reverseButtons&&(n.toast?(e.insertBefore(i,r),e.insertBefore(a,r)):(e.insertBefore(i,t),e.insertBefore(a,t),e.insertBefore(r,t))))}function Re(e,t,n,r){r.buttonsStyling?(te([e,t,n],d.styled),r.confirmButtonColor&&e.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&t.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),Ne(e),Ne(t),Ne(n)):ne([e,t,n],d.styled)}function Ne(e){const t=window.getComputedStyle(e);if(t.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=t.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");e.style.setProperty("--swal2-action-button-focus-box-shadow",t.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/," ".concat(n)))}function Oe(e,t,n){const r=p(t);ce(e,n["show".concat(r,"Button")],"inline-block"),Y(e,n["".concat(t,"ButtonText")]||""),e.setAttribute("aria-label",n["".concat(t,"ButtonAriaLabel")]||""),e.className=d[t],$(e,n,"".concat(t,"Button"))}const Me=(e,t)=>{const n=H();n&&(Y(n,t.closeButtonHtml||""),$(n,t,"closeButton"),ce(n,t.showCloseButton),n.setAttribute("aria-label",t.closeButtonAriaLabel||""))},Fe=(e,t)=>{const n=S();n&&(De(n,t.backdrop),Le(n,t.position),je(n,t.grow),$(n,t,"container"))};function De(e,t){"string"===typeof t?e.style.background=t:t||te([document.documentElement,document.body],d["no-backdrop"])}function Le(e,t){t&&(t in d?te(e,d[t]):(f('The "position" parameter is not valid, defaulting to "center"'),te(e,d.center)))}function je(e,t){t&&te(e,d["grow-".concat(t)])}var Be={innerParams:new WeakMap,domCache:new WeakMap};const Ue=["input","file","range","select","radio","checkbox","textarea"],Ge=(e,t)=>{const n=E();if(!n)return;const r=Be.innerParams.get(e),a=!r||t.input!==r.input;Ue.forEach(e=>{const r=re(n,d[e]);r&&(We(e,t.inputAttributes),r.className=d[e],a&&se(r))}),t.input&&(a&&He(t),qe(t))},He=e=>{if(!e.input)return;if(!Qe[e.input])return void m("Unexpected type of input! Expected ".concat(Object.keys(Qe).join(" | "),', got "').concat(e.input,'"'));const t=Ye(e.input);if(!t)return;const n=Qe[e.input](t,e);ie(t),e.inputAutoFocus&&setTimeout(()=>{Z(n)})},ze=e=>{for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;["id","type","value","style"].includes(n)||e.removeAttribute(n)}},We=(e,t)=>{const n=E();if(!n)return;const r=J(n,e);if(r){ze(r);for(const e in t)r.setAttribute(e,t[e])}},qe=e=>{if(!e.input)return;const t=Ye(e.input);t&&$(t,e,"input")},Ve=(e,t)=>{!e.placeholder&&t.inputPlaceholder&&(e.placeholder=t.inputPlaceholder)},Ke=(e,t,n)=>{if(n.inputLabel){const r=document.createElement("label"),a=d["input-label"];r.setAttribute("for",e.id),r.className=a,"object"===typeof n.customClass&&te(r,n.customClass.inputLabel),r.innerText=n.inputLabel,t.insertAdjacentElement("beforebegin",r)}},Ye=e=>{const t=E();if(t)return re(t,d[e]||d.input)},Xe=(e,t)=>{["string","number"].includes(typeof t)?e.value="".concat(t):A(t)||f('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(typeof t,'"'))},Qe={};Qe.text=Qe.email=Qe.password=Qe.number=Qe.tel=Qe.url=Qe.search=Qe.date=Qe["datetime-local"]=Qe.time=Qe.week=Qe.month=(e,t)=>(Xe(e,t.inputValue),Ke(e,e,t),Ve(e,t),e.type=t.input,e),Qe.file=(e,t)=>(Ke(e,e,t),Ve(e,t),e),Qe.range=(e,t)=>{const n=e.querySelector("input"),r=e.querySelector("output");return Xe(n,t.inputValue),n.type=t.input,Xe(r,t.inputValue),Ke(n,e,t),e},Qe.select=(e,t)=>{if(e.textContent="",t.inputPlaceholder){const n=document.createElement("option");Y(n,t.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,e.appendChild(n)}return Ke(e,e,t),e},Qe.radio=e=>(e.textContent="",e),Qe.checkbox=(e,t)=>{const n=J(E(),"checkbox");n.value="1",n.checked=Boolean(t.inputValue);const r=e.querySelector("span");return Y(r,t.inputPlaceholder||t.inputLabel),n},Qe.textarea=(e,t)=>{Xe(e,t.inputValue),Ve(e,t),Ke(e,e,t);const n=e=>parseInt(window.getComputedStyle(e).marginLeft)+parseInt(window.getComputedStyle(e).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=parseInt(window.getComputedStyle(E()).width);new MutationObserver(()=>{if(!document.body.contains(e))return;const a=e.offsetWidth+n(e);a>r?E().style.width="".concat(a,"px"):ae(E(),"width",t.width)}).observe(e,{attributes:!0,attributeFilter:["style"]})}}),e};const $e=(e,t)=>{const n=I();n&&(oe(n),$(n,t,"htmlContainer"),t.html?(Ee(t.html,n),ie(n,"block")):t.text?(n.textContent=t.text,ie(n,"block")):se(n),Ge(e,t))},Je=(e,t)=>{const n=U();n&&(oe(n),ce(n,Boolean(t.footer),"block"),t.footer&&Ee(t.footer,n),$(n,t,"footer"))},Ze=(e,t)=>{const n=Be.innerParams.get(e),r=T();if(r){if(n&&t.icon===n.icon)return at(r,t),void et(r,t);if(t.icon||t.iconHtml){if(t.icon&&-1===Object.keys(u).indexOf(t.icon))return m('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(t.icon,'"')),void se(r);ie(r),at(r,t),et(r,t),te(r,t.showClass&&t.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",tt)}else se(r)}},et=(e,t)=>{for(const[n,r]of Object.entries(u))t.icon!==n&&ne(e,r);te(e,t.icon&&u[t.icon]),it(e,t),tt(),$(e,t,"icon")},tt=()=>{const e=E();if(!e)return;const t=window.getComputedStyle(e).getPropertyValue("background-color"),n=e.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let r=0;r<n.length;r++)n[r].style.backgroundColor=t},nt=e=>"\n  ".concat(e.animation?'<div class="swal2-success-circular-line-left"></div>':"",'\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div>\n  ').concat(e.animation?'<div class="swal2-success-fix"></div>':"","\n  ").concat(e.animation?'<div class="swal2-success-circular-line-right"></div>':"","\n"),rt='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n',at=(e,t)=>{if(!t.icon&&!t.iconHtml)return;let n=e.innerHTML,r="";t.iconHtml?r=st(t.iconHtml):"success"===t.icon?(r=nt(t),n=n.replace(/ style=".*?"/g,"")):"error"===t.icon?r=rt:t.icon&&(r=st({question:"?",warning:"!",info:"i"}[t.icon])),n.trim()!==r.trim()&&Y(e,r)},it=(e,t)=>{if(t.iconColor){e.style.color=t.iconColor,e.style.borderColor=t.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])le(e,n,"background-color",t.iconColor);le(e,".swal2-success-ring","border-color",t.iconColor)}},st=e=>'<div class="'.concat(d["icon-content"],'">').concat(e,"</div>"),ot=(e,t)=>{const n=R();n&&(t.imageUrl?(ie(n,""),n.setAttribute("src",t.imageUrl),n.setAttribute("alt",t.imageAlt||""),ae(n,"width",t.imageWidth),ae(n,"height",t.imageHeight),n.className=d.image,$(n,t,"image")):se(n))};let lt=!1,ct=0,dt=0,ut=0,ht=0;const pt=e=>{e.addEventListener("mousedown",mt),document.body.addEventListener("mousemove",gt),e.addEventListener("mouseup",vt),e.addEventListener("touchstart",mt),document.body.addEventListener("touchmove",gt),e.addEventListener("touchend",vt)},ft=e=>{e.removeEventListener("mousedown",mt),document.body.removeEventListener("mousemove",gt),e.removeEventListener("mouseup",vt),e.removeEventListener("touchstart",mt),document.body.removeEventListener("touchmove",gt),e.removeEventListener("touchend",vt)},mt=e=>{const t=E();if(e.target===t||T().contains(e.target)){lt=!0;const n=yt(e);ct=n.clientX,dt=n.clientY,ut=parseInt(t.style.insetInlineStart)||0,ht=parseInt(t.style.insetBlockStart)||0,te(t,"swal2-dragging")}},gt=e=>{const t=E();if(lt){let{clientX:n,clientY:r}=yt(e);t.style.insetInlineStart="".concat(ut+(n-ct),"px"),t.style.insetBlockStart="".concat(ht+(r-dt),"px")}},vt=()=>{const e=E();lt=!1,ne(e,"swal2-dragging")},yt=e=>{let t=0,n=0;return e.type.startsWith("mouse")?(t=e.clientX,n=e.clientY):e.type.startsWith("touch")&&(t=e.touches[0].clientX,n=e.touches[0].clientY),{clientX:t,clientY:n}},bt=(e,t)=>{const n=S(),r=E();if(n&&r){if(t.toast){ae(n,"width",t.width),r.style.width="100%";const e=j();e&&r.insertBefore(e,T())}else ae(r,"width",t.width);ae(r,"padding",t.padding),t.color&&(r.style.color=t.color),t.background&&(r.style.background=t.background),se(O()),wt(r,t),t.draggable&&!t.toast?(te(r,d.draggable),pt(r)):(ne(r,d.draggable),ft(r))}},wt=(e,t)=>{const n=t.showClass||{};e.className="".concat(d.popup," ").concat(de(e)?n.popup:""),t.toast?(te([document.documentElement,document.body],d["toast-shown"]),te(e,d.toast)):te(e,d.modal),$(e,t,"popup"),"string"===typeof t.customClass&&te(e,t.customClass),t.icon&&te(e,d["icon-".concat(t.icon)])},_t=(e,t)=>{const n=N();if(!n)return;const{progressSteps:r,currentProgressStep:a}=t;r&&0!==r.length&&void 0!==a?(ie(n),n.textContent="",a>=r.length&&f("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach((e,i)=>{const s=At(e);if(n.appendChild(s),i===a&&te(s,d["active-progress-step"]),i!==r.length-1){const e=St(t);n.appendChild(e)}})):se(n)},At=e=>{const t=document.createElement("li");return te(t,d["progress-step"]),Y(t,e),t},St=e=>{const t=document.createElement("li");return te(t,d["progress-step-line"]),e.progressStepsDistance&&ae(t,"width",e.progressStepsDistance),t},Ct=(e,t)=>{const n=P();n&&(oe(n),ce(n,Boolean(t.title||t.titleText),"block"),t.title&&Ee(t.title,n),t.titleText&&(n.innerText=t.titleText),$(n,t,"title"))},xt=(e,t)=>{bt(e,t),Fe(e,t),_t(e,t),Ze(e,t),ot(e,t),Ct(e,t),Me(e,t),$e(e,t),Pe(e,t),Je(e,t);const n=E();"function"===typeof t.didRender&&n&&t.didRender(n),s.eventEmitter.emit("didRender",n)},Et=()=>de(E()),Tt=()=>{var e;return null===(e=M())||void 0===e?void 0:e.click()},kt=()=>{var e;return null===(e=D())||void 0===e?void 0:e.click()},Pt=()=>{var e;return null===(e=F())||void 0===e?void 0:e.click()},It=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Rt=e=>{e.keydownTarget&&e.keydownHandlerAdded&&(e.keydownTarget.removeEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!1)},Nt=(e,t,n)=>{Rt(e),t.toast||(e.keydownHandler=e=>Dt(t,e,n),e.keydownTarget=t.keydownListenerCapture?window:E(),e.keydownListenerCapture=t.keydownListenerCapture,e.keydownTarget.addEventListener("keydown",e.keydownHandler,{capture:e.keydownListenerCapture}),e.keydownHandlerAdded=!0)},Ot=(e,t)=>{var n;const r=W();if(r.length)return-2===(e+=t)&&(e=r.length-1),e===r.length?e=0:-1===e&&(e=r.length-1),void r[e].focus();null===(n=E())||void 0===n||n.focus()},Mt=["ArrowRight","ArrowDown"],Ft=["ArrowLeft","ArrowUp"],Dt=(e,t,n)=>{e&&(t.isComposing||229===t.keyCode||(e.stopKeydownPropagation&&t.stopPropagation(),"Enter"===t.key?Lt(t,e):"Tab"===t.key?jt(t):[...Mt,...Ft].includes(t.key)?Bt(t.key):"Escape"===t.key&&Ut(t,e,n)))},Lt=(e,t)=>{if(!b(t.allowEnterKey))return;const n=J(E(),t.input);if(e.target&&n&&e.target instanceof HTMLElement&&e.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(t.input))return;Tt(),e.preventDefault()}},jt=e=>{const t=e.target,n=W();let r=-1;for(let a=0;a<n.length;a++)if(t===n[a]){r=a;break}e.shiftKey?Ot(r,-1):Ot(r,1),e.stopPropagation(),e.preventDefault()},Bt=e=>{const t=B(),n=M(),r=D(),a=F();if(!t||!n||!r||!a)return;const i=[n,r,a];if(document.activeElement instanceof HTMLElement&&!i.includes(document.activeElement))return;const s=Mt.includes(e)?"nextElementSibling":"previousElementSibling";let o=document.activeElement;if(o){for(let e=0;e<t.children.length;e++){if(o=o[s],!o)return;if(o instanceof HTMLButtonElement&&de(o))break}o instanceof HTMLButtonElement&&o.focus()}},Ut=(e,t,n)=>{e.preventDefault(),b(t.allowEscapeKey)&&n(It.esc)};var Gt={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Ht=()=>{const e=S();Array.from(document.body.children).forEach(t=>{t.contains(e)||(t.hasAttribute("aria-hidden")&&t.setAttribute("data-previous-aria-hidden",t.getAttribute("aria-hidden")||""),t.setAttribute("aria-hidden","true"))})},zt=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},Wt="undefined"!==typeof window&&!!window.GestureEvent,qt=()=>{if(Wt&&!X(document.body,d.iosfix)){const e=document.body.scrollTop;document.body.style.top="".concat(-1*e,"px"),te(document.body,d.iosfix),Vt()}},Vt=()=>{const e=S();if(!e)return;let t;e.ontouchstart=e=>{t=Kt(e)},e.ontouchmove=e=>{t&&(e.preventDefault(),e.stopPropagation())}},Kt=e=>{const t=e.target,n=S(),r=I();return!(!n||!r)&&!Yt(e)&&!Xt(e)&&(t===n||!(he(n)||!(t instanceof HTMLElement)||pe(t,r)||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||he(r)&&r.contains(t)))},Yt=e=>e.touches&&e.touches.length&&"stylus"===e.touches[0].touchType,Xt=e=>e.touches&&e.touches.length>1,Qt=()=>{if(X(document.body,d.iosfix)){const e=parseInt(document.body.style.top,10);ne(document.body,d.iosfix),document.body.style.top="",document.body.scrollTop=-1*e}},$t=()=>{const e=document.createElement("div");e.className=d["scrollbar-measure"],document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t};let Jt=null;const Zt=e=>{null===Jt&&(document.body.scrollHeight>window.innerHeight||"scroll"===e)&&(Jt=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(Jt+$t(),"px"))},en=()=>{null!==Jt&&(document.body.style.paddingRight="".concat(Jt,"px"),Jt=null)};function tn(e,t,n,r){V()?un(e,r):(l(n).then(()=>un(e,r)),Rt(s)),Wt?(t.setAttribute("style","display:none !important"),t.removeAttribute("class"),t.innerHTML=""):t.remove(),q()&&(en(),Qt(),zt()),nn()}function nn(){ne([document.documentElement,document.body],[d.shown,d["height-auto"],d["no-backdrop"],d["toast-shown"]])}function rn(e){e=ln(e);const t=Gt.swalPromiseResolve.get(this),n=an(this);this.isAwaitingPromise?e.isDismissed||(on(this),t(e)):n&&t(e)}const an=e=>{const t=E();if(!t)return!1;const n=Be.innerParams.get(e);if(!n||X(t,n.hideClass.popup))return!1;ne(t,n.showClass.popup),te(t,n.hideClass.popup);const r=S();return ne(r,n.showClass.backdrop),te(r,n.hideClass.backdrop),cn(e,t,n),!0};function sn(e){const t=Gt.swalPromiseReject.get(this);on(this),t&&t(e)}const on=e=>{e.isAwaitingPromise&&(delete e.isAwaitingPromise,Be.innerParams.get(e)||e._destroy())},ln=e=>"undefined"===typeof e?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},e),cn=(e,t,n)=>{var r;const a=S(),i=fe(t);"function"===typeof n.willClose&&n.willClose(t),null===(r=s.eventEmitter)||void 0===r||r.emit("willClose",t),i?dn(e,t,a,n.returnFocus,n.didClose):tn(e,a,n.returnFocus,n.didClose)},dn=(e,t,n,r,a)=>{s.swalCloseEventFinishedCallback=tn.bind(null,e,n,r,a);const i=function(e){var n;e.target===t&&(null===(n=s.swalCloseEventFinishedCallback)||void 0===n||n.call(s),delete s.swalCloseEventFinishedCallback,t.removeEventListener("animationend",i),t.removeEventListener("transitionend",i))};t.addEventListener("animationend",i),t.addEventListener("transitionend",i)},un=(e,t)=>{setTimeout(()=>{var n;"function"===typeof t&&t.bind(e.params)(),null===(n=s.eventEmitter)||void 0===n||n.emit("didClose"),e._destroy&&e._destroy()})},hn=e=>{let t=E();if(t||new ma,t=E(),!t)return;const n=j();V()?se(T()):pn(t,e),ie(n),t.setAttribute("data-loading","true"),t.setAttribute("aria-busy","true"),t.focus()},pn=(e,t)=>{const n=B(),r=j();n&&r&&(!t&&de(M())&&(t=M()),ie(n),t&&(se(t),r.setAttribute("data-button-to-replace",t.className),n.insertBefore(r,t)),te([e,n],d.loading))},fn=(e,t)=>{"select"===t.input||"radio"===t.input?bn(e,t):["text","email","number","tel","textarea"].some(e=>e===t.input)&&(w(t.inputValue)||A(t.inputValue))&&(hn(M()),wn(e,t))},mn=(e,t)=>{const n=e.getInput();if(!n)return null;switch(t.input){case"checkbox":return gn(n);case"radio":return vn(n);case"file":return yn(n);default:return t.inputAutoTrim?n.value.trim():n.value}},gn=e=>e.checked?1:0,vn=e=>e.checked?e.value:null,yn=e=>e.files&&e.files.length?null!==e.getAttribute("multiple")?e.files:e.files[0]:null,bn=(e,t)=>{const n=E();if(!n)return;const r=e=>{"select"===t.input?_n(n,Sn(e),t):"radio"===t.input&&An(n,Sn(e),t)};w(t.inputOptions)||A(t.inputOptions)?(hn(M()),_(t.inputOptions).then(t=>{e.hideLoading(),r(t)})):"object"===typeof t.inputOptions?r(t.inputOptions):m("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(typeof t.inputOptions))},wn=(e,t)=>{const n=e.getInput();n&&(se(n),_(t.inputValue).then(r=>{n.value="number"===t.input?"".concat(parseFloat(r)||0):"".concat(r),ie(n),n.focus(),e.hideLoading()}).catch(t=>{m("Error in inputValue promise: ".concat(t)),n.value="",ie(n),n.focus(),e.hideLoading()}))};function _n(e,t,n){const r=re(e,d.select);if(!r)return;const a=(e,t,r)=>{const a=document.createElement("option");a.value=r,Y(a,t),a.selected=Cn(r,n.inputValue),e.appendChild(a)};t.forEach(e=>{const t=e[0],n=e[1];if(Array.isArray(n)){const e=document.createElement("optgroup");e.label=t,e.disabled=!1,r.appendChild(e),n.forEach(t=>a(e,t[1],t[0]))}else a(r,n,t)}),r.focus()}function An(e,t,n){const r=re(e,d.radio);if(!r)return;t.forEach(e=>{const t=e[0],a=e[1],i=document.createElement("input"),s=document.createElement("label");i.type="radio",i.name=d.radio,i.value=t,Cn(t,n.inputValue)&&(i.checked=!0);const o=document.createElement("span");Y(o,a),o.className=d.label,s.appendChild(i),s.appendChild(o),r.appendChild(s)});const a=r.querySelectorAll("input");a.length&&a[0].focus()}const Sn=e=>{const t=[];return e instanceof Map?e.forEach((e,n)=>{let r=e;"object"===typeof r&&(r=Sn(r)),t.push([n,r])}):Object.keys(e).forEach(n=>{let r=e[n];"object"===typeof r&&(r=Sn(r)),t.push([n,r])}),t},Cn=(e,t)=>!!t&&t.toString()===e.toString(),xn=e=>{const t=Be.innerParams.get(e);e.disableButtons(),t.input?kn(e,"confirm"):On(e,!0)},En=e=>{const t=Be.innerParams.get(e);e.disableButtons(),t.returnInputValueOnDeny?kn(e,"deny"):In(e,!1)},Tn=(e,t)=>{e.disableButtons(),t(It.cancel)},kn=(e,t)=>{const n=Be.innerParams.get(e);if(!n.input)return void m('The "input" parameter is needed to be set when using returnInputValueOn'.concat(p(t)));const r=e.getInput(),a=mn(e,n);n.inputValidator?Pn(e,a,t):r&&!r.checkValidity()?(e.enableButtons(),e.showValidationMessage(n.validationMessage||r.validationMessage)):"deny"===t?In(e,a):On(e,a)},Pn=(e,t,n)=>{const r=Be.innerParams.get(e);e.disableInput(),Promise.resolve().then(()=>_(r.inputValidator(t,r.validationMessage))).then(r=>{e.enableButtons(),e.enableInput(),r?e.showValidationMessage(r):"deny"===n?In(e,t):On(e,t)})},In=(e,t)=>{const n=Be.innerParams.get(e||void 0);n.showLoaderOnDeny&&hn(D()),n.preDeny?(e.isAwaitingPromise=!0,Promise.resolve().then(()=>_(n.preDeny(t,n.validationMessage))).then(n=>{!1===n?(e.hideLoading(),on(e)):e.close({isDenied:!0,value:"undefined"===typeof n?t:n})}).catch(t=>Nn(e||void 0,t))):e.close({isDenied:!0,value:t})},Rn=(e,t)=>{e.close({isConfirmed:!0,value:t})},Nn=(e,t)=>{e.rejectPromise(t)},On=(e,t)=>{const n=Be.innerParams.get(e||void 0);n.showLoaderOnConfirm&&hn(),n.preConfirm?(e.resetValidationMessage(),e.isAwaitingPromise=!0,Promise.resolve().then(()=>_(n.preConfirm(t,n.validationMessage))).then(n=>{de(O())||!1===n?(e.hideLoading(),on(e)):Rn(e,"undefined"===typeof n?t:n)}).catch(t=>Nn(e||void 0,t))):Rn(e,t)};function Mn(){const e=Be.innerParams.get(this);if(!e)return;const t=Be.domCache.get(this);se(t.loader),V()?e.icon&&ie(T()):Fn(t),ne([t.popup,t.actions],d.loading),t.popup.removeAttribute("aria-busy"),t.popup.removeAttribute("data-loading"),t.confirmButton.disabled=!1,t.denyButton.disabled=!1,t.cancelButton.disabled=!1}const Fn=e=>{const t=e.popup.getElementsByClassName(e.loader.getAttribute("data-button-to-replace"));t.length?ie(t[0],"inline-block"):ue()&&se(e.actions)};function Dn(){const e=Be.innerParams.get(this),t=Be.domCache.get(this);return t?J(t.popup,e.input):null}function Ln(e,t,n){const r=Be.domCache.get(e);t.forEach(e=>{r[e].disabled=n})}function jn(e,t){const n=E();if(n&&e)if("radio"===e.type){const e=n.querySelectorAll('[name="'.concat(d.radio,'"]'));for(let n=0;n<e.length;n++)e[n].disabled=t}else e.disabled=t}function Bn(){Ln(this,["confirmButton","denyButton","cancelButton"],!1)}function Un(){Ln(this,["confirmButton","denyButton","cancelButton"],!0)}function Gn(){jn(this.getInput(),!1)}function Hn(){jn(this.getInput(),!0)}function zn(e){const t=Be.domCache.get(this),n=Be.innerParams.get(this);Y(t.validationMessage,e),t.validationMessage.className=d["validation-message"],n.customClass&&n.customClass.validationMessage&&te(t.validationMessage,n.customClass.validationMessage),ie(t.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",d["validation-message"]),Z(r),te(r,d.inputerror))}function Wn(){const e=Be.domCache.get(this);e.validationMessage&&se(e.validationMessage);const t=this.getInput();t&&(t.removeAttribute("aria-invalid"),t.removeAttribute("aria-describedby"),ne(t,d.inputerror))}const qn={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Vn=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],Kn={allowEnterKey:void 0},Yn=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Xn=e=>Object.prototype.hasOwnProperty.call(qn,e),Qn=e=>-1!==Vn.indexOf(e),$n=e=>Kn[e],Jn=e=>{Xn(e)||f('Unknown parameter "'.concat(e,'"'))},Zn=e=>{Yn.includes(e)&&f('The parameter "'.concat(e,'" is incompatible with toasts'))},er=e=>{const t=$n(e);t&&y(e,t)},tr=e=>{!1===e.backdrop&&e.allowOutsideClick&&f('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),e.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(e.theme)&&f('Invalid theme "'.concat(e.theme,'"'));for(const t in e)Jn(t),e.toast&&Zn(t),er(t)};function nr(e){const t=S(),n=E(),r=Be.innerParams.get(this);if(!n||X(n,r.hideClass.popup))return void f("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const a=rr(e),i=Object.assign({},r,a);tr(i),t.dataset.swal2Theme=i.theme,xt(this,i),Be.innerParams.set(this,i),Object.defineProperties(this,{params:{value:Object.assign({},this.params,e),writable:!1,enumerable:!0}})}const rr=e=>{const t={};return Object.keys(e).forEach(n=>{Qn(n)?t[n]=e[n]:f("Invalid parameter to update: ".concat(n))}),t};function ar(){const e=Be.domCache.get(this),t=Be.innerParams.get(this);t?(e.popup&&s.swalCloseEventFinishedCallback&&(s.swalCloseEventFinishedCallback(),delete s.swalCloseEventFinishedCallback),"function"===typeof t.didDestroy&&t.didDestroy(),s.eventEmitter.emit("didDestroy"),ir(this)):sr(this)}const ir=e=>{sr(e),delete e.params,delete s.keydownHandler,delete s.keydownTarget,delete s.currentInstance},sr=e=>{e.isAwaitingPromise?(or(Be,e),e.isAwaitingPromise=!0):(or(Gt,e),or(Be,e),delete e.isAwaitingPromise,delete e.disableButtons,delete e.enableButtons,delete e.getInput,delete e.disableInput,delete e.enableInput,delete e.hideLoading,delete e.disableLoading,delete e.showValidationMessage,delete e.resetValidationMessage,delete e.close,delete e.closePopup,delete e.closeModal,delete e.closeToast,delete e.rejectPromise,delete e.update,delete e._destroy)},or=(e,t)=>{for(const n in e)e[n].delete(t)};var lr=Object.freeze({__proto__:null,_destroy:ar,close:rn,closeModal:rn,closePopup:rn,closeToast:rn,disableButtons:Un,disableInput:Hn,disableLoading:Mn,enableButtons:Bn,enableInput:Gn,getInput:Dn,handleAwaitingPromise:on,hideLoading:Mn,rejectPromise:sn,resetValidationMessage:Wn,showValidationMessage:zn,update:nr});const cr=(e,t,n)=>{e.toast?dr(e,t,n):(pr(t),fr(t),mr(e,t,n))},dr=(e,t,n)=>{t.popup.onclick=()=>{e&&(ur(e)||e.timer||e.input)||n(It.close)}},ur=e=>!!(e.showConfirmButton||e.showDenyButton||e.showCancelButton||e.showCloseButton);let hr=!1;const pr=e=>{e.popup.onmousedown=()=>{e.container.onmouseup=function(t){e.container.onmouseup=()=>{},t.target===e.container&&(hr=!0)}}},fr=e=>{e.container.onmousedown=t=>{t.target===e.container&&t.preventDefault(),e.popup.onmouseup=function(t){e.popup.onmouseup=()=>{},(t.target===e.popup||t.target instanceof HTMLElement&&e.popup.contains(t.target))&&(hr=!0)}}},mr=(e,t,n)=>{t.container.onclick=r=>{hr?hr=!1:r.target===t.container&&b(e.allowOutsideClick)&&n(It.backdrop)}},gr=e=>"object"===typeof e&&e.jquery,vr=e=>e instanceof Element||gr(e),yr=e=>{const t={};return"object"!==typeof e[0]||vr(e[0])?["title","html","icon"].forEach((n,r)=>{const a=e[r];"string"===typeof a||vr(a)?t[n]=a:void 0!==a&&m("Unexpected type of ".concat(n,'! Expected "string" or "Element", got ').concat(typeof a))}):Object.assign(t,e[0]),t};function br(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new this(...t)}function wr(e){class t extends(this){_main(t,n){return super._main(t,Object.assign({},e,n))}}return t}const _r=()=>s.timeout&&s.timeout.getTimerLeft(),Ar=()=>{if(s.timeout)return ge(),s.timeout.stop()},Sr=()=>{if(s.timeout){const e=s.timeout.start();return me(e),e}},Cr=()=>{const e=s.timeout;return e&&(e.running?Ar():Sr())},xr=e=>{if(s.timeout){const t=s.timeout.increase(e);return me(t,!0),t}},Er=()=>!(!s.timeout||!s.timeout.isRunning());let Tr=!1;const kr={};function Pr(){kr[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Tr||(document.body.addEventListener("click",Ir),Tr=!0)}const Ir=e=>{for(let t=e.target;t&&t!==document;t=t.parentNode)for(const e in kr){const n=t.getAttribute(e);if(n)return void kr[e].fire({template:n})}};class Rr{constructor(){this.events={}}_getHandlersByEventName(e){return"undefined"===typeof this.events[e]&&(this.events[e]=[]),this.events[e]}on(e,t){const n=this._getHandlersByEventName(e);n.includes(t)||n.push(t)}once(e,t){var n=this;const r=function(){n.removeListener(e,r);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];t.apply(n,i)};this.on(e,r)}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._getHandlersByEventName(e).forEach(e=>{try{e.apply(this,n)}catch(m){console.error(m)}})}removeListener(e,t){const n=this._getHandlersByEventName(e),r=n.indexOf(t);r>-1&&n.splice(r,1)}removeAllListeners(e){void 0!==this.events[e]&&(this.events[e].length=0)}reset(){this.events={}}}s.eventEmitter=new Rr;const Nr=(e,t)=>{s.eventEmitter.on(e,t)},Or=(e,t)=>{s.eventEmitter.once(e,t)},Mr=(e,t)=>{e?t?s.eventEmitter.removeListener(e,t):s.eventEmitter.removeAllListeners(e):s.eventEmitter.reset()};var Fr=Object.freeze({__proto__:null,argsToParams:yr,bindClickHandler:Pr,clickCancel:Pt,clickConfirm:Tt,clickDeny:kt,enableLoading:hn,fire:br,getActions:B,getCancelButton:F,getCloseButton:H,getConfirmButton:M,getContainer:S,getDenyButton:D,getFocusableElements:W,getFooter:U,getHtmlContainer:I,getIcon:T,getIconContent:k,getImage:R,getInputLabel:L,getLoader:j,getPopup:E,getProgressSteps:N,getTimerLeft:_r,getTimerProgressBar:G,getTitle:P,getValidationMessage:O,increaseTimer:xr,isDeprecatedParameter:$n,isLoading:K,isTimerRunning:Er,isUpdatableParameter:Qn,isValidParameter:Xn,isVisible:Et,mixin:wr,off:Mr,on:Nr,once:Or,resumeTimer:Sr,showLoading:hn,stopTimer:Ar,toggleTimer:Cr});class Dr{constructor(e,t){this.callback=e,this.remaining=t,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(e){const t=this.running;return t&&this.stop(),this.remaining+=e,t&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Lr=["swal-title","swal-html","swal-footer"],jr=e=>{const t="string"===typeof e.template?document.querySelector(e.template):e.template;if(!t)return{};const n=t.content;return Vr(n),Object.assign(Br(n),Ur(n),Gr(n),Hr(n),zr(n),Wr(n),qr(n,Lr))},Br=e=>{const t={};return Array.from(e.querySelectorAll("swal-param")).forEach(e=>{Kr(e,["name","value"]);const n=e.getAttribute("name"),r=e.getAttribute("value");n&&r&&("boolean"===typeof qn[n]?t[n]="false"!==r:"object"===typeof qn[n]?t[n]=JSON.parse(r):t[n]=r)}),t},Ur=e=>{const t={};return Array.from(e.querySelectorAll("swal-function-param")).forEach(e=>{const n=e.getAttribute("name"),r=e.getAttribute("value");n&&r&&(t[n]=new Function("return ".concat(r))())}),t},Gr=e=>{const t={};return Array.from(e.querySelectorAll("swal-button")).forEach(e=>{Kr(e,["type","color","aria-label"]);const n=e.getAttribute("type");n&&["confirm","cancel","deny"].includes(n)&&(t["".concat(n,"ButtonText")]=e.innerHTML,t["show".concat(p(n),"Button")]=!0,e.hasAttribute("color")&&(t["".concat(n,"ButtonColor")]=e.getAttribute("color")),e.hasAttribute("aria-label")&&(t["".concat(n,"ButtonAriaLabel")]=e.getAttribute("aria-label")))}),t},Hr=e=>{const t={},n=e.querySelector("swal-image");return n&&(Kr(n,["src","width","height","alt"]),n.hasAttribute("src")&&(t.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(t.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(t.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(t.imageAlt=n.getAttribute("alt")||void 0)),t},zr=e=>{const t={},n=e.querySelector("swal-icon");return n&&(Kr(n,["type","color"]),n.hasAttribute("type")&&(t.icon=n.getAttribute("type")),n.hasAttribute("color")&&(t.iconColor=n.getAttribute("color")),t.iconHtml=n.innerHTML),t},Wr=e=>{const t={},n=e.querySelector("swal-input");n&&(Kr(n,["type","label","placeholder","value"]),t.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(t.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(t.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(t.inputValue=n.getAttribute("value")));const r=Array.from(e.querySelectorAll("swal-input-option"));return r.length&&(t.inputOptions={},r.forEach(e=>{Kr(e,["value"]);const n=e.getAttribute("value");if(!n)return;const r=e.innerHTML;t.inputOptions[n]=r})),t},qr=(e,t)=>{const n={};for(const r in t){const a=t[r],i=e.querySelector(a);i&&(Kr(i,[]),n[a.replace(/^swal-/,"")]=i.innerHTML.trim())}return n},Vr=e=>{const t=Lr.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(e.children).forEach(e=>{const n=e.tagName.toLowerCase();t.includes(n)||f("Unrecognized element <".concat(n,">"))})},Kr=(e,t)=>{Array.from(e.attributes).forEach(n=>{-1===t.indexOf(n.name)&&f(['Unrecognized attribute "'.concat(n.name,'" on <').concat(e.tagName.toLowerCase(),">."),"".concat(t.length?"Allowed attributes are: ".concat(t.join(", ")):"To set the value, use HTML within the element.")])})},Yr=10,Xr=e=>{const t=S(),n=E();"function"===typeof e.willOpen&&e.willOpen(n),s.eventEmitter.emit("willOpen",n);const r=window.getComputedStyle(document.body).overflowY;Zr(t,n,e),setTimeout(()=>{$r(t,n)},Yr),q()&&(Jr(t,e.scrollbarPadding,r),Ht()),V()||s.previousActiveElement||(s.previousActiveElement=document.activeElement),"function"===typeof e.didOpen&&setTimeout(()=>e.didOpen(n)),s.eventEmitter.emit("didOpen",n)},Qr=e=>{const t=E();if(e.target!==t)return;const n=S();t.removeEventListener("animationend",Qr),t.removeEventListener("transitionend",Qr),n.style.overflowY="auto",ne(n,d["no-transition"])},$r=(e,t)=>{fe(t)?(e.style.overflowY="hidden",t.addEventListener("animationend",Qr),t.addEventListener("transitionend",Qr)):e.style.overflowY="auto"},Jr=(e,t,n)=>{qt(),t&&"hidden"!==n&&Zt(n),setTimeout(()=>{e.scrollTop=0})},Zr=(e,t,n)=>{te(e,n.showClass.backdrop),n.animation?(t.style.setProperty("opacity","0","important"),ie(t,"grid"),setTimeout(()=>{te(t,n.showClass.popup),t.style.removeProperty("opacity")},Yr)):ie(t,"grid"),te([document.documentElement,document.body],d.shown),n.heightAuto&&n.backdrop&&!n.toast&&te([document.documentElement,document.body],d["height-auto"])};var ea={email:(e,t)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid email address"),url:(e,t)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(e)?Promise.resolve():Promise.resolve(t||"Invalid URL")};function ta(e){e.inputValidator||("email"===e.input&&(e.inputValidator=ea.email),"url"===e.input&&(e.inputValidator=ea.url))}function na(e){(!e.target||"string"===typeof e.target&&!document.querySelector(e.target)||"string"!==typeof e.target&&!e.target.appendChild)&&(f('Target parameter is not valid, defaulting to "body"'),e.target="body")}function ra(e){ta(e),e.showLoaderOnConfirm&&!e.preConfirm&&f("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),na(e),"string"===typeof e.title&&(e.title=e.title.split("\n").join("<br />")),xe(e)}let aa;var ia=new WeakMap;class sa{constructor(){if(r(this,ia,void 0),"undefined"===typeof window)return;aa=this;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=Object.freeze(this.constructor.argsToParams(t));this.params=i,this.isAwaitingPromise=!1,a(ia,this,this._main(aa.params))}_main(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(tr(Object.assign({},t,e)),s.currentInstance){const e=Gt.swalPromiseResolve.get(s.currentInstance),{isAwaitingPromise:t}=s.currentInstance;s.currentInstance._destroy(),t||e({isDismissed:!0}),q()&&zt()}s.currentInstance=aa;const n=la(e,t);ra(n),Object.freeze(n),s.timeout&&(s.timeout.stop(),delete s.timeout),clearTimeout(s.restoreFocusTimeout);const r=ca(aa);return xt(aa,n),Be.innerParams.set(aa,n),oa(aa,r,n)}then(e){return n(ia,this).then(e)}finally(e){return n(ia,this).finally(e)}}const oa=(e,t,n)=>new Promise((r,a)=>{const i=t=>{e.close({isDismissed:!0,dismiss:t,isConfirmed:!1,isDenied:!1})};Gt.swalPromiseResolve.set(e,r),Gt.swalPromiseReject.set(e,a),t.confirmButton.onclick=()=>{xn(e)},t.denyButton.onclick=()=>{En(e)},t.cancelButton.onclick=()=>{Tn(e,i)},t.closeButton.onclick=()=>{i(It.close)},cr(n,t,i),Nt(s,n,i),fn(e,n),Xr(n),da(s,n,i),ua(t,n),setTimeout(()=>{t.container.scrollTop=0})}),la=(e,t)=>{const n=jr(e),r=Object.assign({},qn,t,n,e);return r.showClass=Object.assign({},qn.showClass,r.showClass),r.hideClass=Object.assign({},qn.hideClass,r.hideClass),!1===r.animation&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},ca=e=>{const t={popup:E(),container:S(),actions:B(),confirmButton:M(),denyButton:D(),cancelButton:F(),loader:j(),closeButton:H(),validationMessage:O(),progressSteps:N()};return Be.domCache.set(e,t),t},da=(e,t,n)=>{const r=G();se(r),t.timer&&(e.timeout=new Dr(()=>{n("timer"),delete e.timeout},t.timer),t.timerProgressBar&&(ie(r),$(r,t,"timerProgressBar"),setTimeout(()=>{e.timeout&&e.timeout.running&&me(t.timer)})))},ua=(e,t)=>{if(!t.toast)return b(t.allowEnterKey)?void(ha(e)||pa(e,t)||Ot(-1,1)):(y("allowEnterKey"),void fa())},ha=e=>{const t=Array.from(e.popup.querySelectorAll("[autofocus]"));for(const n of t)if(n instanceof HTMLElement&&de(n))return n.focus(),!0;return!1},pa=(e,t)=>t.focusDeny&&de(e.denyButton)?(e.denyButton.focus(),!0):t.focusCancel&&de(e.cancelButton)?(e.cancelButton.focus(),!0):!(!t.focusConfirm||!de(e.confirmButton))&&(e.confirmButton.focus(),!0),fa=()=>{document.activeElement instanceof HTMLElement&&"function"===typeof document.activeElement.blur&&document.activeElement.blur()};sa.prototype.disableButtons=Un,sa.prototype.enableButtons=Bn,sa.prototype.getInput=Dn,sa.prototype.disableInput=Hn,sa.prototype.enableInput=Gn,sa.prototype.hideLoading=Mn,sa.prototype.disableLoading=Mn,sa.prototype.showValidationMessage=zn,sa.prototype.resetValidationMessage=Wn,sa.prototype.close=rn,sa.prototype.closePopup=rn,sa.prototype.closeModal=rn,sa.prototype.closeToast=rn,sa.prototype.rejectPromise=sn,sa.prototype.update=nr,sa.prototype._destroy=ar,Object.assign(sa,Fr),Object.keys(lr).forEach(e=>{sa[e]=function(){return aa&&aa[e]?aa[e](...arguments):null}}),sa.DismissReason=It,sa.version="11.26.3";const ma=sa;return ma.default=ma,ma}(),"undefined"!==typeof this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(e,t){var n=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=t);else try{n.innerHTML=t}catch(e){n.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}')},4852:(e,t,n)=>{"use strict";n.d(t,{Si:()=>A,ec:()=>h});var r=n(2555),a=n(9950),i=n(6142);var s=n(4641),o=n(4239),l=n(2935),c=n(4414);const d={role:"Employee",canSeeAdmin:!1,canEditAdmin:!1,isSuperAdmin:!1,perms:{}},u=(0,a.createContext)(d),h=()=>(0,a.useContext)(u),p={Admin:{groups:["Sunbeth-Portal-Admins","HR-Managers"]},Manager:{groups:["Sunbeth-Dept-Managers"]},Employee:{groups:["Sunbeth-Employees"]}},f=e=>{const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}[e];return t?t.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0):[]},m=f("REACT_APP_SUPER_ADMINS"),g=f("REACT_APP_ADMINS"),v=f("REACT_APP_MANAGERS");let y=[],b=[],w=[];const _=(e,t)=>{const n=e.toLowerCase();return y.includes(n)||m.includes(n)?"SuperAdmin":b.includes(n)||g.includes(n)?"Admin":w.includes(n)||v.includes(n)?"Manager":t.some(e=>p.Admin.groups.includes(e))?"Admin":t.some(e=>p.Manager.groups.includes(e))?"Manager":"Employee"},A=e=>{let{children:t}=e;const{token:d,account:h}=(0,i.As)(),[p,f]=(0,a.useState)("Employee"),[m,g]=(0,a.useState)({});(0,a.useEffect)(()=>{if(!d||!h)return void f("Employee");let e=!0;const t=h.username||"";return(async()=>{try{if((0,l.Kr)()){const t=await(0,s.O0)();if(!e)return;y=t.filter(e=>"SuperAdmin"===e.role).map(e=>e.email.toLowerCase()),b=t.filter(e=>"Admin"===e.role).map(e=>e.email.toLowerCase()),w=t.filter(e=>"Manager"===e.role).map(e=>e.email.toLowerCase())}else y=[],b=[],w=[]}catch(r){}if(t){const n=_(t,[]);"Employee"!==n&&e&&f(n)}try{const r=await(async e=>{var t;const{default:r}=await n.e(453).then(n.bind(n,9453));return((null===(t=(await r.get("https://graph.microsoft.com/v1.0/me/transitiveMemberOf?$select=displayName",{headers:{Authorization:"Bearer ".concat(e)}})).data)||void 0===t?void 0:t.value)||[]).map(e=>e.displayName)})(d);if(!e)return;const a=_(t,r);f(a)}catch(a){e&&!t&&f("Employee")}})(),()=>{e=!1}},[d,h]),(0,a.useEffect)(()=>{let e=!1;return(async()=>{const t=(null===h||void 0===h?void 0:h.username)||"",n=(0,l.Kr)();try{if(n&&t){const n=await(0,o.aE)(t);return void(e||g(n.permissions||{}))}}catch(a){}try{const t=await(0,o.PQ)().catch(()=>[]),n=Array.isArray(t)&&t.length>0?t.map(e=>e.key):["viewAdmin","manageSettings","viewDebugLogs","exportAnalytics","viewAnalytics","createBatch","editBatch","deleteBatch","manageRecipients","manageDocuments","sendNotifications","uploadDocuments","manageBusinesses","manageRoles","managePermissions"],a=Object.fromEntries(n.map(e=>[e,!0])),i=Object.fromEntries(n.map(e=>[e,!1]));let s=i;if("SuperAdmin"===p)s=a;else if("Admin"===p)s=(0,r.A)((0,r.A)({},a),{},{deleteBatch:!0});else if("Manager"===p){s=(0,r.A)({},i);const e=["viewAdmin","viewAnalytics","exportAnalytics","createBatch","editBatch","manageRecipients","manageDocuments","sendNotifications","uploadDocuments"];for(const t of e)s[t]=!0}e||g(s)}catch(i){}})(),()=>{e=!0}},[p,h]);const v=(0,a.useMemo)(()=>({role:p,canSeeAdmin:"SuperAdmin"===p||"Admin"===p||"Manager"===p,canEditAdmin:"SuperAdmin"===p||"Admin"===p,isSuperAdmin:"SuperAdmin"===p,perms:m}),[p,m]);return(0,c.jsx)(u.Provider,{value:v,children:t})}},5217:(e,t,n)=>{"use strict";n.d(t,{N:()=>o,b:()=>c});var r=n(9950),a=n(4414);const i={user:null,isAuthenticated:!1,login:()=>{},logout:()=>{}},s=(0,r.createContext)(i),o=()=>(0,r.useContext)(s),l="sunbeth:externalAuth",c=e=>{let{children:t}=e;const[n,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{try{const t=localStorage.getItem(l);if(t){const n=JSON.parse(t);var e;if(n&&"string"===typeof n.email)i({email:n.email,name:null!==(e=n.name)&&void 0!==e?e:null})}}catch(t){}},[]),(0,r.useEffect)(()=>{try{n?localStorage.setItem(l,JSON.stringify(n)):localStorage.removeItem(l)}catch(e){}},[n]);const o=e=>i(e),c=()=>i(null),d=(0,r.useMemo)(()=>({user:n,isAuthenticated:!!n,login:o,logout:c}),[n]);return(0,a.jsx)(s.Provider,{value:d,children:t})}},5340:(e,t,n)=>{"use strict";e.exports=n(1761)},6142:(e,t,n)=>{"use strict";n.d(t,{As:()=>u,OJ:()=>h});var r=n(9950),a=n(9955),i=n(1298),s=n(2746),o=n(6374),l=n(4414);const c={account:null,token:null,photo:null,login:async()=>{},logout:async()=>{},getToken:async()=>null},d=(0,r.createContext)(c),u=()=>(0,r.useContext)(d),h=e=>{let{children:t}=e;const[n,c]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),m="sunbeth:suppressAutoLogin",[g,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{((()=>{try{const e=window.location.hash||"",t=window.location.search||"";return/[?#&](code|error|id_token)=/.test(e)||/[?#&](code|error|id_token)=/.test(t)}catch(e){return!1}})()?a.msalInstance.handleRedirectPromise():Promise.resolve(null)).then(e=>{if(e&&e.account){(0,s.pq)("AuthContext handleRedirectPromise: account present",{username:e.account.username});try{localStorage.removeItem(m)}catch(t){}a.msalInstance.setActiveAccount(e.account),a.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:e.account}).then(t=>{h(t.accessToken),c(e.account),(0,s.pq)("AuthContext redirect: token acquired, account attached")}).catch(async t=>{(0,s.R8)("AuthContext redirect: token acquisition failed (silent). Attempting popup fallback.",t);try{const t=await a.msalInstance.acquireTokenPopup({scopes:["User.Read"]});h(t.accessToken),c(e.account),(0,s.pq)("AuthContext redirect: popup token acquired, account attached")}catch(n){(0,s.z3)("AuthContext redirect: popup token acquisition failed",n)}})}}).catch(e=>{(0,s.R8)("handleRedirectPromise error",e)})}catch(n){}let e=!1;try{e="true"===localStorage.getItem(m)}catch(r){}if(e)return void(0,s.pq)("AuthContext: auto-login suppressed (skipping cached account attach)");(0,s.pq)("AuthContext checking MSAL accounts");const t=a.msalInstance.getAllAccounts();t.length>0&&((0,s.pq)("AuthContext found existing account",{count:t.length}),a.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:t[0]}).then(e=>{h(e.accessToken),c(t[0]),(0,s.pq)("AuthContext attached cached account with token")}).catch(()=>{(0,s.pq)("AuthContext: cached account exists but token acquisition failed; awaiting manual login")}))},[]),(0,r.useEffect)(()=>{n&&((0,s.pq)("AuthContext acquiring token silently",{account:n.username}),a.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:n}).then(e=>{(0,s.pq)("AuthContext acquired token silently"),h(e.accessToken)}).catch(async e=>{(0,s.R8)("acquireTokenSilent failed, falling back to popup",e);try{const e=await a.msalInstance.acquireTokenPopup({scopes:["User.Read"]});h(e.accessToken),(0,s.pq)("AuthContext acquired token via popup")}catch(t){(0,s.z3)("acquireTokenPopup failed",t)}}))},[n]),(0,r.useEffect)(()=>{if(!u)return;let e=!0,t=null;return(async()=>{try{const n=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:"Bearer ".concat(u)}});if(!n.ok)return void f(null);const r=await n.blob();t=URL.createObjectURL(r),e&&f(t)}catch(n){e&&f(null)}})(),()=>{e=!1,t&&URL.revokeObjectURL(t)}},[u]);return(0,l.jsx)(d.Provider,{value:{account:n,token:u,photo:p,login:async()=>{try{if(g)return void(0,s.pq)("AuthContext: login ignored (already in progress)");v(!0),(0,s.pq)("AuthContext: manual login requested");try{localStorage.removeItem(m)}catch(e){}const r=(0,o.o)(),l=["User.Read","openid","profile"],d="popup"===r?await a.msalInstance.loginPopup({scopes:l,prompt:"select_account"}):(await a.msalInstance.loginRedirect({scopes:l,prompt:"select_account"}),null);(0,s.pq)("AuthContext loginPopup result",d);const u=a.msalInstance.getAllAccounts();(0,s.pq)("AuthContext accounts after popup",{count:u.length});const p=u&&u.length?u[0]:d.account;if(!p){(0,s.z3)("login: no account returned");try{(0,i.P0)("Sign in failed (no account returned)","error")}catch(t){}return}a.msalInstance.setActiveAccount(p);let f=null;try{f=(await a.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:p})).accessToken,(0,s.pq)("AuthContext acquired token silently after login")}catch(t){(0,s.R8)("acquireTokenSilent after login failed, attempting popup",t);try{if("popup"!==(0,o.o)())return void await a.msalInstance.acquireTokenRedirect({scopes:["User.Read"]});f=(await a.msalInstance.acquireTokenPopup({scopes:["User.Read"]})).accessToken}catch(n){(0,s.z3)("acquireTokenPopup after login failed",n)}}if(!f){try{(0,i.P0)("Sign in failed: could not acquire token","error")}catch(t){}return}h(f),c(p);try{(0,i.P0)("Signed in","success")}catch(t){}}catch(t){(0,s.z3)("login failed (popup)",t);try{return(0,s.pq)("AuthContext: falling back to loginRedirect"),void await a.msalInstance.loginRedirect({scopes:["User.Read","openid","profile"]})}catch(r){(0,s.z3)("loginRedirect also failed",r);try{(0,i.P0)("Sign in failed","error")}catch(l){}}}finally{v(!1)}},logout:async()=>{try{(0,s.pq)("AuthContext: logout requested"),await a.msalInstance.logoutPopup(),c(null),h(null),f(null);try{localStorage.setItem(m,"true")}catch(e){}try{(0,i.P0)("Signed out","success")}catch(t){}}catch(t){(0,s.z3)("logout failed",t);try{(0,i.P0)("Sign out failed","error")}catch(n){}}},getToken:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["User.Read"];(0,s.pq)("AuthContext getToken",{scopes:e});const t=a.msalInstance.getActiveAccount()||a.msalInstance.getAllAccounts()[0]||n;if(!t)throw new Error("No active account");try{return(await a.msalInstance.acquireTokenSilent({account:t,scopes:e})).accessToken}catch(r){const t=(0,o.o)();if((0,s.R8)("getToken: acquireTokenSilent failed, using interactive fallback",{mode:t,error:r}),"popup"!==t)throw await a.msalInstance.acquireTokenRedirect({scopes:e}),new Error("Interactive redirect initiated for token");await new Promise(e=>setTimeout(e,200));try{return(await a.msalInstance.acquireTokenPopup({scopes:e})).accessToken}catch(i){await new Promise(e=>setTimeout(e,400));return(await a.msalInstance.acquireTokenPopup({scopes:e})).accessToken}}}},children:t})}},6221:(e,t,n)=>{"use strict";n.d(t,{jz:()=>o});var r=n(8186),a=n(493);const i={[a.xz]:"Given storage configuration option was not supported.",[a.dg]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[a.jE]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};a.xz,i[a.xz],a.dg,i[a.dg],a.jE,i[a.jE];class s extends r.lR{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,s.prototype)}}function o(e){return new s(e,i[e])}},6374:(e,t,n)=>{"use strict";n.d(t,{o:()=>a});const r="sunbeth:interactiveMode";function a(){try{const e=localStorage.getItem(r);if("popup"===e||"redirect"===e)return e}catch(t){}const e=({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_MSAL_INTERACTIVE_FALLBACK||"").toLowerCase();return"redirect"===e||"popup"===e?e:"popup"}},6668:(e,t,n)=>{var r=n(1756);e.exports=function(e,t){return e.get(r(e,t))},e.exports.__esModule=!0,e.exports.default=e.exports},6671:()=>{},7088:(e,t,n)=>{var r=n(1756);e.exports=function(e,t,n){return e.set(r(e,t),n),n},e.exports.__esModule=!0,e.exports.default=e.exports},7101:e=>{e.exports=function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")},e.exports.__esModule=!0,e.exports.default=e.exports},7119:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(8345)},7492:()=>{},7640:()=>{},7736:(e,t,n)=>{var r=n(3738).default,a=n(9045);e.exports=function(e){var t=a(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},8186:(e,t,n)=>{"use strict";n.d(t,{lR:()=>s,pz:()=>o});var r=n(4388),a=n(9644);const i={[a.W]:"Unexpected error in authentication.",[a.z]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};a.W,i[a.W],a.z,i[a.z];class s extends Error{constructor(e,t,n){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,s.prototype),this.errorCode=e||r.YM.EMPTY_STRING,this.errorMessage=t||r.YM.EMPTY_STRING,this.subError=n||r.YM.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function o(e,t){return new s(e,t?"".concat(i[e]," ").concat(t):i[e])}},8345:(e,t,n)=>{"use strict";var r=n(9950),a=n(5340);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!u.call(f,e)||!u.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),A=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var D,L=Object.assign;function j(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function G(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case A:return"Portal";case x:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){$(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ae=null,Se=null,Ce=null;function xe(e){if(e=ba(e)){if("function"!==typeof Ae)throw Error(i(280));var t=e.stateNode;t&&(t=_a(t),Ae(e.stateNode,e.type,t))}}function Ee(e){Se?Ce?Ce.push(e):Ce=[e]:Se=e}function Te(){if(Se){var e=Se,t=Ce;if(Ce=Se=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function ke(e,t){return e(t)}function Pe(){}var Ie=!1;function Re(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return ke(e,t,n)}finally{Ie=!1,(null!==Se||null!==Ce)&&(Pe(),Te())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=_a(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Oe=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){Oe=!1}function Fe(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var De=!1,Le=null,je=!1,Be=null,Ue={onError:function(e){De=!0,Le=e}};function Ge(e,t,n,r,a,i,s,o,l){De=!1,Le=null,Fe.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(He(e)!==e)throw Error(i(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return We(a),e;if(s===r)return We(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Ye=a.unstable_cancelCallback,Xe=a.unstable_shouldYield,Qe=a.unstable_requestPaint,$e=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=ut(o):0!==(i&=s)&&(r=ut(i))}else 0!==(s=n&~a)?r=ut(s):0!==i&&(r=ut(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,At,St,Ct,xt,Et=!1,Tt=[],kt=null,Pt=null,It=null,Rt=new Map,Nt=new Map,Ot=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Dt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&At(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void xt(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&At(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Bt(e,t,n){jt(e)&&n.delete(t)}function Ut(){Et=!1,null!==kt&&jt(kt)&&(kt=null),null!==Pt&&jt(Pt)&&(Pt=null),null!==It&&jt(It)&&(It=null),Rt.forEach(Bt),Nt.forEach(Bt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return Gt(t,e)}if(0<Tt.length){Gt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==kt&&Gt(kt,e),null!==Pt&&Gt(Pt,e),null!==It&&Gt(It,e),Rt.forEach(t),Nt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var zt=w.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,r){var a=bt,i=zt.transition;zt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,zt.transition=i}}function Vt(e,t,n,r){var a=bt,i=zt.transition;zt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,zt.transition=i}}function Kt(e,t,n,r){if(Wt){var a=Xt(e,t,n,r);if(null===a)Wr(e,t,r,Yt,n),Ft(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return kt=Dt(kt,e,t,n,r,a),!0;case"dragenter":return Pt=Dt(Pt,e,t,n,r,a),!0;case"mouseover":return It=Dt(It,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Rt.set(i,Dt(Rt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Nt.set(i,Dt(Nt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&_t(i),null===(i=Xt(e,t,n,r))&&Wr(e,t,r,Yt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Yt=null;function Xt(e,t,n,r){if(Yt=null,null!==(e=ya(e=_e(r))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,a="value"in $t?$t.value:$t.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=L({},cn,{view:0,detail:0}),hn=an(un),pn=L({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=an(pn),mn=an(L({},pn,{dataTransfer:0})),gn=an(L({},un,{relatedTarget:0})),vn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},An={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function xn(){return Cn}var En=L({},un,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?An[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(En),kn=an(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=an(L({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),In=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=an(Rn),On=[9,13,27,32],Mn=d&&"CompositionEvent"in window,Fn=null;d&&"documentMode"in document&&(Fn=document.documentMode);var Dn=d&&"TextEvent"in window&&!Fn,Ln=d&&(!Mn||Fn&&8<Fn&&11>=Fn),jn=String.fromCharCode(32),Bn=!1;function Un(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function qn(e,t,n,r){Ee(r),0<(t=Vr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Kn=null;function Yn(e){jr(e,0)}function Xn(e){if(K(wa(e)))return e}function Qn(e,t){if("change"===e)return t}var $n=!1;if(d){var Jn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Vn&&(Vn.detachEvent("onpropertychange",nr),Kn=Vn=null)}function nr(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];qn(t,Kn,e,_e(e)),Re(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Vn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function ir(e,t){if("click"===e)return Xn(t)}function sr(e,t){if("input"===e||"change"===e)return Xn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!u.call(t,a)||!or(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=dr(n,i);var s=dr(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Vr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ar={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Sr={},Cr={};function xr(e){if(Sr[e])return Sr[e];if(!Ar[e])return e;var t,n=Ar[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return Sr[e]=n[t];return e}d&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);var Er=xr("animationend"),Tr=xr("animationiteration"),kr=xr("animationstart"),Pr=xr("transitionend"),Ir=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Ir.set(e,t),l(t,[e])}for(var Or=0;Or<Rr.length;Or++){var Mr=Rr[Or];Nr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Nr(Er,"onAnimationEnd"),Nr(Tr,"onAnimationIteration"),Nr(kr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Pr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,l,c){if(Ge.apply(this,arguments),De){if(!De)throw Error(i(198));var d=Le;De=!1,Le=null,je||(je=!0,Be=d)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Lr(a,o,c),i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Lr(a,o,c),i=l}}}if(je)throw e=Be,je=!1,Be=null,e}function Br(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var Gr="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[Gr]){e[Gr]=!0,s.forEach(function(t){"selectionchange"!==t&&(Dr.has(t)||Ur(t,!1,e),Ur(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gr]||(t[Gr]=!0,Ur("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Qt(t)){case 1:var a=qt;break;case 4:a=Vt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=ya(o)))return;if(5===(l=s.tag)||6===l){r=i=s;continue e}o=o.parentNode}}r=r.return}Re(function(){var r=i,a=_e(n),s=[];e:{var o=Ir.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Er:case Tr:case kr:l=vn;break;case Pr:l=In;break;case"scroll":l=hn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ne(f,h))&&d.push(qr(f,m,p)))),u)break;f=f.return}0<d.length&&(o=new l(o,c,null,n,a),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(u=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=kn,m="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==l?o:wa(l),p=null==c?o:wa(c),(o=new d(m,f+"leave",l,n,a)).target=u,o.relatedTarget=p,m=null,ya(a)===r&&((d=new d(h,f+"enter",c,n,a)).target=p,d.relatedTarget=u,m=d),u=m,l&&c)e:{for(h=c,f=0,p=d=l;p;p=Kr(p))f++;for(p=0,m=h;m;m=Kr(m))p++;for(;0<f-p;)d=Kr(d),f--;for(;0<p-f;)h=Kr(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Kr(d),h=Kr(h)}d=null}else d=null;null!==l&&Yr(s,o,l,d,!1),null!==c&&null!==u&&Yr(s,u,c,d,!0)}if("select"===(l=(o=r?wa(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Qn;else if(Wn(o))if($n)g=sr;else{g=ar;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?qn(s,g,n,a):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?wa(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,a)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(y=en()):(Jt="value"in($t=a)?$t.value:$t.textContent,Hn=!0)),0<(v=Vr(r,b)).length&&(b=new wn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Gn(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(Bn=!0,jn);case"textInput":return(e=t.data)===jn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Zt=Jt=$t=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}jr(s,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ne(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Ne(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Ne(n,i))&&s.unshift(qr(n,l,o)):a||null!=(l=Ne(n,i))&&s.push(qr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Xr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ht(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ht(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,pa="__reactProps$"+ua,fa="__reactContainer$"+ua,ma="__reactEvents$"+ua,ga="__reactListeners$"+ua,va="__reactHandles$"+ua;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ha])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function _a(e){return e[pa]||null}var Aa=[],Sa=-1;function Ca(e){return{current:e}}function xa(e){0>Sa||(e.current=Aa[Sa],Aa[Sa]=null,Sa--)}function Ea(e,t){Sa++,Aa[Sa]=e.current,e.current=t}var Ta={},ka=Ca(Ta),Pa=Ca(!1),Ia=Ta;function Ra(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Na(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oa(){xa(Pa),xa(ka)}function Ma(e,t,n){if(ka.current!==Ta)throw Error(i(168));Ea(ka,t),Ea(Pa,n)}function Fa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,z(e)||"Unknown",a));return L({},n,r)}function Da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Ia=ka.current,Ea(ka,e),Ea(Pa,Pa.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fa(e,t,Ia),r.__reactInternalMemoizedMergedChildContext=e,xa(Pa),xa(ka),Ea(ka,e)):xa(Pa),Ea(Pa,n)}var ja=null,Ba=!1,Ua=!1;function Ga(e){null===ja?ja=[e]:ja.push(e)}function Ha(){if(!Ua&&null!==ja){Ua=!0;var e=0,t=bt;try{var n=ja;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ja=null,Ba=!1}catch(a){throw null!==ja&&(ja=ja.slice(e+1)),Ke(Ze,Ha),a}finally{bt=t,Ua=!1}}return null}var za=[],Wa=0,qa=null,Va=0,Ka=[],Ya=0,Xa=null,Qa=1,$a="";function Ja(e,t){za[Wa++]=Va,za[Wa++]=qa,qa=e,Va=t}function Za(e,t,n){Ka[Ya++]=Qa,Ka[Ya++]=$a,Ka[Ya++]=Xa,Xa=e;var r=Qa;e=$a;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Qa=1<<32-st(t)+a|n<<a|r,$a=i+e}else Qa=1<<i|n<<a|r,$a=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===qa;)qa=za[--Wa],za[Wa]=null,Va=za[--Wa],za[Wa]=null;for(;e===Xa;)Xa=Ka[--Ya],Ka[Ya]=null,$a=Ka[--Ya],Ka[Ya]=null,Qa=Ka[--Ya],Ka[Ya]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xa?{id:Qa,overflow:$a}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function ui(e){if(e!==ni)return!1;if(!ai)return di(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)si(e,t),t=ca(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function fi(e){null===ii?ii=[e]:ii.push(e)}var mi=w.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===S?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===N&&yi(i)===t.type)?((r=a(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,i){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case A:return(t=jc(t,e.mode,n)).return=e,t;case N:return h(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Fc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===a?c(e,t,n,r):null;case A:return n.key===a?d(e,t,n,r):null;case N:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||F(n))return null!==a?null:u(e,t,n,r,null);vi(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case A:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case N:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||F(r))return u(t,e=e.get(n)||null,r,a,null);vi(t,r)}return null}function m(a,i,o,l){for(var c=null,d=null,u=i,m=i=0,g=null;null!==u&&m<o.length;m++){u.index>m?(g=u,u=null):g=u.sibling;var v=p(a,u,o[m],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(a,u),i=s(v,i,m),null===d?c=v:d.sibling=v,d=v,u=g}if(m===o.length)return n(a,u),ai&&Ja(a,m),c;if(null===u){for(;m<o.length;m++)null!==(u=h(a,o[m],l))&&(i=s(u,i,m),null===d?c=u:d.sibling=u,d=u);return ai&&Ja(a,m),c}for(u=r(a,u);m<o.length;m++)null!==(g=f(u,a,m,o[m],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?m:g.key),i=s(g,i,m),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ai&&Ja(a,m),c}function g(a,o,l,c){var d=F(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(a,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),o=s(b,o,g),null===u?d=b:u.sibling=b,u=b,m=v}if(y.done)return n(a,m),ai&&Ja(a,g),d;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return ai&&Ja(a,g),d}for(m=r(a,m);!y.done;g++,y=l.next())null!==(y=f(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return e&&m.forEach(function(e){return t(a,e)}),ai&&Ja(a,g),d}return function e(r,i,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case _:e:{for(var c=s.key,d=i;null!==d;){if(d.key===c){if((c=s.type)===S){if(7===d.tag){n(r,d.sibling),(i=a(d,s.props.children)).return=r,r=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===N&&yi(c)===d.type){n(r,d.sibling),(i=a(d,s.props)).ref=gi(r,d,s),i.return=r,r=i;break e}n(r,d);break}t(r,d),d=d.sibling}s.type===S?((i=Fc(s.props.children,r.mode,l,s.key)).return=r,r=i):((l=Mc(s.type,s.key,s.props,null,r.mode,l)).ref=gi(r,i,s),l.return=r,r=l)}return o(r);case A:e:{for(d=s.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=jc(s,r.mode,l)).return=r,r=i}return o(r);case N:return e(r,i,(d=s._init)(s._payload),l)}if(te(s))return m(r,i,s,l);if(F(s))return g(r,i,s,l);vi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Lc(s,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var wi=bi(!0),_i=bi(!1),Ai=Ca(null),Si=null,Ci=null,xi=null;function Ei(){xi=Ci=Si=null}function Ti(e){var t=Ai.current;xa(Ai),e._currentValue=t}function ki(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Pi(e,t){Si=e,xi=Ci=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Ii(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===Ci){if(null===Si)throw Error(i(308));Ci=e,Si.dependencies={lanes:0,firstContext:e}}else Ci=Ci.next=e;return t}var Ri=null;function Ni(e){null===Ri?Ri=[e]:Ri.push(e)}function Oi(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ni(t)):(n.next=a.next,a.next=n),t.interleaved=n,Mi(e,r)}function Mi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fi=!1;function Di(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Li(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ji(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&kl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Mi(e,n)}return null===(a=r.interleaved)?(t.next=t,Ni(r)):(t.next=a.next,a.next=t),r.interleaved=t,Mi(e,n)}function Ui(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Gi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hi(e,t,n,r){var a=e.updateQueue;Fi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=a.baseState;for(s=0,d=c=l=null,o=i;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){u=f.call(p,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,u,h):f)||void 0===h)break e;u=L({},u,h);break e;case 2:Fi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Dl|=s,e.lanes=s,e.memoizedState=u}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Wi={},qi=Ca(Wi),Vi=Ca(Wi),Ki=Ca(Wi);function Yi(e){if(e===Wi)throw Error(i(174));return e}function Xi(e,t){switch(Ea(Ki,t),Ea(Vi,e),Ea(qi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xa(qi),Ea(qi,t)}function Qi(){xa(qi),xa(Vi),xa(Ki)}function $i(e){Yi(Ki.current);var t=Yi(qi.current),n=le(t,e.type);t!==n&&(Ea(Vi,e),Ea(qi,n))}function Ji(e){Vi.current===e&&(xa(qi),xa(Vi))}var Zi=Ca(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=w.ReactCurrentDispatcher,as=w.ReactCurrentBatchConfig,is=0,ss=null,os=null,ls=null,cs=!1,ds=!1,us=0,hs=0;function ps(){throw Error(i(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ms(e,t,n,r,a,s){if(is=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Js:Zs,e=n(r,a),ds){s=0;do{if(ds=!1,us=0,25<=s)throw Error(i(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=eo,e=n(r,a)}while(ds)}if(rs.current=$s,t=null!==os&&null!==os.next,is=0,ls=os=ss=null,cs=!1,t)throw Error(i(300));return e}function gs(){var e=0!==us;return us=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function ys(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(i(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function bs(e,t){return"function"===typeof t?t(e):t}function ws(e){var t=ys(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=os,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((is&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ss.lanes|=u,Dl|=u}d=d.next}while(null!==d&&d!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ss.lanes|=s,Dl|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _s(e){var t=ys(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(bo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function As(){}function Ss(e,t){var n=ss,r=ys(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,bo=!0),r=r.queue,Fs(Es.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,Is(9,xs.bind(null,n,r,a,t),void 0,null),null===Pl)throw Error(i(349));0!==(30&is)||Cs(n,t,a)}return a}function Cs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function xs(e,t,n,r){t.value=n,t.getSnapshot=r,Ts(t)&&ks(e)}function Es(e,t,n){return n(function(){Ts(t)&&ks(e)})}function Ts(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function ks(e){var t=Mi(e,1);null!==t&&nc(t,e,1,-1)}function Ps(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ks.bind(null,ss,e),[t.memoizedState,e]}function Is(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rs(){return ys().memoizedState}function Ns(e,t,n,r){var a=vs();ss.flags|=e,a.memoizedState=Is(1|t,n,void 0,void 0===r?null:r)}function Os(e,t,n,r){var a=ys();r=void 0===r?null:r;var i=void 0;if(null!==os){var s=os.memoizedState;if(i=s.destroy,null!==r&&fs(r,s.deps))return void(a.memoizedState=Is(t,n,i,r))}ss.flags|=e,a.memoizedState=Is(1|t,n,i,r)}function Ms(e,t){return Ns(8390656,8,e,t)}function Fs(e,t){return Os(2048,8,e,t)}function Ds(e,t){return Os(4,2,e,t)}function Ls(e,t){return Os(4,4,e,t)}function js(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Os(4,4,js.bind(null,t,e),n)}function Us(){}function Gs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function zs(e,t,n){return 0===(21&is)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),ss.lanes|=n,Dl|=n,e.baseState=!0),t)}function Ws(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{bt=n,as.transition=r}}function qs(){return ys().memoizedState}function Vs(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ys(e))Xs(t,n);else if(null!==(n=Oi(e,t,n,r))){nc(n,e,r,ec()),Qs(n,t,r)}}function Ks(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ys(e))Xs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(a.next=a,Ni(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Oi(e,t,a,r))&&(nc(n,e,r,a=ec()),Qs(n,t,r))}}function Ys(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Xs(e,t){ds=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qs(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var $s={readContext:Ii,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Js={readContext:Ii,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Ii,useEffect:Ms,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ns(4194308,4,js.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ns(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ns(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Vs.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Ps,useDebugValue:Us,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Ps(!1),t=e[0];return e=Ws.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,a=vs();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Pl)throw Error(i(349));0!==(30&is)||Cs(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Ms(Es.bind(null,r,s,e),[e]),r.flags|=2048,Is(9,xs.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Pl.identifierPrefix;if(ai){var n=$a;t=":"+t+"R"+(n=(Qa&~(1<<32-st(Qa)-1)).toString(32)+n),0<(n=us++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zs={readContext:Ii,useCallback:Gs,useContext:Ii,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:Ds,useLayoutEffect:Ls,useMemo:Hs,useReducer:ws,useRef:Rs,useState:function(){return ws(bs)},useDebugValue:Us,useDeferredValue:function(e){return zs(ys(),os.memoizedState,e)},useTransition:function(){return[ws(bs)[0],ys().memoizedState]},useMutableSource:As,useSyncExternalStore:Ss,useId:qs,unstable_isNewReconciler:!1},eo={readContext:Ii,useCallback:Gs,useContext:Ii,useEffect:Fs,useImperativeHandle:Bs,useInsertionEffect:Ds,useLayoutEffect:Ls,useMemo:Hs,useReducer:_s,useRef:Rs,useState:function(){return _s(bs)},useDebugValue:Us,useDeferredValue:function(e){var t=ys();return null===os?t.memoizedState=e:zs(t,os.memoizedState,e)},useTransition:function(){return[_s(bs)[0],ys().memoizedState]},useMutableSource:As,useSyncExternalStore:Ss,useId:qs,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=ji(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,a))&&(nc(t,e,a,r),Ui(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=ji(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,a))&&(nc(t,e,a,r),Ui(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=ji(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Bi(e,a,r))&&(nc(t,e,r,n),Ui(t,e,r))}};function ao(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function io(e,t,n){var r=!1,a=Ta,i=t.contextType;return"object"===typeof i&&null!==i?i=Ii(i):(a=Na(t)?Ia:ka.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ra(e,a):Ta),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function so(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Di(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ii(i):(i=Na(t)?Ia:ka.current,a.context=Ra(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(no(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ro.enqueueReplaceState(a,a.state,null),Hi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=ji(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,ql=r),uo(0,t)},n}function fo(e,t,n){(n=ji(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){uo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=xc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ji(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yo=w.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?_i(t,null,n,r):wi(t,e.child,n,r)}function _o(e,t,n,r,a){n=n.render;var i=t.ref;return Pi(t,a),r=ms(e,t,n,r,i,a),n=gs(),null===e||bo?(ai&&n&&ei(t),t.flags|=1,wo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function Ao(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Nc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,So(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wo(e,t,a)}return t.flags|=1,(e=Oc(i,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Wo(e,t,a);0!==(131072&e.flags)&&(bo=!0)}}return Eo(e,t,n,r,a)}function Co(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ea(Ol,Nl),Nl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ea(Ol,Nl),Nl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ea(Ol,Nl),Nl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ea(Ol,Nl),Nl|=r;return wo(e,t,a,n),t.child}function xo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,r,a){var i=Na(n)?Ia:ka.current;return i=Ra(t,i),Pi(t,a),n=ms(e,t,n,r,i,a),r=gs(),null===e||bo?(ai&&r&&ei(t),t.flags|=1,wo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wo(e,t,a))}function To(e,t,n,r,a){if(Na(n)){var i=!0;Da(t)}else i=!1;if(Pi(t,a),null===t.stateNode)zo(e,t),io(t,n,r),oo(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ii(c):c=Ra(t,c=Na(n)?Ia:ka.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&so(t,s,r,c),Fi=!1;var h=t.memoizedState;s.state=h,Hi(t,r,s,a),l=t.memoizedState,o!==r||h!==l||Pa.current||Fi?("function"===typeof d&&(no(t,n,d,r),l=t.memoizedState),(o=Fi||ao(t,n,o,r,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Li(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ii(l):l=Ra(t,l=Na(n)?Ia:ka.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==u||h!==l)&&so(t,s,r,l),Fi=!1,h=t.memoizedState,s.state=h,Hi(t,r,s,a);var f=t.memoizedState;o!==u||h!==f||Pa.current||Fi?("function"===typeof p&&(no(t,n,p,r),f=t.memoizedState),(c=Fi||ao(t,n,c,r,h,f,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ko(e,t,n,r,i,a)}function ko(e,t,n,r,a,i){xo(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&La(t,n,!1),Wo(e,t,i);r=t.stateNode,yo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,o,i)):wo(e,t,o,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Po(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Xi(e,t.containerInfo)}function Io(e,t,n,r,a){return pi(),fi(a),t.flags|=256,wo(e,t,n,r),t.child}var Ro,No,Oo,Mo,Fo={dehydrated:null,treeContext:null,retryLane:0};function Do(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,a=t.pendingProps,s=Zi.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ea(Zi,1&s),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Dc(l,a,0,null),e=Fc(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Do(n),t.memoizedState=Fo,e):jo(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=co(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Dc({mode:"visible",children:r.children},a,0,null),(s=Fc(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&wi(t,e.child,null,o),t.child.memoizedState=Do(o),t.memoizedState=Fo,s);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Bo(e,t,o,r=co(s=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=Pl)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Mi(e,a),nc(r,e,a,-1))}return mc(),Bo(e,t,o,r=co(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Ya++]=Qa,Ka[Ya++]=$a,Ka[Ya++]=Xa,Qa=e.id,$a=e.overflow,Xa=t),t=jo(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(o){o=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Oc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Oc(r,o):(o=Fc(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Do(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Fo,a}return e=(o=e.child).sibling,a=Oc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function jo(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&fi(r),wi(t,e.child,null,n),(e=jo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ki(e.return,t,n)}function Go(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Ho(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,n,t);else if(19===e.tag)Uo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ea(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Go(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===es(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Go(t,!0,n,null,i);break;case"together":Go(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qo(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Vo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vo(t),null;case 1:case 17:return Na(t.type)&&Oa(),Vo(t),null;case 3:return r=t.stateNode,Qi(),xa(Pa),xa(ka),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ui(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),No(e,t),Vo(t),null;case 5:Ji(t);var a=Yi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Oo(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Vo(t),null}if(e=Yi(qi.current),ui(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[pa]=s,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,s),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Br("invalid",r);break;case"textarea":ae(r,s),Br("invalid",r)}for(var l in ye(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":V(r),Z(r,s,!0);break;case"textarea":V(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Ro(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Q(e,r),a=X(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(s in ye(n,a),c=a)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ge(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Br("scroll",e):null!=d&&b(e,s,d,l))}switch(n){case"input":V(e),Z(e,r,!1);break;case"textarea":V(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vo(t),null;case 6:if(e&&null!=t.stateNode)Mo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Yi(Ki.current),Yi(qi.current),ui(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Vo(t),null;case 13:if(xa(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),pi(),t.flags|=98560,s=!1;else if(s=ui(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[ha]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vo(t),s=!1}else null!==ii&&(sc(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Ml&&(Ml=3):mc())),null!==t.updateQueue&&(t.flags|=4),Vo(t),null);case 4:return Qi(),No(e,t),null===e&&Hr(t.stateNode.containerInfo),Vo(t),null;case 10:return Ti(t.type._context),Vo(t),null;case 19:if(xa(Zi),null===(s=t.memoizedState))return Vo(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)qo(s,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,qo(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ea(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==s.tail&&$e()>Hl&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ai)return Vo(t),null}else 2*$e()-s.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,qo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=$e(),t.sibling=null,n=Zi.current,Ea(Zi,r?1&n|2:1&n),t):(Vo(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nl)&&(Vo(t),6&t.subtreeFlags&&(t.flags|=8192)):Vo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Yo(e,t){switch(ti(t),t.tag){case 1:return Na(t.type)&&Oa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qi(),xa(Pa),xa(ka),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ji(t),null;case 13:if(xa(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xa(Zi),null;case 4:return Qi(),null;case 10:return Ti(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ro=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},No=function(){},Oo=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Yi(qi.current);var i,s=null;switch(n){case"input":a=X(e,a),r=X(e,r),s=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ye(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Br("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Mo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xo=!1,Qo=!1,$o="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,n,i)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Qo||Zo(n,t);case 6:var r=dl,a=ul;dl=null,hl(e,t,n),ul=a,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Ht(e)):la(dl,n.stateNode));break;case 4:r=dl,a=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=a;break;case 0:case 11:case 14:case 15:if(!Qo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&el(n,t,s),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Qo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Cc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Qo=(r=Qo)||null!==n.memoizedState,hl(e,t,n),Qo=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $o),t.forEach(function(t){var r=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(i(160));pl(s,o,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Cc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Cc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&$(a,s),be(l,o);var d=be(l,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):b(a,u,h,d)}switch(l){case"input":J(a,s);break;case"textarea":ie(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(a,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(g){Cc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Cc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Gl=$e())),4&r&&fl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Qo=(d=Qo)||u,ml(t,e),Qo=d):ml(t,e),vl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Jo=e,u=e.child;null!==u;){for(h=Jo=u;null!==Jo;){switch(f=(p=Jo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==f?(f.return=p,Jo=f):_l(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Cc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,ol(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(i(161))}}catch(o){Cc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Jo=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Jo;){var a=Jo,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Xo;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Qo;o=Xo;var c=Qo;if(Xo=s,(Qo=l)&&!c)for(Jo=a;null!==Jo;)l=(s=Jo).child,22===s.tag&&null!==s.memoizedState?Al(a):null!==l?(l.return=s,Jo=l):Al(a);for(;null!==i;)Jo=i,bl(i,t,n),i=i.sibling;Jo=a,Xo=o,Qo=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Jo=i):wl(e)}}function wl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qo)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&zi(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(i(163))}Qo||512&t.flags&&al(t)}catch(p){Cc(t,t.return,p)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function _l(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function Al(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Cc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Cc(t,a,l)}}var i=t.return;try{al(t)}catch(l){Cc(t,i,l)}break;case 5:var s=t.return;try{al(t)}catch(l){Cc(t,s,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Sl,Cl=Math.ceil,xl=w.ReactCurrentDispatcher,El=w.ReactCurrentOwner,Tl=w.ReactCurrentBatchConfig,kl=0,Pl=null,Il=null,Rl=0,Nl=0,Ol=Ca(0),Ml=0,Fl=null,Dl=0,Ll=0,jl=0,Bl=null,Ul=null,Gl=0,Hl=1/0,zl=null,Wl=!1,ql=null,Vl=null,Kl=!1,Yl=null,Xl=0,Ql=0,$l=null,Jl=-1,Zl=0;function ec(){return 0!==(6&kl)?$e():-1!==Jl?Jl:Jl=$e()}function tc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Rl?Rl&-Rl:null!==mi.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,n,r){if(50<Ql)throw Ql=0,$l=null,Error(i(185));vt(e,n,r),0!==(2&kl)&&e===Pl||(e===Pl&&(0===(2&kl)&&(Ll|=n),4===Ml&&oc(e,Rl)),rc(e,r),1===n&&0===kl&&0===(1&t.mode)&&(Hl=$e()+500,Ba&&Ha()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Pl?Rl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ba=!0,Ga(e)}(lc.bind(null,e)):Ga(lc.bind(null,e)),sa(function(){0===(6&kl)&&Ha()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Jl=-1,Zl=0,0!==(6&kl))throw Error(i(327));var n=e.callbackNode;if(Ac()&&e.callbackNode!==n)return null;var r=ht(e,e===Pl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=kl;kl|=2;var s=fc();for(Pl===e&&Rl===t||(zl=null,Hl=$e()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}Ei(),xl.current=s,kl=a,null!==Il?t=0:(Pl=null,Rl=0,t=Ml)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=ic(e,a))),1===t)throw n=Fl,hc(e,0),oc(e,r),rc(e,$e()),n;if(6===t)oc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(s=ft(e))&&(r=s,t=ic(e,s))),1===t))throw n=Fl,hc(e,0),oc(e,r),rc(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:_c(e,Ul,zl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Gl+500-$e())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(_c.bind(null,e,Ul,zl),t);break}_c(e,Ul,zl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=ra(_c.bind(null,e,Ul,zl),r);break}_c(e,Ul,zl);break;default:throw Error(i(329))}}}return rc(e,$e()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=n,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~jl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&kl))throw Error(i(327));Ac();var t=ht(e,0);if(0===(1&t))return rc(e,$e()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Fl,hc(e,0),oc(e,t),rc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Ul,zl),rc(e,$e()),null}function cc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Hl=$e()+500,Ba&&Ha())}}function dc(e){null!==Yl&&0===Yl.tag&&0===(6&kl)&&Ac();var t=kl;kl|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,0===(6&(kl=t))&&Ha()}}function uc(){Nl=Ol.current,xa(Ol)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oa();break;case 3:Qi(),xa(Pa),xa(ka),ns();break;case 5:Ji(r);break;case 4:Qi();break;case 13:case 19:xa(Zi);break;case 10:Ti(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Pl=e,Il=e=Oc(e.current,null),Rl=Nl=t,Ml=0,Fl=null,jl=Ll=Dl=0,Ul=Bl=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(r=(n=Ri[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Ri=null}return e}function pc(e,t){for(;;){var n=Il;try{if(Ei(),rs.current=$s,cs){for(var r=ss.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}cs=!1}if(is=0,ls=os=ss=null,ds=!1,us=0,El.current=null,null===n||null===n.return){Ml=1,Fl=t,Il=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,vo(f,o,l,0,t),1&f.mode&&mo(s,d,t),c=d;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(s,d,t),mc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),fi(lo(c,l));break e}}s=c=lo(c,l),4!==Ml&&(Ml=2),null===Bl?Bl=[s]:Bl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Gi(s,po(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Vl||!Vl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Gi(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}wc(n)}catch(w){t=w,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fc(){var e=xl.current;return xl.current=$s,null===e?$s:e}function mc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Pl||0===(268435455&Dl)&&0===(268435455&Ll)||oc(Pl,Rl)}function gc(e,t){var n=kl;kl|=2;var r=fc();for(Pl===e&&Rl===t||(zl=null,hc(e,t));;)try{vc();break}catch(a){pc(e,a)}if(Ei(),kl=n,xl.current=r,null!==Il)throw Error(i(261));return Pl=null,Rl=0,Ml}function vc(){for(;null!==Il;)bc(Il)}function yc(){for(;null!==Il&&!Xe();)bc(Il)}function bc(e){var t=Sl(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,null===t?wc(e):Il=t,El.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Nl)))return void(Il=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ml=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ml&&(Ml=5)}function _c(e,t,n){var r=bt,a=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{Ac()}while(null!==Yl);if(0!==(6&kl))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Pl&&(Il=Pl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Pc(tt,function(){return Ac(),null})),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Tl.transition,Tl.transition=null;var o=bt;bt=1;var l=kl;kl|=4,El.current=null,function(e,t){if(ea=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(_){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++d===a&&(l=o),p===s&&++u===r&&(c=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(_){Cc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ta),Wt=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Qe(),kl=l,bt=o,Tl.transition=s}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Xl=a),s=e.pendingLanes,0===s&&(Vl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Wl)throw Wl=!1,e=ql,ql=null,e;0!==(1&Xl)&&0!==e.tag&&Ac(),s=e.pendingLanes,0!==(1&s)?e===$l?Ql++:(Ql=0,$l=e):Ql=0,Ha()}(e,t,n,r)}finally{Tl.transition=a,bt=r}return null}function Ac(){if(null!==Yl){var e=wt(Xl),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Xl=0,0!==(6&kl))throw Error(i(331));var a=kl;for(kl|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!==(16&Jo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Jo=d;null!==Jo;){var u=Jo;switch(u.tag){case 0:case 11:case 15:nl(8,u,s)}var h=u.child;if(null!==h)h.return=u,Jo=h;else for(;null!==Jo;){var p=(u=Jo).sibling,f=u.return;if(il(u),u===d){Jo=null;break}if(null!==p){p.return=f,Jo=p;break}Jo=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Jo=y;break e}Jo=s.return}}var b=e.current;for(Jo=b;null!==Jo;){var w=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Jo=w;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(A){Cc(l,l.return,A)}if(l===o){Jo=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Jo=_;break e}Jo=l.return}}if(kl=a,Ha(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(A){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function Sc(e,t,n){e=Bi(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Vl||!Vl.has(r))){t=Bi(t,e=fo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function xc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Rl&n)===n&&(4===Ml||3===Ml&&(130023424&Rl)===Rl&&500>$e()-Gl?hc(e,0):jl|=n),rc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Mi(e,t))&&(vt(e,t,n),rc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ec(e,n)}function Pc(e,t){return Ke(e,t)}function Ic(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ic(e,t,n,r)}function Nc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)Nc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Fc(n.children,a,s,t);case C:o=8,a|=8;break;case x:return(e=Rc(12,n,t,2|a)).elementType=x,e.lanes=s,e;case P:return(e=Rc(13,n,t,a)).elementType=P,e.lanes=s,e;case I:return(e=Rc(19,n,t,a)).elementType=I,e.lanes=s,e;case O:return Dc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:o=10;break e;case T:o=9;break e;case k:o=11;break e;case R:o=14;break e;case N:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rc(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Fc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Dc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function jc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,a,i,s,o,l){return e=new Bc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Rc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Di(i),e}function Gc(e){if(!e)return Ta;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Na(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Na(n))return Fa(e,n,t)}return t}function Hc(e,t,n,r,a,i,s,o,l){return(e=Uc(n,r,!0,e,0,i,0,o,l)).context=Gc(null),n=e.current,(i=ji(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,a),e.current.lanes=a,vt(e,a,r),rc(e,r),e}function zc(e,t,n,r){var a=t.current,i=ec(),s=tc(a);return n=Gc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ji(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bi(a,t,s))&&(nc(e,a,s,i),Ui(e,a,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pa.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Po(t),pi();break;case 5:$i(t);break;case 1:Na(t.type)&&Da(t);break;case 4:Xi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ea(Ai,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ea(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Ea(Zi,1&Zi.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ea(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ho(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ea(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,Co(e,t,n)}return Wo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,ai&&0!==(1048576&t.flags)&&Za(t,Va,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zo(e,t),e=t.pendingProps;var a=Ra(t,ka.current);Pi(t,n),a=ms(null,t,r,e,a,n);var s=gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Na(r)?(s=!0,Da(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Di(t),a.updater=ro,t.stateNode=a,a._reactInternals=t,oo(t,r,e,n),t=ko(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),wo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zo(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Nc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===R)return 14}return 2}(r),e=to(r,e),a){case 0:t=Eo(null,t,r,e,n);break e;case 1:t=To(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=Ao(null,t,r,to(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Eo(e,t,r,a=t.elementType===r?a:to(r,a),n);case 1:return r=t.type,a=t.pendingProps,To(e,t,r,a=t.elementType===r?a:to(r,a),n);case 3:e:{if(Po(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Li(e,t),Hi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Io(e,t,r,n,a=lo(Error(i(423)),t));break e}if(r!==a){t=Io(e,t,r,n,a=lo(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=_i(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=Wo(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return $i(t),null===e&&ci(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),xo(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Lo(e,t,n);case 4:return Xi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_o(e,t,r,a=t.elementType===r?a:to(r,a),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Ea(Ai,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Pa.current){t=Wo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=ji(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),ki(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ki(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Pi(t,n),r=r(a=Ii(a)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return a=to(r=t.type,t.pendingProps),Ao(e,t,r,a=to(r.type,a),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:to(r,a),zo(e,t),t.tag=1,Na(r)?(e=!0,Da(t)):e=!1,Pi(t,n),io(t,r,a),oo(t,r,a,n),ko(null,t,r,!0,e,n);case 19:return Ho(e,t,n);case 22:return Co(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Wc(s);o.call(e)}}zc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Wc(s);i.call(e)}}var s=Hc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=s,e[fa]=s.current,Hr(8===e.nodeType?e.parentNode:e),dc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=Wc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[fa]=l.current,Hr(8===e.nodeType?e.parentNode:e),dc(function(){zc(t,l,n,r)}),l}(n,t,e,a,r);return Wc(s)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));zc(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){zc(null,e,null,null)}),t[fa]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,$e()),0===(6&kl)&&(Hl=$e()+500,Ha()))}break;case 13:dc(function(){var t=Mi(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Vc(e,1)}},At=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)nc(t,e,134217728,ec());Vc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Mi(e,t);if(null!==n)nc(n,e,t,ec());Vc(e,t)}},Ct=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ae=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=_a(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ke=cc,Pe=dc;var ed={usingClientEntryPoint:!1,Events:[ba,wa,_a,Ee,Te,cc]},td={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{at=rd.inject(nd),it=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:A,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,a,0,s,o),e[fa]=t.current,Hr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Xc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},8398:(e,t,n)=>{"use strict";n.d(t,{$:()=>r,V:()=>i});var r,a=n(4388);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(r||(r={}));class i{constructor(e,t,n){this.level=r.Info;const s=e||i.createDefaultLoggerOptions();this.localCallback=s.loggerCallback||(()=>{}),this.piiLoggingEnabled=s.piiLoggingEnabled||!1,this.level="number"===typeof s.logLevel?s.logLevel:r.Info,this.correlationId=s.correlationId||a.YM.EMPTY_STRING,this.packageName=t||a.YM.EMPTY_STRING,this.packageVersion=n||a.YM.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:r.Info}}clone(e,t,n){return new i({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=(new Date).toUTCString(),a="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(a," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(r[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!1,correlationId:t||a.YM.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!0,correlationId:t||a.YM.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!1,correlationId:t||a.YM.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!0,correlationId:t||a.YM.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!1,correlationId:t||a.YM.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!0,correlationId:t||a.YM.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!1,correlationId:t||a.YM.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!0,correlationId:t||a.YM.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!1,correlationId:t||a.YM.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!0,correlationId:t||a.YM.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},8429:(e,t,n)=>{"use strict";var r;n.d(t,{$P:()=>p,BV:()=>L,C5:()=>M,Ix:()=>D,V8:()=>O,Zp:()=>v,g:()=>y,jb:()=>c,qh:()=>F,x$:()=>b,zy:()=>m});var a=n(9950),i=n(1018);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}const o=a.createContext(null);const l=a.createContext(null);const c=a.createContext(null);const d=a.createContext(null);const u=a.createContext({outlet:null,matches:[],isDataRoute:!1});const h=a.createContext(null);function p(e,t){let{relative:n}=void 0===t?{}:t;f()||(0,i.Oi)(!1);let{basename:r,navigator:s}=a.useContext(c),{hash:o,pathname:l,search:d}=b(e,{relative:n}),u=l;return"/"!==r&&(u="/"===l?r:(0,i.HS)([r,l])),s.createHref({pathname:u,search:d,hash:o})}function f(){return null!=a.useContext(d)}function m(){return f()||(0,i.Oi)(!1),a.useContext(d).location}function g(e){a.useContext(c).static||a.useLayoutEffect(e)}function v(){let{isDataRoute:e}=a.useContext(u);return e?function(){let{router:e}=k(E.UseNavigateStable),t=I(T.UseNavigateStable),n=a.useRef(!1);return g(()=>{n.current=!0}),a.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,s({fromRouteId:t},a)))},[e,t])}():function(){f()||(0,i.Oi)(!1);let e=a.useContext(o),{basename:t,future:n,navigator:r}=a.useContext(c),{matches:s}=a.useContext(u),{pathname:l}=m(),d=JSON.stringify((0,i.yD)(s,n.v7_relativeSplatPath)),h=a.useRef(!1);return g(()=>{h.current=!0}),a.useCallback(function(n,a){if(void 0===a&&(a={}),!h.current)return;if("number"===typeof n)return void r.go(n);let s=(0,i.Gh)(n,JSON.parse(d),l,"path"===a.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:(0,i.HS)([t,s.pathname])),(a.replace?r.replace:r.push)(s,a.state,a)},[t,r,d,l,e])}()}function y(){let{matches:e}=a.useContext(u),t=e[e.length-1];return t?t.params:{}}function b(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=a.useContext(c),{matches:s}=a.useContext(u),{pathname:o}=m(),l=JSON.stringify((0,i.yD)(s,r.v7_relativeSplatPath));return a.useMemo(()=>(0,i.Gh)(e,JSON.parse(l),o,"path"===n),[e,l,o,n])}function w(e,t,n,r){f()||(0,i.Oi)(!1);let{navigator:o}=a.useContext(c),{matches:l}=a.useContext(u),h=l[l.length-1],p=h?h.params:{},g=(h&&h.pathname,h?h.pathnameBase:"/");h&&h.route;let v,y=m();if(t){var b;let e="string"===typeof t?(0,i.Rr)(t):t;"/"===g||(null==(b=e.pathname)?void 0:b.startsWith(g))||(0,i.Oi)(!1),v=e}else v=y;let w=v.pathname||"/",_=w;if("/"!==g){let e=g.replace(/^\//,"").split("/");_="/"+w.replace(/^\//,"").split("/").slice(e.length).join("/")}let A=(0,i.ue)(e,{pathname:_});let S=x(A&&A.map(e=>Object.assign({},e,{params:Object.assign({},p,e.params),pathname:(0,i.HS)([g,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?g:(0,i.HS)([g,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,r);return t&&S?a.createElement(d.Provider,{value:{location:s({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:i.rc.Pop}},S):S}function _(){let e=function(){var e;let t=a.useContext(h),n=P(T.UseRouteError),r=I(T.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=(0,i.pX)(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:s},n):null,null)}const A=a.createElement(_,null);class S extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(u.Provider,{value:this.props.routeContext},a.createElement(h.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function C(e){let{routeContext:t,match:n,children:r}=e,i=a.useContext(o);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(u.Provider,{value:t},r)}function x(e,t,n,r){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let l=e,c=null==(s=n)?void 0:s.errors;if(null!=c){let e=l.findIndex(e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id]));e>=0||(0,i.Oi)(!1),l=l.slice(0,Math.min(l.length,e+1))}let d=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let a=0;a<l.length;a++){let e=l[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=a),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){d=!0,l=u>=0?l.slice(0,u+1):[l[0]];break}}}return l.reduceRight((e,r,i)=>{let s,o=!1,h=null,p=null;var f;n&&(s=c&&r.route.id?c[r.route.id]:void 0,h=r.route.errorElement||A,d&&(u<0&&0===i?(f="route-fallback",!1||R[f]||(R[f]=!0),o=!0,p=null):u===i&&(o=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(l.slice(0,i+1)),g=()=>{let t;return t=s?h:o?p:r.route.Component?a.createElement(r.route.Component,null):r.route.element?r.route.element:e,a.createElement(C,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?a.createElement(S,{location:n.location,revalidation:n.revalidation,component:h,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var E=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(E||{}),T=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(T||{});function k(e){let t=a.useContext(o);return t||(0,i.Oi)(!1),t}function P(e){let t=a.useContext(l);return t||(0,i.Oi)(!1),t}function I(e){let t=function(){let e=a.useContext(u);return e||(0,i.Oi)(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||(0,i.Oi)(!1),n.route.id}const R={};const N=(e,t,n)=>{};function O(e,t){void 0===(null==e?void 0:e.v7_startTransition)&&N("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),void 0!==(null==e?void 0:e.v7_relativeSplatPath)||t&&void 0!==t.v7_relativeSplatPath||N("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),t&&(void 0===t.v7_fetcherPersist&&N("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),void 0===t.v7_normalizeFormMethod&&N("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),void 0===t.v7_partialHydration&&N("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),void 0===t.v7_skipActionErrorRevalidation&&N("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}(r||(r=n.t(a,2))).startTransition;function M(e){let{to:t,replace:n,state:r,relative:s}=e;f()||(0,i.Oi)(!1);let{future:o,static:l}=a.useContext(c),{matches:d}=a.useContext(u),{pathname:h}=m(),p=v(),g=(0,i.Gh)(t,(0,i.yD)(d,o.v7_relativeSplatPath),h,"path"===s),y=JSON.stringify(g);return a.useEffect(()=>p(JSON.parse(y),{replace:n,state:r,relative:s}),[p,y,s,n,r]),null}function F(e){(0,i.Oi)(!1)}function D(e){let{basename:t="/",children:n=null,location:r,navigationType:o=i.rc.Pop,navigator:l,static:u=!1,future:h}=e;f()&&(0,i.Oi)(!1);let p=t.replace(/^\/*/,"/"),m=a.useMemo(()=>({basename:p,navigator:l,static:u,future:s({v7_relativeSplatPath:!1},h)}),[p,h,l,u]);"string"===typeof r&&(r=(0,i.Rr)(r));let{pathname:g="/",search:v="",hash:y="",state:b=null,key:w="default"}=r,_=a.useMemo(()=>{let e=(0,i.pb)(g,p);return null==e?null:{location:{pathname:e,search:v,hash:y,state:b,key:w},navigationType:o}},[p,g,v,y,b,w,o]);return null==_?null:a.createElement(c.Provider,{value:m},a.createElement(d.Provider,{children:n,value:_}))}function L(e){let{children:t,location:n}=e;return w(j(t),n)}new Promise(()=>{});a.Component;function j(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,(e,r)=>{if(!a.isValidElement(e))return;let s=[...t,r];if(e.type===a.Fragment)return void n.push.apply(n,j(e.props.children,s));e.type!==F&&(0,i.Oi)(!1),e.props.index&&e.props.children&&(0,i.Oi)(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=j(e.props.children,s)),n.push(o)}),n}},8728:(e,t,n)=>{e.exports=function e(t,n,r){function a(s,o){if(!n[s]){if(!t[s]){if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return a(t[s][1][e]||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var i=void 0,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(e,t,n){"use strict";var r=e("./utils"),a=e("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,a,s,o,l,c,d=[],u=0,h=e.length,p=h,f="string"!==r.getTypeOf(e);u<e.length;)p=h-u,a=f?(t=e[u++],n=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),n=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),s=t>>2,o=(3&t)<<4|n>>4,l=1<p?(15&n)<<2|a>>6:64,c=2<p?63&a:64,d.push(i.charAt(s)+i.charAt(o)+i.charAt(l)+i.charAt(c));return d.join("")},n.decode=function(e){var t,n,r,s,o,l,c=0,d=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===i.charAt(64)&&p--,e.charAt(e.length-2)===i.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=a.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=i.indexOf(e.charAt(c++))<<2|(s=i.indexOf(e.charAt(c++)))>>4,n=(15&s)<<4|(o=i.indexOf(e.charAt(c++)))>>2,r=(3&o)<<6|(l=i.indexOf(e.charAt(c++))),h[d++]=t,64!==o&&(h[d++]=n),64!==l&&(h[d++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),a=e("./stream/DataWorker"),i=e("./stream/Crc32Probe"),s=e("./stream/DataLengthProbe");function o(e,t,n,r,a){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=a}o.prototype={getContentWorker:function(){var e=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,n){return e.pipe(new i).pipe(new s("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var i=a,s=r+n;e^=-1;for(var o=r;o<s;o++)e=e>>>8^i[255&(e^t[o])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var i=a,s=r+n;e^=-1;for(var o=r;o<s;o++)e=e>>>8^i[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r=null;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=e("pako"),i=e("./utils"),s=e("./stream/GenericWorker"),o=r?"uint8array":"array";function l(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",i.inherits(l,s),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(i.transformTo(o,e.data),!1)},l.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function a(e,t,n,a,s,d){var u,h,p=e.file,f=e.compression,m=d!==o.utf8encode,g=i.transformTo("string",d(p.name)),v=i.transformTo("string",o.utf8encode(p.name)),y=p.comment,b=i.transformTo("string",d(y)),w=i.transformTo("string",o.utf8encode(y)),_=v.length!==p.name.length,A=w.length!==y.length,S="",C="",x="",E=p.dir,T=p.date,k={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(k.crc32=e.crc32,k.compressedSize=e.compressedSize,k.uncompressedSize=e.uncompressedSize);var P=0;t&&(P|=8),m||!_&&!A||(P|=2048);var I=0,R=0;E&&(I|=16),"UNIX"===s?(R=798,I|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(p.unixPermissions,E)):(R=20,I|=function(e){return 63&(e||0)}(p.dosPermissions)),u=T.getUTCHours(),u<<=6,u|=T.getUTCMinutes(),u<<=5,u|=T.getUTCSeconds()/2,h=T.getUTCFullYear()-1980,h<<=4,h|=T.getUTCMonth()+1,h<<=5,h|=T.getUTCDate(),_&&(C=r(1,1)+r(l(g),4)+v,S+="up"+r(C.length,2)+C),A&&(x=r(1,1)+r(l(b),4)+w,S+="uc"+r(x.length,2)+x);var N="";return N+="\n\0",N+=r(P,2),N+=f.magic,N+=r(u,2),N+=r(h,2),N+=r(k.crc32,4),N+=r(k.compressedSize,4),N+=r(k.uncompressedSize,4),N+=r(g.length,2),N+=r(S.length,2),{fileRecord:c.LOCAL_FILE_HEADER+N+g+S,dirRecord:c.CENTRAL_FILE_HEADER+r(R,2)+N+r(b.length,2)+"\0\0\0\0"+r(I,4)+r(a,4)+g+S+b}}var i=e("../utils"),s=e("../stream/GenericWorker"),o=e("../utf8"),l=e("../crc32"),c=e("../signature");function d(e,t,n,r){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(d,s),d.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=a(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=a(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,a=function(e,t,n,a,s){var o=i.transformTo("string",s(a));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(o.length,2)+o}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:a,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},d.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),a=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var i=new a(t.streamFiles,n,t.platform,t.encodeFileName),s=0;try{e.forEach(function(e,n){s++;var a=function(e,t){var n=e||t,a=r[n];if(!a)throw new Error(n+" is not a valid compression method !");return a}(n.options.compression,t.compression),o=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(a,o).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(i)}),i.entriesCount=s}catch(e){i.error(e)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),a=e("./external"),i=e("./utf8"),s=e("./zipEntries"),o=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new a.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new o);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),l.isNode&&l.isStream(e)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new s(t);return n.load(e),n}).then(function(e){var n=[a.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var i=0;i<r.length;i++)n.push(c(r[i]));return a.Promise.all(n)}).then(function(e){for(var a=e.shift(),i=a.files,s=0;s<i.length;s++){var o=i[s],l=o.fileNameStr,c=r.resolve(o.fileNameStr);n.file(c,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(n.file(c).unsafeOriginalName=l)}return a.zipComment.length&&(n.comment=a.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),a=e("../stream/GenericWorker");function i(e,t){a.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(i,a),i.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function a(e,t,n){r.call(this,t),this._helper=e;var a=this;e.on("data",function(e,t){a.push(e)||a._helper.pause(),n&&n(t)}).on("error",function(e){a.emit("error",e)}).on("end",function(){a.push(null)})}e("../utils").inherits(a,r),a.prototype._read=function(){this._helper.resume()},t.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,a=i.getTypeOf(t),o=i.extend(n||{},l);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=m(e)),o.createFolders&&(r=f(e))&&g.call(this,r,!0);var u="string"===a&&!1===o.binary&&!1===o.base64;n&&void 0!==n.binary||(o.binary=!u),(t instanceof c&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",a="string");var v=null;v=t instanceof c||t instanceof s?t:h.isNode&&h.isStream(t)?new p(e,t):i.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var y=new d(e,v,o);this.files[e]=y}var a=e("./utf8"),i=e("./utils"),s=e("./stream/GenericWorker"),o=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(v(e)){var a=e;return this.filter(function(e,t){return!t.dir&&a.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=u.generateWorker(this,n,r)}catch(e){(t=new s("error")).error(e)}return new o(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function a(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(a,r),a.prototype.byteAt=function(e){return this.data[this.zero+e]},a.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),a=e.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===t&&this.data[i+1]===n&&this.data[i+2]===r&&this.data[i+3]===a)return i-this.zero;return-1},a.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),a=e.charCodeAt(3),i=this.readData(4);return t===i[0]&&n===i[1]&&r===i[2]&&a===i[3]},a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function a(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=a},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function a(e){r.call(this,e)}e("../utils").inherits(a,r),a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function a(e){r.call(this,e)}e("../utils").inherits(a,r),a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},a.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function a(e){r.call(this,e)}e("../utils").inherits(a,r),a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),a=e("../support"),i=e("./ArrayReader"),s=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||a.uint8array?"nodebuffer"===t?new o(e):a.uint8array?new l(r.transformTo("uint8array",e)):new i(r.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),a=e("../utils");function i(e){r.call(this,"ConvertWorker to "+e),this.destType=e}a.inherits(i,r),i.prototype.processChunk=function(e){this.push({data:a.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),a=e("../crc32");function i(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(i,r),i.prototype.processChunk=function(e){this.streamInfo.crc32=a(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),a=e("./GenericWorker");function i(e){a.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(i,a),i.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}a.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),a=e("./GenericWorker");function i(e){a.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(i,a),i.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),a=e("./ConvertWorker"),i=e("./GenericWorker"),s=e("../base64"),o=e("../support"),l=e("../external"),c=null;if(o.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function d(e,t){return new l.Promise(function(n,a){var i=[],o=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){i.push(e),t&&t(n)}).on("error",function(e){i=[],a(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return s.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,a=null,i=0;for(n=0;n<t.length;n++)i+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(a=new Uint8Array(i),n=0;n<t.length;n++)a.set(t[n],r),r+=t[n].length;return a;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,i),c);n(e)}catch(e){a(e)}i=[]}).resume()})}function u(e,t,n){var s=t;switch(t){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=t,this._mimeType=n,r.checkSupport(s),this._worker=e.pipe(new a(s)),e.lock()}catch(e){this._worker=new i("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return d(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(r),n.blob=0===a.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),a=e("./support"),i=e("./nodejsUtils"),s=e("./stream/GenericWorker"),o=new Array(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){s.call(this,"utf-8 decode"),this.leftOver=null}function d(){s.call(this,"utf-8 encode")}o[254]=o[254]=1,n.utf8encode=function(e){return a.nodebuffer?i.newBufferFrom(e,"utf-8"):function(e){var t,n,r,i,s,o=e.length,l=0;for(i=0;i<o;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=a.uint8array?new Uint8Array(l):new Array(l),i=s=0;s<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){return a.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,a,i,s=e.length,l=new Array(2*s);for(t=n=0;t<s;)if((a=e[t++])<128)l[n++]=a;else if(4<(i=o[a]))l[n++]=65533,t+=i-1;else{for(a&=2===i?31:3===i?15:7;1<i&&t<s;)a=a<<6|63&e[t++],i--;1<i?l[n++]=65533:a<65536?l[n++]=a:(a-=65536,l[n++]=55296|a>>10&1023,l[n++]=56320|1023&a)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(a.uint8array?"uint8array":"array",e))},r.inherits(c,s),c.prototype.processChunk=function(e){var t=r.transformTo(a.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}(t),l=t;s!==t.length&&(a.uint8array?(l=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(l=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(d,s),d.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),a=e("./base64"),i=e("./nodejsUtils"),s=e("./external");function o(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(t,r){n.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return a.append(t),a.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var r=[],a=0,i=e.length;if(i<=n)return String.fromCharCode.apply(null,e);for(;a<i;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+n,i)))):r.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+n,i)))),a+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,i.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,r=n.getTypeOf(e),a=!0;if("uint8array"===r?a=c.applyCanBeUsed.uint8array:"nodebuffer"===r&&(a=c.applyCanBeUsed.nodebuffer),a)for(;1<t;)try{return c.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=d;var h={};h.string={string:o,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,i.allocBuffer(e.length))}},h.array={string:d,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(e)}},h.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return i.newBufferFrom(e)}},h.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:o},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var a=t[r];"."===a||""===a&&0!==r&&r!==t.length-1||(".."===a?n.pop():n.push(a))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&i.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,i,o,c){return s.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var d=n.getTypeOf(t);return d?("arraybuffer"===d?t=n.transformTo("uint8array",t):"string"===d&&(c?t=a.decode(t):i&&!0!==o&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),a=e("./utils"),i=e("./signature"),s=e("./zipEntry"),o=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",n=a.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,i.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),a=e("./utils"),i=e("./compressedObject"),s=e("./crc32"),o=e("./utf8"),l=e("./compressions"),c=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,a=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<a;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(a)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=a.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var i=a.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var a=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),s=e("./utf8"),o=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!r&&(t=t.pipe(new s.Utf8EncodeWorker)),!i&&r&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new a(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof l?this._data:new i(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)r.prototype[c[u]]=d;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var i=0,s=new a(d),o=e.document.createTextNode("");s.observe(o,{characterData:!0}),n=function(){o.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,n=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||n()}}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function a(){}var i={},s=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==a&&p(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){r(function(){var r;try{r=t(n)}catch(r){return i.reject(e,r)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function a(t){n||(n=!0,i.resolve(e,t))}var s=f(function(){t(a,r)});"error"===s.status&&r(s.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(a);return this.state!==l?u(n,this.state===o?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){i.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=f(h,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=o,e.outcome=t;for(var a=-1,s=e.queue.length;++a<s;)e.queue[a].callFulfilled(t)}return e},i.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:i.resolve(new this(a),e)},c.reject=function(e){var t=new this(a);return i.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),o=0,l=-1,c=new this(a);++l<n;)d(e[l],l);return c;function d(e,a){t.resolve(e).then(function(e){s[a]=e,++o!==n||r||(r=!0,i.resolve(c,s))},function(e){r||(r=!0,i.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s,o=-1,l=new this(a);++o<n;)s=e[o],t.resolve(s).then(function(e){r||(r=!0,i.resolve(l,e))},function(e){r||(r=!0,i.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),a=e("./utils/common"),i=e("./utils/strings"),s=e("./zlib/messages"),o=e("./zlib/zstream"),l=Object.prototype.toString,c=0,d=-1,u=0,h=8;function p(e){if(!(this instanceof p))return new p(e);this.options=a.assign({level:d,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(s[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,f))!==c)throw new Error(s[n]);this._dict_set=!0}}function f(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}p.prototype.push=function(e,t){var n,s,o=this.strm,d=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new a.Buf8(d),o.next_out=0,o.avail_out=d),1!==(n=r.deflate(o,s))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(i.buf2binstring(a.shrinkBuf(o.output,o.next_out))):this.onData(a.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==s||(this.onEnd(c),!(o.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=p,n.deflate=f,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),a=e("./utils/common"),i=e("./utils/strings"),s=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}u.prototype.push=function(e,t){var n,o,l,c,u,h,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?p.input=i.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new a.Buf8(f),p.next_out=0,p.avail_out=f),(n=r.inflate(p,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&m&&(h="string"==typeof m?i.string2buf(m):"[object ArrayBuffer]"===d.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===s.Z_BUF_ERROR&&!0===g&&(n=s.Z_OK,g=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==s.Z_STREAM_END&&(0!==p.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(p.output,p.next_out),c=p.next_out-l,u=i.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&a.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(a.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,n,r,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),a);else for(var i=0;i<r;i++)e[a+i]=t[n+i]},flattenChunks:function(e){var t,n,r,a,i,s;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),t=a=0,n=e.length;t<n;t++)i=e[t],s.set(i,a),a+=i.length;return s}},i={arraySet:function(e,t,n,r,a){for(var i=0;i<r;i++)e[a+i]=t[n+i]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,i))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),a=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var s=new r.Buf8(256),o=0;o<256;o++)s[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function l(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,n.string2buf=function(e){var t,n,a,i,s,o=e.length,l=0;for(i=0;i<o;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(a=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(a-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),i=s=0;s<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(a=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(a-56320),i++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,a=t.length;n<a;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,a,i,o=t||e.length,c=new Array(2*o);for(n=r=0;n<o;)if((a=e[n++])<128)c[r++]=a;else if(4<(i=s[a]))c[r++]=65533,n+=i-1;else{for(a&=2===i?31:3===i?15:7;1<i&&n<o;)a=a<<6|63&e[n++],i--;1<i?c[r++]=65533:a<65536?c[r++]=a:(a-=65536,c[r++]=55296|a>>10&1023,c[r++]=56320|1023&a)}return l(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var a=65535&e,i=e>>>16&65535,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;i=i+(a=a+t[r++]|0)|0,--s;);a%=65521,i%=65521}return a|i<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,a){var i=r,s=a+n;e^=-1;for(var o=a;o<s;o++)e=e>>>8^i[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,a=e("../utils/common"),i=e("./trees"),s=e("./adler32"),o=e("./crc32"),l=e("./messages"),c=0,d=4,u=0,h=-2,p=-1,f=4,m=2,g=8,v=9,y=286,b=30,w=19,_=2*y+1,A=15,S=3,C=258,x=C+S+1,E=42,T=113,k=1,P=2,I=3,R=4;function N(e,t){return e.msg=l[t],t}function O(e){return(e<<1)-(4<e?9:0)}function M(e){for(var t=e.length;0<=--t;)e[t]=0}function F(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(a.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function D(e,t){i._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)}function L(e,t){e.pending_buf[e.pending++]=t}function j(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function B(e,t){var n,r,a=e.max_chain_length,i=e.strstart,s=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+C,p=c[i+s-1],f=c[i+s];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(n=t)+s]===f&&c[n+s-1]===p&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<h);if(r=C-(h-i),i=h-C,s<r){if(e.match_start=t,o<=(s=r))break;p=c[i+s-1],f=c[i+s]}}}while((t=u[t&d])>l&&0!=--a);return s<=e.lookahead?s:e.lookahead}function U(e){var t,n,r,i,l,c,d,u,h,p,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-x)){for(a.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;r=e.head[--t],e.head[t]=f<=r?r-f:0,--n;);for(t=n=f;r=e.prev[--t],e.prev[t]=f<=r?r-f:0,--n;);i+=f}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,p=void 0,(h=i)<(p=c.avail_in)&&(p=h),n=0===p?0:(c.avail_in-=p,a.arraySet(d,c.input,c.next_in,p,u),1===c.state.wrap?c.adler=s(c.adler,d,p,u):2===c.state.wrap&&(c.adler=o(c.adler,d,p,u)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=S)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+S-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<S)););}while(e.lookahead<x&&0!==e.strm.avail_in)}function G(e,t){for(var n,r;;){if(e.lookahead<x){if(U(e),e.lookahead<x&&t===c)return k;if(0===e.lookahead)break}if(n=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-x&&(e.match_length=B(e,n)),e.match_length>=S)if(r=i._tr_tally(e,e.strstart-e.match_start,e.match_length-S),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=S){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=e.strstart<S-1?e.strstart:S-1,t===d?(D(e,!0),0===e.strm.avail_out?I:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?k:P}function H(e,t){for(var n,r,a;;){if(e.lookahead<x){if(U(e),e.lookahead<x&&t===c)return k;if(0===e.lookahead)break}if(n=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=S-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-x&&(e.match_length=B(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===S&&4096<e.strstart-e.match_start)&&(e.match_length=S-1)),e.prev_length>=S&&e.match_length<=e.prev_length){for(a=e.strstart+e.lookahead-S,r=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-S),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=S-1,e.strstart++,r&&(D(e,!1),0===e.strm.avail_out))return k}else if(e.match_available){if((r=i._tr_tally(e,0,e.window[e.strstart-1]))&&D(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return k}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<S-1?e.strstart:S-1,t===d?(D(e,!0),0===e.strm.avail_out?I:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?k:P}function z(e,t,n,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=a}function W(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*_),this.dyn_dtree=new a.Buf16(2*(2*b+1)),this.bl_tree=new a.Buf16(2*(2*w+1)),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(A+1),this.heap=new a.Buf16(2*y+1),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*y+1),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function q(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?E:T,e.adler=2===t.wrap?0:1,t.last_flush=c,i._tr_init(t),u):N(e,h)}function V(e){var t=q(e);return t===u&&function(e){e.window_size=2*e.w_size,M(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=S-1,e.match_available=0,e.ins_h=0}(e.state),t}function K(e,t,n,r,i,s){if(!e)return h;var o=1;if(t===p&&(t=6),r<0?(o=0,r=-r):15<r&&(o=2,r-=16),i<1||v<i||n!==g||r<8||15<r||t<0||9<t||s<0||f<s)return N(e,h);8===r&&(r=9);var l=new W;return(e.state=l).strm=e,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+S-1)/S),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=n,V(e)}r=[new z(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(U(e),0===e.lookahead&&t===c)return k;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,D(e,!1),0===e.strm.avail_out))return k;if(e.strstart-e.block_start>=e.w_size-x&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===d?(D(e,!0),0===e.strm.avail_out?I:R):(e.strstart>e.block_start&&(D(e,!1),e.strm.avail_out),k)}),new z(4,4,8,4,G),new z(4,5,16,8,G),new z(4,6,32,32,G),new z(4,4,16,16,H),new z(8,16,32,32,H),new z(8,16,128,128,H),new z(8,32,128,256,H),new z(32,128,258,1024,H),new z(32,258,258,4096,H)],n.deflateInit=function(e,t){return K(e,t,g,15,8,0)},n.deflateInit2=K,n.deflateReset=V,n.deflateResetKeep=q,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,u):h},n.deflate=function(e,t){var n,a,s,l;if(!e||!e.state||5<t||t<0)return e?N(e,h):h;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==d)return N(e,0===e.avail_out?-5:h);if(a.strm=e,n=a.last_flush,a.last_flush=t,a.status===E)if(2===a.wrap)e.adler=0,L(a,31),L(a,139),L(a,8),a.gzhead?(L(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),L(a,255&a.gzhead.time),L(a,a.gzhead.time>>8&255),L(a,a.gzhead.time>>16&255),L(a,a.gzhead.time>>24&255),L(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),L(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(L(a,255&a.gzhead.extra.length),L(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=o(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(L(a,0),L(a,0),L(a,0),L(a,0),L(a,0),L(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),L(a,3),a.status=T);else{var p=g+(a.w_bits-8<<4)<<8;p|=(2<=a.strategy||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(p|=32),p+=31-p%31,a.status=T,j(a,p),0!==a.strstart&&(j(a,e.adler>>>16),j(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(s=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),F(e),s=a.pending,a.pending!==a.pending_buf_size));)L(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),F(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,L(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),F(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,L(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&F(e),a.pending+2<=a.pending_buf_size&&(L(a,255&e.adler),L(a,e.adler>>8&255),e.adler=0,a.status=T)):a.status=T),0!==a.pending){if(F(e),0===e.avail_out)return a.last_flush=-1,u}else if(0===e.avail_in&&O(t)<=O(n)&&t!==d)return N(e,-5);if(666===a.status&&0!==e.avail_in)return N(e,-5);if(0!==e.avail_in||0!==a.lookahead||t!==c&&666!==a.status){var f=2===a.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(U(e),0===e.lookahead)){if(t===c)return k;break}if(e.match_length=0,n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===d?(D(e,!0),0===e.strm.avail_out?I:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?k:P}(a,t):3===a.strategy?function(e,t){for(var n,r,a,s,o=e.window;;){if(e.lookahead<=C){if(U(e),e.lookahead<=C&&t===c)return k;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=S&&0<e.strstart&&(r=o[a=e.strstart-1])===o[++a]&&r===o[++a]&&r===o[++a]){s=e.strstart+C;do{}while(r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&r===o[++a]&&a<s);e.match_length=C-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=S?(n=i._tr_tally(e,1,e.match_length-S),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===d?(D(e,!0),0===e.strm.avail_out?I:R):e.last_lit&&(D(e,!1),0===e.strm.avail_out)?k:P}(a,t):r[a.level].func(a,t);if(f!==I&&f!==R||(a.status=666),f===k||f===I)return 0===e.avail_out&&(a.last_flush=-1),u;if(f===P&&(1===t?i._tr_align(a):5!==t&&(i._tr_stored_block(a,0,0,!1),3===t&&(M(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),F(e),0===e.avail_out))return a.last_flush=-1,u}return t!==d?u:a.wrap<=0?1:(2===a.wrap?(L(a,255&e.adler),L(a,e.adler>>8&255),L(a,e.adler>>16&255),L(a,e.adler>>24&255),L(a,255&e.total_in),L(a,e.total_in>>8&255),L(a,e.total_in>>16&255),L(a,e.total_in>>24&255)):(j(a,e.adler>>>16),j(a,65535&e.adler)),F(e),0<a.wrap&&(a.wrap=-a.wrap),0!==a.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==E&&69!==t&&73!==t&&91!==t&&103!==t&&t!==T&&666!==t?N(e,h):(e.state=null,t===T?N(e,-3):u):h},n.deflateSetDictionary=function(e,t){var n,r,i,o,l,c,d,p,f=t.length;if(!e||!e.state)return h;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==E||n.lookahead)return h;for(1===o&&(e.adler=s(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(M(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new a.Buf8(n.w_size),a.arraySet(p,t,f-n.w_size,n.w_size,0),t=p,f=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,U(n);n.lookahead>=S;){for(r=n.strstart,i=n.lookahead-(S-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+S-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--i;);n.strstart=r,n.lookahead=S-1,U(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=S-1,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=o,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,a,i,s,o,l,c,d,u,h,p,f,m,g,v,y,b,w,_,A,S,C,x,E;n=e.state,r=e.next_in,x=e.input,a=r+(e.avail_in-5),i=e.next_out,E=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),l=n.dmax,c=n.wsize,d=n.whave,u=n.wnext,h=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=x[r++]<<f,f+=8,p+=x[r++]<<f,f+=8),b=m[p&v];t:for(;;){if(p>>>=w=b>>>24,f-=w,0===(w=b>>>16&255))E[i++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(p&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}_=65535&b,(w&=15)&&(f<w&&(p+=x[r++]<<f,f+=8),_+=p&(1<<w)-1,p>>>=w,f-=w),f<15&&(p+=x[r++]<<f,f+=8,p+=x[r++]<<f,f+=8),b=g[p&y];n:for(;;){if(p>>>=w=b>>>24,f-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=g[(65535&b)+(p&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(A=65535&b,f<(w&=15)&&(p+=x[r++]<<f,(f+=8)<w&&(p+=x[r++]<<f,f+=8)),l<(A+=p&(1<<w)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=w,f-=w,(w=i-s)<A){if(d<(w=A-w)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(C=h,(S=0)===u){if(S+=c-w,w<_){for(_-=w;E[i++]=h[S++],--w;);S=i-A,C=E}}else if(u<w){if(S+=c+u-w,(w-=u)<_){for(_-=w;E[i++]=h[S++],--w;);if(S=0,u<_){for(_-=w=u;E[i++]=h[S++],--w;);S=i-A,C=E}}}else if(S+=u-w,w<_){for(_-=w;E[i++]=h[S++],--w;);S=i-A,C=E}for(;2<_;)E[i++]=C[S++],E[i++]=C[S++],E[i++]=C[S++],_-=3;_&&(E[i++]=C[S++],1<_&&(E[i++]=C[S++]))}else{for(S=i-A;E[i++]=E[S++],E[i++]=E[S++],E[i++]=E[S++],2<(_-=3););_&&(E[i++]=E[S++],1<_&&(E[i++]=E[S++]))}break}}break}}while(r<a&&i<o);r-=_=f>>3,p&=(1<<(f-=_<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=i<o?o-i+257:257-(i-o),n.hold=p,n.bits=f}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),a=e("./adler32"),i=e("./crc32"),s=e("./inffast"),o=e("./inftrees"),l=1,c=2,d=0,u=-2,h=1,p=852,f=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(p),t.distcode=t.distdyn=new r.Buf32(f),t.sane=1,t.back=-1,d):u}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,v(e)):u}function b(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,y(e))):u}function w(e,t){var n,r;return e?(r=new g,(e.state=r).window=null,(n=b(e,t))!==d&&(e.state=null),n):u}var _,A,S=!0;function C(e){if(S){var t;for(_=new r.Buf32(512),A=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(l,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(c,e.lens,0,32,A,0,e.work,{bits:5}),S=!1}e.lencode=_,e.lenbits=9,e.distcode=A,e.distbits=5}function x(e,t,n,a){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),a>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(a<(i=s.wsize-s.wnext)&&(i=a),r.arraySet(s.window,t,n-a,i,s.wnext),(a-=i)?(r.arraySet(s.window,t,n-a,a,0),s.wnext=a,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}n.inflateReset=y,n.inflateReset2=b,n.inflateResetKeep=v,n.inflateInit=function(e){return w(e,15)},n.inflateInit2=w,n.inflate=function(e,t){var n,p,f,g,v,y,b,w,_,A,S,E,T,k,P,I,R,N,O,M,F,D,L,j,B=0,U=new r.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),v=e.next_out,f=e.output,b=e.avail_out,g=e.next_in,p=e.input,y=e.avail_in,w=n.hold,_=n.bits,A=y,S=b,D=d;e:for(;;)switch(n.mode){case h:if(0===n.wrap){n.mode=13;break}for(;_<16;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(2&n.wrap&&35615===w){U[n.check=0]=255&w,U[1]=w>>>8&255,n.check=i(n.check,U,2,0),_=w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&w)){e.msg="unknown compression method",n.mode=30;break}if(_-=4,F=8+(15&(w>>>=4)),0===n.wbits)n.wbits=F;else if(F>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<F,e.adler=n.check=1,n.mode=512&w?10:12,_=w=0;break;case 2:for(;_<16;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=i(n.check,U,2,0)),_=w=0,n.mode=3;case 3:for(;_<32;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.head&&(n.head.time=w),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,U[2]=w>>>16&255,U[3]=w>>>24&255,n.check=i(n.check,U,4,0)),_=w=0,n.mode=4;case 4:for(;_<16;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=i(n.check,U,2,0)),_=w=0,n.mode=5;case 5:if(1024&n.flags){for(;_<16;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(U[0]=255&w,U[1]=w>>>8&255,n.check=i(n.check,U,2,0)),_=w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(y<(E=n.length)&&(E=y),E&&(n.head&&(F=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,p,g,E,F)),512&n.flags&&(n.check=i(n.check,p,E,g)),y-=E,g+=E,n.length-=E),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===y)break e;for(E=0;F=p[g+E++],n.head&&F&&n.length<65536&&(n.head.name+=String.fromCharCode(F)),F&&E<y;);if(512&n.flags&&(n.check=i(n.check,p,E,g)),y-=E,g+=E,F)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===y)break e;for(E=0;F=p[g+E++],n.head&&F&&n.length<65536&&(n.head.comment+=String.fromCharCode(F)),F&&E<y;);if(512&n.flags&&(n.check=i(n.check,p,E,g)),y-=E,g+=E,F)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;_<16;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}_=w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;_<32;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}e.adler=n.check=m(w),_=w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=_,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){w>>>=7&_,_-=7&_,n.mode=27;break}for(;_<3;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}switch(n.last=1&w,_-=1,3&(w>>>=1)){case 0:n.mode=14;break;case 1:if(C(n),n.mode=20,6!==t)break;w>>>=2,_-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}w>>>=2,_-=2;break;case 14:for(w>>>=7&_,_-=7&_;_<32;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&w,_=w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(E=n.length){if(y<E&&(E=y),b<E&&(E=b),0===E)break e;r.arraySet(f,p,g,E,v),y-=E,g+=E,b-=E,v+=E,n.length-=E;break}n.mode=12;break;case 17:for(;_<14;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(n.nlen=257+(31&w),w>>>=5,_-=5,n.ndist=1+(31&w),w>>>=5,_-=5,n.ncode=4+(15&w),w>>>=4,_-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;_<3;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.lens[G[n.have++]]=7&w,w>>>=3,_-=3}for(;n.have<19;)n.lens[G[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L={bits:n.lenbits},D=o(0,n.lens,0,19,n.lencode,0,n.work,L),n.lenbits=L.bits,D){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;I=(B=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,R=65535&B,!((P=B>>>24)<=_);){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(R<16)w>>>=P,_-=P,n.lens[n.have++]=R;else{if(16===R){for(j=P+2;_<j;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(w>>>=P,_-=P,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}F=n.lens[n.have-1],E=3+(3&w),w>>>=2,_-=2}else if(17===R){for(j=P+3;_<j;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}_-=P,F=0,E=3+(7&(w>>>=P)),w>>>=3,_-=3}else{for(j=P+7;_<j;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}_-=P,F=0,E=11+(127&(w>>>=P)),w>>>=7,_-=7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=F}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,L={bits:n.lenbits},D=o(l,n.lens,0,n.nlen,n.lencode,0,n.work,L),n.lenbits=L.bits,D){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,L={bits:n.distbits},D=o(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L),n.distbits=L.bits,D){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=y&&258<=b){e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=_,s(e,S),v=e.next_out,f=e.output,b=e.avail_out,g=e.next_in,p=e.input,y=e.avail_in,w=n.hold,_=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;I=(B=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,R=65535&B,!((P=B>>>24)<=_);){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(I&&0==(240&I)){for(N=P,O=I,M=R;I=(B=n.lencode[M+((w&(1<<N+O)-1)>>N)])>>>16&255,R=65535&B,!(N+(P=B>>>24)<=_);){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}w>>>=N,_-=N,n.back+=N}if(w>>>=P,_-=P,n.back+=P,n.length=R,0===I){n.mode=26;break}if(32&I){n.back=-1,n.mode=12;break}if(64&I){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&I,n.mode=22;case 22:if(n.extra){for(j=n.extra;_<j;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,_-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;I=(B=n.distcode[w&(1<<n.distbits)-1])>>>16&255,R=65535&B,!((P=B>>>24)<=_);){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(0==(240&I)){for(N=P,O=I,M=R;I=(B=n.distcode[M+((w&(1<<N+O)-1)>>N)])>>>16&255,R=65535&B,!(N+(P=B>>>24)<=_);){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}w>>>=N,_-=N,n.back+=N}if(w>>>=P,_-=P,n.back+=P,64&I){e.msg="invalid distance code",n.mode=30;break}n.offset=R,n.extra=15&I,n.mode=24;case 24:if(n.extra){for(j=n.extra;_<j;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,_-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===b)break e;if(E=S-b,n.offset>E){if((E=n.offset-E)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}T=E>n.wnext?(E-=n.wnext,n.wsize-E):n.wnext-E,E>n.length&&(E=n.length),k=n.window}else k=f,T=v-n.offset,E=n.length;for(b<E&&(E=b),b-=E,n.length-=E;f[v++]=k[T++],--E;);0===n.length&&(n.mode=21);break;case 26:if(0===b)break e;f[v++]=n.length,b--,n.mode=21;break;case 27:if(n.wrap){for(;_<32;){if(0===y)break e;y--,w|=p[g++]<<_,_+=8}if(S-=b,e.total_out+=S,n.total+=S,S&&(e.adler=n.check=n.flags?i(n.check,f,S,v-S):a(n.check,f,S,v-S)),S=b,(n.flags?w:m(w))!==n.check){e.msg="incorrect data check",n.mode=30;break}_=w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;_<32;){if(0===y)break e;y--,w+=p[g++]<<_,_+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}_=w=0}n.mode=29;case 29:D=1;break e;case 30:D=-3;break e;case 31:return-4;default:return u}return e.next_out=v,e.avail_out=b,e.next_in=g,e.avail_in=y,n.hold=w,n.bits=_,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&x(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(A-=e.avail_in,S-=e.avail_out,e.total_in+=A,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?i(n.check,f,S,e.next_out-S):a(n.check,f,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==A&&0===S||4===t)&&D===d&&(D=-5),D)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,d},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?u:((n.head=t).done=!1,d):u},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&a(1,t,r,0)!==n.check?-3:x(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,d):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,d,u,h){var p,f,m,g,v,y,b,w,_,A=h.bits,S=0,C=0,x=0,E=0,T=0,k=0,P=0,I=0,R=0,N=0,O=null,M=0,F=new r.Buf16(16),D=new r.Buf16(16),L=null,j=0;for(S=0;S<=15;S++)F[S]=0;for(C=0;C<l;C++)F[t[n+C]]++;for(T=A,E=15;1<=E&&0===F[E];E--);if(E<T&&(T=E),0===E)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(x=1;x<E&&0===F[x];x++);for(T<x&&(T=x),S=I=1;S<=15;S++)if(I<<=1,(I-=F[S])<0)return-1;if(0<I&&(0===e||1!==E))return-1;for(D[1]=0,S=1;S<15;S++)D[S+1]=D[S]+F[S];for(C=0;C<l;C++)0!==t[n+C]&&(u[D[t[n+C]]++]=C);if(y=0===e?(O=L=u,19):1===e?(O=a,M-=257,L=i,j-=257,256):(O=s,L=o,-1),S=x,v=d,P=C=N=0,m=-1,g=(R=1<<(k=T))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(b=S-P,_=u[C]<y?(w=0,u[C]):u[C]>y?(w=L[j+u[C]],O[M+u[C]]):(w=96,0),p=1<<S-P,x=f=1<<k;c[v+(N>>P)+(f-=p)]=b<<24|w<<16|_,0!==f;);for(p=1<<S-1;N&p;)p>>=1;if(0!==p?(N&=p-1,N+=p):N=0,C++,0==--F[S]){if(S===E)break;S=t[n+u[C]]}if(T<S&&(N&g)!==m){for(0===P&&(P=T),v+=x,I=1<<(k=S-P);k+P<E&&!((I-=F[k+P])<=0);)k++,I<<=1;if(R+=1<<k,1===e&&852<R||2===e&&592<R)return 1;c[m=N&g]=T<<24|k<<16|v-d}}return 0!==N&&(c[v+N]=S-P<<24|64<<16),h.bits=T,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common"),a=0,i=1;function s(e){for(var t=e.length;0<=--t;)e[t]=0}var o=0,l=29,c=256,d=c+1+l,u=30,h=19,p=2*d+1,f=15,m=16,g=7,v=256,y=16,b=17,w=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(d+2));s(x);var E=new Array(2*u);s(E);var T=new Array(512);s(T);var k=new Array(256);s(k);var P=new Array(l);s(P);var I,R,N,O=new Array(u);function M(e,t,n,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function D(e){return e<256?T[e]:T[256+(e>>>7)]}function L(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function j(e,t,n){e.bi_valid>m-n?(e.bi_buf|=t<<e.bi_valid&65535,L(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=n-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function B(e,t,n){j(e,n[2*t],n[2*t+1])}function U(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function G(e,t,n){var r,a,i=new Array(f+1),s=0;for(r=1;r<=f;r++)i[r]=s=s+n[r-1]<<1;for(a=0;a<=t;a++){var o=e[2*a+1];0!==o&&(e[2*a]=U(i[o]++,o))}}function H(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function z(e){8<e.bi_valid?L(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function W(e,t,n,r){var a=2*t,i=2*n;return e[a]<e[i]||e[a]===e[i]&&r[t]<=r[n]}function q(e,t,n){for(var r=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&W(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!W(t,r,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=r}function V(e,t,n){var r,a,i,s,o=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],a=e.pending_buf[e.l_buf+o],o++,0===r?B(e,a,t):(B(e,(i=k[a])+c+1,t),0!==(s=_[i])&&j(e,a-=P[i],s),B(e,i=D(--r),n),0!==(s=A[i])&&j(e,r-=O[i],s)),o<e.last_lit;);B(e,v,t)}function K(e,t){var n,r,a,i=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=p,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=s[2*a+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)q(e,i,n);for(a=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],q(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,i[2*a]=i[2*n]+i[2*r],e.depth[a]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,i[2*n+1]=i[2*r+1]=a,e.heap[1]=a++,q(e,i,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,a,i,s,o,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,v=0;for(i=0;i<=f;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<p;n++)g<(i=l[2*l[2*(r=e.heap[n])+1]+1]+1)&&(i=g,v++),l[2*r+1]=i,c<r||(e.bl_count[i]++,s=0,m<=r&&(s=h[r-m]),o=l[2*r],e.opt_len+=o*(i+s),u&&(e.static_len+=o*(d[2*r+1]+s)));if(0!==v){do{for(i=g-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[g]--,v-=2}while(0<v);for(i=g;0!==i;i--)for(r=e.bl_count[i];0!==r;)c<(a=e.heap[--n])||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),r--)}}(e,t),G(i,c,e.bl_count)}function Y(e,t,n){var r,a,i=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)a=s,s=t[2*(r+1)+1],++o<l&&a===s||(o<c?e.bl_tree[2*a]+=o:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[2*y]++):o<=10?e.bl_tree[2*b]++:e.bl_tree[2*w]++,i=a,c=(o=0)===s?(l=138,3):a===s?(l=6,3):(l=7,4))}function X(e,t,n){var r,a,i=-1,s=t[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),r=0;r<=n;r++)if(a=s,s=t[2*(r+1)+1],!(++o<l&&a===s)){if(o<c)for(;B(e,a,e.bl_tree),0!=--o;);else 0!==a?(a!==i&&(B(e,a,e.bl_tree),o--),B(e,y,e.bl_tree),j(e,o-3,2)):o<=10?(B(e,b,e.bl_tree),j(e,o-3,3)):(B(e,w,e.bl_tree),j(e,o-11,7));i=a,c=(o=0)===s?(l=138,3):a===s?(l=6,3):(l=7,4)}}s(O);var Q=!1;function $(e,t,n,a){j(e,(o<<1)+(a?1:0),3),function(e,t,n,a){z(e),a&&(L(e,n),L(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){Q||(function(){var e,t,n,r,a,i=new Array(f+1);for(r=n=0;r<l-1;r++)for(P[r]=n,e=0;e<1<<_[r];e++)k[n++]=r;for(k[n-1]=r,r=a=0;r<16;r++)for(O[r]=a,e=0;e<1<<A[r];e++)T[a++]=r;for(a>>=7;r<u;r++)for(O[r]=a<<7,e=0;e<1<<A[r]-7;e++)T[256+a++]=r;for(t=0;t<=f;t++)i[t]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,i[8]++;for(;e<=255;)x[2*e+1]=9,e++,i[9]++;for(;e<=279;)x[2*e+1]=7,e++,i[7]++;for(;e<=287;)x[2*e+1]=8,e++,i[8]++;for(G(x,d+1,i),e=0;e<u;e++)E[2*e+1]=5,E[2*e]=U(e,5);I=new M(x,_,c+1,d,f),R=new M(E,A,0,u,f),N=new M(new Array(0),S,0,h,g)}(),Q=!0),e.l_desc=new F(e.dyn_ltree,I),e.d_desc=new F(e.dyn_dtree,R),e.bl_desc=new F(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,H(e)},n._tr_stored_block=$,n._tr_flush_block=function(e,t,n,r){var s,o,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return i;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return i;return a}(e)),K(e,e.l_desc),K(e,e.d_desc),l=function(e){var t;for(Y(e,e.dyn_ltree,e.l_desc.max_code),Y(e,e.dyn_dtree,e.d_desc.max_code),K(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*C[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),s=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=s&&(s=o)):s=o=n+5,n+4<=s&&-1!==t?$(e,t,n,r):4===e.strategy||o===s?(j(e,2+(r?1:0),3),V(e,x,E)):(j(e,4+(r?1:0),3),function(e,t,n,r){var a;for(j(e,t-257,5),j(e,n-1,5),j(e,r-4,4),a=0;a<r;a++)j(e,e.bl_tree[2*C[a]+1],3);X(e,e.dyn_ltree,t-1),X(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),V(e,e.dyn_ltree,e.dyn_dtree)),H(e),r&&z(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(k[n]+c+1)]++,e.dyn_dtree[2*D(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){j(e,2,3),B(e,v,x),function(e){16===e.bi_valid?(L(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,a,i,s=1,o={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){h(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){a.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(h,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var a={callback:e,args:t};return o[s]=a,n(s),s++},d.clearImmediate=u}function u(e){delete o[e]}function h(e){if(l)setTimeout(h,0,e);else{var n=o[e];if(n){l=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{u(e),l=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&h(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9644:(e,t,n)=>{"use strict";n.d(t,{W:()=>r,z:()=>a});const r="unexpected_error",a="post_request_failed"},9950:(e,t,n)=>{"use strict";e.exports=n(2049)},9955:(e,t,n)=>{"use strict";n.r(t),n.d(t,{msalInstance:()=>Us});var r=n(2555),a=n(8398),i=n(4388);const s="AAD",o="OIDC",l="none";var c=n(8186);const d="client_info_decoding_error",u="client_info_empty_error",h="token_parsing_error",p="null_or_empty_token",f="endpoints_resolution_error",m="network_error",g="openid_config_error",v="hash_not_deserialized",y="invalid_state",b="state_mismatch",w="state_not_found",_="nonce_mismatch",A="auth_time_not_found",S="max_age_transpired",C="multiple_matching_tokens",x="multiple_matching_accounts",E="multiple_matching_appMetadata",T="request_cannot_be_made",k="cannot_remove_empty_scope",P="cannot_append_scopeset",I="empty_input_scopeset",R="device_code_polling_cancelled",N="device_code_expired",O="device_code_unknown_error",M="no_account_in_silent_request",F="invalid_cache_record",D="invalid_cache_environment",L="no_account_found",j="no_crypto_object",B="unexpected_credential_type",U="invalid_assertion",G="invalid_client_credential",H="token_refresh_required",z="user_timeout_reached",W="token_claims_cnf_required_for_signedjwt",q="authorization_code_missing_from_server_response",V="binding_key_not_removed",K="end_session_endpoint_not_supported",Y="key_id_missing",X="no_network_connectivity",Q="user_canceled",$="missing_tenant_id_error",J="method_not_implemented",Z="nested_app_auth_bridge_disabled",ee={[d]:"The client info could not be parsed/decoded correctly",[u]:"The client info was empty",[h]:"Token cannot be parsed",[p]:"The token is null or empty",[f]:"Endpoints cannot be resolved",[m]:"Network request failed",[g]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[v]:"The hash parameters could not be deserialized",[y]:"State was not the expected format",[b]:"State mismatch error",[w]:"State not found",[_]:"Nonce mismatch error",[A]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[S]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[C]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[x]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[E]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[T]:"Token request cannot be made without authorization code or refresh token.",[k]:"Cannot remove null or empty scope from ScopeSet",[P]:"Cannot append ScopeSet",[I]:"Empty input ScopeSet cannot be processed",[R]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[N]:"Device code is expired.",[O]:"Device code stopped polling for unknown reasons.",[M]:"Please pass an account object, silent flow is not supported without account information",[F]:"Cache record object was null or undefined.",[D]:"Invalid environment when attempting to create cache entry",[L]:"No account found in cache for given key.",[j]:"No crypto object detected.",[B]:"Unexpected credential type.",[U]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[G]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[H]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[z]:"User defined timeout for device code polling reached",[W]:"Cannot generate a POP jwt if the token_claims are not populated",[q]:"Server response does not contain an authorization code to proceed",[V]:"Could not remove the credential's binding key from storage.",[K]:"The provided authority does not support logout",[Y]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[X]:"No network connectivity. Check your internet connection.",[Q]:"User cancelled the flow.",[$]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[J]:"This method has not been implemented",[Z]:"The nested app auth bridge is disabled"};class te extends c.lR{constructor(e,t){super(e,t?"".concat(ee[e],": ").concat(t):ee[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,te.prototype)}}function ne(e,t){return new te(e,t)}const re={createNewGuid:()=>{throw ne(J)},base64Decode:()=>{throw ne(J)},base64Encode:()=>{throw ne(J)},base64UrlEncode:()=>{throw ne(J)},encodeKid:()=>{throw ne(J)},async getPublicKeyThumbprint(){throw ne(J)},async removeTokenBindingKey(){throw ne(J)},async clearKeystore(){throw ne(J)},async signJwt(){throw ne(J)},async hashString(){throw ne(J)}},ae="@azure/msal-common",ie="14.16.1";function se(e,t){const n=function(e){if(!e)throw ne(p);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw ne(h);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw ne(h)}}function oe(e,t){if(0===t||Date.now()-3e5>e+t)throw ne(S)}function le(){return Math.round((new Date).getTime()/1e3)}function ce(e,t){const n=Number(e)||0;return le()+t>n}function de(e){return[ye(e),be(e),we(e),_e(e),Ae(e)].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function ue(e,t,n,r,a){return{credentialType:i.aG.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:a}}function he(e,t,n,r,a,s,o,l,c,d,u,h,p,f,m){var g,v;const y={homeAccountId:e,credentialType:i.aG.ACCESS_TOKEN,secret:n,cachedAt:le().toString(),expiresOn:o.toString(),extendedExpiresOn:l.toString(),environment:t,clientId:r,realm:a,target:s,tokenType:u||i.IO.BEARER};if(h&&(y.userAssertionHash=h),d&&(y.refreshOn=d.toString()),f&&(y.requestedClaims=f,y.requestedClaimsHash=m),(null===(g=y.tokenType)||void 0===g?void 0:g.toLowerCase())!==i.IO.BEARER.toLowerCase())switch(y.credentialType=i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case i.IO.POP:const e=se(n,c);if(null===e||void 0===e||null===(v=e.cnf)||void 0===v||!v.kid)throw ne(W);y.keyId=e.cnf.kid;break;case i.IO.SSH:y.keyId=p}return y}function pe(e,t,n,r,a,s,o){const l={credentialType:i.aG.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n};return s&&(l.userAssertionHash=s),a&&(l.familyId=a),o&&(l.expiresOn=o.toString()),l}function fe(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function me(e){return!!e&&(fe(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===i.aG.ACCESS_TOKEN||e.credentialType===i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function ge(e){return!!e&&(fe(e)&&e.hasOwnProperty("realm")&&e.credentialType===i.aG.ID_TOKEN)}function ve(e){return!!e&&(fe(e)&&e.credentialType===i.aG.REFRESH_TOKEN)}function ye(e){return[e.homeAccountId,e.environment].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function be(e){const t=e.credentialType===i.aG.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function we(e){return(e.target||"").toLowerCase()}function _e(e){return(e.requestedClaimsHash||"").toLowerCase()}function Ae(e){return e.tokenType&&e.tokenType.toLowerCase()!==i.IO.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function Se(){return le()+i.u0.REFRESH_TIME_SECONDS}function Ce(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function xe(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Ee(e){return e.expiresAt<=le()}const Te="redirect_uri_empty",ke="claims_request_parsing_error",Pe="authority_uri_insecure",Ie="url_parse_error",Re="empty_url_error",Ne="empty_input_scopes_error",Oe="invalid_prompt_value",Me="invalid_claims",Fe="token_request_empty",De="logout_request_empty",Le="invalid_code_challenge_method",je="pkce_params_missing",Be="invalid_cloud_discovery_metadata",Ue="invalid_authority_metadata",Ge="untrusted_authority",He="missing_ssh_jwk",ze="missing_ssh_kid",We="missing_nonce_authentication_header",qe="invalid_authentication_header",Ve="cannot_set_OIDCOptions",Ke="cannot_allow_native_broker",Ye="authority_mismatch",Xe={[Te]:"A redirect URI is required for all calls, and none has been set.",[ke]:"Could not parse the given claims request object.",[Pe]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Ie]:"URL could not be parsed into appropriate segments.",[Re]:"URL was empty or null.",[Ne]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Oe]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Me]:"Given claims parameter must be a stringified JSON object.",[Fe]:"Token request was empty and not found in cache.",[De]:"The logout request was null or undefined.",[Le]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[je]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Be]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ue]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Ge]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[He]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[ze]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[We]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[qe]:"Invalid authentication header provided",[Ve]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ke]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[Ye]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Qe extends c.lR{constructor(e){super(e,Xe[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Qe.prototype)}}function $e(e){return new Qe(e)}class Je{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,a]=e.split(/=(.+)/g,2);n&&a&&(t[r(n)]=r(a))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Ze{constructor(e){const t=e?Je.trimArrayEntries([...e]):[],n=t?Je.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||i.YM.EMPTY_STRING).split(" ");return new Ze(t)}static createSearchScopes(e){const t=new Ze(e);return t.containsOnlyOIDCScopes()?t.removeScope(i.YM.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw $e(Ne)}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Ze(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return i._A.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(t){throw ne(P)}}removeScope(e){if(!e)throw ne(k);this.scopes.delete(e.trim())}removeOIDCScopes(){i._A.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ne(I);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw ne(I);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return i.YM.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function et(e,t){if(!e)throw ne(u);try{const n=t(e);return JSON.parse(n)}catch(n){throw ne(d)}}function tt(e){if(!e)throw ne(d);const t=e.split(i.LR.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?i.YM.EMPTY_STRING:t[1]}}function nt(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const rt=["isHomeTenant"],at=["isHomeTenant"];function it(e,t){return!!e&&!!t&&e===t.split(".")[1]}function st(e,t,n,r){if(r){const{oid:t,sub:n,tid:a,name:i,tfp:s,acr:o}=r,l=a||s||o||"";return{tenantId:l,localAccountId:t||n||"",name:i,isHomeTenant:it(l,e)}}return{tenantId:n,localAccountId:t,isHomeTenant:it(n,e)}}function ot(e,t,n,a){let i=e;if(t){const{isHomeTenant:n}=t,a=nt(t,rt);i=(0,r.A)((0,r.A)({},e),a)}if(n){const t=st(e.homeAccountId,e.localAccountId,e.tenantId,n),{isHomeTenant:s}=t,o=nt(t,at);return i=(0,r.A)((0,r.A)((0,r.A)({},i),o),{},{idTokenClaims:n,idToken:a}),i}return i}const lt=0,ct=1,dt=2,ut=3;function ht(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class pt{generateAccountId(){return[this.homeAccountId,this.environment].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return pt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){var r,a,o,l,c,d,u,h;const p=new pt;let f;t.authorityType===ct?p.authorityType=i.Qd.ADFS_ACCOUNT_TYPE:t.protocolMode===s?p.authorityType=i.Qd.MSSTS_ACCOUNT_TYPE:p.authorityType=i.Qd.GENERIC_ACCOUNT_TYPE,e.clientInfo&&n&&(f=et(e.clientInfo,n)),p.clientInfo=e.clientInfo,p.homeAccountId=e.homeAccountId,p.nativeAccountId=e.nativeAccountId;const m=e.environment||t&&t.getPreferredCache();if(!m)throw ne(D);p.environment=m,p.realm=(null===(r=f)||void 0===r?void 0:r.utid)||ht(e.idTokenClaims)||"",p.localAccountId=(null===(a=f)||void 0===a?void 0:a.uid)||(null===(o=e.idTokenClaims)||void 0===o?void 0:o.oid)||(null===(l=e.idTokenClaims)||void 0===l?void 0:l.sub)||"";const g=(null===(c=e.idTokenClaims)||void 0===c?void 0:c.preferred_username)||(null===(d=e.idTokenClaims)||void 0===d?void 0:d.upn),v=null!==(u=e.idTokenClaims)&&void 0!==u&&u.emails?e.idTokenClaims.emails[0]:null;if(p.username=g||v||"",p.name=(null===(h=e.idTokenClaims)||void 0===h?void 0:h.name)||"",p.cloudGraphHostName=e.cloudGraphHostName,p.msGraphHost=e.msGraphHost,e.tenantProfiles)p.tenantProfiles=e.tenantProfiles;else{const t=st(e.homeAccountId,p.localAccountId,p.realm,e.idTokenClaims);p.tenantProfiles=[t]}return p}static createFromAccountInfo(e,t,n){var r;const a=new pt;return a.authorityType=e.authorityType||i.Qd.GENERIC_ACCOUNT_TYPE,a.homeAccountId=e.homeAccountId,a.localAccountId=e.localAccountId,a.nativeAccountId=e.nativeAccountId,a.realm=e.tenantId,a.environment=e.environment,a.username=e.username,a.name=e.name,a.cloudGraphHostName=t,a.msGraphHost=n,a.tenantProfiles=Array.from((null===(r=e.tenantProfiles)||void 0===r?void 0:r.values())||[]),a}static generateHomeAccountId(e,t,n,r,a){if(t!==ct&&t!==dt){if(e)try{const t=et(e,r.base64Decode);if(t.uid&&t.utid)return"".concat(t.uid,".").concat(t.utid)}catch(i){}n.warning("No client info in response")}return(null===a||void 0===a?void 0:a.sub)||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},a=t.idTokenClaims||{};r=n.iat===a.iat&&n.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function ft(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function mt(e){if(!e||e.indexOf("=")<0)return null;try{const t=ft(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.error||n.error_description||n.state)return n}catch(t){throw ne(v)}return null}class gt{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw $e(Re);e.includes("#")||(this._urlString=gt.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Je.endsWith(t,"?")?t=t.slice(0,-1):Je.endsWith(t,"?/")&&(t=t.slice(0,-2)),Je.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw $e(Ie)}if(!e.HostNameAndPort||!e.PathSegments)throw $e(Ie);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw $e(Pe)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return gt.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==i.v2.COMMON&&n[0]!==i.v2.ORGANIZATIONS||(n[0]=e),gt.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw $e(Ie);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw $e(Ie);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===i.YM.FORWARD_SLASH){const n=new gt(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new gt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!mt(e)}}const vt={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},yt={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},bt=new Set;function wt(e,t,n,r){if(null===r||void 0===r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){const a=_t(t,e);if(a)return null===r||void 0===r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),a.aliases;null===r||void 0===r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function _t(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}yt.metadata.forEach(e=>{e.aliases.forEach(e=>{bt.add(e)})});const At="cache_quota_exceeded",St="cache_error_unknown",Ct={[At]:"Exceeded cache storage capacity.",[St]:"Unexpected error occurred when using cache storage."};class xt extends Error{constructor(e,t){const n=t||(Ct[e]?Ct[e]:Ct[St]);super("".concat(e,": ").concat(n)),Object.setPrototypeOf(this,xt.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function Et(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new xt(At):new xt(e.name,e.message):new xt(St)}class Tt{constructor(e,t,n,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(ae,ie),this.staticAuthorityOptions=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(t||{},e),e,t)}getAccountInfoFilteredBy(e,t){const n=this.getAllAccounts(t,e);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null===n||void 0===n?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,a){let i,s=null;if(a&&!this.tenantProfileMatchesFilter(n,a))return null;const o=this.getIdToken(e,r,t,n.tenantId);return o&&(i=se(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,a))?null:(s=ot(e,n,i,null===o||void 0===o?void 0:o.secret),s)}getTenantProfilesFromAccountEntity(e,t,n,r){const a=e.getAccountInfo();let i=a.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const e=i.get(n);if(!e)return[];i=new Map([[n,e]])}const o=[];return i.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(a,s,e,t,r);n&&o.push(n)}),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw ne(F);try{e.account&&this.setAccount(e.account,t),e.idToken&&!1!==(null===n||void 0===n?void 0:n.idToken)&&this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==(null===n||void 0===n?void 0:n.accessToken)&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==(null===n||void 0===n?void 0:n.refreshToken)&&this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(a){var r;throw null===(r=this.commonLogger)||void 0===r||r.error("CacheManager.saveCacheRecord: failed"),a instanceof c.lR?a:Et(a)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),a=Ze.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){Ze.fromString(r.target).intersectingScopeSets(a)&&this.removeAccessToken(e,t)}}),this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{var a;if(!this.isAccountKey(n,e.homeAccountId))return;const i=this.getAccount(n,t,this.commonLogger);if(!i)return;if(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId))return;if(e.username&&!this.matchUsername(i.username,e.username))return;if(e.environment&&!this.matchEnvironment(i,e.environment))return;if(e.realm&&!this.matchRealm(i,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const s={localAccountId:null===e||void 0===e?void 0:e.localAccountId,name:null===e||void 0===e?void 0:e.name},o=null===(a=i.tenantProfiles)||void 0===a?void 0:a.filter(e=>this.tenantProfileMatchesFilter(e,s));o&&0===o.length||r.push(i)}),r}isAccountKey(e,t,n){return!(e.split(i.LR.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(n&&!e.toLowerCase().includes(n.toLowerCase())))}isCredentialKey(e){if(e.split(i.LR.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(i.aG.ID_TOKEN.toLowerCase())&&-1===t.indexOf(i.aG.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(i.aG.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(i.aG.REFRESH_TOKEN.toLowerCase())>-1){const e="".concat(i.aG.REFRESH_TOKEN).concat(i.LR.CACHE_KEY_SEPARATOR).concat(this.clientId).concat(i.LR.CACHE_KEY_SEPARATOR),n="".concat(i.aG.REFRESH_TOKEN).concat(i.LR.CACHE_KEY_SEPARATOR).concat(i.hB).concat(i.LR.CACHE_KEY_SEPARATOR);if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===i.IO.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}async removeAllAccounts(e){const t=this.getAccountKeys(),n=[];t.forEach(t=>{n.push(this.removeAccount(t,e))}),await Promise.all(n)}async removeAccount(e,t){const n=this.getAccount(e,t,this.commonLogger);n&&(await this.removeAccountContext(n,t),this.removeItem(e,t))}async removeAccountContext(e,t){const n=this.getTokenKeys(),r=e.generateAccountId();n.idToken.forEach(e=>{0===e.indexOf(r)&&this.removeIdToken(e,t)}),n.accessToken.forEach(e=>{0===e.indexOf(r)&&this.removeAccessToken(e,t)}),n.refreshToken.forEach(e=>{0===e.indexOf(r)&&this.removeRefreshToken(e,t)}),this.getKeys().forEach(e=>{e.includes(r)&&this.removeItem(e,t)})}updateOutdatedCachedAccount(e,t,n,a){if(t&&t.isSingleTenant()){var i;null===(i=this.commonLogger)||void 0===i||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const s=this.getAccountKeys().filter(e=>e.startsWith(t.homeAccountId)),o=[];s.forEach(e=>{const t=this.getCachedAccountEntity(e,n);t&&o.push(t)});const l=o.find(e=>it(e.realm,e.homeAccountId))||o[0];l.tenantProfiles=o.map(e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:it(e.realm,e.homeAccountId)}));const c=Tt.toObject(new pt,(0,r.A)({},l)),d=c.generateAccountKey();return s.forEach(t=>{t!==d&&this.removeOutdatedAccount(e,n)}),this.setAccount(c,n),null===a||void 0===a||a.verbose("Updated an outdated account entity in the cache"),c}return t}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),!n||n.credentialType.toLowerCase()!==i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==i.IO.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}readAccountFromCache(e,t){const n=pt.generateAccountCacheKey(e);return this.getAccount(n,t,this.commonLogger)}getIdToken(e,t,n,r,a){this.commonLogger.trace("CacheManager - getIdToken called");const s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.aG.ID_TOKEN,clientId:this.clientId,realm:r},o=this.getIdTokensByFilter(s,t,n),l=o.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let n=o;if(!r){const t=new Map;o.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),a&&t&&a.addFields({multiMatchedID:o.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t,n){const a=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return a.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,(0,r.A)({clientId:this.clientId},e)))return;const a=this.getIdTokenCredential(n,t);a&&this.credentialMatchesFilter(a,e)&&i.set(n,a)}),i}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r,a){this.commonLogger.trace("CacheManager - getAccessToken called");const s=Ze.createSearchScopes(t.scopes),o=t.authenticationScheme||i.IO.BEARER,l=o&&o.toLowerCase()!==i.IO.BEARER.toLowerCase()?i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME:i.aG.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:r||e.tenantId,target:s,tokenType:o,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];d.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){const n=this.getAccessTokenCredential(e,t.correlationId);n&&this.credentialMatchesFilter(n,c)&&u.push(n)}});const h=u.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),u.forEach(e=>{this.removeAccessToken(de(e),t.correlationId)}),a&&t.correlationId&&a.addFields({multiMatchedAT:u.length},t.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const a=this.getAccessTokenCredential(n,t);a&&this.credentialMatchesFilter(a,e)&&r.push(a)}),r}getRefreshToken(e,t,n,r,a){this.commonLogger.trace("CacheManager - getRefreshToken called");const s=t?i.hB:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.aG.REFRESH_TOKEN,clientId:this.clientId,familyId:s},l=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,o)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,o)&&c.push(t)}});const d=c.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&a&&n&&a.addFields({multiMatchedRT:d},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),a=r.length;if(a<1)return null;if(a>1)throw ne(E);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==i.hB)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!==typeof e||(null===t||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){var a;const s=new gt(r).getUrlComponents().HostNameAndPort;n=wt(s,null===(a=e.cloudDiscoveryMetadata)||void 0===a?void 0:a.metadata,i.E_.CONFIG,t)||wt(s,yt.metadata,i.E_.HARDCODED_VALUES,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==i.aG.ACCESS_TOKEN&&e.credentialType!==i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Ze.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(i.GU)}isAuthorityMetadata(e){return-1!==e.indexOf(i.u0.CACHE_KEY)}generateAuthorityMetadataCacheKey(e){return"".concat(i.u0.CACHE_KEY,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class kt extends Tt{setAccount(){throw ne(J)}getAccount(){throw ne(J)}getCachedAccountEntity(){throw ne(J)}setIdTokenCredential(){throw ne(J)}getIdTokenCredential(){throw ne(J)}setAccessTokenCredential(){throw ne(J)}getAccessTokenCredential(){throw ne(J)}setRefreshTokenCredential(){throw ne(J)}getRefreshTokenCredential(){throw ne(J)}setAppMetadata(){throw ne(J)}getAppMetadata(){throw ne(J)}setServerTelemetry(){throw ne(J)}getServerTelemetry(){throw ne(J)}setAuthorityMetadata(){throw ne(J)}getAuthorityMetadata(){throw ne(J)}getAuthorityMetadataKeys(){throw ne(J)}setThrottlingCache(){throw ne(J)}getThrottlingCache(){throw ne(J)}removeItem(){throw ne(J)}getKeys(){throw ne(J)}getAccountKeys(){throw ne(J)}getTokenKeys(){throw ne(J)}updateCredentialCacheKey(){throw ne(J)}removeOutdatedAccount(){throw ne(J)}}const Pt={tokenRenewalOffsetSeconds:i.F0,preventCorsPreflight:!1},It={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:a.$.Info,correlationId:i.YM.EMPTY_STRING},Rt={claimsBasedCachingEnabled:!1},Nt={async sendGetRequestAsync(){throw ne(J)},async sendPostRequestAsync(){throw ne(J)}},Ot={sku:i.YM.SKU,version:ie,cpu:i.YM.EMPTY_STRING,os:i.YM.EMPTY_STRING},Mt={clientSecret:i.YM.EMPTY_STRING,clientAssertion:void 0},Ft={azureCloudInstance:l,tenant:"".concat(i.YM.DEFAULT_COMMON_TENANT)},Dt={application:{appName:"",appVersion:""}};function Lt(e){return e.authOptions.authority.options.protocolMode===o}const jt={sendGetRequestAsync:()=>Promise.reject(ne(J)),sendPostRequestAsync:()=>Promise.reject(ne(J))},Bt="acquireTokenByCode",Ut="acquireTokenByRefreshToken",Gt="acquireTokenSilent",Ht="acquireTokenSilentAsync",zt="acquireTokenPopup",Wt="acquireTokenPreRedirect",qt="acquireTokenRedirect",Vt="cryptoOptsGetPublicKeyThumbprint",Kt="cryptoOptsSignJwt",Yt="silentCacheClientAcquireToken",Xt="silentIframeClientAcquireToken",Qt="awaitConcurrentIframe",$t="silentRefreshClientAcquireToken",Jt="ssoSilent",Zt="standardInteractionClientGetDiscoveredAuthority",en="fetchAccountIdWithNativeBroker",tn="nativeInteractionClientAcquireToken",nn="networkClientSendPostRequestAsync",rn="refreshTokenClientExecutePostToTokenEndpoint",an="authorizationCodeClientExecutePostToTokenEndpoint",sn="refreshTokenClientExecuteTokenRequest",on="refreshTokenClientAcquireToken",ln="refreshTokenClientAcquireTokenWithCachedRefreshToken",cn="refreshTokenClientAcquireTokenByRefreshToken",dn="refreshTokenClientCreateTokenRequestBody",un="acquireTokenFromCache",hn="silentFlowClientAcquireCachedToken",pn="silentFlowClientGenerateResultFromCacheRecord",fn="acquireTokenBySilentIframe",mn="initializeBaseRequest",gn="initializeSilentRequest",vn="initializeClientApplication",yn="silentIframeClientTokenHelper",bn="silentHandlerInitiateAuthRequest",wn="silentHandlerMonitorIframeForHash",_n="silentHandlerLoadFrame",An="silentHandlerLoadFrameSync",Sn="standardInteractionClientCreateAuthCodeClient",Cn="standardInteractionClientGetClientConfiguration",xn="standardInteractionClientInitializeAuthorizationRequest",En="standardInteractionClientInitializeAuthorizationCodeRequest",Tn="getAuthCodeUrl",kn="handleCodeResponseFromServer",Pn="handleCodeResponse",In="updateTokenEndpointAuthority",Rn="authClientAcquireToken",Nn="authClientExecuteTokenRequest",On="authClientCreateTokenRequestBody",Mn="authClientCreateQueryString",Fn="popTokenGenerateCnf",Dn="popTokenGenerateKid",Ln="handleServerTokenResponse",jn="deserializeResponse",Bn="authorityFactoryCreateDiscoveredInstance",Un="authorityResolveEndpointsAsync",Gn="authorityGetCloudDiscoveryMetadataFromNetwork",Hn="authorityUpdateCloudDiscoveryMetadata",zn="authorityGetEndpointMetadataFromNetwork",Wn="authorityUpdateEndpointMetadata",qn="authorityUpdateMetadataWithRegionalInformation",Vn="regionDiscoveryDetectRegion",Kn="regionDiscoveryGetRegionFromIMDS",Yn="regionDiscoveryGetCurrentVersion",Xn="acquireTokenByCodeAsync",Qn="handleRedirectPromise",$n="handleNativeRedirectPromise",Jn="nativeMessageHandlerHandshake",Zn="removeHiddenIframe",er="clearTokensAndKeysWithClaims",tr="cacheManagerGetRefreshToken",nr="generatePkceCodes",rr="generateCodeVerifier",ar="generateCodeChallengeFromVerifier",ir="sha256Digest",sr="getRandomValues",or=(new Map([[Bt,"ATByCode"],[Ut,"ATByRT"],[Gt,"ATS"],[Ht,"ATSAsync"],[zt,"ATPopup"],[qt,"ATRedirect"],[Vt,"CryptoGetPKThumb"],[Kt,"CryptoSignJwt"],[Yt,"SltCacheClientAT"],[Xt,"SltIframeClientAT"],[$t,"SltRClientAT"],[Jt,"SsoSlt"],[Zt,"StdIntClientGetDiscAuth"],[en,"FetchAccIdWithNtvBroker"],[tn,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[nn,"NetClientSendPost"],[rn,"RTClientExecPost"],[an,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[sn,"RTClientExecTReq"],[on,"RTClientAT"],[ln,"RTClientATWithCachedRT"],[cn,"RTClientATByRT"],[dn,"RTClientCreateTReqBody"],[un,"ATFromCache"],[hn,"SltFlowClientATCached"],[pn,"SltFlowClientGenResFromCache"],[fn,"ATBySltIframe"],[mn,"InitBaseReq"],[gn,"InitSltReq"],[vn,"InitClientApplication"],[yn,"SIClientTHelper"],[bn,"SHandlerInitAuthReq"],[wn,"SltHandlerMonitorIframeForHash"],[_n,"SHandlerLoadFrame"],[An,"SHandlerLoadFrameSync"],[Sn,"StdIntClientCreateAuthCodeClient"],[Cn,"StdIntClientGetClientConf"],[xn,"StdIntClientInitAuthReq"],[En,"StdIntClientInitAuthCodeReq"],[Tn,"GetAuthCodeUrl"],[kn,"HandleCodeResFromServer"],[Pn,"HandleCodeResp"],[In,"UpdTEndpointAuth"],[Rn,"AuthClientAT"],[Nn,"AuthClientExecTReq"],[On,"AuthClientCreateTReqBody"],[Mn,"AuthClientCreateQueryStr"],[Fn,"PopTGenCnf"],[Dn,"PopTGenKid"],[Ln,"HandleServerTRes"],[jn,"DeserializeRes"],[Bn,"AuthFactCreateDiscInst"],[Un,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Gn,"AuthGetCDMetaFromNet"],[Hn,"AuthUpdCDMeta"],[zn,"AuthUpdCDMetaFromNet"],[Wn,"AuthUpdEndpointMeta"],[qn,"AuthUpdMetaWithRegInfo"],[Vn,"RegDiscDetectReg"],[Kn,"RegDiscGetRegFromIMDS"],[Yn,"RegDiscGetCurrentVer"],[Xn,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Qn,"HandleRedirectPromise"],[$n,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Jn,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[Zn,"RemoveHiddenIframe"],[er,"ClearTAndKeysWithClaims"],[tr,"CacheManagerGetRT"],[nr,"GenPkceCodes"],[rr,"GenCodeVerifier"],[ar,"GenCodeChallengeFromVerifier"],[ir,"Sha256Digest"],[sr,"GetRandomValues"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);class lr{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class cr{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:or,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new lr}}startPerformanceMeasurement(){return new lr}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var dr=n(89);class ur{navigateInternal(e,t){return ur.defaultNavigateWindow(e,t)}navigateExternal(e,t){return ur.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(e=>{setTimeout(()=>{e(!0)},t.timeout)})}}class hr extends c.lR{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,hr.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function pr(e,t,n){return new hr(e,t,n)}const fr="pkce_not_created",mr="crypto_nonexistent",gr="empty_navigate_uri",vr="hash_empty_error",yr="no_state_in_hash",br="hash_does_not_contain_known_properties",wr="unable_to_parse_state",_r="state_interaction_type_mismatch",Ar="interaction_in_progress",Sr="popup_window_error",Cr="empty_window_error",xr="user_cancelled",Er="monitor_popup_timeout",Tr="monitor_window_timeout",kr="redirect_in_iframe",Pr="block_iframe_reload",Ir="block_nested_popups",Rr="iframe_closed_prematurely",Nr="silent_logout_unsupported",Or="no_account_error",Mr="silent_prompt_value_error",Fr="no_token_request_cache_error",Dr="unable_to_parse_token_request_cache_error",Lr="no_cached_authority_error",jr="auth_request_not_set_error",Br="invalid_cache_type",Ur="non_browser_environment",Gr="database_not_open",Hr="no_network_connectivity",zr="post_request_failed",Wr="get_request_failed",qr="failed_to_parse_response",Vr="unable_to_load_token",Kr="crypto_key_not_found",Yr="auth_code_required",Xr="auth_code_or_nativeAccountId_required",Qr="spa_code_and_nativeAccountId_present",$r="database_unavailable",Jr="unable_to_acquire_token_from_native_platform",Zr="native_handshake_timeout",ea="native_extension_not_installed",ta="native_connection_not_established",na="uninitialized_public_client_application",ra="native_prompt_not_supported",aa="invalid_base64_string",ia="invalid_pop_token_request",sa="failed_to_build_headers",oa="failed_to_parse_headers",la="For more visit: aka.ms/msaljs/browser-errors",ca={[fr]:"The PKCE code challenge and verifier could not be generated.",[mr]:"The crypto object or function is not available.",[gr]:"Navigation URI is empty. Please check stack trace for more info.",[vr]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(la),[yr]:"Hash does not contain state. Please verify that the request originated from msal.",[br]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(la),[wr]:"Unable to parse state. Please verify that the request originated from msal.",[_r]:"Hash contains state but the interaction type does not match the caller.",[Ar]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(la),[Sr]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Cr]:"window.open returned null or undefined window object.",[xr]:"User cancelled the flow.",[Er]:"Token acquisition in popup failed due to timeout.  ".concat(la),[Tr]:"Token acquisition in iframe failed due to timeout.  ".concat(la),[kr]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Pr]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(la),[Ir]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Rr]:"The iframe being monitored was closed prematurely.",[Nr]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Or]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Mr]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Fr]:"No token request found in cache.",[Dr]:"The cached token request could not be parsed.",[Lr]:"No cached authority found.",[jr]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Br]:"Invalid cache type",[Ur]:"Login and token requests are not supported in non-browser environments.",[Gr]:"Database is not open!",[Hr]:"No network connectivity. Check your internet connection.",[zr]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Wr]:"Network request failed. Please check the network trace to determine root cause.",[qr]:"Failed to parse network response. Check network trace.",[Vr]:"Error loading token to cache.",[Kr]:"Cryptographic Key or Keypair not found in browser storage.",[Yr]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Xr]:"An authorization code or nativeAccountId must be provided to this flow.",[Qr]:"Request cannot contain both spa code and native account id.",[$r]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Jr]:"Unable to acquire token from native platform.  ".concat(la),[Zr]:"Timed out while attempting to establish connection to browser extension",[ea]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[ta]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(la),[na]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(la),[ra]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[aa]:"Invalid base64 encoded string.",[ia]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[sa]:"Failed to build request headers object.",[oa]:"Failed to parse response headers"};class da extends c.lR{constructor(e,t){super(e,ca[e],t),Object.setPrototypeOf(this,da.prototype),this.name="BrowserAuthError"}}function ua(e,t){return new da(e,t)}class ha{async sendGetRequestAsync(e,t){let n,r={},a=0;const i=pa(t);try{n=await fetch(e,{method:dr.CC.GET,headers:i})}catch(s){throw ua(window.navigator.onLine?Wr:Hr)}r=fa(n.headers);try{return a=n.status,{headers:r,body:await n.json(),status:a}}catch(s){throw pr(ua(qr),a,r)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=pa(t);let a,i=0,s={};try{a=await fetch(e,{method:dr.CC.POST,headers:r,body:n})}catch(o){throw ua(window.navigator.onLine?zr:Hr)}s=fa(a.headers);try{return i=a.status,{headers:s,body:await a.json(),status:i}}catch(o){throw pr(ua(qr),i,s)}}}function pa(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(t){throw ua(sa)}}function fa(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(t){throw ua(oa)}}function ma(e){return encodeURIComponent(va(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function ga(e){return ya(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function va(e){return ya((new TextEncoder).encode(e))}function ya(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}const ba="SHA-256",wa=new Uint8Array([1,0,1]),_a="0123456789abcdef",Aa=new Uint32Array(1),Sa={name:"RSASSA-PKCS1-v1_5",hash:ba,modulusLength:2048,publicExponent:wa};async function Ca(e,t,n){null===t||void 0===t||t.addQueueMeasurement(ir,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(ba,r)}function xa(e){return window.crypto.getRandomValues(e)}function Ea(){return window.crypto.getRandomValues(Aa),Aa[0]}function Ta(){const e=Date.now(),t=1024*Ea()+(1023&Ea()),n=new Uint8Array(16),r=Math.trunc(t/2**30),a=t&2**30-1,i=Ea();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|a>>>24,n[9]=a>>>16,n[10]=a>>>8,n[11]=a,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let o=0;o<n.length;o++)s+=_a.charAt(n[o]>>>4),s+=_a.charAt(15&n[o]),3!==o&&5!==o&&7!==o&&9!==o||(s+="-");return s}async function ka(e){return window.crypto.subtle.exportKey(dr.jb,e)}async function Pa(e){const t=await Ca(e);return ga(new Uint8Array(t))}var Ia=n(6221),Ra=n(493);function Na(){return window.parent!==window}function Oa(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Ma(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(dr.Q1.POPUP_NAME_PREFIX,".")))throw ua(Ir)}function Fa(){if("undefined"===typeof window)throw ua(Ur)}function Da(e){if(!e)throw ua(na)}function La(e){Fa(),function(){if(gt.hashContainsKnownProperties(window.location.hash)&&Na())throw ua(Pr)}(),Ma(),Da(e)}function ja(e,t){if(La(e),function(e){if(Na()&&!e)throw ua(kr)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===dr.Al.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw(0,Ia.jz)(Ra.jE)}function Ba(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}const Ua=1e4;const Ga="3.30.0";class Ha{static loggerCallback(e,t){switch(e){case a.$.Error:return void console.error(t);case a.$.Info:return void console.info(t);case a.$.Verbose:return void console.debug(t);case a.$.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,n;let c;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:c,system:d,telemetry:u}=e;const h={clientId:i.YM.EMPTY_STRING,authority:"".concat(i.YM.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:i.YM.EMPTY_STRING,authorityMetadata:i.YM.EMPTY_STRING,redirectUri:"undefined"!==typeof window?Oa():"",postLogoutRedirectUri:i.YM.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:s,OIDCOptions:{serverResponseType:i.zL.FRAGMENT,defaultScopes:[i.YM.OPENID_SCOPE,i.YM.PROFILE_SCOPE,i.YM.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:l,tenant:i.YM.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},p={cacheLocation:dr.Al.SessionStorage,temporaryCacheLocation:dr.Al.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!c||c.cacheLocation!==dr.Al.LocalStorage),claimsBasedCachingEnabled:!1},f={loggerCallback:()=>{},logLevel:a.$.Info,piiLoggingEnabled:!1},m=(0,r.A)((0,r.A)({},Pt),{},{loggerOptions:f,networkClient:t?new ha:jt,navigationClient:new ur,loadFrameTimeout:0,windowHashTimeout:(null===d||void 0===d?void 0:d.loadFrameTimeout)||6e4,iframeHashTimeout:(null===d||void 0===d?void 0:d.loadFrameTimeout)||Ua,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null===d||void 0===d?void 0:d.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:dr.Q1.DEFAULT_POLL_INTERVAL_MS}),g=(0,r.A)((0,r.A)((0,r.A)({},m),d),{},{loggerOptions:(null===d||void 0===d?void 0:d.loggerOptions)||f}),v={application:{appName:i.YM.EMPTY_STRING,appVersion:i.YM.EMPTY_STRING},client:new cr};(null===n||void 0===n?void 0:n.protocolMode)!==o&&null!==n&&void 0!==n&&n.OIDCOptions&&new a.V(g.loggerOptions).warning(JSON.stringify($e(Ve)));if(null!==n&&void 0!==n&&n.protocolMode&&n.protocolMode!==s&&null!==g&&void 0!==g&&g.allowNativeBroker)throw $e(Ke);return{auth:(0,r.A)((0,r.A)((0,r.A)({},h),n),{},{OIDCOptions:(0,r.A)((0,r.A)({},h.OIDCOptions),null===n||void 0===n?void 0:n.OIDCOptions)}),cache:(0,r.A)((0,r.A)({},p),c),system:g,telemetry:(0,r.A)((0,r.A)({},v),u)}}(e,this.browserEnvironment);try{c=window[dr.Al.SessionStorage]}catch(m){}const d=null===(t=c)||void 0===t?void 0:t.getItem(dr.L$),u=null===(n=c)||void 0===n||null===(n=n.getItem(dr.P3))||void 0===n?void 0:n.toLowerCase(),h="true"===u||"false"!==u&&void 0,p=(0,r.A)({},this.config.system.loggerOptions),f=d&&Object.keys(a.$).includes(d)?a.$[d]:void 0;f&&(p.loggerCallback=Ha.loggerCallback,p.logLevel=f),void 0!==h&&(p.piiLoggingEnabled=h),this.logger=new a.V(p,"@azure/msal-browser",Ga),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class za extends Ha{getModuleName(){return za.MODULE_NAME}getId(){return za.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}za.MODULE_NAME="",za.ID="StandardOperatingContext";const Wa="missing_kid_error",qa="missing_alg_error",Va={[Wa]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[qa]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Ka extends c.lR{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Ka.prototype)}}function Ya(e){return new Ka(e,Va[e])}class Xa{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ya(Wa);if(!e.alg)throw Ya(qa);const t=new Xa({typ:e.typ||i.Lz.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function Qa(e){return(new TextDecoder).decode(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw ua(aa)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}(e))}class $a{constructor(){this.dbName=dr.$u,this.version=dr.G8,this.tableName=dr.WJ,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(ua($r)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ua(Gr));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(ua(Gr));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),n()}),a.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ua(Gr));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(ua(Gr));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ua(Gr));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(dr.$u),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class Ja{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class Za{constructor(e){this.inMemoryCache=new Ja,this.indexedDBCache=new $a,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof da&&e.errorCode===$r))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class ei{constructor(e,t,n){this.logger=e,function(e){if(!window)throw ua(Ur);if(!window.crypto)throw ua(mr);if(!e&&!window.crypto.subtle)throw ua(mr,"crypto_subtle_undefined")}(null!==n&&void 0!==n&&n),this.cache=new Za(this.logger),this.performanceClient=t}createNewGuid(){return Ta()}base64Encode(e){return va(e)}base64Decode(e){return Qa(e)}base64UrlEncode(e){return ma(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var t;const n=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(Vt,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(Sa,e,t)}(ei.EXTRACTABLE,ei.POP_KEY_USAGES),a=await ka(r.publicKey),i=ti({e:a.e,kty:a.kty,n:a.n}),s=await this.hashString(i),o=await ka(r.privateKey),l=await async function(e,t,n){return window.crypto.subtle.importKey(dr.jb,e,Sa,t,n)}(o,!1,["sign"]);return await this.cache.setItem(s,{privateKey:l,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),s}async removeTokenBindingKey(e){await this.cache.removeItem(e);return!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,a){var i;const s=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(Kt,a),o=await this.cache.getItem(t);if(!o)throw ua(Kr);const l=await ka(o.publicKey),c=ti(l),d=ma(JSON.stringify({kid:t})),u=ma(Xa.getShrHeaderString((0,r.A)((0,r.A)({},null===n||void 0===n?void 0:n.header),{},{alg:l.alg,kid:d})));e.cnf={jwk:JSON.parse(c)};const h=ma(JSON.stringify(e)),p="".concat(u,".").concat(h),f=(new TextEncoder).encode(p),m=await async function(e,t){return window.crypto.subtle.sign(Sa,e,t)}(o.privateKey,f),g=ga(new Uint8Array(m)),v="".concat(p,".").concat(g);return s&&s.end({success:!0}),v}async hashString(e){return Pa(e)}}function ti(e){return JSON.stringify(e,Object.keys(e).sort())}ei.POP_KEY_USAGES=["sign","verify"],ei.EXTRACTABLE=!0;const ni=(e,t,n,r,a)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,a);if(a){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},a)}try{const r=e(...arguments);return null===i||void 0===i||i.end({success:!0}),n.trace("Returning result from ".concat(t)),r}catch(s){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(s))}catch(s){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},s),s}},ri=(e,t,n,r,a)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,a);if(a){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},a)}return null===r||void 0===r||r.setPreQueueTime(t,a),e(...arguments).then(e=>(n.trace("Returning result from ".concat(t)),null===i||void 0===i||i.end({success:!0}),e)).catch(e=>{n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},e),e})};class ai{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Vn,this.correlationId);let r=e;if(r)t.region_source=i.jZ.ENVIRONMENT_VARIABLE;else{const e=ai.IMDS_OPTIONS;try{const n=await ri(this.getRegionFromIMDS.bind(this),Kn,this.logger,this.performanceClient,this.correlationId)(i.YM.IMDS_VERSION,e);if(n.status===i.Kk.httpSuccess&&(r=n.body,t.region_source=i.jZ.IMDS),n.status===i.Kk.httpBadRequest){const n=await ri(this.getCurrentVersion.bind(this),Yn,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=i.jZ.FAILED_AUTO_DETECTION,null;const a=await ri(this.getRegionFromIMDS.bind(this),Kn,this.logger,this.performanceClient,this.correlationId)(n,e);a.status===i.Kk.httpSuccess&&(r=a.body,t.region_source=i.jZ.IMDS)}}catch(a){return t.region_source=i.jZ.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=i.jZ.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var n;return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Kn,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(i.YM.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,i.YM.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Yn,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(i.YM.IMDS_ENDPOINT,"?format=json"),e);return t.status===i.Kk.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(n){return null}}}ai.IMDS_OPTIONS={headers:{Metadata:"true"}};class ii{constructor(e,t,n,r,a,i,s,o){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=a,this.performanceClient=s,this.correlationId=i,this.managedIdentity=o||!1,this.regionDiscovery=new ai(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(i.YM.CIAM_AUTH_URL))return ut;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case i.YM.ADFS:return ct;case i.YM.DSTS:return dt}return lt}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new gt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ne(f)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ne(f)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ne(f)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ne(K);return this.replacePath(this.metadata.end_session_endpoint)}throw ne(f)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ne(f)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ne(f)}canReplaceTenant(e){return 1===e.PathSegments.length&&!ii.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===lt&&this.protocolMode===s}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new gt(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,a)=>{let i=r[a];if(0===a&&this.canReplaceTenant(n)){const e=new gt(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(e)),i=e)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===ct||this.protocolMode!==s&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e,t;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Un,this.correlationId);const n=this.getCurrentMetadataEntity(),r=await ri(this.updateCloudDiscoveryMetadata.bind(this),Hn,this.logger,this.performanceClient,this.correlationId)(n);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network);const a=await ri(this.updateEndpointMetadata.bind(this),Wn,this.logger,this.performanceClient,this.correlationId)(n);this.updateCachedMetadata(n,r,{source:a}),null===(t=this.performanceClient)||void 0===t||t.addFields({cloudDiscoverySource:r,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Se(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==i.E_.CACHE&&(null===n||void 0===n?void 0:n.source)!==i.E_.CACHE&&(e.expiresAt=Se(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Wn,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){var r;if(n.source===i.E_.HARDCODED_VALUES)if(null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion&&n.metadata){Ce(e,await ri(this.updateMetadataWithRegionalInformation.bind(this),qn,this.logger,this.performanceClient,this.correlationId)(n.metadata),!1),e.canonical_authority=this.canonicalAuthority}return n.source}let a=await ri(this.getEndpointMetadataFromNetwork.bind(this),zn,this.logger,this.performanceClient,this.correlationId)();var s;if(a)return null!==(s=this.authorityOptions.azureRegionConfiguration)&&void 0!==s&&s.azureRegion&&(a=await ri(this.updateMetadataWithRegionalInformation.bind(this),qn,this.logger,this.performanceClient,this.correlationId)(a)),Ce(e,a,!0),i.E_.NETWORK;throw ne(g,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Ce(e,t,!1),{source:i.E_.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Ce(e,t,!1),{source:i.E_.HARDCODED_VALUES,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Ee(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:i.E_.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new gt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw $e(Ue)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(zn,this.correlationId);const t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(n));try{const e=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return r?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(r)),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in vt?vt[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(qn,this.correlationId);const r=null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(r){var a;if(r!==i.YM.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=i._2.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,ii.replaceWithRegionalInformation(e,r);const t=await ri(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Vn,this.logger,this.performanceClient,this.correlationId)(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=i._2.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=t,ii.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=i._2.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Hn,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await ri(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Gn,this.logger,this.performanceClient,this.correlationId)();if(r)return xe(e,r,!0),i.E_.NETWORK;throw $e(Ge)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||i.YM.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||i.YM.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||i.YM.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),xe(e,t,!1),i.E_.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,_t(yt.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),xe(e,t,!1),i.E_.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=Ee(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),i.E_.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===ut)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),ii.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=_t(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),$e(Be)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),ii.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Gn,this.correlationId);const t="".concat(i.YM.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),n={};let r=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,n);let a,s;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))a=e.body,s=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(a.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),a=e.body,a.error===i.YM.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(a.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(a.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=_t(s,this.hostnameAndPort)}catch(a){if(a instanceof c.lR)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(a.errorCode,"\nError Description: ").concat(a.errorMessage));else{const e=a;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=ii.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&gt.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==l){const e=t.tenant?t.tenant:i.YM.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(e,"/")}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return i.YM.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ne(f)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return bt.has(e)}static isPublicCloudAuthority(e){return i.YM.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const a=new gt(e);a.validateAsUri();const s=a.getUrlComponents();let o="".concat(t,".").concat(s.HostNameAndPort);this.isPublicCloudAuthority(s.HostNameAndPort)&&(o="".concat(t,".").concat(i.YM.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const l=gt.constructAuthorityUriFromObject((0,r.A)((0,r.A)({},a.getUrlComponents()),{},{HostNameAndPort:o})).urlString;return n?"".concat(l,"?").concat(n):l}static replaceWithRegionalInformation(e,t){const n=(0,r.A)({},e);return n.authorization_endpoint=ii.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=ii.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=ii.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new gt(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(i.YM.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(i.YM.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function si(e){return e.endsWith(i.YM.FORWARD_SLASH)?e:"".concat(e).concat(i.YM.FORWARD_SLASH)}ii.reservedTenantDomains=new Set(["{tenant}","{tenantid}",i.v2.COMMON,i.v2.CONSUMERS,i.v2.ORGANIZATIONS]);const oi="no_tokens_found",li="native_account_unavailable",ci="refresh_token_expired",di="bad_token",ui=["interaction_required","consent_required","login_required",di],hi=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],pi={[oi]:"No refresh token found in the cache. Please sign-in.",[li]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[ci]:"Refresh token has expired.",[di]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class fi extends c.lR{constructor(e,t,n,r,a,s,o,l){super(e,t,n),Object.setPrototypeOf(this,fi.prototype),this.timestamp=r||i.YM.EMPTY_STRING,this.traceId=a||i.YM.EMPTY_STRING,this.correlationId=s||i.YM.EMPTY_STRING,this.claims=o||i.YM.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function mi(e,t,n){const r=!!e&&ui.indexOf(e)>-1,a=!!n&&hi.indexOf(n)>-1,i=!!t&&ui.some(e=>t.indexOf(e)>-1);return r||i||a}function gi(e){return new fi(e,pi[e])}class vi{static setRequestState(e,t,n){const r=vi.generateLibraryState(e,n);return t?"".concat(r).concat(i.YM.RESOURCE_DELIM).concat(t):r}static generateLibraryState(e,t){if(!e)throw ne(j);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw ne(j);if(!t)throw ne(y);try{const n=t.split(i.YM.RESOURCE_DELIM),r=n[0],a=n.length>1?n.slice(1).join(i.YM.RESOURCE_DELIM):i.YM.EMPTY_STRING,s=e.base64Decode(r),o=JSON.parse(s);return{userRequestState:a||i.YM.EMPTY_STRING,libraryState:o}}catch(n){throw ne(y)}}}const yi="home_account_id",bi="UPN";class wi{constructor(){if(!window.localStorage)throw(0,Ia.jz)(Ra.xz)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}class _i{constructor(){if(!window.sessionStorage)throw(0,Ia.jz)(Ra.xz)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}function Ai(e,t){if(!t)return null;try{return vi.parseRequestState(e,t).libraryState.meta}catch(n){throw ne(y)}}const Si=864e5;class Ci{getItem(e){const t="".concat(encodeURIComponent(e)),n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[a,...i]=decodeURIComponent(e).trim().split("="),s=i.join("=");if(a===t)return s}return""}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=Lax;");if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*Si);return n.toUTCString()}(n);a+="expires=".concat(e,";")}r&&(a+="Secure;"),document.cookie=a}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}}class xi extends Tt{constructor(e,t,n,r,a,i){super(e,n,r,a),this.cacheConfig=t,this.logger=r,this.internalStorage=new Ja,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new Ci,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=i}setupBrowserStorage(e){try{switch(e){case dr.Al.LocalStorage:return new wi;case dr.Al.SessionStorage:return new _i;case dr.Al.MemoryStorage:}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=dr.Al.MemoryStorage,new Ja}migrateCacheEntries(){const e=this.browserStorage.getItem(dr.dh.VERSION);e&&this.logger.info("MSAL.js was last initialized with version ".concat(e)),e!==Ga&&this.browserStorage.setItem(dr.dh.VERSION,Ga);const t="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ID_TOKEN),n="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.CLIENT_INFO),r="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ERROR),a="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ERROR_DESC),s=[this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(r),this.browserStorage.getItem(a)];[i.Gd.ID_TOKEN,i.Gd.CLIENT_INFO,i.Gd.ERROR,i.Gd.ERROR_DESC].forEach((e,t)=>{const n=s[t];n&&this.setTemporaryCache(e,n,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),t=this.getItem(dr.dh.ACCOUNT_KEYS),n=this.getItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId));if(t&&n)return void this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");this.browserStorage.getKeys().forEach(t=>{if(this.isCredentialKey(t)){const n=this.getItem(t);if(n){const r=this.validateAndParseJson(n);if(r&&r.hasOwnProperty("credentialType"))switch(r.credentialType){case i.aG.ID_TOKEN:if(ge(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: ".concat(t," found, saving key to token key map"));const n=r,a=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(a,i.aG.ID_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: ".concat(t));break;case i.aG.ACCESS_TOKEN:case i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(me(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: ".concat(t," found, saving key to token key map"));const n=r,a=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(a,i.aG.ACCESS_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ".concat(t));break;case i.aG.REFRESH_TOKEN:if(ve(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: ".concat(t," found, saving key to token key map"));const n=r,a=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(a,i.aG.REFRESH_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ".concat(t))}}}if(this.isAccountKey(t)){const n=this.getItem(t);if(n){const r=this.validateAndParseJson(n);r&&pt.isAccountEntity(r)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: ".concat(t," found, saving key to account key map")),this.addAccountKeyToMap(t,e))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,n){let r=[];for(let i=0;i<=20;i++)try{this.browserStorage.setItem(e,t),i>0&&this.removeAccessTokenKeys(r.slice(0,i),n);break}catch(a){const s=Et(a);if(!(s.errorCode===At&&i<20))throw s;if(r.length||(r=e==="".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken),r.length<=i)throw s;this.removeAccessToken(r[i],n,!1)}}getAccount(e,t,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,r,t,n)}getCachedAccountEntity(e,t){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&pt.isAccountEntity(r)?Tt.toObject(new pt,r):null}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addAccountKeyToMap(n,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(dr.dh.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const n=this.getAccountKeys();-1===n.indexOf(e)?(n.push(e),this.setItem(dr.dh.ACCOUNT_KEYS,JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(dr.dh.ACCOUNT_KEYS);this.setItem(dr.dh.ACCOUNT_KEYS,JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,i.aG.ID_TOKEN,t)}removeAccessToken(e,t){var n;let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),null===(n=this.performanceClient)||void 0===n||n.incrementFields({accessTokensRemoved:1},t),r&&this.removeTokenKey(e,i.aG.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys();let r=0;if(e.forEach(e=>{const t=n.accessToken.indexOf(e);t>-1&&(n.accessToken.splice(t,1),r++)}),r>0)return this.logger.info("removed ".concat(r," accessToken keys from tokenKeys map")),void this.setTokenKeys(n,t)}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,i.aG.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId));if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId),JSON.stringify(e),t):this.removeItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId))}addTokenKey(e,t,n){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case i.aG.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case i.aG.ACCESS_TOKEN:const n=r.accessToken.indexOf(e);-1!==n&&r.accessToken.splice(n,1),this.logger.trace("access token ".concat(-1===n?"added to":"updated in"," map")),r.accessToken.push(e);break;case i.aG.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),ne(B)}this.setTokenKeys(r,n)}removeTokenKey(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getTokenKeys();switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case i.aG.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ".concat(e," from map"));const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case i.aG.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ".concat(e," from map"));const a=r.accessToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case i.aG.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ".concat(e," from map"));const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),ne(B)}this.setTokenKeys(r,n)}getIdTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&ge(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.ID_TOKEN,t)}getAccessTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,i.aG.ACCESS_TOKEN,t),null;const r=this.validateAndParseJson(n);return r&&me(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,i.aG.REFRESH_TOKEN,t),null;const r=this.validateAndParseJson(n);return r&&ve(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.REFRESH_TOKEN,t)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(a=n)&&0===r.indexOf(i.GU)&&a.hasOwnProperty("clientId")&&a.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,a}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[i.GU,t,n].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(i.gT.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(i.u0.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(dr.H3.WRAPPER_SKU,e),this.internalStorage.setItem(dr.H3.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(dr.H3.WRAPPER_SKU)||i.YM.EMPTY_STRING,this.internalStorage.getItem(dr.H3.WRAPPER_VER)||i.YM.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(t);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const t=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT),n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const r=this.getAccountInfoFilteredBy({localAccountId:n},e);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(r,e),r):null}const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const a={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(n,JSON.stringify(a),t),this.setItem(r,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(i.Xw.THROTTLING_PREFIX));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===dr.Al.LocalStorage){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(i.YM.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(i.YM.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(er,t);const n=this.getTokenKeys();let r=0;n.accessToken.forEach(e=>{const n=this.getAccessTokenCredential(e,t);null!==n&&void 0!==n&&n.requestedClaimsHash&&e.includes(n.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(e,t),r++)}),r>0&&this.logger.warning("".concat(r," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Je.startsWith(e,i.YM.CACHE_PREFIX)||Je.startsWith(e,i.Gd.ADAL_ID_TOKEN)?e:"".concat(i.YM.CACHE_PREFIX,".").concat(this.clientId,".").concat(e)}generateAuthorityKey(e){const{libraryState:{id:t}}=vi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.AUTHORITY,".").concat(t))}generateNonceKey(e){const{libraryState:{id:t}}=vi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.NONCE_IDTOKEN,".").concat(t))}generateStateKey(e){const{libraryState:{id:t}}=vi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.REQUEST_STATE,".").concat(t))}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)}updateCacheEntries(e,t,n,r,a){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);const s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);const o=this.generateAuthorityKey(e);if(this.setTemporaryCache(o,n,!1),a){const e={credential:a.homeAccountId,type:yi};this.setTemporaryCache(dr._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(r){const e={credential:r,type:bi};this.setTemporaryCache(dr._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(dr._p.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(dr._p.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(dr._p.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(dr._p.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(dr._p.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(dr._p.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ".concat(n)),this.resetRequestCache(n||i.YM.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(-1===t.indexOf(dr._p.REQUEST_STATE))return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const r=Ai(this.cryptoImpl,n);r&&r.interactionType===e&&(this.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ".concat(n)),this.resetRequestCache(n))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=va(JSON.stringify(e));this.setTemporaryCache(dr._p.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(dr._p.REQUEST_PARAMS,!0);if(!t)throw ua(Fr);let n;try{n=JSON.parse(Qa(t))}catch(r){throw this.logger.errorPii("Attempted to parse: ".concat(t)),this.logger.error("Parsing cached token request threw with error: ".concat(r)),ua(Dr)}if(this.removeTemporaryItem(this.generateCacheKey(dr._p.REQUEST_PARAMS)),!n.authority){const t=this.generateAuthorityKey(e),r=this.getTemporaryCache(t);if(!r)throw ua(Lr);n.authority=r}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(dr._p.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e="".concat(i.YM.CACHE_PREFIX,".").concat(dr._p.INTERACTION_STATUS_KEY);return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t="".concat(i.YM.CACHE_PREFIX,".").concat(dr._p.INTERACTION_STATUS_KEY);if(e){if(this.getInteractionInProgress())throw ua(Ar);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(i.Gd.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(i.Gd.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(i.Gd.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(i.Gd.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const e=se(n,Qa);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,n){const r=de(t);if(e!==r){const a=this.getItem(e);if(a)return this.browserStorage.removeItem(e),this.setItem(r,a,n),this.logger.verbose("Updated an outdated ".concat(t.credentialType," cache key")),r;this.logger.error("Attempted to update an outdated ".concat(t.credentialType," cache key but no item matching the outdated key was found in storage"))}return e}async hydrateCache(e,t){var n,r,a;const i=ue(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(r=e.account)||void 0===r?void 0:r.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const o={idToken:i,accessToken:he(null===(a=e.account)||void 0===a?void 0:a.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Qa,void 0,e.tokenType,void 0,t.sshKid,t.claims,s)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof xt&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(r){}throw r}}}var Ei=n(1261);class Ti{constructor(e){this.eventCallbacks=new Map,this.logger=e||new a.V({})}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||Ta();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,n,r){if("undefined"!==typeof window){const a={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.eventCallbacks.forEach((t,n)=>{let[r,i]=t;(0===i.length||i.includes(e))&&(this.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e)),r.apply(null,[a]))})}}}class ki extends c.lR{constructor(e,t,n,r,a){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=a,Object.setPrototypeOf(this,ki.prototype)}}class Pi{static generateThrottlingStorageKey(e){return"".concat(i.Xw.THROTTLING_PREFIX,".").concat(JSON.stringify(e))}static preProcess(e,t,n){const r=Pi.generateThrottlingStorageKey(t),a=e.getThrottlingCache(r);if(a){var s;if(a.throttleTime<Date.now())return void e.removeItem(r,n);throw new ki((null===(s=a.errorCodes)||void 0===s?void 0:s.join(" "))||i.YM.EMPTY_STRING,a.errorMessage,a.subError)}}static postProcess(e,t,n,r){if(Pi.checkResponseStatus(n)||Pi.checkResponseForRetryAfter(n)){const a={throttleTime:Pi.calculateThrottleTime(parseInt(n.headers[i.OK.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(Pi.generateThrottlingStorageKey(t),a,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(i.OK.RETRY_AFTER)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||i.Xw.DEFAULT_THROTTLE_TIME_SECONDS),n+i.Xw.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,n,r){const a={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},i=this.generateThrottlingStorageKey(a);e.removeItem(i,n.correlationId)}}const Ii="client_id",Ri="redirect_uri",Ni="response_type",Oi="token_type",Mi="req_cnf",Fi="return_spa_code",Di="x-client-xtra-sku",Li="brk_client_id",ji="brk_redirect_uri";class Bi{static validateRedirectUri(e){if(!e)throw $e(Te)}static validatePrompt(e){const t=[];for(const n in i._M)t.push(i._M[n]);if(t.indexOf(e)<0)throw $e(Oe)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw $e(Me)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw $e(je);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([i.iF.PLAIN,i.iF.S256].indexOf(e)<0)throw $e(Le)}}class Ui{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Ni,encodeURIComponent(i.YM.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Ni,encodeURIComponent("".concat(i.YM.TOKEN_RESPONSE_TYPE," ").concat(i.YM.ID_TOKEN_RESPONSE_TYPE)))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||i.p.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.aZ;!t||n.includes("openid")||e.includes("openid")||n.push("openid");const r=t?[...e||[],...n]:e||[],a=new Ze(r);this.parameters.set("scope",encodeURIComponent(a.printScopes()))}addClientId(e){this.parameters.set(Ii,encodeURIComponent(e))}addRedirectUri(e){Bi.validateRedirectUri(e),this.parameters.set(Ri,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Bi.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(i.OK.CCS_HEADER,encodeURIComponent("UPN:".concat(e)))}addCcsOid(e){this.parameters.set(i.OK.CCS_HEADER,encodeURIComponent("Oid:".concat(e.uid,"@").concat(e.utid)))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){const n=this.addClientCapabilitiesToClaims(e,t);Bi.validateClaims(n),this.parameters.set("claims",encodeURIComponent(n))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){null!==e&&void 0!==e&&e.appName&&this.parameters.set("x-app-name",e.appName),null!==e&&void 0!==e&&e.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){Bi.validatePrompt(e),this.parameters.set("".concat("prompt"),encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Bi.validateCodeChallengeParams(e,t),!e||!t)throw $e(je);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set(i.JR,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(e=>{let[t,n]=e;!this.parameters.has(t)&&n&&this.parameters.set(t,n)})}addClientCapabilitiesToClaims(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw $e(Me)}else n={};return t&&t.length>0&&(n.hasOwnProperty(i.Fq.ACCESS_TOKEN)||(n[i.Fq.ACCESS_TOKEN]={}),n[i.Fq.ACCESS_TOKEN][i.Fq.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(i.Tq.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(i.Tq.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Oi,i.IO.POP),this.parameters.set(Mi,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Oi,i.IO.SSH),this.parameters.set(Mi,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability",i.Xw.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Li]=e.brokerClientId,t[ji]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,n)=>{e.push("".concat(n,"=").concat(t))}),function(e,t,n){if(!t)return;const r=e.get(Ii);r&&e.has(Li)&&(null===n||void 0===n||n.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(Ri)},t))}(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}async function Gi(e,t,n,r,a,i,s){null===s||void 0===s||s.addQueueMeasurement(Bn,i);const o=ii.transformCIAMAuthority(si(e)),l=new ii(o,t,n,r,a,i,s);try{return await ri(l.resolveEndpointsAsync.bind(l),Un,a,s,i)(),l}catch(c){throw ne(f)}}class Hi{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:i,cacheOptions:s,storageInterface:o,networkInterface:l,cryptoInterface:c,clientCredentials:d,libraryInfo:u,telemetry:h,serverTelemetryManager:p,persistencePlugin:f,serializableCache:m}=e;const g=(0,r.A)((0,r.A)({},It),i);return{authOptions:(v=t,(0,r.A)({clientCapabilities:[],azureCloudOptions:Ft,skipAuthorityMetadataCache:!1,instanceAware:!1},v)),systemOptions:(0,r.A)((0,r.A)({},Pt),n),loggerOptions:g,cacheOptions:(0,r.A)((0,r.A)({},Rt),s),storageInterface:o||new kt(t.clientId,re,new a.V(g)),networkInterface:l||Nt,cryptoInterface:c||re,clientCredentials:d||Mt,libraryInfo:(0,r.A)((0,r.A)({},Ot),u),telemetry:(0,r.A)((0,r.A)({},Dt),h),serverTelemetryManager:p||null,persistencePlugin:f||null,serializableCache:m||null};var v}(e),this.logger=new a.V(this.config.loggerOptions,ae,ie),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[i.OK.CONTENT_TYPE]=i.YM.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case yi:try{const n=tt(e.credential);t[i.OK.CCS_HEADER]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case bi:t[i.OK.CCS_HEADER]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,n,r,a,i){var s;i&&(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(i,a));const o=await this.sendPostRequest(r,e,{body:t,headers:n},a);return this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,n,r){let a;Pi.preProcess(this.cacheManager,e,r);try{var s,o;a=await ri(this.networkClient.sendPostRequestAsync.bind(this.networkClient),nn,this.logger,this.performanceClient,r)(t,n);const e=a.headers||{};null===(s=this.performanceClient)||void 0===s||s.addFields({refreshTokenSize:(null===(o=a.body.refresh_token)||void 0===o?void 0:o.length)||0,httpVerToken:e[i.OK.X_MS_HTTP_VERSION]||"",requestId:e[i.OK.X_MS_REQUEST_ID]||""},r)}catch(d){if(d instanceof hr){const e=d.responseHeaders;var l;if(e)null===(l=this.performanceClient)||void 0===l||l.addFields({httpVerToken:e[i.OK.X_MS_HTTP_VERSION]||"",requestId:e[i.OK.X_MS_REQUEST_ID]||"",contentTypeHeader:e[i.OK.CONTENT_TYPE]||void 0,contentLengthHeader:e[i.OK.CONTENT_LENGTH]||void 0,httpStatus:d.httpStatus},r);throw d.error}throw d instanceof c.lR?d:ne(m)}return Pi.postProcess(this.cacheManager,e,a,r),a}async updateAuthority(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(In,t);const r="https://".concat(e,"/").concat(this.authority.tenant,"/"),a=await Gi(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=a}createTokenQueryParameters(e){const t=new Ui(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}const zi="sw";class Wi{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Fn,e.correlationId);const r=await ri(this.generateKid.bind(this),Fn,t,this.performanceClient,e.correlationId)(e),a=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:a}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Dn,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:zi}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,a){const{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:o,shrNonce:l,shrOptions:c}=n,d=s?new gt(s):void 0,u=null===d||void 0===d?void 0:d.getUrlComponents();return this.cryptoUtils.signJwt((0,r.A)({at:e,ts:le(),m:null===i||void 0===i?void 0:i.toUpperCase(),u:null===u||void 0===u?void 0:u.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:null===u||void 0===u?void 0:u.AbsolutePath,q:null!==u&&void 0!==u&&u.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0},a),t,c,n.correlationId)}}class qi{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Vi{constructor(e,t,n,r,a,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=a,this.persistencePlugin=i,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?ne(w,"Cached State"):ne(w,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(a){throw ne(y,e.state)}try{r=decodeURIComponent(t)}catch(a){throw ne(y,e.state)}if(n!==r)throw ne(b);if(e.error||e.error_description||e.suberror){const t=function(e){var t,n;const r="code=",a=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(r);return a&&a>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(a+5):void 0}(e);if(mi(e.error,e.error_description,e.suberror))throw new fi(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new ki(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var n;const r="Error(s): ".concat(e.error_codes||i.YM.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||i.YM.NOT_AVAILABLE," - Description: ").concat(e.error_description||i.YM.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||i.YM.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||i.YM.NOT_AVAILABLE),a=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,s=new ki(e.error,r,e.suberror,a,e.status);if(t&&e.status&&e.status>=i.t3.SERVER_ERROR_RANGE_START&&e.status<=i.t3.SERVER_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(s));if(t&&e.status&&e.status>=i.t3.CLIENT_ERROR_RANGE_START&&e.status<=i.t3.CLIENT_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(s));if(mi(e.error,e.error_description,e.suberror))throw new fi(e.error,e.error_description,e.suberror,e.timestamp||i.YM.EMPTY_STRING,e.trace_id||i.YM.EMPTY_STRING,e.correlation_id||i.YM.EMPTY_STRING,e.claims||i.YM.EMPTY_STRING,a);throw s}}async handleServerTokenResponse(e,t,n,r,a,s,o,l,c){var d;let u,h;if(null===(d=this.performanceClient)||void 0===d||d.addQueueMeasurement(Ln,e.correlation_id),e.id_token){if(u=se(e.id_token||i.YM.EMPTY_STRING,this.cryptoObj.base64Decode),a&&a.nonce&&u.nonce!==a.nonce)throw ne(_);if(r.maxAge||0===r.maxAge){const e=u.auth_time;if(!e)throw ne(A);oe(e,r.maxAge)}}this.homeAccountIdentifier=pt.generateHomeAccountId(e.client_info||i.YM.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),a&&a.state&&(h=vi.parseRequestState(this.cryptoObj,a.state)),e.key_id=e.key_id||r.sshKid||void 0;const p=this.generateCacheRecord(e,t,n,r,u,s,a);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new qi(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),o&&!l&&p.account){const e=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,r.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Vi.generateAuthenticationResult(this.cryptoObj,t,p,!1,r,u,h,void 0,c)}await this.cacheStorage.saveCacheRecord(p,r.correlationId,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return Vi.generateAuthenticationResult(this.cryptoObj,t,p,!1,r,u,h,e,c)}generateCacheRecord(e,t,n,r,a,i,s){const o=t.getPreferredCache();if(!o)throw ne(D);const l=ht(a);let c,d;e.id_token&&a&&(c=ue(this.homeAccountIdentifier,o,e.id_token,this.clientId,l||""),d=Ki(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,a,e.client_info,o,l,s,void 0,this.logger));let u=null;if(e.access_token){const a=e.scope?Ze.fromString(e.scope):new Ze(r.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,c=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,d=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+s,p=h+c,f=d&&d>0?n+d:void 0;u=he(this.homeAccountIdentifier,o,e.access_token,this.clientId,l||t.tenant||"",a.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=pe(this.homeAccountIdentifier,o,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:o,familyId:e.foci}),{account:d,idToken:c,accessToken:u,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,n,r,a,s,o,l,c){var d,u,h,p,f;let m,g,v=i.YM.EMPTY_STRING,y=[],b=null,w=i.YM.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==i.IO.POP||a.popKid)v=n.accessToken.secret;else{const t=new Wi(e),{secret:r,keyId:i}=n.accessToken;if(!i)throw ne(Y);v=await t.signPopToken(r,i,a)}y=Ze.fromString(n.accessToken.target).asArray(),b=new Date(1e3*Number(n.accessToken.expiresOn)),m=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&(g=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(w=n.appMetadata.familyId===i.hB?i.hB:"");const _=(null===s||void 0===s?void 0:s.oid)||(null===s||void 0===s?void 0:s.sub)||"",A=(null===s||void 0===s?void 0:s.tid)||"";null!==l&&void 0!==l&&l.spa_accountid&&n.account&&(n.account.nativeAccountId=null===l||void 0===l?void 0:l.spa_accountid);const S=n.account?ot(n.account.getAccountInfo(),void 0,s,null===(d=n.idToken)||void 0===d?void 0:d.secret):null;return{authority:t.canonicalAuthority,uniqueId:_,tenantId:A,scopes:y,account:S,idToken:(null===n||void 0===n||null===(u=n.idToken)||void 0===u?void 0:u.secret)||"",idTokenClaims:s||{},accessToken:v,fromCache:r,expiresOn:b,extExpiresOn:m,refreshOn:g,correlationId:a.correlationId,requestId:c||i.YM.EMPTY_STRING,familyId:w,tokenType:(null===(h=n.accessToken)||void 0===h?void 0:h.tokenType)||i.YM.EMPTY_STRING,state:o?o.userRequestState:i.YM.EMPTY_STRING,cloudGraphHostName:(null===(p=n.account)||void 0===p?void 0:p.cloudGraphHostName)||i.YM.EMPTY_STRING,msGraphHost:(null===(f=n.account)||void 0===f?void 0:f.msGraphHost)||i.YM.EMPTY_STRING,code:null===l||void 0===l?void 0:l.spa_code,fromNativeBroker:!1}}}function Ki(e,t,n,r,a,i,s,o,l,c,d,u){null===u||void 0===u||u.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let p=null;h&&(p=e.getAccount(h,a,u));const f=p||pt.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:s,environment:o,cloudGraphHostName:null===c||void 0===c?void 0:c.cloud_graph_host_name,msGraphHost:null===c||void 0===c?void 0:c.msgraph_host,nativeAccountId:d},t,r),m=f.tenantProfiles||[],g=l||f.realm;if(g&&!m.find(e=>e.tenantId===g)){const e=st(n,f.localAccountId,g,i);m.push(e)}return f.tenantProfiles=m,f}async function Yi(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class Xi extends Hi{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes}async getAuthCodeUrl(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Tn,e.correlationId);const n=await ri(this.createAuthCodeUrlQueryString.bind(this),Mn,this.logger,this.performanceClient,e.correlationId)(e);return gt.appendQueryString(this.authority.authorizationEndpoint,n)}async acquireToken(e,t){var n,r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Rn,e.correlationId),!e.code)throw ne(T);const a=le(),s=await ri(this.executeTokenRequest.bind(this),Nn,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=null===(r=s.headers)||void 0===r?void 0:r[i.OK.X_MS_REQUEST_ID],l=new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return l.validateTokenResponse(s.body),ri(l.handleServerTokenResponse.bind(l),Ln,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,a,e,t,void 0,void 0,void 0,o)}handleFragmentResponse(e,t){if(new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw ne(q);return e}getLogoutUri(e){if(!e)throw $e(De);const t=this.createLogoutUrlQueryString(e);return gt.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var n,r;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Nn,t.correlationId);const a=this.createTokenQueryParameters(t),s=gt.appendQueryString(e.tokenEndpoint,a),o=await ri(this.createTokenRequestBody.bind(this),On,this.logger,this.performanceClient,t.correlationId)(t);let l;if(t.clientInfo)try{const e=et(t.clientInfo,this.cryptoUtils.base64Decode);l={credential:"".concat(e.uid).concat(i.LR.CLIENT_INFO_SEPARATOR).concat(e.utid),type:yi}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}const c=this.createTokenRequestHeaders(l||t.ccsCredential),d={clientId:(null===(r=t.tokenBodyParameters)||void 0===r?void 0:r.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return ri(this.executePostToTokenEndpoint.bind(this),an,this.logger,this.performanceClient,t.correlationId)(s,o,c,d,t.correlationId,an)}async createTokenRequestBody(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(On,e.correlationId);const r=new Ui(e.correlationId,this.performanceClient);if(r.addClientId(e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Ii])||this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):Bi.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.oidcDefaultScopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!Lt(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await Yi(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(r.addGrantType(i.$x.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),e.authenticationScheme===i.IO.POP){const t=new Wi(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await ri(t.generateCnf.bind(t),Fn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}r.addPopToken(n)}else if(e.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw $e(He);r.addSshJwk(e.sshJwk)}let a;if((!Je.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=et(e.clientInfo,this.cryptoUtils.base64Decode);a={credential:"".concat(t.uid).concat(i.LR.CLIENT_INFO_SEPARATOR).concat(t.utid),type:yi}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case yi:try{const e=tt(a.credential);r.addCcsOid(e)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case bi:r.addCcsUpn(a.credential)}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Fi]||r.addExtraQueryParameters({[Fi]:"1"}),r.createQueryString()}async createAuthCodeUrlQueryString(e){var t,n;const r=e.correlationId||this.config.cryptoInterface.createNewGuid();null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Mn,r);const a=new Ui(r,this.performanceClient);a.addClientId(e.embeddedClientId||(null===(n=e.extraQueryParameters)||void 0===n?void 0:n[Ii])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(a.addScopes(s,!0,this.oidcDefaultScopes),a.addRedirectUri(e.redirectUri),a.addCorrelationId(r),a.addResponseMode(e.responseMode),a.addResponseTypeCode(),a.addLibraryInfo(this.config.libraryInfo),Lt(this.config)||a.addApplicationTelemetry(this.config.telemetry.application),a.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&a.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&a.addPrompt(e.prompt),e.domainHint&&a.addDomainHint(e.domainHint),e.prompt!==i._M.SELECT_ACCOUNT)if(e.sid&&e.prompt===i._M.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),a.addSid(e.sid);else if(e.account){const t=this.extractAccountSid(e.account);let n=this.extractLoginHint(e.account);if(n&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),n=null),n){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),a.addLoginHint(n);try{const t=tt(e.account.homeAccountId);a.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t&&e.prompt===i._M.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),a.addSid(t);try{const t=tt(e.account.homeAccountId);a.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),a.addLoginHint(e.loginHint),a.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),a.addLoginHint(e.account.username);try{const t=tt(e.account.homeAccountId);a.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),a.addLoginHint(e.loginHint),a.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&a.addNonce(e.nonce),e.state&&a.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&a.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&a.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,a),e.nativeBroker&&(a.addNativeBroker(),e.authenticationScheme===i.IO.POP)){const t=new Wi(this.cryptoUtils);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await ri(t.generateCnf.bind(t),Fn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}a.addPopToken(n)}return a.createQueryString()}createLogoutUrlQueryString(e){const t=new Ui(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}extractLoginHint(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}}function Qi(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:a,extensionVersion:i}=e,s=new Map([[0,[n,r]],[2,[a,i]]]);let o=[];if(null!==t&&void 0!==t&&t.length){if(o=t.split(","),o.length<4)return t}else o=Array.from({length:4},()=>"|");return s.forEach((e,t)=>{var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:a}=e;if(n>=t.length)return;t[n]=[r,a].join("|")}({skuArr:o,index:t,skuName:e[0],skuVersion:e[1]})}),o.join(",")}class $i{constructor(e,t){this.cacheOutcome=i.Rv.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||i.YM.EMPTY_STRING,this.wrapperVer=e.wrapperVer||i.YM.EMPTY_STRING,this.telemetryCacheKey=i.gT.CACHE_KEY+i.LR.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(i.gT.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!==n&&void 0!==n&&n.length&&t.push("broker_error=".concat(n));const r=t.join(i.gT.VALUE_SEPARATOR),a=[e,this.getRegionDiscoveryFields()].join(i.gT.VALUE_SEPARATOR);return[i.gT.SCHEMA_VERSION,a,r].join(i.gT.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=$i.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(i.gT.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(i.gT.VALUE_SEPARATOR),a=e.errors.length,s=[a,t<a?i.gT.OVERFLOW_TRUE:i.gT.OVERFLOW_FALSE].join(i.gT.VALUE_SEPARATOR);return[i.gT.SCHEMA_VERSION,e.cacheHits,n,r,s].join(i.gT.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=i.gT.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof c.lR?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(i.gT.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=$i.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const a=e.errors.length;for(t=0;t<a;t++){const a=e.failedRequests[2*t]||i.YM.EMPTY_STRING,s=e.failedRequests[2*t+1]||i.YM.EMPTY_STRING,o=e.errors[t]||i.YM.EMPTY_STRING;if(r+=a.toString().length+s.toString().length+o.length+3,!(r<i.gT.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||i.YM.EMPTY_STRING),e.push(this.regionSource||i.YM.EMPTY_STRING),e.push(this.regionOutcome||i.YM.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return Qi(e)}}class Ji{constructor(e,t,n,r,a,i,s,o,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=a,this.navigationClient=i,this.nativeMessageHandler=o,this.correlationId=l||Ta(),this.logger=r.clone(dr.Q1.MSAL_SKU,Ga,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e){if(e){pt.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(pt.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch(n){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return gt.getAbsoluteUrl(t,Oa())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new $i(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Zt,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.requestAuthority||this.config.auth.authority,i=null!==n&&void 0!==n&&n.length?"true"===n:this.config.auth.instanceAware,s=t&&i?this.config.auth.authority.replace(gt.getDomainFromUrl(a),t.environment):a,o=ii.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await ri(Gi,Bn,this.logger,this.performanceClient,this.correlationId)(o,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw $e(Ye);return l}}async function Zi(e,t,n){e.addQueueMeasurement(nr,n);const r=ni(es,rr,t,e,n)(e,t,n);return{verifier:r,challenge:await ri(ts,ar,t,e,n)(r,e,t,n)}}function es(e,t,n){try{const r=new Uint8Array(32);ni(xa,sr,t,e,n)(r);return ga(r)}catch(r){throw ua(fr)}}async function ts(e,t,n,r){t.addQueueMeasurement(ar,r);try{const a=await ri(Ca,ir,n,t,r)(e,t,r);return ga(new Uint8Array(a))}catch(a){throw ua(fr)}}async function ns(e,t,n,a){n.addQueueMeasurement(mn,e.correlationId);const s=e.authority||t.auth.authority,o=[...e&&e.scopes||[]],l=(0,r.A)((0,r.A)({},e),{},{correlationId:e.correlationId,authority:s,scopes:o});if(l.authenticationScheme){if(l.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw $e(He);if(!e.sshKid)throw $e(ze)}a.verbose('Authentication Scheme set to "'.concat(l.authenticationScheme,'" as configured in Auth request'))}else l.authenticationScheme=i.IO.BEARER,a.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Je.isEmptyObj(e.claims)&&(l.requestedClaimsHash=await Pa(e.claims)),l}async function rs(e,t,n,a,i){a.addQueueMeasurement(gn,e.correlationId);const s=await ri(ns,mn,i,a,e.correlationId)(e,n,a,i);return(0,r.A)((0,r.A)((0,r.A)({},e),s),{},{account:t,forceRefresh:e.forceRefresh||!1})}class as extends Ji{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(En,this.correlationId);const t=await ri(Zi,nr,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n=(0,r.A)((0,r.A)({},e),{},{redirectUri:e.redirectUri,code:i.YM.EMPTY_STRING,codeVerifier:t.verifier});return e.codeChallenge=t.challenge,e.codeChallengeMethod=i.YM.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t=(0,r.A)({correlationId:this.correlationId||Ta()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(e.postLogoutRedirectUri,Oa())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Oa())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(Oa(),Oa())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Sn,this.correlationId);const t=await ri(this.getClientConfiguration.bind(this),Cn,this.logger,this.performanceClient,this.correlationId)(e);return new Xi(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:a,account:s}=e;this.performanceClient.addQueueMeasurement(Cn,this.correlationId);const o=await ri(this.getDiscoveredAuthority.bind(this),Zt,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:a,account:s}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:dr.Q1.MSAL_SKU,version:Ga,cpu:i.YM.EMPTY_STRING,os:i.YM.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(xn,this.correlationId);const n=this.getRedirectUri(e.redirectUri),a={interactionType:t},s=vi.setRequestState(this.browserCrypto,e&&e.state||i.YM.EMPTY_STRING,a),o=await ri(ns,mn,this.logger,this.performanceClient,this.correlationId)((0,r.A)((0,r.A)({},e),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),l=(0,r.A)((0,r.A)({},o),{},{redirectUri:n,state:s,nonce:e.nonce||Ta(),responseMode:this.config.auth.OIDCOptions.serverResponseType});if(e.loginHint||e.sid)return l;const c=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(c.homeAccountId),this.correlationId),l.account=c),!l.loginHint&&!c){const e=this.browserStorage.getLegacyLoginHint();e&&(l.loginHint=e)}return l}}function is(e){if(null==e)throw new TypeError("Cannot destructure "+e)}var ss=n(9644);const os="user_switch",ls={[os]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class cs extends c.lR{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,cs.prototype),this.name="NativeAuthError",this.ext=n}}function ds(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function us(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return gi(li);case"USER_INTERACTION_REQUIRED":return new fi(e,t);case"USER_CANCEL":return ua(xr);case"NO_NETWORK":return ua(Hr)}return new cs(e,ls[e]||t,n)}class hs extends Hi{constructor(e,t){super(e,t)}async acquireToken(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(on,e.correlationId);const r=le(),a=await ri(this.executeTokenRequest.bind(this),sn,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=null===(n=a.headers)||void 0===n?void 0:n[i.OK.X_MS_REQUEST_ID],o=new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(a.body),ri(o.handleServerTokenResponse.bind(o),Ln,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var t;if(!e)throw $e(Fe);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(cn,e.correlationId),!e.account)throw ne(M);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await ri(this.acquireTokenWithCachedRefreshToken.bind(this),ln,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){const t=n instanceof fi&&n.errorCode===oi,r=n instanceof ki&&n.errorCode===i.I.INVALID_GRANT_ERROR&&n.subError===i.I.CLIENT_MISMATCH_ERROR;if(t||r)return ri(this.acquireTokenWithCachedRefreshToken.bind(this),ln,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return ri(this.acquireTokenWithCachedRefreshToken.bind(this),ln,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ln,e.correlationId);const a=ni(this.cacheManager.getRefreshToken.bind(this.cacheManager),tr,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!a)throw gi(oi);if(a.expiresOn&&ce(a.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw gi(ci);const s=(0,r.A)((0,r.A)({},e),{},{refreshToken:a.secret,authenticationScheme:e.authenticationScheme||i.IO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:yi}});try{return await ri(this.acquireToken.bind(this),on,this.logger,this.performanceClient,e.correlationId)(s)}catch(o){if(o instanceof fi&&o.subError===di){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=de(a);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw o}}async executeTokenRequest(e,t){var n,r;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(sn,e.correlationId);const a=this.createTokenQueryParameters(e),i=gt.appendQueryString(t.tokenEndpoint,a),s=await ri(this.createTokenRequestBody.bind(this),dn,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),l={clientId:(null===(r=e.tokenBodyParameters)||void 0===r?void 0:r.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return ri(this.executePostToTokenEndpoint.bind(this),rn,this.logger,this.performanceClient,e.correlationId)(i,s,o,l,e.correlationId,rn)}async createTokenRequestBody(e){var t,n,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dn,e.correlationId);const a=e.correlationId,s=new Ui(a,this.performanceClient);if(s.addClientId(e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Ii])||this.config.authOptions.clientId),e.redirectUri&&s.addRedirectUri(e.redirectUri),s.addScopes(e.scopes,!0,null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes),s.addGrantType(i.$x.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&!Lt(this.config)&&s.addServerTelemetry(this.serverTelemetryManager),s.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;s.addClientAssertion(await Yi(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),s.addClientAssertionType(t.assertionType)}if(e.authenticationScheme===i.IO.POP){const t=new Wi(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await ri(t.generateCnf.bind(t),Fn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}s.addPopToken(n)}else if(e.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw $e(He);s.addSshJwk(e.sshJwk)}if((!Je.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case yi:try{const t=tt(e.ccsCredential.credential);s.addCcsOid(t)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case bi:s.addCcsUpn(e.ccsCredential.credential)}return e.embeddedClientId&&s.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&s.addExtraQueryParameters(e.tokenBodyParameters),s.createQueryString()}}class ps extends Hi{constructor(e,t){super(e,t)}async acquireToken(e){try{var t;const[n,a]=await this.acquireCachedToken((0,r.A)((0,r.A)({},e),{},{scopes:null!==(t=e.scopes)&&void 0!==t&&t.length?e.scopes:[...i.aZ]}));if(a===i.Rv.PROACTIVELY_REFRESHED){this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");new hs(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})}return n}catch(n){if(n instanceof te&&n.errorCode===H){return new hs(this.config,this.performanceClient).acquireTokenByRefreshToken(e)}throw n}}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(hn,e.correlationId);let n=i.Rv.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Je.isEmptyObj(e.claims))throw this.setCacheOutcome(i.Rv.FORCE_REFRESH_OR_CLAIMS,e.correlationId),ne(H);if(!e.account)throw ne(M);const r=e.account.tenantId||function(e){var t;const n=null===(t=new gt(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case i.v2.COMMON:case i.v2.ORGANIZATIONS:case i.v2.CONSUMERS:return;default:return n}}(e.authority),a=this.cacheManager.getTokenKeys(),s=this.cacheManager.getAccessToken(e.account,e,a,r,this.performanceClient);if(!s)throw this.setCacheOutcome(i.Rv.NO_CACHED_ACCESS_TOKEN,e.correlationId),ne(H);if(o=s.cachedAt,Number(o)>le()||ce(s.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(i.Rv.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),ne(H);var o;s.refreshOn&&ce(s.refreshOn,0)&&(n=i.Rv.PROACTIVELY_REFRESHED);const l=e.authority||this.authority.getPreferredCache(),c={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:s,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,a,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(l)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await ri(this.generateResultFromCacheRecord.bind(this),pn,this.logger,this.performanceClient,e.correlationId)(c,e),n]}setCacheOutcome(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),e!==i.Rv.NOT_APPLICABLE&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var n;let r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(pn,t.correlationId),e.idToken&&(r=se(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var a;const e=null===(a=r)||void 0===a?void 0:a.auth_time;if(!e)throw ne(A);oe(e,t.maxAge)}return Vi.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class fs extends as{async acquireToken(e){this.performanceClient.addQueueMeasurement(Yt,e.correlationId);const t=this.initializeServerTelemetryManager(dr.sA.acquireTokenSilent_silentFlow),n=await ri(this.getClientConfiguration.bind(this),Cn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new ps(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await ri(r.acquireCachedToken.bind(r),hn,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(a){throw a instanceof da&&a.errorCode===Kr&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),a}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(null===t||void 0===t?void 0:t.account)}}const ms=["prompt"],gs=["scopes"];class vs extends Ji{constructor(e,t,n,r,a,i,s,o,l,c,d,u){var h;super(e,t,n,r,a,i,o,l,u),this.apiId=s,this.accountId=c,this.nativeMessageHandler=l,this.nativeStorageManager=d,this.silentCacheClient=new fs(e,this.nativeStorageManager,n,r,a,i,o,l,u),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const p=this.nativeMessageHandler.getExtensionId()===dr.JD.PREFERRED_EXTENSION_ID?"chrome":null!==(h=this.nativeMessageHandler.getExtensionId())&&void 0!==h&&h.length?"unknown":void 0;this.skus=$i.makeExtraSkuString({libraryName:dr.Q1.MSAL_SKU,libraryVersion:Ga,extensionName:p,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=(0,r.A)((0,r.A)({},e.extraParameters),{},{[Di]:this.skus})}async acquireToken(e){this.performanceClient.addQueueMeasurement(tn,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(tn,e.correlationId),n=le();try{const a=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,a);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(r){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const i=Object.assign({},(is(a),a)),s={method:dr.Ct.GetToken,request:i},o=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(o);return await this.handleNativeResponse(l,a,n).then(e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),e)).catch(e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(r){throw r instanceof cs&&this.serverTelemetryManager.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Ze.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ne(L);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!n)throw ne(L);try{const e=this.createSilentCacheRequest(t,n),a=await this.silentCacheClient.acquireToken(e),i=(0,r.A)((0,r.A)({},n),{},{idTokenClaims:null===a||void 0===a?void 0:a.idTokenClaims,idToken:null===a||void 0===a?void 0:a.idToken});return(0,r.A)((0,r.A)({},a),{},{account:i})}catch(a){throw a}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=Object.assign({},(is(e),e));delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n),a={method:dr.Ct.GetToken,request:r};try{const e=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(e)}catch(o){if(o instanceof cs&&(this.serverTelemetryManager.setNativeBrokerErrorCode(o.errorCode),ds(o)))throw o}this.browserStorage.setTemporaryCache(dr._p.NATIVE_REQUEST,JSON.stringify(r),!0);const i={apiId:dr.sA.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(s,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null===e||void 0===e||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:r}=n,a=nt(n,ms);r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(dr._p.NATIVE_REQUEST));const i={method:dr.Ct.GetToken,request:a},s=le();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,a,s);this.browserStorage.setInteractionInProgress(!1);const n=await t;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),n}catch(o){throw this.browserStorage.setInteractionInProgress(!1),o}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){var r;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const a=se(e.id_token,Qa),i=this.createHomeAccountIdentifier(e,a);if(i!==(null===(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))||void 0===r?void 0:r.homeAccountId)&&e.account.id!==t.accountId)throw us(os);const s=await this.getDiscoveredAuthority({requestAuthority:t.authority}),o=Ki(this.browserStorage,s,i,Qa,this.correlationId,a,e.client_info,void 0,a.tid,void 0,e.account.id,this.logger),l=await this.generateAuthenticationResult(e,t,a,o,s.canonicalAuthority,n);return this.cacheAccount(o),this.cacheNativeTokens(e,t,i,a,e.access_token,l.tenantId,n),l}createHomeAccountIdentifier(e,t){return pt.generateHomeAccountId(e.client_info||i.YM.EMPTY_STRING,lt,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Ze.fromString(e.scope):Ze.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===i.IO.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Wi(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw ne(Y);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,a,s){const o=this.addTelemetryFromNativeResponse(e),l=e.scope?Ze.fromString(e.scope):Ze.fromString(t.scope),c=e.account.properties||{},d=c.UID||n.oid||n.sub||i.YM.EMPTY_STRING,u=c.TenantId||n.tid||i.YM.EMPTY_STRING,h=ot(r.getAccountInfo(),void 0,n,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const p=await this.generatePopAccessToken(e,t),f=t.tokenType===i.IO.POP?i.IO.POP:i.IO.BEARER;return{authority:a,uniqueId:d,tenantId:u,scopes:l.asArray(),account:h,idToken:e.id_token,idTokenClaims:n,accessToken:p,fromCache:!!o&&this.isResponseFromCache(o),expiresOn:new Date(1e3*Number(s+e.expires_in)),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(e=>{this.logger.error("Error occurred while removing account context from browser storage. ".concat(e))})}cacheNativeTokens(e,t,n,r,a,s,o){const l=ue(n,t.authority,e.id_token||"",t.clientId,r.tid||""),c=o+(t.tokenType===i.IO.POP?i.YM.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),d=this.generateScopes(e,t),u={idToken:l,accessToken:he(n,t.authority,a,t.clientId,r.tid||s,d.printScopes(),c,0,Qa,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(u,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw(0,c.pz)(ss.W,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new gt(t);n.validateAsUri();const{scopes:a}=e,s=nt(e,gs),o=new Ze(a||[]);o.appendScopes(i.aZ);const l=(0,r.A)((0,r.A)({},s),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case dr.sA.ssoSilent:case dr.sA.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),i._M.NONE}if(e.prompt)switch(e.prompt){case i._M.NONE:case i._M.CONSENT:case i._M.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e.prompt," is not compatible with native flow")),ua(ra)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:(0,r.A)((0,r.A)({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(l.signPopToken&&e.popKid)throw ua(ia);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=dr.JD.MATS_TELEMETRY,e.authenticationScheme===i.IO.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Wi(this.browserCrypto);let r;if(l.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const a=await ri(n.generateCnf.bind(n),Fn,this.logger,this.performanceClient,e.correlationId)(t,this.logger);r=a.reqCnfString,l.keyId=a.kid,l.signPopToken=!0}l.reqCnf=r}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var t;const n=e.extraParameters&&e.extraParameters.hasOwnProperty(Li)&&e.extraParameters.hasOwnProperty(ji)&&e.extraParameters.hasOwnProperty(Ii);if(!e.embeddedClientId&&!n)return;let r="";const a=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[ji],r=e.extraParameters[Ii]),e.extraParameters={child_client_id:r,child_redirect_uri:a},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:r,embeddedRedirectUri:a},e.correlationId)}}class ys{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(Jn)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:dr.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:Ta(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: ".concat(JSON.stringify(t))),this.messageChannel.port1.postMessage(t),new Promise((e,n)=>{this.resolvers.set(t.responseId,{resolve:e,reject:n})})}static async createProvider(e,t,n){e.trace("NativeMessageHandler - createProvider called.");try{const r=new ys(e,t,n,dr.JD.PREFERRED_EXTENSION_ID);return await r.sendHandshakeRequest(),r}catch(r){const a=new ys(e,t,n);return await a.sendHandshakeRequest(),a}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:dr.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:Ta(),body:{method:dr.Ct.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(ua(Zr)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===dr.JD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===dr.Ct.HandshakeRequest){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace("NativeMessageHandler.onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(ua(ea))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===dr.Ct.Response){if(!n)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)n.reject(us(e.code,e.description,e.ext));else{if(!e.result)throw(0,c.pz)(ss.W,"Event does not contain result.");e.result.code&&e.result.description?n.reject(us(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===dr.Ct.HandshakeResponse){if(!r)return void this.logger.trace("NativeMessageHandler.onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(a)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(a):r&&r.reject(a)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,r){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case i.IO.BEARER:case i.IO.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class bs{constructor(e,t,n,r,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=a}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(Pn,t.correlationId);try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(r){throw r instanceof ki&&r.subError===xr?ua(xr):r}return ri(this.handleCodeResponseFromServer.bind(this),kn,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(kn,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await ri(this.authModule.updateAuthority.bind(this.authModule),In,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await ri(this.authModule.acquireToken.bind(this.authModule),Rn,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:yi}:e.loginHint?{credential:e.loginHint,type:bi}:null}}function ws(e,t,n){const r=mt(e);if(!r)throw ft(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),ua(br)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),ua(vr));return r}class _s extends as{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,s,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=o}acquireToken(e){try{var t;const n={popupName:this.generatePopupName(e.scopes||i.aZ,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(t=e.popupWindowParent)&&void 0!==t?t:window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(n){return Promise.reject(n)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null===e||void 0===e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null===e||void 0===e?void 0:e.popupWindowParent)&&void 0!==t?t:window},a=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,a,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,a,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");const n=this.initializeServerTelemetryManager(dr.sA.acquireTokenPopup),a=await ri(this.initializeAuthorizationRequest.bind(this),xn,this.logger,this.performanceClient,this.correlationId)(e,dr.X8.Popup);Ba(a.authority);try{const i=await ri(this.initializeAuthorizationCodeRequest.bind(this),En,this.logger,this.performanceClient,this.correlationId)(a),s=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),o=ys.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let l;o&&(l=this.performanceClient.startMeasurement(en,e.correlationId));const c=await s.getAuthCodeUrl((0,r.A)((0,r.A)({},a),{},{nativeBroker:o})),d=new bs(s,this.browserStorage,i,this.logger,this.performanceClient),u=this.initiateAuthRequest(c,t);this.eventHandler.emitEvent(Ei.B.POPUP_OPENED,dr.X8.Popup,{popupWindow:u},null);const h=await this.monitorPopupForHash(u,t.popupWindowParent),p=ni(ws,jn,this.logger,this.performanceClient,this.correlationId)(h,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,i),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw ua(ta);const e=new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,p.accountId,this.nativeStorage,a.correlationId),{userRequestState:t}=vi.parseRequestState(this.browserCrypto,a.state);return await e.acquireToken((0,r.A)((0,r.A)({},a),{},{state:t,prompt:void 0}))}return await d.handleCodeResponse(p,a)}catch(s){var i;throw null===(i=t.popup)||void 0===i||i.close(),s instanceof c.lR&&(s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s)),s}}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Ei.B.LOGOUT_START,dr.X8.Popup,e);const a=this.initializeServerTelemetryManager(dr.sA.logoutPopup);try{await this.clearCacheOnLogout(e.account);const c=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:n,account:e.account||void 0});try{c.authority.endSessionEndpoint}catch(u){var i;if(null!==(i=e.account)&&void 0!==i&&i.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===o){var s,l;if(this.browserStorage.removeAccount(null===(s=e.account)||void 0===s?void 0:s.homeAccountId,this.correlationId),this.eventHandler.emitEvent(Ei.B.LOGOUT_SUCCESS,dr.X8.Popup,e),r){const e={apiId:dr.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=gt.getAbsoluteUrl(r,Oa());await this.navigationClient.navigateInternal(t,e)}return void(null===(l=t.popup)||void 0===l||l.close())}}const d=c.getLogoutUri(e);this.eventHandler.emitEvent(Ei.B.LOGOUT_SUCCESS,dr.X8.Popup,e);const h=this.openPopup(d,t);if(this.eventHandler.emitEvent(Ei.B.POPUP_OPENED,dr.X8.Popup,{popupWindow:h},null),await this.monitorPopupForHash(h,t.popupWindowParent).catch(()=>{}),r){const e={apiId:dr.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=gt.getAbsoluteUrl(r,Oa());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(h){var d;throw null===(d=t.popup)||void 0===d||d.close(),h instanceof c.lR&&(h.setCorrelationId(this.correlationId),a.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Ei.B.LOGOUT_FAILURE,dr.X8.Popup,null,h),this.eventHandler.emitEvent(Ei.B.LOGOUT_END,dr.X8.Popup),h}this.eventHandler.emitEvent(Ei.B.LOGOUT_END,dr.X8.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),ua(gr)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(ua(xr));let a="";try{a=e.location.href}catch(l){}if(!a||"about:blank"===a)return;clearInterval(r);let s="";const o=this.config.auth.OIDCOptions.serverResponseType;e&&(s=o===i.zL.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(s)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw ua(Cr);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),ua(Sr)}}openSizedPopup(e,t){var n,r,a,i;let{popupName:s,popupWindowAttributes:o,popupWindowParent:l}=t;const c=l.screenLeft?l.screenLeft:l.screenX,d=l.screenTop?l.screenTop:l.screenY,u=l.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=l.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let p=null===(n=o.popupSize)||void 0===n?void 0:n.width,f=null===(r=o.popupSize)||void 0===r?void 0:r.height,m=null===(a=o.popupPosition)||void 0===a?void 0:a.top,g=null===(i=o.popupPosition)||void 0===i?void 0:i.left;return(!p||p<0||p>u)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),p=dr.Q1.POPUP_WIDTH),(!f||f<0||f>h)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),f=dr.Q1.POPUP_HEIGHT),(!m||m<0||m>h)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),m=Math.max(0,h/2-dr.Q1.POPUP_HEIGHT/2+d)),(!g||g<0||g>u)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,u/2-dr.Q1.POPUP_WIDTH/2+c)),l.open(e,s,"width=".concat(p,", height=").concat(f,", top=").concat(m,", left=").concat(g,", scrollbars=yes"))}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(dr.X8.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return"".concat(dr.Q1.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(dr.Q1.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class As{constructor(e,t,n,r,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=a}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(dr._p.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(dr._p.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const n={apiId:dr.sA.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"===typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),ua(gr)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const n=this.browserStorage.generateStateKey(t),r=this.browserStorage.getTemporaryCache(n);if(!r)throw ne(w,"Cached State");let a;try{a=this.authModule.handleFragmentResponse(e,r)}catch(l){throw l instanceof ki&&l.subError===xr?ua(xr):l}const i=this.browserStorage.generateNonceKey(r),s=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=a.code,a.cloud_instance_host_name&&await ri(this.authModule.updateAuthority.bind(this.authModule),In,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(a.cloud_instance_host_name,this.authCodeRequest.correlationId),a.nonce=s||void 0,a.state=r,a.client_info)this.authCodeRequest.clientInfo=a.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const o=await this.authModule.acquireToken(this.authCodeRequest,a);return this.browserStorage.cleanRequestByState(t),o}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(dr._p.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: ".concat(e))}return null}}class Ss extends as{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,s,l,c),this.nativeStorage=o}async acquireToken(e){const t=await ri(this.initializeAuthorizationRequest.bind(this),xn,this.logger,this.performanceClient,this.correlationId)(e,dr.X8.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const n=this.initializeServerTelemetryManager(dr.sA.acquireTokenRedirect),a=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(Ei.B.RESTORE_FROM_BFCACHE,dr.X8.Redirect))};try{const i=await ri(this.initializeAuthorizationCodeRequest.bind(this),En,this.logger,this.performanceClient,this.correlationId)(t),s=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new As(s,this.browserStorage,i,this.logger,this.performanceClient),l=await s.getAuthCodeUrl((0,r.A)((0,r.A)({},t),{},{nativeBroker:ys.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii("Redirect start page: ".concat(c)),window.addEventListener("pageshow",a),await o.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof c.lR&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",a),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;const n=this.initializeServerTelemetryManager(dr.sA.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[r,a]=this.getRedirectResponse(e||"");if(!r)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(dr.X8.Redirect),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null===t||void 0===t?void 0:t.type}()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(dr._p.ORIGIN_URI,!0)||i.YM.EMPTY_STRING,o=gt.removeHashFromUrl(s);if(o===gt.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s);return await this.handleResponse(r,n)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(r,n);if(!Na()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(dr._p.URL_HASH,a,!0);const e={apiId:dr.sA.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(s&&"null"!==s)this.logger.verbose("Navigating to loginRequestUrl: ".concat(s)),t=await this.navigationClient.navigateInternal(s,e);else{const n=function(){const e=new gt(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(dr._p.ORIGIN_URI,n,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(n,e)}if(!t)return await this.handleResponse(r,n)}return null}catch(r){throw r instanceof c.lR&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.browserStorage.cleanRequestByInteractionType(dr.X8.Redirect),r}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===i.zL.QUERY?window.location.search:window.location.hash);let n=mt(t);if(n){try{!function(e,t,n){if(!e.state)throw ua(yr);const r=Ai(t,e.state);if(!r)throw ua(wr);if(r.interactionType!==n)throw ua(_r)}(n,this.browserCrypto,dr.X8.Redirect)}catch(s){return s instanceof c.lR&&this.logger.error("Interaction type validation failed due to ".concat(s.errorCode,": ").concat(s.errorMessage)),[null,""]}return(r=window).location.hash="","function"===typeof r.history.replaceState&&r.history.replaceState(null,"","".concat(r.location.origin).concat(r.location.pathname).concat(r.location.search)),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}var r;const a=this.browserStorage.getTemporaryCache(dr._p.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(dr._p.URL_HASH)),a&&(n=mt(a),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,a]):[null,""]}async handleResponse(e,t){const n=e.state;if(!n)throw ua(yr);const a=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw ua(ta);const t=new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,a.correlationId),{userRequestState:i}=vi.parseRequestState(this.browserCrypto,n);return t.acquireToken((0,r.A)((0,r.A)({},a),{},{state:i,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(n)})}const i=this.browserStorage.getCachedAuthority(n);if(!i)throw ua(Lr);const s=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});Pi.removeThrottle(this.browserStorage,this.config.auth.clientId,a);return new As(s,this.browserStorage,a,this.logger,this.performanceClient).handleCodeResponse(e,n)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(dr.sA.logout);try{this.eventHandler.emitEvent(Ei.B.LOGOUT_START,dr.X8.Redirect,e),await this.clearCacheOnLogout(t.account);const s={apiId:dr.sA.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},l=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null===e||void 0===e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(l.authority.protocolMode===o)try{l.authority.endSessionEndpoint}catch(i){var r,a;if(null!==(r=t.account)&&void 0!==r&&r.homeAccountId)return this.browserStorage.removeAccount(null===(a=t.account)||void 0===a?void 0:a.homeAccountId,this.correlationId),void this.eventHandler.emitEvent(Ei.B.LOGOUT_SUCCESS,dr.X8.Redirect,t)}const c=l.getLogoutUri(t);if(this.eventHandler.emitEvent(Ei.B.LOGOUT_SUCCESS,dr.X8.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(c,s);if(!1!==e.onRedirectNavigate(c))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(c,s);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(s){throw s instanceof c.lR&&(s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s)),this.eventHandler.emitEvent(Ei.B.LOGOUT_FAILURE,dr.X8.Redirect,null,s),this.eventHandler.emitEvent(Ei.B.LOGOUT_END,dr.X8.Redirect),s}this.eventHandler.emitEvent(Ei.B.LOGOUT_END,dr.X8.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return gt.getAbsoluteUrl(t,Oa())}}async function Cs(e,t,n,r,a){if(t.addQueueMeasurement(bn,r),!e)throw n.info("Navigate url is empty"),ua(gr);return a?ri(Es,_n,n,t,r)(e,a,t,r):ni(Ts,An,n,t,r)(e)}async function xs(e,t,n,r,a,s,o){return r.addQueueMeasurement(wn,s),new Promise((r,s)=>{t<Ua&&a.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(Ua,"ms). This may result in timeouts."));const l=window.setTimeout(()=>{window.clearInterval(c),s(ua(Tr))},t),c=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(s){}if(!t||"about:blank"===t)return;let a="";n&&(a=o===i.zL.QUERY?n.location.search:n.location.hash),window.clearTimeout(l),window.clearInterval(c),r(a)},n)}).finally(()=>{ni(Ps,Zn,a,r,s)(e)})}function Es(e,t,n,r){return n.addQueueMeasurement(_n,r),new Promise((n,r)=>{const a=ks();window.setTimeout(()=>{a?(a.src=e,n(a)):r("Unable to load iframe")},t)})}function Ts(e){const t=ks();return t.src=e,t}function ks(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Ps(e){document.body===e.parentNode&&document.body.removeChild(e)}class Is extends as{constructor(e,t,n,r,a,i,s,o,l,c,d){super(e,t,n,r,a,i,o,c,d),this.apiId=s,this.nativeStorage=l}async acquireToken(e){this.performanceClient.addQueueMeasurement(Xt,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t=(0,r.A)({},e);t.prompt?t.prompt!==i._M.NONE&&t.prompt!==i._M.NO_SESSION&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(t.prompt," with ").concat(i._M.NONE)),t.prompt=i._M.NONE):t.prompt=i._M.NONE;const n=await ri(this.initializeAuthorizationRequest.bind(this),xn,this.logger,this.performanceClient,e.correlationId)(t,dr.X8.Silent);Ba(n.authority);const a=this.initializeServerTelemetryManager(this.apiId);let s;try{return s=await ri(this.createAuthCodeClient.bind(this),Sn,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await ri(this.silentTokenHelper.bind(this),yn,this.logger,this.performanceClient,e.correlationId)(s,n)}catch(o){if(o instanceof c.lR&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),!s||!(o instanceof c.lR)||o.errorCode!==dr.Q1.INVALID_GRANT_ERROR)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);const n=await ri(this.initializeAuthorizationRequest.bind(this),xn,this.logger,this.performanceClient,e.correlationId)(t,dr.X8.Silent);return await ri(this.silentTokenHelper.bind(this),yn,this.logger,this.performanceClient,this.correlationId)(s,n)}}logout(){return Promise.reject(ua(Nr))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(yn,n);const a=await ri(this.initializeAuthorizationCodeRequest.bind(this),En,this.logger,this.performanceClient,n)(t),s=await ri(e.getAuthCodeUrl.bind(e),Tn,this.logger,this.performanceClient,n)((0,r.A)((0,r.A)({},t),{},{nativeBroker:ys.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)})),o=new bs(e,this.browserStorage,a,this.logger,this.performanceClient),l=await ri(Cs,bn,this.logger,this.performanceClient,n)(s,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,d=await ri(xs,wn,this.logger,this.performanceClient,n)(l,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,c),u=ni(ws,jn,this.logger,this.performanceClient,this.correlationId)(d,c,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw ua(ta);const e=new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,n),{userRequestState:a}=vi.parseRequestState(this.browserCrypto,t.state);return ri(e.acquireToken.bind(e),tn,this.logger,this.performanceClient,n)((0,r.A)((0,r.A)({},t),{},{state:a,prompt:t.prompt||i._M.NONE}))}return ri(o.handleCodeResponse.bind(o),Pn,this.logger,this.performanceClient,n)(u,t)}}class Rs extends as{async acquireToken(e){this.performanceClient.addQueueMeasurement($t,e.correlationId);const t=await ri(ns,mn,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=(0,r.A)((0,r.A)({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const a=this.initializeServerTelemetryManager(dr.sA.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:a,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return ri(i.acquireTokenByRefreshToken.bind(i),cn,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),a.cacheFailedRequest(e),e})}logout(){return Promise.reject(ua(Nr))}async createRefreshTokenClient(e){const t=await ri(this.getClientConfiguration.bind(this),Cn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new hs(t,this.performanceClient)}}class Ns{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw ua(Ur);const r=e.correlationId||Ta(),a=t.id_token?se(t.id_token,Qa):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new ii(ii.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Ta()):void 0,o=this.loadAccount(e,n.clientInfo||t.client_info||"",r,a,s),l=this.loadIdToken(t,o.homeAccountId,o.environment,o.realm,r),c=this.loadAccessToken(e,t,o.homeAccountId,o.environment,o.realm,n,r),d=this.loadRefreshToken(t,o.homeAccountId,o.environment,r);return this.generateAuthenticationResult(e,{account:o,idToken:l,accessToken:c,refreshToken:d},a,s)}loadAccount(e,t,n,r,a){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=pt.createFromAccountInfo(e.account);return this.storage.setAccount(t,n),t}if(!a||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),ua(Vr);const i=pt.generateHomeAccountId(t,a.authorityType,this.logger,this.cryptoObj,r),s=null===r||void 0===r?void 0:r.tid,o=Ki(this.storage,a,i,Qa,n,r,t,a.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(o,n),o}loadIdToken(e,t,n,r,a){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=ue(t,n,e.id_token,this.config.auth.clientId,r);return this.storage.setIdTokenCredential(i,a),i}loadAccessToken(e,t,n,r,a,i,s){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const o=t.scope?Ze.fromString(t.scope):new Ze(e.scopes),l=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+(new Date).getTime()/1e3,d=he(n,r,t.access_token,this.config.auth.clientId,a,o.printScopes(),l,c,Qa);return this.storage.setAccessTokenCredential(d,s),d}loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const a=pe(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(a,r),a}generateAuthenticationResult(e,t,n,r){var a,i,s;let o,l="",c=[],d=null;null!==t&&void 0!==t&&t.accessToken&&(l=t.accessToken.secret,c=Ze.fromString(t.accessToken.target).asArray(),d=new Date(1e3*Number(t.accessToken.expiresOn)),o=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));const u=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:c,account:u.getAccountInfo(),idToken:(null===(a=t.idToken)||void 0===a?void 0:a.secret)||"",idTokenClaims:n||{},accessToken:l,fromCache:!0,expiresOn:d,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null===t||void 0===t||null===(s=t.accessToken)||void 0===s?void 0:s.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}class Os extends Xi{constructor(e){super(e),this.includeRedirectUri=!1}}class Ms extends as{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,o,l,c),this.apiId=s}async acquireToken(e){if(!e.code)throw ua(Yr);const t=await ri(this.initializeAuthorizationRequest.bind(this),xn,this.logger,this.performanceClient,e.correlationId)(e,dr.X8.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const a=(0,r.A)((0,r.A)({},t),{},{code:e.code}),i=await ri(this.getClientConfiguration.bind(this),Cn,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new Os(i);this.logger.verbose("Auth code client created");const o=new bs(s,this.browserStorage,a,this.logger,this.performanceClient);return await ri(o.handleCodeResponseFromServer.bind(o),kn,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(a){throw a instanceof c.lR&&(a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a)),a}}logout(){return Promise.reject(ua(Nr))}}function Fs(e){const t=null===e||void 0===e?void 0:e.idTokenClaims;return null!==t&&void 0!==t&&t.tfp||null!==t&&void 0!==t&&t.acr?"B2C":null!==t&&void 0!==t&&t.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===(null===t||void 0===t?void 0:t.tid)?"MSA":"AAD":void 0}function Ds(e,t){try{La(e)}catch(n){throw t.end({success:!1},n),n}}class Ls{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new ei(this.logger,this.performanceClient):re,this.eventHandler=new Ti(this.logger),this.browserStorage=this.isBrowserEnvironment?new xi(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw $e(Be)}return{canonicalAuthority:e.authority?si(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth),this.performanceClient):((e,t)=>{const n={cacheLocation:dr.Al.MemoryStorage,temporaryCacheLocation:dr.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new xi(e,n,re,t)})(this.config.auth.clientId,this.logger);const t={cacheLocation:dr.Al.MemoryStorage,temporaryCacheLocation:dr.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new xi(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new Ns(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const n=new Ls(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Ei.B.INITIALIZE_END);const t=(null===e||void 0===e?void 0:e.correlationId)||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(vn,t);if(this.eventHandler.emitEvent(Ei.B.INITIALIZE_START),n)try{this.nativeExtensionProvider=await ys.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(a){this.logger.verbose(a)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await ri(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),er,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(Ei.B.INITIALIZE_END),r.end({allowNativeBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Da(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),r=n&&ys.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,a=r?null===n||void 0===n?void 0:n.correlationId:this.browserStorage.getTemporaryCache(dr._p.CORRELATION_ID,!0)||"",i=this.performanceClient.startMeasurement(qt,a);let s;if(this.eventHandler.emitEvent(Ei.B.HANDLE_REDIRECT_START,dr.X8.Redirect),r&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=ri(e.handleRedirectPromise.bind(e),$n,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.createRedirectClient(a);s=ri(t.handleRedirectPromise.bind(t),Qn,this.logger,this.performanceClient,i.event.correlationId)(e,i)}return s.then(e=>{if(e){t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Ei.B.LOGIN_SUCCESS,dr.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:Fs(e.account)})}else i.event.errorCode?i.end({success:!1}):i.discard();return this.eventHandler.emitEvent(Ei.B.HANDLE_REDIRECT_END,dr.X8.Redirect),e}).catch(e=>{const n=e;throw t.length>0?this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Redirect,null,n):this.eventHandler.emitEvent(Ei.B.LOGIN_FAILURE,dr.X8.Redirect,null,n),this.eventHandler.emitEvent(Ei.B.HANDLE_REDIRECT_END,dr.X8.Redirect),i.end({success:!1},n),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(Wt,t);n.add({accountType:Fs(e.account),scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=e=>{const t="function"===typeof r?r(e):void 0;return!1!==t?n.end({success:!0}):n.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const r="function"===typeof e?e(t):void 0;return!1!==r?n.end({success:!0}):n.discard(),r}}const a=this.getAllAccounts().length>0;try{let r;if(ja(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),a?this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_START,dr.X8.Redirect,e):this.eventHandler.emitEvent(Ei.B.LOGIN_START,dr.X8.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)){r=new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(n=>{if(n instanceof cs&&ds(n)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(n instanceof fi){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(i){throw n.end({success:!1},i),a?this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Redirect,null,i):this.eventHandler.emitEvent(Ei.B.LOGIN_FAILURE,dr.X8.Redirect,null,i),i}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(zt,t);n.add({scenarioId:e.scenarioId,accountType:Fs(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Ds(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}const a=this.getAllAccounts();let i;if(a.length>0?this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_START,dr.X8.Popup,e):this.eventHandler.emitEvent(Ei.B.LOGIN_START,dr.X8.Popup,e),this.canUseNative(e))i=this.acquireTokenNative((0,r.A)((0,r.A)({},e),{},{correlationId:t}),dr.sA.acquireTokenPopup).then(e=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:Fs(e.account)}),e)).catch(n=>{if(n instanceof cs&&ds(n)){this.nativeExtensionProvider=void 0;return this.createPopupClient(t).acquireToken(e)}if(n instanceof fi){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n});else{i=this.createPopupClient(t).acquireToken(e)}return i.then(e=>(a.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Ei.B.LOGIN_SUCCESS,dr.X8.Popup,e):this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Fs(e.account)}),e)).catch(e=>(a.length>0?this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Popup,null,e):this.eventHandler.emitEvent(Ei.B.LOGIN_FAILURE,dr.X8.Popup,null,e),n.end({success:!1},e),Promise.reject(e)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t,n;const a=this.getRequestCorrelationId(e),i=(0,r.A)((0,r.A)({},e),{},{prompt:e.prompt,correlationId:a});let s;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Jt,a),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({scenarioId:e.scenarioId,accountType:Fs(e.account)}),Ds(this.initialized,this.ssoSilentMeasurement),null===(n=this.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",a),this.eventHandler.emitEvent(Ei.B.SSO_SILENT_START,dr.X8.Silent,i),this.canUseNative(i))s=this.acquireTokenNative(i,dr.sA.ssoSilent).catch(e=>{if(e instanceof cs&&ds(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(i.correlationId).acquireToken(i)}throw e});else{s=this.createSilentIframeClient(i.correlationId).acquireToken(i)}return s.then(e=>{var t;return this.eventHandler.emitEvent(Ei.B.SSO_SILENT_SUCCESS,dr.X8.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Fs(e.account)}),e}).catch(e=>{var t;throw this.eventHandler.emitEvent(Ei.B.SSO_SILENT_FAILURE,dr.X8.Silent,null,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(Bt,t);Ds(this.initialized,n),this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_BY_CODE_START,dr.X8.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw ua(Qr);if(e.code){const a=e.code;let i=this.hybridAuthCodeResponses.get(a);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync((0,r.A)((0,r.A)({},e),{},{correlationId:t})).then(e=>(this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_BY_CODE_SUCCESS,dr.X8.Silent,e),this.hybridAuthCodeResponses.delete(a),n.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:Fs(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(a),this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_BY_CODE_FAILURE,dr.X8.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(a,i)),await i}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId)){const a=await this.acquireTokenNative((0,r.A)((0,r.A)({},e),{},{correlationId:t}),dr.sA.acquireTokenByCode,e.nativeAccountId).catch(e=>{throw e instanceof cs&&ds(e)&&(this.nativeExtensionProvider=void 0),e});return n.end({accountType:Fs(a.account),success:!0}),a}throw ua(Jr)}throw ua(Xr)}catch(a){throw this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_BY_CODE_FAILURE,dr.X8.Silent,null,a),n.end({success:!1},a),a}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Xn,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const n=this.createSilentAuthCodeClient(e.correlationId);return await n.acquireToken(e).then(e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e}).catch(e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(un,e.correlationId),t){case dr.nN.Default:case dr.nN.AccessToken:case dr.nN.AccessTokenAndRefreshToken:const t=this.createSilentCacheClient(e.correlationId);return ri(t.acquireToken.bind(t),Yt,this.logger,this.performanceClient,e.correlationId)(e);default:throw ne(H)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ut,e.correlationId),t){case dr.nN.Default:case dr.nN.AccessTokenAndRefreshToken:case dr.nN.RefreshToken:case dr.nN.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return ri(t.acquireToken.bind(t),$t,this.logger,this.performanceClient,e.correlationId)(e);default:throw ne(H)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(fn,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return ri(t.acquireToken.bind(t),Xt,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect((0,r.A)({correlationId:t},e))}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);ja(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);La(this.initialized),this.browserStorage.setInteractionInProgress(!0);return this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,a){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(r,a):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const a=n.getAccountInfoFilteredBy(e,r);return a?(t.verbose("getAccount: Account matching provided filter found, returning"),a):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const a=n.getAccountInfoFilteredBy({username:e},r);return a?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),a):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const a=n.getAccountInfoFilteredBy({homeAccountId:e},r);return a?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),a):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const a=n.getAccountInfoFilteredBy({localAccountId:e},r);return a?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),a):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=pt.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw ua(ta);return new vs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!ys.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case i._M.NONE:case i._M.CONSENT:case i._M.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = ".concat(e.prompt," is not compatible with native flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new _s(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Ss(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Is(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new fs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Rs(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Ms(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Fa(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{var t;null!==(t=e.key)&&void 0!==t&&t.includes(i.Gd.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(Ei.B.ACTIVE_ACCOUNT_CHANGED);const n=e.newValue||e.oldValue;if(!n)return;const r=JSON.parse(n);if("object"!==typeof r||!pt.isAccountEntity(r))return;const a=Tt.toObject(new pt,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(Ei.B.ACCOUNT_ADDED,void 0,a)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(Ei.B.ACCOUNT_REMOVED,void 0,a))}catch(e){return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Ta():i.YM.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect((0,r.A)({correlationId:t},e||dr.uq))}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup((0,r.A)({correlationId:t},e||dr.uq))}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Gt,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Ds(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const a=e.account||this.getActiveAccount();if(!a)throw ua(Or);n.add({accountType:Fs(a)});const s={clientId:this.config.auth.clientId,authority:e.authority||i.YM.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:a.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},o=JSON.stringify(s),l=this.activeSilentTokenRequests.get(o);if("undefined"===typeof l){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const i=ri(this.acquireTokenSilentAsync.bind(this),Ht,this.logger,this.performanceClient,t)((0,r.A)((0,r.A)({},e),{},{correlationId:t}),a).then(t=>(this.activeSilentTokenRequests.delete(o),n.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t)).catch(e=>{throw this.activeSilentTokenRequests.delete(o),n.end({success:!1},e),e});return this.activeSilentTokenRequests.set(o,i),(0,r.A)((0,r.A)({},await i),{},{state:e.state})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),(0,r.A)((0,r.A)({},await l),{},{state:e.state})}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ht,e.correlationId),this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_START,dr.X8.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await ri(rs,gn,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),a=e.cacheLookupPolicy||dr.nN.Default;return this.acquireTokenSilentNoIframe(r,a).catch(async e=>{const t=function(e,t){const n=!(e instanceof fi&&e.subError!==di),r=e.errorCode===dr.Q1.INVALID_GRANT_ERROR||e.errorCode===H,a=n&&r||e.errorCode===oi||e.errorCode===ci,i=dr.JE.includes(t);return a&&i}(e,a);if(t){if(this.activeIframeRequest){if(a!==dr.nN.Skip){const[t,n]=this.activeIframeRequest;this.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(n),r.correlationId);const i=this.performanceClient.startMeasurement(Qt,r.correlationId);i.add({awaitIframeCorrelationId:n});const s=await t;if(i.end({success:s}),s)return this.logger.verbose("Parallel iframe request with correlationId: ".concat(n," succeeded. Retrying cache and/or RT redemption"),r.correlationId),this.acquireTokenSilentNoIframe(r,a);throw this.logger.info("Iframe request with correlationId: ".concat(n," failed. Interaction is required.")),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),ri(this.acquireTokenBySilentIframe.bind(this),fn,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),ri(this.acquireTokenBySilentIframe.bind(this),fn,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return ys.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,dr.sA.acquireTokenSilent_silentFlow).catch(async e=>{if(e instanceof cs&&ds(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ne(H);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),ri(this.acquireTokenFromCache.bind(this),un,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===dr.nN.AccessToken)throw n;return this.eventHandler.emitEvent(Ei.B.ACQUIRE_TOKEN_NETWORK_START,dr.X8.Silent,e),ri(this.acquireTokenByRefreshToken.bind(this),Ut,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}class js{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new za(e);return await n.initialize(),Ls.createController(n,t)}(e);return new js(e,t)}constructor(e,t){this.controller=t||new Ls(new za(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var Bs=n(2746);const Us=(()=>{try{if("undefined"===typeof window)return!1;const e=window;return!(!e.crypto||!e.crypto.subtle&&!e.msCrypto)}catch(e){return!1}})()?new js({auth:{clientId:"a8337154-a8a8-400d-8817-c03ade433449",authority:"https://login.microsoftonline.com/".concat("3493b8fa-b849-45bc-b23e-7d0384e4fa46"),redirectUri:"undefined"!==typeof window?window.location.origin:"/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,t,n)=>{try{if(n)return;e===a.$.Error?(0,Bs.z3)("msal",t):e===a.$.Warning?(0,Bs.R8)("msal",t):(0,Bs.pq)("msal",t)}catch(r){}},piiLoggingEnabled:!1,logLevel:a.$.Warning}}}):(()=>{const e=()=>{};return{addEventCallback:e,handleRedirectPromise:async()=>null,setActiveAccount:e,getAllAccounts:()=>[],loginPopup:async()=>{throw new Error("MSAL disabled in this environment")},loginRedirect:async()=>{throw new Error("MSAL disabled in this environment")},acquireTokenSilent:async()=>{throw new Error("MSAL disabled in this environment")},acquireTokenPopup:async()=>{throw new Error("MSAL disabled in this environment")},logoutPopup:async()=>{}}})();try{Us.addEventCallback(e=>{try{const t=e&&e.eventType||"msal_event",n=e&&e.payload||{};(0,Bs.pq)("msal:event",{type:t,payload:n})}catch(t){try{(0,Bs.z3)("msal:event logging failed",t)}catch(n){}}})}catch(Gs){}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var a=Object.create(null);__webpack_require__.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,__webpack_require__.d(a,i),a}})(),__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce((t,n)=>(__webpack_require__.f[n](e,t),t),[])),__webpack_require__.u=e=>"static/js/"+e+"."+{102:"02d7baa2",217:"89440b20",453:"0ff269d6",575:"27ab4583",845:"f33d5569",883:"41c11188",942:"139d601e",964:"c2a7e8fb"}[e]+".chunk.js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="sunbeth-portal-react-ts:";__webpack_require__.l=(n,r,a,i)=>{if(e[n])e[n].push(r);else{var s,o;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(o=!0,(s=document.createElement("script")).charset="utf-8",__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.setAttribute("data-webpack",t+a),s.src=n),e[n]=[r];var u=(t,r)=>{s.onerror=s.onload=null,clearTimeout(h);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(e=>e(r)),t)return t(r)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=u.bind(null,s.onerror),s.onload=u.bind(null,s.onload),o&&document.head.appendChild(s)}}})(),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/",(()=>{var e={792:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((n,a)=>r=e[t]=[n,a]);n.push(r[2]=a);var i=__webpack_require__.p+__webpack_require__.u(t),s=new Error;__webpack_require__.l(i,n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",s.name="ChunkLoadError",s.type=a,s.request=i,r[1](s)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,a,[i,s,o]=n,l=0;if(i.some(t=>0!==e[t])){for(r in s)__webpack_require__.o(s,r)&&(__webpack_require__.m[r]=s[r]);if(o)o(__webpack_require__)}for(t&&t(n);l<i.length;l++)a=i[l],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunksunbeth_portal_react_ts=self.webpackChunksunbeth_portal_react_ts||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(9950),t=__webpack_require__(1352),n=__webpack_require__(2074),r=__webpack_require__(6221),a=__webpack_require__(493);const i={initialize:()=>Promise.reject((0,r.jz)(a.dg)),acquireTokenPopup:()=>Promise.reject((0,r.jz)(a.dg)),acquireTokenRedirect:()=>Promise.reject((0,r.jz)(a.dg)),acquireTokenSilent:()=>Promise.reject((0,r.jz)(a.dg)),acquireTokenByCode:()=>Promise.reject((0,r.jz)(a.dg)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject((0,r.jz)(a.dg)),loginPopup:()=>Promise.reject((0,r.jz)(a.dg)),loginRedirect:()=>Promise.reject((0,r.jz)(a.dg)),logout:()=>Promise.reject((0,r.jz)(a.dg)),logoutRedirect:()=>Promise.reject((0,r.jz)(a.dg)),logoutPopup:()=>Promise.reject((0,r.jz)(a.dg)),ssoSilent:()=>Promise.reject((0,r.jz)(a.dg)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw(0,r.jz)(a.dg)},getLogger:()=>{throw(0,r.jz)(a.dg)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw(0,r.jz)(a.dg)},hydrateCache:()=>Promise.reject((0,r.jz)(a.dg)),clearCache:()=>Promise.reject((0,r.jz)(a.dg))};var s=__webpack_require__(89),o=__webpack_require__(8398);const l={instance:i,inProgress:s.T$.None,accounts:[],logger:new o.V({})},c=e.createContext(l);c.Consumer;var d=__webpack_require__(2555),u=__webpack_require__(1261);class h{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case u.B.LOGIN_START:return s.T$.Login;case u.B.SSO_SILENT_START:return s.T$.SsoSilent;case u.B.ACQUIRE_TOKEN_START:if(e.interactionType===s.X8.Redirect||e.interactionType===s.X8.Popup)return s.T$.AcquireToken;break;case u.B.HANDLE_REDIRECT_START:return s.T$.HandleRedirect;case u.B.LOGOUT_START:return s.T$.Logout;case u.B.SSO_SILENT_SUCCESS:case u.B.SSO_SILENT_FAILURE:if(t&&t!==s.T$.SsoSilent)break;return s.T$.None;case u.B.LOGOUT_END:if(t&&t!==s.T$.Logout)break;return s.T$.None;case u.B.HANDLE_REDIRECT_END:if(t&&t!==s.T$.HandleRedirect)break;return s.T$.None;case u.B.LOGIN_SUCCESS:case u.B.LOGIN_FAILURE:case u.B.ACQUIRE_TOKEN_SUCCESS:case u.B.ACQUIRE_TOKEN_FAILURE:case u.B.RESTORE_FROM_BFCACHE:if(e.interactionType===s.X8.Redirect||e.interactionType===s.X8.Popup){if(t&&t!==s.T$.Login&&t!==s.T$.AcquireToken)break;return s.T$.None}}return null}}function p(e,t){if(e.length!==t.length)return!1;const n=[...t];return e.every(e=>{const t=n.shift();return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username)})}const f="2.2.0",m="UNBLOCK_INPROGRESS",g="EVENT",v=(e,t)=>{const{type:n,payload:r}=t;let a=e.inProgress;switch(n){case m:e.inProgress===s.T$.Startup&&(a=s.T$.None,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case g:const t=r.message,i=h.getInteractionStatusFromEvent(t,e.inProgress);i&&(r.logger.info("MsalProvider - ".concat(t.eventType," results in setting inProgress from ").concat(e.inProgress," to ").concat(i)),a=i);break;default:throw new Error("Unknown action type: ".concat(n))}const i=r.instance.getAllAccounts();return a===e.inProgress||p(i,e.accounts)?a!==e.inProgress?(0,d.A)((0,d.A)({},e),{},{inProgress:a}):p(i,e.accounts)?e:(0,d.A)((0,d.A)({},e),{},{accounts:i}):(0,d.A)((0,d.A)({},e),{},{inProgress:a,accounts:i})};function y(t){let{instance:n,children:r}=t;(0,e.useEffect)(()=>{n.initializeWrapperLibrary(s.f7.React,f)},[n]);const a=(0,e.useMemo)(()=>n.getLogger().clone("@azure/msal-react",f),[n]),[i,o]=(0,e.useReducer)(v,void 0,()=>({inProgress:s.T$.Startup,accounts:n.getAllAccounts()}));(0,e.useEffect)(()=>{const e=n.addEventCallback(e=>{o({payload:{instance:n,logger:a,message:e},type:g})});return a.verbose("MsalProvider - Registered event callback with id: ".concat(e)),n.initialize().then(()=>{n.handleRedirectPromise().catch(()=>{}).finally(()=>{o({payload:{instance:n,logger:a},type:m})})}).catch(()=>{}),()=>{e&&(a.verbose("MsalProvider - Removing event callback ".concat(e)),n.removeEventCallback(e))}},[n,a]);const l={instance:n,inProgress:i.inProgress,accounts:i.accounts,logger:a};return e.createElement(c.Provider,{value:l},r)}var b=__webpack_require__(8186);b.lR;var w=__webpack_require__(9955),_=__webpack_require__(6142),A=__webpack_require__(5217),S=__webpack_require__(4852),C=__webpack_require__(2932),x=__webpack_require__(4414);const E=(0,e.createContext)({externalSupport:!1,flags:{},loaded:!1,refresh:()=>{}}),T=t=>{let{children:n}=t;const[r,a]=(0,e.useState)(!1),[i,s]=(0,e.useState)({}),[o,l]=(0,e.useState)(!1),c=async()=>{l(!1);try{const[n,r]=await Promise.allSettled([(0,C.Vg)("/api/settings/external-support"),(0,C.Vg)("/api/flags/effective")]);var e;if("fulfilled"===n.status)a(!(null===(e=n.value)||void 0===e||!e.enabled));else a(!1);if("fulfilled"===r.status){var t;const e=null===(t=r.value)||void 0===t?void 0:t.flags;s(e&&"object"===typeof e?e:{})}else s({})}catch(n){a(!1),s({})}finally{l(!0)}};return(0,e.useEffect)(()=>{c()},[]),(0,x.jsx)(E.Provider,{value:{externalSupport:r,flags:i,loaded:o,refresh:c},children:n})},k=()=>(0,e.useContext)(E);var P=__webpack_require__(2935);const I=(0,e.createContext)({tenant:null,loading:!0,error:null,applyTheme:()=>{}});function R(e,t){try{document.documentElement.style.setProperty(e,t)}catch(n){}}function N(e){if(!e)return;(()=>{try{return"true"===({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_ENABLE_SERVER_THEME||"").toLowerCase()}catch(e){return!1}})()&&(e.cssVars&&Object.entries(e.cssVars).forEach(e=>{let[t,n]=e;return R(t,String(n))}),e.colors&&(e.colors.primary&&R("--primary",e.colors.primary),e.colors.accent&&R("--accent",e.colors.accent),e.colors.bg&&R("--bg",e.colors.bg),e.colors.bgElevated&&R("--bg-elevated",e.colors.bgElevated),e.colors.card&&R("--card",e.colors.card),e.colors.muted&&R("--muted",e.colors.muted)));try{const t=e.darkMode?"dark":"light";document.documentElement.setAttribute("data-theme",t)}catch(t){}}const O=t=>{let{children:n}=t;const r=(0,P.Gi)()||"",[a,i]=(0,e.useState)(null),[s,o]=(0,e.useState)(!0),[l,c]=(0,e.useState)(null);(0,e.useEffect)(()=>{let e=!0;return(async()=>{o(!0),c(null);try{let s=null;try{const e=await fetch("".concat(r,"/api/theme/effective"),{cache:"no-store"});if(e.ok){var t,n;const r=await e.json(),a=(()=>{try{const e=localStorage.getItem("sunbeth_theme");if("light"===e||"dark"===e)return e}catch(e){}try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch(t){return"light"}})();s=(null===r||void 0===r||null===(t=r.theme)||void 0===t?void 0:t[a])||(null===r||void 0===r||null===(n=r.theme)||void 0===n?void 0:n.light)||null}}catch(a){}const o=await fetch("".concat(r,"/api/tenant"),{cache:"no-store"});if(!o.ok)throw new Error("tenant_fetch_failed");const l=await o.json(),c=l&&l.tenant?l.tenant:null;e&&(i(c),N(s||(null===c||void 0===c?void 0:c.theme)||null))}catch(s){e&&c((null===s||void 0===s?void 0:s.message)||"Failed to fetch tenant")}finally{e&&o(!1)}})(),()=>{e=!1}},[r]);const d=(0,e.useMemo)(()=>({tenant:a,loading:s,error:l,applyTheme:N}),[a,s,l]);return(0,x.jsx)(I.Provider,{value:d,children:n})};function M(){return(0,e.useContext)(I)}var F=__webpack_require__(8429),D=__webpack_require__(2746),L=__webpack_require__(4641),j=__webpack_require__(7119);const B=t=>{let{open:n,onClose:r,title:a,children:i,width:s=640,maxWidth:o="90%"}=t;const l=(0,e.useRef)(null),c=(0,e.useMemo)(()=>"undefined"!==typeof window&&window.innerWidth<768,[]);if((0,e.useEffect)(()=>{if(!n)return;const e=e=>{"Escape"===e.key&&r()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,r]),(0,e.useEffect)(()=>{if(!n)return;const e=l.current;if(!e)return;const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=t[0],a=t[t.length-1];r&&r.focus();const i=e=>{"Tab"===e.key&&0!==t.length&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),null===a||void 0===a||a.focus()):document.activeElement===a&&(e.preventDefault(),null===r||void 0===r||r.focus()))};return e.addEventListener("keydown",i),()=>e.removeEventListener("keydown",i)},[n]),(0,e.useEffect)(()=>{if(!n)return;const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[n]),!n)return null;const d=(()=>{try{let e=document.getElementById("sunbeth-modal-root");return e||(e=document.createElement("div"),e.id="sunbeth-modal-root",document.body.appendChild(e)),e}catch(e){return null}})(),u=(0,x.jsx)("div",{role:"button","aria-label":"Close modal backdrop",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},tabIndex:0,onKeyDown:e=>{"Escape"!==e.key&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),r())},onClick:e=>{e.target===e.currentTarget&&r()},children:(0,x.jsxs)("div",{ref:l,className:"card",style:{width:c?"90vw":s,maxWidth:c?"90vw":o,height:c?"95vh":"auto",maxHeight:"95vh",overflowY:"auto",padding:16,borderRadius:12},role:"dialog","aria-modal":"true","aria-label":a||"Modal",tabIndex:-1,onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsx)("h3",{style:{margin:0},children:a||"Modal"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:r,"aria-label":"Close",children:"Close"})]}),(0,x.jsx)("div",{children:i})]})});return d?j.createPortal(u,d):u};var U=__webpack_require__(3114);const G=U;var H=__webpack_require__(1942),z=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},W=z(z(z(z(z(z(z(z(z(z(z(z(z(z(z(z(z(z([],["onCopy","onCut","onPaste"],!0),["onCompositionEnd","onCompositionStart","onCompositionUpdate"],!0),["onFocus","onBlur"],!0),["onInput","onInvalid","onReset","onSubmit"],!0),["onLoad","onError"],!0),["onKeyDown","onKeyPress","onKeyUp"],!0),["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],!0),["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],!0),["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],!0),["onSelect"],!0),["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],!0),["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],!0),["onScroll"],!0),["onWheel"],!0),["onAnimationStart","onAnimationEnd","onAnimationIteration"],!0),["onTransitionEnd"],!0),["onChange"],!0),["onToggle"],!0);function q(e,t){var n={};return W.forEach(function(r){var a=e[r];a&&(n[r]=t?function(e){return a(e,t(r))}:a)}),n}function V(e){var t=!1;return{promise:new Promise(function(n,r){e.then(function(e){return!t&&n(e)}).catch(function(e){return!t&&r(e)})}),cancel:function(){t=!0}}}function K(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=K(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const Y=function(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=K(e))&&(r&&(r+=" "),r+=t);return r};var X="Invariant failed";function Q(e,t){if(!e)throw new Error(X)}var J=__webpack_require__(2241),Z=Object.prototype.hasOwnProperty;function ee(e,t,n){for(n of e.keys())if(te(n,t))return n}function te(e,t){var n,r,a;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&te(e[r],t[r]););return-1===r}if(n===Set){if(e.size!==t.size)return!1;for(r of e){if((a=r)&&"object"===typeof a&&!(a=ee(t,a)))return!1;if(!t.has(a))return!1}return!0}if(n===Map){if(e.size!==t.size)return!1;for(r of e){if((a=r[0])&&"object"===typeof a&&!(a=ee(t,a)))return!1;if(!te(r[1],t.get(a)))return!1}return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return-1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return-1===r}if(!n||"object"===typeof e){for(n in r=0,e){if(Z.call(e,n)&&++r&&!Z.call(t,n))return!1;if(!(n in t)||!te(e[n],t[n]))return!1}return Object.keys(t).length===r}}return e!==e&&t!==t}const ne=(0,e.createContext)(null);function re(t){let{children:n,type:r}=t;return e.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(r)},n)}class ae{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Q(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Q(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{Q(this.pdfDocument),Q(e),"string"===typeof e?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(e=>{Q(Array.isArray(e),'"'.concat(e,'" is not a valid destination array.'));const t=e[0];new Promise(e=>{Q(this.pdfDocument),t instanceof Object?this.pdfDocument.getPageIndex(t).then(t=>{e(t)}).catch(()=>{Q(!1,'"'.concat(t,'" is not a valid page reference.'))}):"number"===typeof t?e(t):Q(!1,'"'.concat(t,'" is not a valid destination reference.'))}).then(t=>{const n=t+1;Q(this.pdfViewer),Q(n>=1&&n<=this.pagesCount,'"'.concat(n,'" is not a valid page number.')),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:t,pageNumber:n})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;Q(this.pdfViewer),Q(e>=1&&e<=this.pagesCount,'"'.concat(e,'" is not a valid page number.')),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||"noopener noreferrer nofollow",e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const ie={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},se="undefined"!==typeof document,oe=se&&"file:"===window.location.protocol;function le(e){return"undefined"!==typeof e}function ce(e){return le(e)&&null!==e}function de(e){return function(e){return"string"===typeof e}(e)&&/^data:/.test(e)}function ue(e){Q(de(e));const[t="",n=""]=e.split(",");return-1!==t.split(";").indexOf("base64")?atob(n):unescape(n)}function he(){return se&&window.devicePixelRatio||1}const pe="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function fe(){J(!oe,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(pe))}function me(e){e&&e.cancel&&e.cancel()}function ge(e,t){return Object.defineProperty(e,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(e,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(e,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(e,"originalHeight",{get(){return this.view[3]},configurable:!0}),e}function ve(e){return"RenderingCancelledException"===e.name}function ye(e,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return e}}function be(){return(0,e.useReducer)(ye,{value:void 0,error:void 0})}const{PDFDataRangeTransport:we}=G,_e=(()=>{const e={};return W.forEach(t=>{e[t]=H.func}),e})(),Ae=H.oneOfType([H.instanceOf(Int8Array),H.instanceOf(Uint8Array),H.instanceOf(Uint8ClampedArray),H.instanceOf(Int16Array),H.instanceOf(Uint16Array),H.instanceOf(Int32Array),H.instanceOf(Uint32Array),H.instanceOf(Float32Array),H.instanceOf(Float64Array)]),Se=[H.string,H.instanceOf(ArrayBuffer),H.shape({data:H.oneOfType([H.string,H.instanceOf(ArrayBuffer),H.arrayOf(H.number.isRequired),Ae]).isRequired}),H.shape({range:H.instanceOf(we).isRequired}),H.shape({url:H.string.isRequired})];"undefined"!==typeof Blob&&Se.push(H.instanceOf(Blob));const Ce=H.oneOfType([H.string,H.arrayOf(H.string)]),xe=H.oneOfType(Se),Ee=(H.instanceOf(ae),H.oneOf(["_self","_blank","_parent","_top"]),H.shape({commonObjs:H.shape({}).isRequired,getAnnotations:H.func.isRequired,getTextContent:H.func.isRequired,getViewport:H.func.isRequired,render:H.func.isRequired}),H.oneOfType([H.any,H.oneOf([!1])])),Te=H.oneOfType([H.func,H.exact({current:H.any})]),ke=H.oneOf(["canvas","custom","none","svg"]),Pe=H.oneOf([0,90,180,270]);var Ie=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,o)}l((r=r.apply(e,t||[])).next())})},Re=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const{PDFDataRangeTransport:Ne}=G,Oe=(e,t)=>{switch(t){case ie.NEED_PASSWORD:e(prompt("Enter the password to open this PDF file."));break;case ie.INCORRECT_PASSWORD:e(prompt("Invalid password. Please try again."));break}};function Me(e){return"object"===typeof e&&null!==e&&("data"in e||"range"in e||"url"in e)}const Fe=(0,e.forwardRef)(function(t,n){var{children:r,className:a,error:i="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:d,loading:u="Loading PDF\u2026",noData:h="No PDF file specified.",onItemClick:p,onLoadError:f,onLoadProgress:m,onLoadSuccess:g,onPassword:v=Oe,onSourceError:y,onSourceSuccess:b,options:w,renderMode:_,rotate:A}=t,S=Re(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[C,x]=be(),{value:E,error:T}=C,[k,P]=be(),{value:I,error:R}=k,N=(0,e.useRef)(new ae),O=(0,e.useRef)([]),M=(0,e.useRef)(),F=(0,e.useRef)();(0,e.useEffect)(()=>{l&&l!==M.current&&Me(l)&&(J(!te(l,M.current),'File prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.'),M.current=l)},[l]),(0,e.useEffect)(()=>{w&&w!==F.current&&(J(!te(w,F.current),'Options prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.'),F.current=w)},[w]);const D=(0,e.useRef)({scrollPageIntoView:e=>{const{dest:t,pageNumber:n,pageIndex:r=n-1}=e;if(p)return void p({dest:t,pageIndex:r,pageNumber:n});const a=O.current[r];a?a.scrollIntoView():J(!1,"An internal link leading to page ".concat(n," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}});(0,e.useImperativeHandle)(n,()=>({linkService:N,pages:O,viewer:D}),[]),(0,e.useEffect)(function(){x({type:"RESET"})},[l,x]);const L=(0,e.useCallback)(()=>Ie(this,void 0,void 0,function*(){if(!l)return null;if("string"===typeof l){if(de(l)){return{data:ue(l)}}return fe(),{url:l}}if(l instanceof Ne)return{range:l};if(l instanceof ArrayBuffer)return{data:l};if(se&&function(e){return Q(se),e instanceof Blob}(l)){const e=yield function(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return n(new Error("Error while reading a file."));t(r.result)},r.onerror=e=>{if(!e.target)return n(new Error("Error while reading a file."));const{error:t}=e.target;if(!t)return n(new Error("Error while reading a file."));switch(t.code){case t.NOT_FOUND_ERR:return n(new Error("Error while reading a file: File not found."));case t.SECURITY_ERR:return n(new Error("Error while reading a file: Security error."));case t.ABORT_ERR:return n(new Error("Error while reading a file: Aborted."));default:return n(new Error("Error while reading a file."))}},r.readAsArrayBuffer(e)})}(l);return{data:e}}if(Q("object"===typeof l),Q(Me(l)),"url"in l&&"string"===typeof l.url){if(de(l.url)){const{url:e}=l,t=Re(l,["url"]),n=ue(e);return Object.assign({data:n},t)}fe()}return l}),[l]);function j(e,t){O.current[e]=t}function B(e){delete O.current[e]}(0,e.useEffect)(()=>{const e=V(L());return e.promise.then(e=>{x({type:"RESOLVE",value:e})}).catch(e=>{x({type:"REJECT",error:e})}),()=>{me(e)}},[L,x]),(0,e.useEffect)(()=>{"undefined"!==typeof E&&(!1!==E?b&&b():T&&(J(!1,T.toString()),y&&y(T)))},[E]),(0,e.useEffect)(function(){P({type:"RESET"})},[P,E]),(0,e.useEffect)(function(){if(!E)return;const e=Object.assign(Object.assign({},w),{isEvalSupported:!1}),t=Object.assign(Object.assign({},E),e),n=G.getDocument(t);m&&(n.onProgress=m),v&&(n.onPassword=v);const r=n;return r.promise.then(e=>{P({type:"RESOLVE",value:e})}).catch(e=>{r.destroyed||P({type:"REJECT",error:e})}),()=>{r.destroy()}},[w,P,E]),(0,e.useEffect)(()=>{"undefined"!==typeof I&&(!1!==I?I&&(g&&g(I),O.current=new Array(I.numPages),N.current.setDocument(I)):R&&(J(!1,R.toString()),f&&f(R)))},[I]),(0,e.useEffect)(function(){N.current.setViewer(D.current),N.current.setExternalLinkRel(s),N.current.setExternalLinkTarget(o)},[s,o]);const U=(0,e.useMemo)(()=>({imageResourcesPath:d,linkService:N.current,onItemClick:p,pdf:I,registerPage:j,renderMode:_,rotate:A,unregisterPage:B}),[d,p,I,_,A]),H=(0,e.useMemo)(()=>q(S,()=>I),[S,I]);return e.createElement("div",Object.assign({className:Y("react-pdf__Document",a),ref:c,style:{"--scale-factor":"1"}},H),l?void 0===I||null===I?e.createElement(re,{type:"loading"},"function"===typeof u?u():u):!1===I?e.createElement(re,{type:"error"},"function"===typeof i?i():i):e.createElement(ne.Provider,{value:U},r):e.createElement(re,{type:"no-data"},"function"===typeof h?h():h))}),De=H.oneOfType([H.func,H.node]);Fe.propTypes=Object.assign(Object.assign({},_e),{children:H.node,className:Ce,error:De,externalLinkRel:H.string,externalLinkTarget:H.oneOf(["_self","_blank","_parent","_top"]),file:xe,imageResourcesPath:H.string,inputRef:Te,loading:De,noData:De,onItemClick:H.func,onLoadError:H.func,onLoadProgress:H.func,onLoadSuccess:H.func,onPassword:H.func,onSourceError:H.func,onSourceSuccess:H.func,options:H.shape({canvasFactory:H.any,canvasMaxAreaInBytes:H.number,cMapPacked:H.bool,CMapReaderFactory:H.any,cMapUrl:H.string,disableAutoFetch:H.bool,disableFontFace:H.bool,disableRange:H.bool,disableStream:H.bool,docBaseUrl:H.string,enableXfa:H.bool,filterFactory:H.any,fontExtraProperties:H.bool,httpHeaders:H.object,isEvalSupported:H.bool,isOffscreenCanvasSupported:H.bool,length:H.number,maxImageSize:H.number,ownerDocument:H.any,password:H.string,pdfBug:H.bool,rangeChunkSize:H.number,StandardFontDataFactory:H.any,standardFontDataUrl:H.string,stopAtErrors:H.bool,useSystemFonts:H.bool,useWorkerFetch:H.bool,verbosity:H.number,withCredentials:H.bool,worker:H.any}),rotate:H.number});const Le=Fe;function je(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(Boolean);return n.length<=1?n[0]||null:function(e){n.forEach(function(t){"function"===typeof t?t(e):t&&(t.current=e)})}}const Be=(0,e.createContext)(null),Ue={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Ge=/^H(\d+)$/;function He(e){return"children"in e}function ze(e){return!!He(e)&&(1===e.children.length&&0 in e.children&&"id"in e.children[0])}function We(e){const t={};if(He(e)){const{role:n}=e,r=n.match(Ge);if(r)t.role="heading",t["aria-level"]=Number(r[1]);else if(function(e){return e in Ue}(n)){const e=Ue[n];e&&(t.role=e)}}return t}function qe(e){const t={};if(He(e)){if(void 0!==e.alt&&(t["aria-label"]=e.alt),void 0!==e.lang&&(t.lang=e.lang),ze(e)){const[n]=e.children;if(n){const e=qe(n);return Object.assign(Object.assign({},t),e)}}}else"id"in e&&(t["aria-owns"]=e.id);return t}function Ve(e){return e?Object.assign(Object.assign({},We(e)),qe(e)):null}function Ke(t){let{className:n,node:r}=t;const a=(0,e.useMemo)(()=>Ve(r),[r]),i=(0,e.useMemo)(()=>He(r)?ze(r)?null:r.children.map((t,n)=>e.createElement(Ke,{key:n,node:t})):null,[r]);return e.createElement("span",Object.assign({className:n},a),i)}function Ye(){return(0,e.useContext)(Be)}function Xe(){const t=Ye();Q(t);const{onGetStructTreeError:n,onGetStructTreeSuccess:r}=t,[a,i]=be(),{value:s,error:o}=a,{customTextRenderer:l,page:c}=t;return(0,e.useEffect)(function(){i({type:"RESET"})},[i,c]),(0,e.useEffect)(function(){if(l)return;if(!c)return;const e=V(c.getStructTree()),t=e;return e.promise.then(e=>{i({type:"RESOLVE",value:e})}).catch(e=>{i({type:"REJECT",error:e})}),()=>me(t)},[l,c,i]),(0,e.useEffect)(()=>{void 0!==s&&(!1!==s?s&&r&&r(s):o&&(J(!1,o.toString()),n&&n(o)))},[s]),s?e.createElement(Ke,{className:"react-pdf__Page__structTree structTree",node:s}):null}const Qe=G.AnnotationMode;function $e(t){const n=Ye();Q(n);const r=Object.assign(Object.assign({},n),t),{_className:a,canvasBackground:i,devicePixelRatio:s=he(),onRenderError:o,onRenderSuccess:l,page:c,renderForms:d,renderTextLayer:u,rotate:h,scale:p}=r,{canvasRef:f}=t;Q(c);const m=(0,e.useRef)(null);function g(e){ve(e)||(J(!1,e.toString()),o&&o(e))}const v=(0,e.useMemo)(()=>c.getViewport({scale:p*s,rotation:h}),[s,c,h,p]),y=(0,e.useMemo)(()=>c.getViewport({scale:p,rotation:h}),[c,h,p]);(0,e.useEffect)(function(){if(!c)return;c.cleanup();const{current:e}=m;if(!e)return;e.width=v.width,e.height=v.height,e.style.width="".concat(Math.floor(y.width),"px"),e.style.height="".concat(Math.floor(y.height),"px"),e.style.visibility="hidden";const t={annotationMode:d?Qe.ENABLE_FORMS:Qe.ENABLE,canvasContext:e.getContext("2d",{alpha:!1}),viewport:v};i&&(t.background=i);const n=c.render(t),r=n;return n.promise.then(()=>{e.style.visibility="",c&&l&&l(ge(c,p))}).catch(g),()=>me(r)},[i,m,s,c,d,v,y]);const b=(0,e.useCallback)(()=>{const{current:e}=m;e&&(e.width=0,e.height=0)},[m]);return(0,e.useEffect)(()=>b,[b]),e.createElement("canvas",{className:"".concat(a,"__canvas"),dir:"ltr",ref:je(f,m),style:{display:"block",userSelect:"none"}},u?e.createElement(Xe,null):null)}function Je(){const t=Ye();Q(t);const{_className:n,onRenderSuccess:r,onRenderError:a,page:i,rotate:s,scale:o}=t;Q(i);const[l,c]=be(),{value:d,error:u}=l;const h=(0,e.useMemo)(()=>i.getViewport({scale:o,rotation:s}),[i,s,o]);(0,e.useEffect)(function(){c({type:"RESET"})},[i,c,h]),(0,e.useEffect)(function(){if(!i)return;const e=V(i.getOperatorList());return e.promise.then(e=>{new G.SVGGraphics(i.commonObjs,i.objs).getSVG(e,h).then(e=>{if(!(e instanceof SVGElement))throw new Error("getSVG returned unexpected result.");c({type:"RESOLVE",value:e})}).catch(e=>{c({type:"REJECT",error:e})})}).catch(e=>{c({type:"REJECT",error:e})}),()=>me(e)},[i,c,h]),(0,e.useEffect)(()=>{void 0!==d&&(!1!==d?i&&r&&r(ge(i,o)):u&&(ve(u)||(J(!1,u.toString()),a&&a(u))))},[d]);const{width:p,height:f}=h;return e.createElement("div",{className:"".concat(n,"__svg"),ref:e=>function(e){if(!e||!d)return;e.firstElementChild||e.appendChild(d);const{width:t,height:n}=h;d.setAttribute("width","".concat(t)),d.setAttribute("height","".concat(n))}(e),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:p,height:f,userSelect:"none"}})}function Ze(){const t=Ye();Q(t);const{customTextRenderer:n,onGetTextError:r,onGetTextSuccess:a,onRenderTextLayerError:i,onRenderTextLayerSuccess:s,page:o,pageIndex:l,pageNumber:c,rotate:d,scale:u}=t;Q(o);const[h,p]=be(),{value:f,error:m}=h,g=(0,e.useRef)(null),v=(0,e.useRef)();J(1===parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10),"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),(0,e.useEffect)(function(){p({type:"RESET"})},[o,p]),(0,e.useEffect)(function(){if(!o)return;const e=V(o.getTextContent()),t=e;return e.promise.then(e=>{p({type:"RESOLVE",value:e})}).catch(e=>{p({type:"REJECT",error:e})}),()=>me(t)},[o,p]),(0,e.useEffect)(()=>{void 0!==f&&(!1!==f?f&&a&&a(f):m&&(J(!1,m.toString()),r&&r(m)))},[f]);const y=(0,e.useCallback)(()=>{s&&s()},[s]),b=(0,e.useCallback)(e=>{J(!1,e.toString()),i&&i(e)},[i]);const w=(0,e.useMemo)(()=>o.getViewport({scale:u,rotation:d}),[o,d,u]);return(0,e.useLayoutEffect)(function(){if(!o||!f)return;const{current:e}=g;if(!e)return;e.innerHTML="";const t=o.streamTextContent({includeMarkedContent:!0}),r={container:e,textContentSource:t,viewport:w},a=G.renderTextLayer(r),i=a;return a.promise.then(()=>{const t=document.createElement("div");t.className="endOfContent",e.append(t),v.current=t;const r=e.querySelectorAll('[role="presentation"]');if(n){let e=0;f.items.forEach((t,a)=>{if(!function(e){return"str"in e}(t))return;const i=r[e];if(!i)return;const s=n(Object.assign({pageIndex:l,pageNumber:c,itemIndex:a},t));i.innerHTML=s,e+=t.str&&t.hasEOL?2:1})}y()}).catch(b),()=>me(i)},[n,b,y,o,l,c,f,w]),e.createElement("div",{className:Y("react-pdf__Page__textContent","textLayer"),onMouseUp:function(){const e=v.current;e&&e.classList.remove("active")},onMouseDown:function(){const e=v.current;e&&e.classList.add("active")},ref:g})}function et(){return(0,e.useContext)(ne)}function tt(){const t=et(),n=Ye();Q(n);const r=Object.assign(Object.assign({},t),n),{imageResourcesPath:a,linkService:i,onGetAnnotationsError:s,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:c,page:d,pdf:u,renderForms:h,rotate:p,scale:f=1}=r;Q(u),Q(d),Q(i);const[m,g]=be(),{value:v,error:y}=m,b=(0,e.useRef)(null);J(1===parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10),"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),(0,e.useEffect)(function(){g({type:"RESET"})},[g,d]),(0,e.useEffect)(function(){if(!d)return;const e=V(d.getAnnotations()),t=e;return e.promise.then(e=>{g({type:"RESOLVE",value:e})}).catch(e=>{g({type:"REJECT",error:e})}),()=>{me(t)}},[g,d,h]),(0,e.useEffect)(()=>{void 0!==v&&(!1!==v?v&&o&&o(v):y&&(J(!1,y.toString()),s&&s(y)))},[v]);const w=(0,e.useMemo)(()=>d.getViewport({scale:f,rotation:p}),[d,p,f]);return(0,e.useEffect)(function(){if(!u||!d||!i||!v)return;const{current:e}=b;if(!e)return;const t=w.clone({dontFlip:!0}),n={accessibilityManager:null,annotationCanvasMap:null,div:e,l10n:null,page:d,viewport:t},r={annotations:v,annotationStorage:u.annotationStorage,div:e,downloadManager:null,imageResourcesPath:a,linkService:i,page:d,renderForms:h,viewport:t};e.innerHTML="";try{new G.AnnotationLayer(n).render(r),c&&c()}catch(s){!function(e){J(!1,"".concat(e)),l&&l(e)}(s)}return()=>{}},[v,a,i,d,h,w]),e.createElement("div",{className:Y("react-pdf__Page__annotations","annotationLayer"),ref:b})}var nt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const rt=1,at=function(t){const n=et(),r=Object.assign(Object.assign({},n),t),{_className:a="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:s,canvasRef:o,children:l,className:c,customRenderer:d,customTextRenderer:u,devicePixelRatio:h,error:p="Failed to load the page.",height:f,inputRef:m,loading:g="Loading page\u2026",noData:v="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:b,onGetStructTreeError:w,onGetStructTreeSuccess:_,onGetTextError:A,onGetTextSuccess:S,onLoadError:C,onLoadSuccess:x,onRenderAnnotationLayerError:E,onRenderAnnotationLayerSuccess:T,onRenderError:k,onRenderSuccess:P,onRenderTextLayerError:I,onRenderTextLayerSuccess:R,pageIndex:N,pageNumber:O,pdf:M,registerPage:F,renderAnnotationLayer:D=!0,renderForms:L=!1,renderMode:j="canvas",renderTextLayer:B=!0,rotate:U,scale:G=rt,unregisterPage:H,width:z}=r,W=nt(r,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[K,X]=be(),{value:$,error:Z}=K,ee=(0,e.useRef)(null);Q(M);const te=ce(O)?O-1:null!==N&&void 0!==N?N:null,ne=null!==O&&void 0!==O?O:ce(N)?N+1:null,ae=null!==U&&void 0!==U?U:$?$.rotate:null,ie=(0,e.useMemo)(()=>{if(!$)return null;let e=1;const t=null!==G&&void 0!==G?G:rt;if(z||f){const t=$.getViewport({scale:1,rotation:ae});z?e=z/t.width:f&&(e=f/t.height)}return t*e},[f,$,ae,G,z]);(0,e.useEffect)(function(){return()=>{ce(te)&&i&&H&&H(te)}},[i,M,te,H]),(0,e.useEffect)(function(){X({type:"RESET"})},[X,M,te]),(0,e.useEffect)(function(){if(!M||!ne)return;const e=V(M.getPage(ne)),t=e;return e.promise.then(e=>{X({type:"RESOLVE",value:e})}).catch(e=>{X({type:"REJECT",error:e})}),()=>me(t)},[X,M,te,ne,F]),(0,e.useEffect)(()=>{void 0!==$&&(!1!==$?function(){if(x){if(!$||!ie)return;x(ge($,ie))}if(i&&F){if(!ce(te)||!ee.current)return;F(te,ee.current)}}():Z&&(J(!1,Z.toString()),C&&C(Z)))},[$,ie]);const se=(0,e.useMemo)(()=>$&&ce(te)&&ne&&ce(ae)&&ce(ie)?{_className:a,canvasBackground:s,customTextRenderer:u,devicePixelRatio:h,onGetAnnotationsError:y,onGetAnnotationsSuccess:b,onGetStructTreeError:w,onGetStructTreeSuccess:_,onGetTextError:A,onGetTextSuccess:S,onRenderAnnotationLayerError:E,onRenderAnnotationLayerSuccess:T,onRenderError:k,onRenderSuccess:P,onRenderTextLayerError:I,onRenderTextLayerSuccess:R,page:$,pageIndex:te,pageNumber:ne,renderForms:L,renderTextLayer:B,rotate:ae,scale:ie}:null,[a,s,u,h,y,b,w,_,A,S,E,T,k,P,I,R,$,te,ne,L,B,ae,ie]),oe=(0,e.useMemo)(()=>q(W,()=>$?ie?ge($,ie):void 0:$),[W,$,ie]),le="".concat(te,"@").concat(ie,"/").concat(ae),de="".concat(te,"/").concat(ae);function ue(){return e.createElement(Be.Provider,{value:se},function(){switch(j){case"custom":return Q(d),e.createElement(d,{key:"".concat(le,"_custom")});case"none":return null;case"svg":return e.createElement(Je,{key:"".concat(de,"_svg")});default:return e.createElement($e,{key:"".concat(le,"_canvas"),canvasRef:o})}}(),B?e.createElement(Ze,{key:"".concat(le,"_text")}):null,D?e.createElement(tt,{key:"".concat(le,"_annotations")}):null,l)}return e.createElement("div",Object.assign({className:Y(a,c),"data-page-number":ne,ref:je(m,ee),style:{"--scale-factor":"".concat(ie),backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},oe),ne?null===M||void 0===$||null===$?e.createElement(re,{type:"loading"},"function"===typeof g?g():g):!1===M||!1===$?e.createElement(re,{type:"error"},"function"===typeof p?p():p):ue():e.createElement(re,{type:"no-data"},"function"===typeof v?v():v))},it=H.oneOfType([H.func,H.node]);at.propTypes=Object.assign(Object.assign({},_e),{canvasBackground:H.string,canvasRef:Te,children:H.node,className:Ce,customRenderer:H.func,customTextRenderer:H.func,devicePixelRatio:H.number,error:it,height:H.number,imageResourcesPath:H.string,inputRef:Te,loading:it,noData:it,onGetTextError:H.func,onGetTextSuccess:H.func,onLoadError:H.func,onLoadSuccess:H.func,onRenderError:H.func,onRenderSuccess:H.func,onRenderTextLayerError:H.func,onRenderTextLayerSuccess:H.func,pageIndex:function(e,t,n){const{[t]:r,pageNumber:a,pdf:i}=e;if(!le(i))return null;if(le(r)){if("number"!==typeof r)return new Error("`".concat(t,"` of type `").concat(typeof r,"` supplied to `").concat(n,"`, expected `number`."));if(r<0)return new Error("Expected `".concat(t,"` to be greater or equal to 0."));const{numPages:e}=i;if(r+1>e)return new Error("Expected `".concat(t,"` to be less or equal to ").concat(e-1,"."))}else if(!le(a))return new Error("`".concat(t,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(n,"`."));return null},pageNumber:function(e,t,n){const{[t]:r,pageIndex:a,pdf:i}=e;if(!le(i))return null;if(le(r)){if("number"!==typeof r)return new Error("`".concat(t,"` of type `").concat(typeof r,"` supplied to `").concat(n,"`, expected `number`."));if(r<1)return new Error("Expected `".concat(t,"` to be greater or equal to 1."));const{numPages:e}=i;if(r>e)return new Error("Expected `".concat(t,"` to be less or equal to ").concat(e,"."))}else if(!le(a))return new Error("`".concat(t,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(n,"`."));return null},pdf:Ee,renderAnnotationLayer:H.bool,renderForms:H.bool,renderMode:ke,renderTextLayer:H.bool,rotate:Pe,scale:H.number,width:H.number});const st=at;G.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(G.version,"/pdf.worker.min.js");const ot=t=>{let{url:n}=t;const[r,a]=(0,e.useState)(0),[i,s]=(0,e.useState)(!0),[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)(1),[p,f]=(0,e.useState)(1),m=(0,e.useRef)(null),[g,v]=(0,e.useState)(800),y=(0,e.useMemo)(()=>{if(!c)return null;const e=new Uint8Array(c);return new Blob([e.buffer],{type:"application/pdf"})},[c]);(0,e.useEffect)(()=>{let e=!0;s(!0),l(""),d(null);return(async()=>{try{const t=await(async e=>{const t=Array.isArray(e)?e.filter(Boolean):[e].filter(Boolean),n=[],r=async e=>{const t=await fetch(e,{headers:{Accept:"application/pdf,*/*;q=0.8"},cache:"no-store"});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));const n=await t.arrayBuffer();return new Uint8Array(n)};let a=null;for(const o of t)if(o){try{n.push(o);const e=await r(o);if(e.byteLength>0)return e}catch(s){a=s}try{const e=o+(o.includes("?")?"&":"?")+"download=1";n.push(e);const t=await r(e);if(t.byteLength>0)return t}catch(s){a=s}}const i=(a instanceof Error?a.message:"Failed to load PDF")+(n.length?"\nTried: ".concat(n.join(" | ")):"");throw new Error(i)})(n);if(0===t.byteLength)throw new Error("The PDF file is empty, i.e. its size is zero bytes.");e&&(d(t),s(!1))}catch(t){console.error("PDF fetch error:",t),e&&(l(t instanceof Error?t.message:"Failed to load PDF"),s(!1))}})(),()=>{e=!1}},[n]);if((0,e.useEffect)(()=>{const e=()=>{var e;const t=(null===(e=m.current)||void 0===e?void 0:e.clientWidth)||Math.min(window.innerWidth-100,900);v(Math.max(320,Math.min(1e3,t)))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),i)return(0,x.jsx)("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Loading PDF..."});if(o){const e=(Array.isArray(n)?n[0]:n)||"",t=e?e+(e.includes("?")?"&":"?")+"download=1":"";return(0,x.jsxs)("div",{style:{padding:12},children:[(0,x.jsxs)("div",{style:{marginBottom:8,textAlign:"center",color:"#d32f2f"},children:[(0,x.jsx)("div",{style:{marginBottom:4},children:"\u26a0\ufe0f Error loading PDF"}),(0,x.jsx)("div",{style:{fontSize:"0.9em",whiteSpace:"pre-wrap"},children:o})]}),e&&(0,x.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:6,overflow:"hidden",background:"#f5f5f5"},children:[(0,x.jsx)("div",{className:"small",style:{padding:8,background:"#fff",borderBottom:"1px solid #e6e6e6"},children:"Trying inline preview fallback\u2026"}),(0,x.jsx)("iframe",{title:"pdf-fallback",src:t,style:{display:"block",width:"100%",height:"70vh",border:"none"}})]})]})}if(!c)return(0,x.jsx)("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"No PDF data available"});const b=u>1,w=u<Math.max(1,r),_=Math.floor(g*p);return(0,x.jsxs)("div",{ref:m,style:{maxHeight:"70vh",display:"flex",flexDirection:"column",overflow:"hidden",border:"1px solid #ddd",borderRadius:6,background:"#f5f5f5"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #e6e6e6",background:"#fff"},children:[(0,x.jsx)("button",{type:"button",className:"btn ghost xs",onClick:()=>f(e=>Math.max(.5,Math.round(10*(e-.1))/10)),title:"Zoom out",children:"\u2212"}),(0,x.jsxs)("div",{className:"small",style:{minWidth:56,textAlign:"center"},children:[Math.round(100*p),"%"]}),(0,x.jsx)("button",{type:"button",className:"btn ghost xs",onClick:()=>f(e=>Math.min(3,Math.round(10*(e+.1))/10)),title:"Zoom in",children:"+"}),(0,x.jsx)("button",{type:"button",className:"btn ghost xs",onClick:()=>f(1),title:"Reset zoom",children:"Reset"}),(0,x.jsx)("div",{style:{flex:1}}),(0,x.jsx)("button",{type:"button",className:"btn ghost xs",onClick:()=>b&&h(e=>e-1),disabled:!b,title:"Previous page",children:"\u2190"}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("input",{type:"number",min:1,max:Math.max(1,r),value:u,onChange:e=>{const t=Number(e.target.value||"1");Number.isFinite(t)&&h(Math.min(Math.max(1,Math.floor(t)),Math.max(1,r)))},style:{width:64,padding:"2px 6px",border:"1px solid #ddd",borderRadius:4}}),(0,x.jsxs)("span",{children:["/ ",Math.max(1,r)]})]}),(0,x.jsx)("button",{type:"button",className:"btn ghost xs",onClick:()=>w&&h(e=>e+1),disabled:!w,title:"Next page",children:"\u2192"})]}),(0,x.jsx)("div",{style:{overflow:"auto",padding:12},children:(0,x.jsx)(Le,{file:y||void 0,onLoadSuccess:e=>{let{numPages:t}=e;a(t),h(1)},onLoadError:e=>{console.error("PDF.js load error:",e),l("Failed to render PDF: "+e.message)},loading:(0,x.jsx)("div",{style:{padding:20,textAlign:"center"},children:"Rendering PDF..."}),children:(0,x.jsx)(st,{pageNumber:u,renderTextLayer:!0,renderAnnotationLayer:!0,width:_,loading:(0,x.jsxs)("div",{style:{padding:20,textAlign:"center",color:"#999"},children:["Loading page ",u,"..."]})},"page_".concat(u))})})]})};function lt(n){const{title:r="Legal document",url:a,width:i=920,maxWidth:s="95%"}=n,o=document.createElement("div");document.body.appendChild(o);const l=t.createRoot(o);return new Promise(t=>{const n=()=>{const[n,c]=(0,e.useState)(!0),d=Array.isArray(a)?a[0]||"":a,u=d?d+(d.includes("?")?"&":"?")+"download=1":"";return(0,x.jsx)(B,{open:n,onClose:()=>{c(!1),setTimeout(()=>{l.unmount(),o.remove(),t()},0)},title:r,width:i,maxWidth:s,children:(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("div",{className:"small",style:{color:"#666"},children:"You can review the official document here. This is the same file linked in the consent."}),(0,x.jsx)("div",{style:{flex:1}}),d&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("a",{className:"btn ghost xs",href:d,target:"_blank",rel:"noopener noreferrer",children:"Open in new tab"}),(0,x.jsx)("a",{className:"btn xs",href:u,target:"_blank",rel:"noopener noreferrer",children:"Download"})]})]}),(0,x.jsx)(ot,{url:a})]})})};l.render((0,x.jsx)(e.StrictMode,{children:(0,x.jsx)(n,{})}))})}var ct=__webpack_require__(1298);function dt(e,t){const n=(0,P.EO)()||"default",r=(e||"anon").toLowerCase(),a=t||"none";return"".concat("sunbeth:legalConsent:v1",":").concat(n,":").concat(r,":").concat(a)}function ut(e,t){try{const n=dt(e,t);return"true"===localStorage.getItem(n)}catch(n){return!1}}function ht(e,t){try{const n=dt(e,t);localStorage.setItem(n,"true")}catch(n){}}async function pt(e,t){try{const n=(0,P.Gi)()||"";if(!n||!e)return;await fetch("".concat(n,"/api/consents"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,batchId:t||void 0})})}catch(n){console.debug("consent receipt failed (non-blocking)",n)}}async function ft(e,t){if(ut(e,t))return!0;const n="Court-certified acknowledgement consent";let r=null;try{const e=(0,P.Gi)()||"";if(e){const t=await fetch("".concat(e,"/api/settings/legal-consent"),{cache:"no-store"}),n=await t.json().catch(()=>null),a=null!==n&&void 0!==n&&n.url?e+n.url:null;a&&(r=a)}}catch(s){}const a='\n    <div style="text-align:left">\n      <p>Before you can acknowledge documents in this batch, you must consent to the following:</p>\n      <ul style="margin-left:1em">\n        <li>Your acknowledgement constitutes a legally-binding record for employment compliance.</li>\n        <li>Your name and timestamp will be stored and may be presented in court if required.</li>\n        <li>Any misrepresentation is subject to disciplinary action under company policy.</li>\n      </ul>\n      '.concat(r?'<p style="margin:8px 0">You can preview the official PDF inside the app before agreeing.</p>':"","\n      <p>You may review documents without consenting, but you cannot submit acknowledgements unless you agree.</p>\n    </div>\n  "),i=async()=>{if(r){const e=await(0,ct.$z)(n,a,"I Agree","Deny","Preview PDF",{icon:"info"});return"confirm"===e?"agree":"deny"===e?"preview":"deny"}return await(0,ct.ZD)(n,a,"I Agree","Deny",{icon:"info"})?"agree":"deny"};for(;;){const n=await i();if("agree"===n)return ht(e,t),pt(e,t),!0;if("preview"!==n||!r)return!1;await lt({title:"Legal document (PDF)",url:r})}}async function mt(e){const t=(0,P.Gi)();if(!t)return[];try{const n=await fetch("".concat(t,"/api/policies/due?email=").concat(encodeURIComponent(e)),{cache:"no-store"}),r=await n.json().catch(()=>null);return Array.isArray(null===r||void 0===r?void 0:r.due)?r.due:[]}catch(n){return[]}}async function gt(e,t){const n=(0,P.Gi)();if(!n)return!1;try{const r=await fetch("".concat(n,"/api/policies/ack"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,fileId:t})});return 403!==r.status&&r.ok}catch(r){return!1}}async function vt(e){const t=await mt(e);if(0===t.length)return!0;const n=(0,P.Gi)()||"";for(const r of t){const t="".concat(n,"/api/files/").concat(r.fileId),a='\n      <div style="text-align:left">\n        <div style="font-weight:600">'.concat(r.name,"</div>\n        ").concat(r.description?'<div class="small" style="margin-top:4px">'.concat(r.description,"</div>"):"",'\n        <div class="small muted" style="margin-top:8px">Due: ').concat(new Date(r.nextDue).toLocaleString()," \u2022 Grace until: ").concat(new Date(r.graceUntil).toLocaleString(),'</div>\n        <div class="small muted">Frequency: ').concat(r.frequency).concat(r.intervalDays?" (".concat(r.intervalDays," days)"):"","</div>\n      </div>\n    ");for(;;){const n=await(0,ct.$z)("Policy acknowledgement required",a,"Acknowledge","Later","Preview PDF",{icon:r.overdue?"warning":"info"});if("deny"===n)break;if("cancel"===n){await lt({title:r.name,url:t});continue}if(!await(0,ct.ZD)("Confirm acknowledgement","I have read and understand this policy.","Confirm","Back",{icon:"question"}))continue;if(!await ft(e,"policy"))break;let i=await gt(e,r.fileId);if(!i){await ft(e,"policy")&&(i=await gt(e,r.fileId))}if(!i){if(await(0,ct.ZD)("Save failed","We could not record your acknowledgement. Try again?","Retry","Cancel",{icon:"error"}))continue;break}break}}return 0===(await mt(e)).length}const yt=()=>{const{token:t,account:r}=(0,_.As)(),[a,i]=(0,e.useState)([]),[s,o]=(0,e.useState)({}),[l,c]=(0,e.useState)(null),[u,h]=(0,e.useState)(!0),[p,f]=(0,e.useState)(0),m=(0,S.ec)();(0,e.useEffect)(()=>{(async()=>{try{h(!0);const e=await(0,L.d6)(null!==t&&void 0!==t?t:void 0,(null===r||void 0===r?void 0:r.username)||void 0);i(Array.isArray(e)?e:[]),c(null)}catch(e){i([]),c("Unable to load your batches.")}finally{h(!1)}})()},[t,null===r||void 0===r?void 0:r.username]),(0,e.useEffect)(()=>{if(null===r||void 0===r||!r.username)return void f(0);let e=!1;return(async()=>{try{const t=await mt(r.username);e||f(t.length)}catch(t){e||f(0)}})(),()=>{e=!0}},[null===r||void 0===r?void 0:r.username]),(0,e.useEffect)(()=>{Array.isArray(a)&&0!==a.length&&(async()=>{const e={};for(const o of a)try{var n,i;const a=await(0,L.Pg)(o.toba_batchid,null!==t&&void 0!==t?t:void 0,void 0,(null===r||void 0===r?void 0:r.username)||void 0);e[o.toba_batchid]={percent:a.percent,total:null!==(n=a.total)&&void 0!==n?n:0,acknowledged:null!==(i=a.acknowledged)&&void 0!==i?i:0}}catch(s){e[o.toba_batchid]={percent:0,total:0,acknowledged:0}}o(e)})()},[a,t,null===r||void 0===r?void 0:r.username]),(0,e.useEffect)(()=>{const e=async e=>{var n;const r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.batchId;if(r)try{const e=await(0,L.Pg)(r,null!==t&&void 0!==t?t:void 0);o(t=>{var n,a;return(0,d.A)((0,d.A)({},t),{},{[r]:{percent:e.percent,total:null!==(n=e.total)&&void 0!==n?n:0,acknowledged:null!==(a=e.acknowledged)&&void 0!==a?a:0}})})}catch(a){}};return window.addEventListener("sunbeth:progressUpdated",e),()=>{window.removeEventListener("sunbeth:progressUpdated",e)}},[t]);const g=e=>{if(!e)return"\u2014";try{return new Date(e).toLocaleDateString()}catch(t){return e}},v=Array.isArray(a)?a:[],y=(0,e.useMemo)(()=>v.filter(e=>{var t,n;return(null!==(t=null===(n=s[e.toba_batchid])||void 0===n?void 0:n.percent)&&void 0!==t?t:0)<100}).length,[v,s]),b=(0,e.useMemo)(()=>{const e=v.filter(e=>{var t,n;return(null!==(t=null===(n=s[e.toba_batchid])||void 0===n?void 0:n.percent)&&void 0!==t?t:0)<100}).map(e=>e.toba_duedate).filter(Boolean);if(!e.length)return null;return e.reduce((e,t)=>new Date(t)<new Date(e)?t:e)},[v,s]);return(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",children:[p>0&&(0,x.jsxs)("div",{className:"small",style:{background:"#f8f9fa",border:"1px solid #e9ecef",padding:8,borderRadius:6,marginBottom:10},children:[(0,x.jsx)("span",{style:{fontWeight:600},children:p})," policy acknowledgement",p>1?"s":""," due. You may be prompted to review them."]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"title",children:["Welcome",r?", ".concat(r.name):""]}),(0,x.jsxs)("div",{className:"muted",style:{marginTop:6},children:["You have ",(0,x.jsx)("strong",{children:y})," pending items"]})]}),(0,x.jsxs)("div",{style:{textAlign:"right"},children:[(0,x.jsxs)("div",{className:"muted small",children:["Due by: ",(0,x.jsx)("strong",{style:{color:"var(--accent)"},children:b?g(b):"\u2014"})]}),m.canSeeAdmin&&(0,x.jsx)("div",{style:{marginTop:8},children:(0,x.jsx)(n.N_,{to:"/admin",children:(0,x.jsx)("button",{className:"btn ghost sm",children:"Admin"})})})]})]}),(0,x.jsx)("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #f2f2f2"}}),u?(0,x.jsxs)("div",{style:{display:"grid",gap:10},children:[(0,x.jsx)("div",{className:"skeleton block"}),(0,x.jsx)("div",{className:"skeleton block"}),(0,x.jsx)("div",{className:"skeleton block"})]}):0===v.length?(0,x.jsx)("div",{style:{padding:12},children:(0,x.jsx)("div",{className:"muted",children:l||"No batches assigned."})}):(0,x.jsx)("div",{className:"batch-list",children:v.map(e=>{var t,r,a,i;return(0,x.jsxs)("div",{className:"batch-tile",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:e.toba_name}),(0,x.jsxs)("div",{className:"muted",style:{marginTop:6},children:["Mandatory for all staff \u2022 Due: ",g(e.toba_duedate)]}),(0,x.jsxs)("div",{style:{marginTop:8},children:[(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,x.jsx)("i",{style:{width:"".concat((null===(t=s[e.toba_batchid])||void 0===t?void 0:t.percent)||0,"%")}})}),(0,x.jsxs)("div",{className:"muted small",style:{marginTop:6},children:[(null===(r=s[e.toba_batchid])||void 0===r?void 0:r.percent)||0,"% acknowledged"]}),((t,n,r,a)=>{const i=s[e.toba_batchid]||{percent:0,total:0,acknowledged:0},o=Math.max(0,(null!==(t=i.total)&&void 0!==t?t:0)-(null!==(n=i.acknowledged)&&void 0!==n?n:0));return(0,x.jsxs)("div",{className:"stats-row","aria-label":"batch document stats",children:[(0,x.jsxs)("span",{className:"chip",children:[(0,x.jsx)("strong",{children:null!==(r=i.total)&&void 0!==r?r:0})," Docs"]}),(0,x.jsxs)("span",{className:"chip ok",children:[(0,x.jsx)("strong",{children:null!==(a=i.acknowledged)&&void 0!==a?a:0})," Acknowledged"]}),(0,x.jsxs)("span",{className:"chip warn",children:[(0,x.jsx)("strong",{children:o})," Remaining"]})]})})()]})]}),(0,x.jsxs)("div",{style:{textAlign:"right"},children:[(0,x.jsx)("div",{children:100===((null===(a=s[e.toba_batchid])||void 0===a?void 0:a.percent)||0)?(0,x.jsx)("span",{className:"badge done",children:"Completed"}):(0,x.jsx)("span",{className:"badge progress",children:"In Progress"})}),(0,x.jsx)("div",{style:{marginTop:10},children:100===((null===(i=s[e.toba_batchid])||void 0===i?void 0:i.percent)||0)?(0,x.jsx)(n.N_,{to:"/batch/".concat(e.toba_batchid,"/completed"),children:(0,x.jsx)("button",{className:"btn ghost sm",children:"View"})}):(0,x.jsx)(n.N_,{to:"/batch/".concat(e.toba_batchid),children:(0,x.jsx)("button",{className:"btn ghost sm",children:"Continue"})})})]})]},e.toba_batchid)})})]})})},bt=()=>{const{id:t}=(0,F.g)(),{token:r,account:a}=(0,_.As)(),[i,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(!0),[u,h]=(0,e.useState)([]),[p,f]=(0,e.useState)(!1),m=(0,F.Zp)();return(0,e.useEffect)(()=>{(async()=>{if(t){try{const e=await(0,L.Pg)(t,null!==r&&void 0!==r?r:void 0,void 0,(null===a||void 0===a?void 0:a.username)||void 0);if((null===e||void 0===e?void 0:e.percent)>=100)return void f(!0)}catch(e){}try{if(!await ft((null===a||void 0===a?void 0:a.username)||void 0,t))return void m("/");f(!0);try{const e=await(0,L.getDocumentsByBatch)(t,null!==r&&void 0!==r?r:void 0);if(Array.isArray(e)&&e.length>0){const n=e[0];if(n&&n.toba_documentid)return void m("/document/".concat(n.toba_documentid,"?batchId=").concat(t))}}catch(n){}}catch(i){m("/")}}else f(!0)})()},[t,r,null===a||void 0===a?void 0:a.username,m]),(0,e.useEffect)(()=>{if(!t)return;if(!p)return;(async()=>{try{d(!0);const e=await(0,L.getDocumentsByBatch)(t,null!==r&&void 0!==r?r:void 0);s(e),l(null);const n=await(0,L.DC)(t,null!==r&&void 0!==r?r:void 0,(null===a||void 0===a?void 0:a.username)||void 0);h(n)}catch(e){s([]),l("Unable to load documents for this batch.")}finally{d(!1)}})()},[r,t,null===a||void 0===a?void 0:a.username,p]),(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"title",children:"Batch"}),(0,x.jsx)("div",{className:"muted small",children:"Documents assigned"})]}),(0,x.jsx)(n.N_,{to:"/",children:(0,x.jsx)("button",{className:"btn ghost",children:"\u2190 Back"})})]}),(0,x.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),c?(0,x.jsxs)("div",{className:"doc-list",children:[(0,x.jsxs)("div",{className:"doc-row",children:[(0,x.jsxs)("div",{className:"doc-meta",children:[(0,x.jsx)("div",{className:"skeleton circle"}),(0,x.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,x.jsx)("div",{className:"skeleton line",style:{width:220}}),(0,x.jsx)("div",{className:"skeleton line",style:{width:140}})]})]}),(0,x.jsx)("div",{className:"skeleton line",style:{width:80}})]}),(0,x.jsxs)("div",{className:"doc-row",children:[(0,x.jsxs)("div",{className:"doc-meta",children:[(0,x.jsx)("div",{className:"skeleton circle"}),(0,x.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,x.jsx)("div",{className:"skeleton line",style:{width:240}}),(0,x.jsx)("div",{className:"skeleton line",style:{width:120}})]})]}),(0,x.jsx)("div",{className:"skeleton line",style:{width:80}})]})]}):0===i.length?(0,x.jsx)("div",{style:{padding:12},children:(0,x.jsx)("div",{className:"muted",children:o||"No documents found."})}):(0,x.jsx)("div",{className:"doc-list",children:i.map((e,r)=>(0,x.jsxs)("div",{className:"doc-row",children:[(0,x.jsxs)("div",{className:"doc-meta",children:[(0,x.jsx)("div",{className:"doc-icon",children:"PDF"}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontWeight:700,display:"flex",alignItems:"center",gap:8},children:[(0,x.jsxs)("span",{children:[r+1,". ",e.toba_title]}),u.includes(e.toba_documentid)&&(0,x.jsx)("span",{className:"badge done",children:"Acknowledged"})]}),(0,x.jsx)("div",{className:"muted small",children:e.toba_version||""})]})]}),(0,x.jsx)("div",{style:{textAlign:"right"},children:(0,x.jsx)(n.N_,{to:"/document/".concat(e.toba_documentid,"?batchId=").concat(t),children:(0,x.jsx)("button",{className:"btn sm",children:u.includes(e.toba_documentid)?"View":"Read"})})})]},e.toba_documentid))})]})})},wt=e=>{let{message:t,show:n}=e;return(0,x.jsx)("div",{className:"toast".concat(n?" show":""),role:"status","aria-live":"polite",children:t})},_t=e=>{let{title:t,backTo:r="/"}=e;return(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"title",children:t}),(0,x.jsx)("div",{className:"muted small",children:"Please read and acknowledge"})]}),(0,x.jsx)(n.N_,{to:r,children:(0,x.jsx)("button",{className:"btn ghost sm",children:"\u2190 Back"})})]})},At=e=>{let{show:t}=e;return t?(0,x.jsx)("div",{className:"small",style:{marginTop:8,background:"#fff8e1",border:"1px solid #ffe0b2",padding:10,borderRadius:8},children:"To submit an acknowledgement in this batch, you must first consent to legal terms. You'll be prompted when you click I Accept."}):null},St=e=>{let{visible:t,onGrant:n}=e;return t?(0,x.jsxs)("div",{className:"small",style:{marginBottom:8,background:"#fff8e1",border:"1px solid #ffe0b2",padding:10,borderRadius:8},children:["This document is stored in SharePoint. We need Microsoft Graph access to preview it here.",(0,x.jsx)("button",{className:"btn ghost xs",style:{marginLeft:8},onClick:n,children:"Grant access"})]}):null};var Ct,xt=__webpack_require__(8728);function Et(e){return/^[^"'].*\s.*[^"']$/.test(e)?"'".concat(e,"'"):e}function Tt(e){let t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function kt(e,t){try{const n="http://docx/";return new URL(e,n+t).toString().substring(n.length)}catch(n){return"".concat(t).concat(e)}}function Pt(e,t){return e.reduce((e,n)=>(e[t(n)]=n,e),{})}function It(e){return e&&"object"===typeof e&&!Array.isArray(e)}function Rt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;const a=n.shift();if(It(e)&&It(a))for(const s in a)if(It(a[s])){var i;Rt(null!==(i=e[s])&&void 0!==i?i:e[s]={},a[s])}else e[s]=a[s];return Rt(e,...n)}function Nt(e){return Array.isArray(e)?e:[e]}!function(e){e.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",e.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",e.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",e.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",e.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",e.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",e.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",e.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",e.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",e.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",e.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",e.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",e.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",e.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",e.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",e.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",e.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",e.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",e.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"}(Ct||(Ct={}));const Ot="http://schemas.openxmlformats.org/wordprocessingml/2006/main",Mt={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt",min:.25,max:12},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"}};function Ft(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mt.Dxa;if(null==e||/.+(p[xt]|[%])$/.test(e))return e;var n=parseInt(e)*t.mul;return t.min&&t.max&&(n=function(e,t,n){return t>e?t:n<e?n:e}(n,t.min,t.max)),"".concat(n.toFixed(2)).concat(t.unit)}function Dt(e,t,n){if(e.namespaceURI!=Ot)return!1;switch(e.localName){case"color":t.color=n.attr(e,"val");break;case"sz":t.fontSize=n.lengthAttr(e,"val",Mt.FontSize);break;default:return!1}return!0}class Lt{elements(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];for(let r=0,a=e.childNodes.length;r<a;r++){let a=e.childNodes.item(r);a.nodeType!=Node.ELEMENT_NODE||null!=t&&a.localName!=t||n.push(a)}return n}element(e,t){for(let n=0,r=e.childNodes.length;n<r;n++){let r=e.childNodes.item(n);if(1==r.nodeType&&r.localName==t)return r}return null}elementAttr(e,t,n){var r=this.element(e,t);return r?this.attr(r,n):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let n=0,r=e.attributes.length;n<r;n++){let r=e.attributes.item(n);if(r.localName==t)return r.value}return null}intAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var r=this.attr(e,t);return r?parseInt(r):n}hexAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var r=this.attr(e,t);return r?parseInt(r,16):n}floatAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var r=this.attr(e,t);return r?parseFloat(r):n}boolAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}(this.attr(e,t),n)}lengthAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mt.Dxa;return Ft(this.attr(e,t),n)}}const jt=new Lt;class Bt{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);const e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}const Ut={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function Gt(e,t){return t.elements(e).map(e=>function(e,t){let n={name:t.attr(e,"name"),embedFontRefs:[]};for(let r of t.elements(e))switch(r.localName){case"family":n.family=t.attr(r,"val");break;case"altName":n.altName=t.attr(r,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":n.embedFontRefs.push(Ht(r,t))}return n}(e,t))}function Ht(e,t){return{id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:Ut[e.localName]}}class zt extends Bt{parseXml(e){this.fonts=Gt(e,this._package.xmlParser)}}class Wt{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new Lt}get(e){var t;const n=function(e){return e.startsWith("/")?e.substr(1):e}(e);return null!==(t=this._zip.files[n])&&void 0!==t?t:this._zip.files[n.replace(/\//g,"\\")]}update(e,t){this._zip.file(e,t)}static async load(e,t){const n=await xt.loadAsync(e);return new Wt(n,t)}save(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"blob";return this._zip.generateAsync({type:e})}load(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";return null!==(t=null===(n=this.get(e))||void 0===n?void 0:n.async(r))&&void 0!==t?t:Promise.resolve(null)}async loadRelationships(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t="_rels/.rels";if(null!=e){const[n,r]=Tt(e);t="".concat(n,"_rels/").concat(r,".rels")}const n=await this.load(t);return n?(r=this.parseXmlDocument(n).firstElementChild,(a=this.xmlParser).elements(r).map(e=>({id:a.attr(e,"Id"),type:a.attr(e,"Type"),target:a.attr(e,"Target"),targetMode:a.attr(e,"TargetMode")}))):null;var r,a}parseXmlDocument(e){return function(e){var t;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(t=e).charCodeAt(0)?t.substring(1):t;const n=(new DOMParser).parseFromString(e,"application/xml"),r=function(e){var t;return null===(t=e.getElementsByTagName("parsererror")[0])||void 0===t?void 0:t.textContent}(n);if(r)throw new Error(r);return n}(e,this.options.trimXmlDeclaration)}}class qt extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function Vt(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",Mt.Border),offset:t.lengthAttr(e,"space",Mt.Point),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function Kt(e,t){var n={};for(let r of t.elements(e))switch(r.localName){case"left":n.left=Vt(r,t);break;case"top":n.top=Vt(r,t);break;case"right":n.right=Vt(r,t);break;case"bottom":n.bottom=Vt(r,t)}return n}var Yt,Xt;function Qt(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt;var a={};for(let i of r.elements(e))switch(i.localName){case"pgSz":a.pageSize={width:r.lengthAttr(i,"w"),height:r.lengthAttr(i,"h"),orientation:r.attr(i,"orient")};break;case"type":a.type=r.attr(i,"val");break;case"pgMar":a.pageMargins={left:r.lengthAttr(i,"left"),right:r.lengthAttr(i,"right"),top:r.lengthAttr(i,"top"),bottom:r.lengthAttr(i,"bottom"),header:r.lengthAttr(i,"header"),footer:r.lengthAttr(i,"footer"),gutter:r.lengthAttr(i,"gutter")};break;case"cols":a.columns=$t(i,r);break;case"headerReference":(null!==(t=a.headerRefs)&&void 0!==t?t:a.headerRefs=[]).push(Zt(i,r));break;case"footerReference":(null!==(n=a.footerRefs)&&void 0!==n?n:a.footerRefs=[]).push(Zt(i,r));break;case"titlePg":a.titlePage=r.boolAttr(i,"val",!0);break;case"pgBorders":a.pageBorders=Kt(i,r);break;case"pgNumType":a.pageNumber=Jt(i,r)}return a}function $t(e,t){return{numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function Jt(e,t){return{chapSep:t.attr(e,"chapSep"),chapStyle:t.attr(e,"chapStyle"),format:t.attr(e,"fmt"),start:t.intAttr(e,"start")}}function Zt(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function en(e,t){let n={};for(let r of t.elements(e))tn(r,n,t);return n}function tn(e,t,n){return!!Dt(e,t,n)}function nn(e,t){let n={};for(let r of t.elements(e))rn(r,n,t);return n}function rn(e,t,n){if(e.namespaceURI!=Ot)return!1;if(Dt(e,t,n))return!0;switch(e.localName){case"tabs":t.tabs=function(e,t){return t.elements(e,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}(e,n);break;case"sectPr":t.sectionProps=Qt(e,n);break;case"numPr":t.numbering=function(e,t){var n={};for(let r of t.elements(e))switch(r.localName){case"numId":n.id=t.attr(r,"val");break;case"ilvl":n.level=t.intAttr(r,"val")}return n}(e,n);break;case"spacing":return t.lineSpacing=function(e,t){return{before:t.lengthAttr(e,"before"),after:t.lengthAttr(e,"after"),line:t.intAttr(e,"line"),lineRule:t.attr(e,"lineRule")}}(e,n),!1;case"textAlignment":return t.textAlignment=n.attr(e,"val"),!1;case"keepLines":t.keepLines=n.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=n.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=n.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=n.intAttr(e,"val");break;case"pStyle":t.styleName=n.attr(e,"val");break;case"rPr":t.runProps=en(e,n);break;default:return!1}return!0}function an(e,t){let n={id:t.attr(e,"numId"),overrides:[]};for(let r of t.elements(e))switch(r.localName){case"abstractNumId":n.abstractId=t.attr(r,"val");break;case"lvlOverride":n.overrides.push(ln(r,t))}return n}function sn(e,t){let n={id:t.attr(e,"abstractNumId"),levels:[]};for(let r of t.elements(e))switch(r.localName){case"name":n.name=t.attr(r,"val");break;case"multiLevelType":n.multiLevelType=t.attr(r,"val");break;case"numStyleLink":n.numberingStyleLink=t.attr(r,"val");break;case"styleLink":n.styleLink=t.attr(r,"val");break;case"lvl":n.levels.push(on(r,t))}return n}function on(e,t){let n={level:t.intAttr(e,"ilvl")};for(let r of t.elements(e))switch(r.localName){case"start":n.start=t.attr(r,"val");break;case"lvlRestart":n.restart=t.intAttr(r,"val");break;case"numFmt":n.format=t.attr(r,"val");break;case"lvlText":n.text=t.attr(r,"val");break;case"lvlJc":n.justification=t.attr(r,"val");break;case"lvlPicBulletId":n.bulletPictureId=t.attr(r,"val");break;case"pStyle":n.paragraphStyle=t.attr(r,"val");break;case"pPr":n.paragraphProps=nn(r,t);break;case"rPr":n.runProps=en(r,t)}return n}function ln(e,t){let n={level:t.intAttr(e,"ilvl")};for(let r of t.elements(e))switch(r.localName){case"startOverride":n.start=t.intAttr(r,"val");break;case"lvl":n.numberingLevel=on(r,t)}return n}function cn(e,t){var n=t.element(e,"pict"),r=n&&t.element(n,"shape"),a=r&&t.element(r,"imagedata");return a?{id:t.attr(e,"numPicBulletId"),referenceId:t.attr(a,"id"),style:t.attr(r,"style")}:null}!function(e){e.Continuous="continuous",e.NextPage="nextPage",e.NextColumn="nextColumn",e.EvenPage="evenPage",e.OddPage="oddPage"}(Yt||(Yt={}));class dn extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}parseXml(e){Object.assign(this,function(e,t){let n={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let r of t.elements(e))switch(r.localName){case"num":n.numberings.push(an(r,t));break;case"abstractNum":n.abstractNumberings.push(sn(r,t));break;case"numPicBullet":n.bulletPictures.push(cn(r,t))}return n}(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class un extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}!function(e){e.Document="document",e.Paragraph="paragraph",e.Run="run",e.Break="break",e.NoBreakHyphen="noBreakHyphen",e.Table="table",e.Row="row",e.Cell="cell",e.Hyperlink="hyperlink",e.SmartTag="smartTag",e.Drawing="drawing",e.Image="image",e.Text="text",e.Tab="tab",e.Symbol="symbol",e.BookmarkStart="bookmarkStart",e.BookmarkEnd="bookmarkEnd",e.Footer="footer",e.Header="header",e.FootnoteReference="footnoteReference",e.EndnoteReference="endnoteReference",e.Footnote="footnote",e.Endnote="endnote",e.SimpleField="simpleField",e.ComplexField="complexField",e.Instruction="instruction",e.VmlPicture="vmlPicture",e.MmlMath="mmlMath",e.MmlMathParagraph="mmlMathParagraph",e.MmlFraction="mmlFraction",e.MmlFunction="mmlFunction",e.MmlFunctionName="mmlFunctionName",e.MmlNumerator="mmlNumerator",e.MmlDenominator="mmlDenominator",e.MmlRadical="mmlRadical",e.MmlBase="mmlBase",e.MmlDegree="mmlDegree",e.MmlSuperscript="mmlSuperscript",e.MmlSubscript="mmlSubscript",e.MmlPreSubSuper="mmlPreSubSuper",e.MmlSubArgument="mmlSubArgument",e.MmlSuperArgument="mmlSuperArgument",e.MmlNary="mmlNary",e.MmlDelimiter="mmlDelimiter",e.MmlRun="mmlRun",e.MmlEquationArray="mmlEquationArray",e.MmlLimit="mmlLimit",e.MmlLimitLower="mmlLimitLower",e.MmlMatrix="mmlMatrix",e.MmlMatrixRow="mmlMatrixRow",e.MmlBox="mmlBox",e.MmlBar="mmlBar",e.MmlGroupChar="mmlGroupChar",e.VmlElement="vmlElement",e.Inserted="inserted",e.Deleted="deleted",e.DeletedText="deletedText",e.Comment="comment",e.CommentReference="commentReference",e.CommentRangeStart="commentRangeStart",e.CommentRangeEnd="commentRangeEnd",e.AltChunk="altChunk"}(Xt||(Xt={}));class hn{constructor(){this.children=[],this.cssStyle={}}}class pn extends hn{constructor(){super(...arguments),this.type=Xt.Header}}class fn extends hn{constructor(){super(...arguments),this.type=Xt.Footer}}class mn extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class gn extends mn{createRootElement(){return new pn}}class vn extends mn{createRootElement(){return new fn}}function yn(e){if("undefined"!==typeof e)return parseInt(e)}class bn extends Bt{parseXml(e){this.props=function(e,t){const n={};for(let r of t.elements(e))switch(r.localName){case"Template":n.template=r.textContent;break;case"Pages":n.pages=yn(r.textContent);break;case"Words":n.words=yn(r.textContent);break;case"Characters":n.characters=yn(r.textContent);break;case"Application":n.application=r.textContent;break;case"Lines":n.lines=yn(r.textContent);break;case"Paragraphs":n.paragraphs=yn(r.textContent);break;case"Company":n.company=r.textContent;break;case"AppVersion":n.appVersion=r.textContent}return n}(e,this._package.xmlParser)}}class wn extends Bt{parseXml(e){this.props=function(e,t){const n={};for(let r of t.elements(e))switch(r.localName){case"title":n.title=r.textContent;break;case"description":n.description=r.textContent;break;case"subject":n.subject=r.textContent;break;case"creator":n.creator=r.textContent;break;case"keywords":n.keywords=r.textContent;break;case"language":n.language=r.textContent;break;case"lastModifiedBy":n.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(n.revision=parseInt(r.textContent))}return n}(e,this._package.xmlParser)}}class _n{}function An(e,t){var n={name:t.attr(e,"name"),colors:{}};for(let i of t.elements(e)){var r=t.element(i,"srgbClr"),a=t.element(i,"sysClr");r?n.colors[i.localName]=t.attr(r,"val"):a&&(n.colors[i.localName]=t.attr(a,"lastClr"))}return n}function Sn(e,t){var n={name:t.attr(e,"name")};for(let r of t.elements(e))switch(r.localName){case"majorFont":n.majorFont=Cn(r,t);break;case"minorFont":n.minorFont=Cn(r,t)}return n}function Cn(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class xn extends Bt{constructor(e,t){super(e,t)}parseXml(e){this.theme=function(e,t){var n=new _n,r=t.element(e,"themeElements");for(let a of t.elements(r))switch(a.localName){case"clrScheme":n.colorScheme=An(a,t);break;case"fontScheme":n.fontScheme=Sn(a,t)}return n}(e,this._package.xmlParser)}}class En{}class Tn extends En{constructor(){super(...arguments),this.type=Xt.Footnote}}class kn extends En{constructor(){super(...arguments),this.type=Xt.Endnote}}class Pn extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}}class In extends Pn{constructor(e,t,n){super(e,t,n)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",Tn)}}class Rn extends Pn{constructor(e,t,n){super(e,t,n)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",kn)}}function Nn(e,t){var n={defaultNoteIds:[]};for(let r of t.elements(e))switch(r.localName){case"numFmt":n.nummeringFormat=t.attr(r,"val");break;case"footnote":case"endnote":n.defaultNoteIds.push(t.attr(r,"id"))}return n}class On extends Bt{constructor(e,t){super(e,t)}parseXml(e){this.settings=function(e,t){var n={};for(let r of t.elements(e))switch(r.localName){case"defaultTabStop":n.defaultTabStop=t.lengthAttr(r,"val");break;case"footnotePr":n.footnoteProps=Nn(r,t);break;case"endnotePr":n.endnoteProps=Nn(r,t);break;case"autoHyphenation":n.autoHyphenation=t.boolAttr(r,"val")}return n}(e,this._package.xmlParser)}}class Mn extends Bt{parseXml(e){this.props=function(e,t){return t.elements(e,"property").map(e=>{const n=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:n.nodeName,value:n.textContent}})}(e,this._package.xmlParser)}}class Fn extends Bt{constructor(e,t,n){super(e,t),this._documentParser=n}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=Pt(this.comments,e=>e.id)}}class Dn extends Bt{constructor(e,t){super(e,t),this.comments=[]}parseXml(e){const t=this._package.xmlParser;for(let n of t.elements(e,"commentEx"))this.comments.push({paraId:t.attr(n,"paraId"),paraIdParent:t.attr(n,"paraIdParent"),done:t.boolAttr(n,"done")});this.commentMap=Pt(this.comments,e=>e.paraId)}}const Ln=[{type:Ct.OfficeDocument,target:"word/document.xml"},{type:Ct.ExtendedProperties,target:"docProps/app.xml"},{type:Ct.CoreProperties,target:"docProps/core.xml"},{type:Ct.CustomProperties,target:"docProps/custom.xml"}];class jn{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,n){var r=new jn;return r._options=n,r._parser=t,r._package=await Wt.load(e,n),r.rels=await r._package.loadRelationships(),await Promise.all(Ln.map(e=>{var t;const n=null!==(t=r.rels.find(t=>t.type===e.type))&&void 0!==t?t:e;return r.loadRelationshipPart(n.target,n.type)})),r}save(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"blob";return this._package.save(e)}async loadRelationshipPart(e,t){var n;if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case Ct.OfficeDocument:this.documentPart=r=new qt(this._package,e,this._parser);break;case Ct.FontTable:this.fontTablePart=r=new zt(this._package,e);break;case Ct.Numbering:this.numberingPart=r=new dn(this._package,e,this._parser);break;case Ct.Styles:this.stylesPart=r=new un(this._package,e,this._parser);break;case Ct.Theme:this.themePart=r=new xn(this._package,e);break;case Ct.Footnotes:this.footnotesPart=r=new In(this._package,e,this._parser);break;case Ct.Endnotes:this.endnotesPart=r=new Rn(this._package,e,this._parser);break;case Ct.Footer:r=new vn(this._package,e,this._parser);break;case Ct.Header:r=new gn(this._package,e,this._parser);break;case Ct.CoreProperties:this.corePropsPart=r=new wn(this._package,e);break;case Ct.ExtendedProperties:this.extendedPropsPart=r=new bn(this._package,e);break;case Ct.CustomProperties:r=new Mn(this._package,e);break;case Ct.Settings:this.settingsPart=r=new On(this._package,e);break;case Ct.Comments:this.commentsPart=r=new Fn(this._package,e,this._parser);break;case Ct.CommentsExtended:this.commentsExtendedPart=r=new Dn(this._package,e)}if(null==r)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),await r.load(),(null===(n=r.rels)||void 0===n?void 0:n.length)>0){const[e]=Tt(r.path);await Promise.all(r.rels.map(t=>this.loadRelationshipPart(kt(t.target,e),t.type)))}return r}async loadDocumentImage(e,t){const n=await this.loadResource(null!==t&&void 0!==t?t:this.documentPart,e,"blob");return this.blobToURL(n)}async loadNumberingImage(e){const t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){const n=await this.loadResource(this.fontTablePart,e,"uint8array");return n?this.blobToURL(new Blob([Bn(n,t)])):n}async loadAltChunk(e,t){return await this.loadResource(null!==t&&void 0!==t?t:this.documentPart,e,"string")}blobToURL(e){return e?this._options.useBase64URL?function(e){return new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=()=>n(),r.readAsDataURL(e)})}(e):URL.createObjectURL(e):null}findPartByRelId(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var r=(null!==(t=n.rels)&&void 0!==t?t:this.rels).find(t=>t.id==e);const a=n?Tt(n.path)[0]:"";return r?this.partsMap[kt(r.target,a)]:null}getPathById(e,t){const n=e.rels.find(e=>e.id==t),[r]=Tt(e.path);return n?kt(n.target,r):null}loadResource(e,t,n){const r=this.getPathById(e,t);return r?this._package.load(r,n):Promise.resolve(null)}}function Bn(e,t){const n=t.replace(/{|}|-/g,""),r=new Array(16);for(let a=0;a<16;a++)r[16-a-1]=parseInt(n.substring(2*a,2*a+2),16);for(let a=0;a<32;a++)e[a]=e[a]^r[a%16];return e}function Un(e,t){return{type:Xt.BookmarkStart,id:t.attr(e,"id"),name:t.attr(e,"name"),colFirst:t.intAttr(e,"colFirst"),colLast:t.intAttr(e,"colLast")}}function Gn(e,t){return{type:Xt.BookmarkEnd,id:t.attr(e,"id")}}class Hn extends hn{constructor(){super(...arguments),this.type=Xt.VmlElement,this.attrs={}}}function zn(e,t){var n=new Hn;switch(e.localName){case"rect":n.tagName="rect",Object.assign(n.attrs,{width:"100%",height:"100%"});break;case"oval":n.tagName="ellipse",Object.assign(n.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":n.tagName="line";break;case"shape":n.tagName="g";break;case"textbox":n.tagName="foreignObject",Object.assign(n.attrs,{width:"100%",height:"100%"});break;default:return null}for(const r of jt.attrs(e))switch(r.localName){case"style":n.cssStyleText=r.value;break;case"fillcolor":n.attrs.fill=r.value;break;case"from":const[e,t]=Vn(r.value);Object.assign(n.attrs,{x1:e,y1:t});break;case"to":const[a,i]=Vn(r.value);Object.assign(n.attrs,{x2:a,y2:i})}for(const r of jt.elements(e))switch(r.localName){case"stroke":Object.assign(n.attrs,Wn(r));break;case"fill":Object.assign(n.attrs,qn());break;case"imagedata":n.tagName="image",Object.assign(n.attrs,{width:"100%",height:"100%"}),n.imageHref={id:jt.attr(r,"id"),title:jt.attr(r,"title")};break;case"txbxContent":n.children.push(...t.parseBodyElements(r));break;default:const e=zn(r,t);e&&n.children.push(e)}return n}function Wn(e){var t;return{stroke:jt.attr(e,"color"),"stroke-width":null!==(t=jt.lengthAttr(e,"weight",Mt.Emu))&&void 0!==t?t:"1px"}}function qn(e){return{}}function Vn(e){return e.split(",")}class Kn extends hn{constructor(){super(...arguments),this.type=Xt.Comment}}class Yn extends hn{constructor(e){super(),this.id=e,this.type=Xt.CommentReference}}class Xn extends hn{constructor(e){super(),this.id=e,this.type=Xt.CommentRangeStart}}class Qn extends hn{constructor(e){super(),this.id=e,this.type=Xt.CommentRangeEnd}}var $n="inherit",Jn="black",Zn="black",er="transparent";const tr=[],nr={oMath:Xt.MmlMath,oMathPara:Xt.MmlMathParagraph,f:Xt.MmlFraction,func:Xt.MmlFunction,fName:Xt.MmlFunctionName,num:Xt.MmlNumerator,den:Xt.MmlDenominator,rad:Xt.MmlRadical,deg:Xt.MmlDegree,e:Xt.MmlBase,sSup:Xt.MmlSuperscript,sSub:Xt.MmlSubscript,sPre:Xt.MmlPreSubSuper,sup:Xt.MmlSuperArgument,sub:Xt.MmlSubArgument,d:Xt.MmlDelimiter,nary:Xt.MmlNary,eqArr:Xt.MmlEquationArray,lim:Xt.MmlLimit,limLow:Xt.MmlLimitLower,m:Xt.MmlMatrix,mr:Xt.MmlMatrixRow,box:Xt.MmlBox,bar:Xt.MmlBar,groupChr:Xt.MmlGroupChar};class rr{constructor(e){this.options=(0,d.A)({ignoreWidth:!1,debug:!1},e)}parseNotes(e,t,n){var r=[];for(let a of jt.elements(e,t)){const e=new n;e.id=jt.attr(a,"id"),e.noteType=jt.attr(a,"type"),e.children=this.parseBodyElements(a),r.push(e)}return r}parseComments(e){var t=[];for(let n of jt.elements(e,"comment")){const e=new Kn;e.id=jt.attr(n,"id"),e.author=jt.attr(n,"author"),e.initials=jt.attr(n,"initials"),e.date=jt.attr(n,"date"),e.children=this.parseBodyElements(n),t.push(e)}return t}parseDocumentFile(e){var t=jt.element(e,"body"),n=jt.element(e,"background"),r=jt.element(t,"sectPr");return{type:Xt.Document,children:this.parseBodyElements(t),props:r?Qt(r,jt):{},cssStyle:n?this.parseBackground(n):{}}}parseBackground(e){var t={},n=ir.colorAttr(e,"color");return n&&(t["background-color"]=n),t}parseBodyElements(e){var t=[];for(const n of jt.elements(e))switch(n.localName){case"p":t.push(this.parseParagraph(n));break;case"altChunk":t.push(this.parseAltChunk(n));break;case"tbl":t.push(this.parseTable(n));break;case"sdt":t.push(...this.parseSdt(n,e=>this.parseBodyElements(e)))}return t}parseStylesFile(e){var t=[];for(const n of jt.elements(e))switch(n.localName){case"style":t.push(this.parseStyle(n));break;case"docDefaults":t.push(this.parseDefaultStyles(n))}return t}parseDefaultStyles(e){var t={id:null,name:null,target:null,basedOn:null,styles:[]};for(const a of jt.elements(e))switch(a.localName){case"rPrDefault":var n=jt.element(a,"rPr");n&&t.styles.push({target:"span",values:this.parseDefaultProperties(n,{})});break;case"pPrDefault":var r=jt.element(a,"pPr");r&&t.styles.push({target:"p",values:this.parseDefaultProperties(r,{})})}return t}parseStyle(e){var t={id:jt.attr(e,"styleId"),isDefault:jt.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(jt.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span"}for(const n of jt.elements(e))switch(n.localName){case"basedOn":t.basedOn=jt.attr(n,"val");break;case"name":t.name=jt.attr(n,"val");break;case"link":t.linked=jt.attr(n,"val");break;case"next":t.next=jt.attr(n,"val");break;case"aliases":t.aliases=jt.attr(n,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(n,{})}),t.paragraphProps=nn(n,jt);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(n,{})}),t.runProps=en(n,jt);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(n,{})});break;case"tblStylePr":for(let e of this.parseTableStyle(n))t.styles.push(e);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn("DOCX: Unknown style element: ".concat(n.localName))}return t}parseTableStyle(e){var t=[],n="",r="";switch(jt.attr(e,"type")){case"firstRow":r=".first-row",n="tr.first-row td";break;case"lastRow":r=".last-row",n="tr.last-row td";break;case"firstCol":r=".first-col",n="td.first-col";break;case"lastCol":r=".last-col",n="td.last-col";break;case"band1Vert":r=":not(.no-vband)",n="td.odd-col";break;case"band2Vert":r=":not(.no-vband)",n="td.even-col";break;case"band1Horz":r=":not(.no-hband)",n="tr.odd-row";break;case"band2Horz":r=":not(.no-hband)",n="tr.even-row";break;default:return[]}for(const a of jt.elements(e))switch(a.localName){case"pPr":t.push({target:"".concat(n," p"),mod:r,values:this.parseDefaultProperties(a,{})});break;case"rPr":t.push({target:"".concat(n," span"),mod:r,values:this.parseDefaultProperties(a,{})});break;case"tblPr":case"tcPr":t.push({target:n,mod:r,values:this.parseDefaultProperties(a,{})})}return t}parseNumberingFile(e){var t=[],n={},r=[];for(const s of jt.elements(e))switch(s.localName){case"abstractNum":this.parseAbstractNumbering(s,r).forEach(e=>t.push(e));break;case"numPicBullet":r.push(this.parseNumberingPicBullet(s));break;case"num":var a=jt.attr(s,"numId"),i=jt.elementAttr(s,"abstractNumId","val");n[i]=a}return t.forEach(e=>e.id=n[e.id]),t}parseNumberingPicBullet(e){var t=jt.element(e,"pict"),n=t&&jt.element(t,"shape"),r=n&&jt.element(n,"imagedata");return r?{id:jt.intAttr(e,"numPicBulletId"),src:jt.attr(r,"id"),style:jt.attr(n,"style")}:null}parseAbstractNumbering(e,t){var n=[],r=jt.attr(e,"abstractNumId");for(const a of jt.elements(e))if("lvl"===a.localName)n.push(this.parseNumberingLevel(r,a,t));return n}parseNumberingLevel(e,t,n){var r={id:e,level:jt.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};for(const i of jt.elements(t))switch(i.localName){case"start":r.start=jt.intAttr(i,"val");break;case"pPr":this.parseDefaultProperties(i,r.pStyle);break;case"rPr":this.parseDefaultProperties(i,r.rStyle);break;case"lvlPicBulletId":var a=jt.intAttr(i,"val");r.bullet=n.find(e=>(null===e||void 0===e?void 0:e.id)==a);break;case"lvlText":r.levelText=jt.attr(i,"val");break;case"pStyle":r.pStyleName=jt.attr(i,"val");break;case"numFmt":r.format=jt.attr(i,"val");break;case"suff":r.suff=jt.attr(i,"val")}return r}parseSdt(e,t){const n=jt.element(e,"sdtContent");return n?t(n):[]}parseInserted(e,t){var n,r;return{type:Xt.Inserted,children:null!==(n=null===(r=t(e))||void 0===r?void 0:r.children)&&void 0!==n?n:[]}}parseDeleted(e,t){var n,r;return{type:Xt.Deleted,children:null!==(n=null===(r=t(e))||void 0===r?void 0:r.children)&&void 0!==n?n:[]}}parseAltChunk(e){return{type:Xt.AltChunk,children:[],id:jt.attr(e,"id")}}parseParagraph(e){var t={type:Xt.Paragraph,children:[]};for(let n of jt.elements(e))switch(n.localName){case"pPr":this.parseParagraphProperties(n,t);break;case"r":t.children.push(this.parseRun(n,t));break;case"hyperlink":t.children.push(this.parseHyperlink(n,t));break;case"smartTag":t.children.push(this.parseSmartTag(n,t));break;case"bookmarkStart":t.children.push(Un(n,jt));break;case"bookmarkEnd":t.children.push(Gn(n,jt));break;case"commentRangeStart":t.children.push(new Xn(jt.attr(n,"id")));break;case"commentRangeEnd":t.children.push(new Qn(jt.attr(n,"id")));break;case"oMath":case"oMathPara":t.children.push(this.parseMathElement(n));break;case"sdt":t.children.push(...this.parseSdt(n,e=>this.parseParagraph(e).children));break;case"ins":t.children.push(this.parseInserted(n,e=>this.parseParagraph(e)));break;case"del":t.children.push(this.parseDeleted(n,e=>this.parseParagraph(e)))}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{if(rn(e,t,jt))return!0;switch(e.localName){case"pStyle":t.styleName=jt.attr(e,"val");break;case"cnfStyle":t.className=sr.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){"drop"==jt.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){var n={type:Xt.Hyperlink,parent:t,children:[]};n.anchor=jt.attr(e,"anchor"),n.id=jt.attr(e,"id");for(const r of jt.elements(e))if("r"===r.localName)n.children.push(this.parseRun(r,n));return n}parseSmartTag(e,t){var n={type:Xt.SmartTag,parent:t,children:[]},r=jt.attr(e,"uri"),a=jt.attr(e,"element");r&&(n.uri=r),a&&(n.element=a);for(const i of jt.elements(e))if("r"===i.localName)n.children.push(this.parseRun(i,n));return n}parseRun(e,t){var n={type:Xt.Run,parent:t,children:[]};for(let r of jt.elements(e))switch(r=this.checkAlternateContent(r),r.localName){case"t":n.children.push({type:Xt.Text,text:r.textContent});break;case"delText":n.children.push({type:Xt.DeletedText,text:r.textContent});break;case"commentReference":n.children.push(new Yn(jt.attr(r,"id")));break;case"fldSimple":n.children.push({type:Xt.SimpleField,instruction:jt.attr(r,"instr"),lock:jt.boolAttr(r,"lock",!1),dirty:jt.boolAttr(r,"dirty",!1)});break;case"instrText":n.fieldRun=!0,n.children.push({type:Xt.Instruction,text:r.textContent});break;case"fldChar":n.fieldRun=!0,n.children.push({type:Xt.ComplexField,charType:jt.attr(r,"fldCharType"),lock:jt.boolAttr(r,"lock",!1),dirty:jt.boolAttr(r,"dirty",!1)});break;case"noBreakHyphen":n.children.push({type:Xt.NoBreakHyphen});break;case"br":n.children.push({type:Xt.Break,break:jt.attr(r,"type")||"textWrapping"});break;case"lastRenderedPageBreak":n.children.push({type:Xt.Break,break:"lastRenderedPageBreak"});break;case"sym":n.children.push({type:Xt.Symbol,font:Et(jt.attr(r,"font")),char:jt.attr(r,"char")});break;case"tab":n.children.push({type:Xt.Tab});break;case"footnoteReference":n.children.push({type:Xt.FootnoteReference,id:jt.attr(r,"id")});break;case"endnoteReference":n.children.push({type:Xt.EndnoteReference,id:jt.attr(r,"id")});break;case"drawing":let e=this.parseDrawing(r);e&&(n.children=[e]);break;case"pict":n.children.push(this.parseVmlPicture(r));break;case"rPr":this.parseRunProperties(r,n)}return n}parseMathElement(e){const t="".concat(e.localName,"Pr"),n={type:nr[e.localName],children:[]};for(const a of jt.elements(e)){if(nr[a.localName])n.children.push(this.parseMathElement(a));else if("r"==a.localName){var r=this.parseRun(a);r.type=Xt.MmlRun,n.children.push(r)}else a.localName==t&&(n.props=this.parseMathProperies(a))}return n}parseMathProperies(e){const t={};for(const n of jt.elements(e))switch(n.localName){case"chr":t.char=jt.attr(n,"val");break;case"vertJc":t.verticalJustification=jt.attr(n,"val");break;case"pos":t.position=jt.attr(n,"val");break;case"degHide":t.hideDegree=jt.boolAttr(n,"val");break;case"begChr":t.beginChar=jt.attr(n,"val");break;case"endChr":t.endChar=jt.attr(n,"val")}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{switch(e.localName){case"rStyle":t.styleName=jt.attr(e,"val");break;case"vertAlign":t.verticalAlign=sr.valueOfVertAlign(e,!0);break;default:return!1}return!0})}parseVmlPicture(e){const t={type:Xt.VmlPicture,children:[]};for(const n of jt.elements(e)){const e=zn(n,this);e&&t.children.push(e)}return t}checkAlternateContent(e){var t;if("AlternateContent"!=e.localName)return e;var n=jt.element(e,"Choice");if(n){var r=jt.attr(n,"Requires"),a=e.lookupNamespaceURI(r);if(tr.includes(a))return n.firstElementChild}return null===(t=jt.element(e,"Fallback"))||void 0===t?void 0:t.firstElementChild}parseDrawing(e){for(var t of jt.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t={type:Xt.Drawing,children:[],cssStyle:{}},n="anchor"==e.localName;let r=null,a=jt.boolAttr(e,"simplePos");jt.boolAttr(e,"behindDoc");let i={relative:"page",align:"left",offset:"0"},s={relative:"page",align:"top",offset:"0"};for(var o of jt.elements(e))switch(o.localName){case"simplePos":a&&(i.offset=jt.lengthAttr(o,"x",Mt.Emu),s.offset=jt.lengthAttr(o,"y",Mt.Emu));break;case"extent":t.cssStyle.width=jt.lengthAttr(o,"cx",Mt.Emu),t.cssStyle.height=jt.lengthAttr(o,"cy",Mt.Emu);break;case"positionH":case"positionV":if(!a){var l;let e="positionH"==o.localName?i:s;var c=jt.element(o,"align"),d=jt.element(o,"posOffset");e.relative=null!==(l=jt.attr(o,"relativeFrom"))&&void 0!==l?l:e.relative,c&&(e.align=c.textContent),d&&(e.offset=Ft(d.textContent,Mt.Emu))}break;case"wrapTopAndBottom":r="wrapTopAndBottom";break;case"wrapNone":r="wrapNone";break;case"graphic":var u=this.parseGraphic(o);u&&t.children.push(u)}return"wrapTopAndBottom"==r?(t.cssStyle.display="block",i.align&&(t.cssStyle["text-align"]=i.align,t.cssStyle.width="100%")):"wrapNone"==r?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",i.offset&&(t.cssStyle.left=i.offset),s.offset&&(t.cssStyle.top=s.offset)):!n||"left"!=i.align&&"right"!=i.align||(t.cssStyle.float=i.align),t}parseGraphic(e){var t=jt.element(e,"graphicData");for(let n of jt.elements(t))if("pic"===n.localName)return this.parsePicture(n);return null}parsePicture(e){var t={type:Xt.Image,src:"",cssStyle:{}},n=jt.element(e,"blipFill"),r=jt.element(n,"blip"),a=jt.element(n,"srcRect");t.src=jt.attr(r,"embed"),a&&(t.srcRect=[jt.intAttr(a,"l",0)/1e5,jt.intAttr(a,"t",0)/1e5,jt.intAttr(a,"r",0)/1e5,jt.intAttr(a,"b",0)/1e5]);var i=jt.element(e,"spPr"),s=jt.element(i,"xfrm");if(t.cssStyle.position="relative",s)for(var o of(t.rotation=jt.intAttr(s,"rot",0)/6e4,jt.elements(s)))switch(o.localName){case"ext":t.cssStyle.width=jt.lengthAttr(o,"cx",Mt.Emu),t.cssStyle.height=jt.lengthAttr(o,"cy",Mt.Emu);break;case"off":t.cssStyle.left=jt.lengthAttr(o,"x",Mt.Emu),t.cssStyle.top=jt.lengthAttr(o,"y",Mt.Emu)}return t}parseTable(e){var t={type:Xt.Table,children:[]};for(const n of jt.elements(e))switch(n.localName){case"tr":t.children.push(this.parseTableRow(n));break;case"tblGrid":t.columns=this.parseTableColumns(n);break;case"tblPr":this.parseTableProperties(n,t)}return t}parseTableColumns(e){var t=[];for(const n of jt.elements(e))if("gridCol"===n.localName)t.push({width:jt.lengthAttr(n,"w")});return t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,e=>{switch(e.localName){case"tblStyle":t.styleName=jt.attr(e,"val");break;case"tblLook":t.className=sr.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=jt.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=jt.intAttr(e,"val");break;case"hidden":t.cssStyle.display="none";break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){var n=jt.lengthAttr(e,"topFromText"),r=jt.lengthAttr(e,"bottomFromText"),a=jt.lengthAttr(e,"rightFromText"),i=jt.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=sr.addSize(t.cssStyle["margin-bottom"],r),t.cssStyle["margin-left"]=sr.addSize(t.cssStyle["margin-left"],i),t.cssStyle["margin-right"]=sr.addSize(t.cssStyle["margin-right"],a),t.cssStyle["margin-top"]=sr.addSize(t.cssStyle["margin-top"],n)}parseTableRow(e){var t={type:Xt.Row,children:[]};for(const n of jt.elements(e))switch(n.localName){case"tc":t.children.push(this.parseTableCell(n));break;case"trPr":case"tblPrEx":this.parseTableRowProperties(n,t)}return t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"cnfStyle":t.className=sr.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=jt.boolAttr(e,"val");break;case"gridBefore":t.gridBefore=jt.intAttr(e,"val");break;case"gridAfter":t.gridAfter=jt.intAttr(e,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:Xt.Cell,children:[]};for(const n of jt.elements(e))switch(n.localName){case"tbl":t.children.push(this.parseTable(n));break;case"p":t.children.push(this.parseParagraph(n));break;case"tcPr":this.parseTableCellProperties(n,t)}return t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{var n;switch(e.localName){case"gridSpan":t.span=jt.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=null!==(n=jt.attr(e,"val"))&&void 0!==n?n:"continue";break;case"cnfStyle":t.className=sr.classNameOfCnfStyle(e);break;default:return!1}return!0}),this.parseTableCellVerticalText(e,t)}parseTableCellVerticalText(e,t){const n={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};for(const r of jt.elements(e))if("textDirection"===r.localName){const e=n[jt.attr(r,"val")]||{writingMode:"horizontal-tb"};t.cssStyle["writing-mode"]=e.writingMode,t.cssStyle.transform=e.transform}}parseDefaultProperties(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=t||{};for(const a of jt.elements(e))if(null===r||void 0===r||!r(a))switch(a.localName){case"jc":t["text-align"]=sr.valueOfJc(a);break;case"textAlignment":t["vertical-align"]=sr.valueOfTextAlignment(a);break;case"color":t.color=ir.colorAttr(a,"val",null,Jn);break;case"sz":t["font-size"]=t["min-height"]=jt.lengthAttr(a,"val",Mt.FontSize);break;case"shd":t["background-color"]=ir.colorAttr(a,"fill",null,$n);break;case"highlight":t["background-color"]=ir.colorAttr(a,"val",null,er);break;case"vertAlign":break;case"position":t.verticalAlign=jt.lengthAttr(a,"val",Mt.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":t.width=sr.valueOfSize(a,"w");break;case"trHeight":this.parseTrHeight(a,t);break;case"strike":t["text-decoration"]=jt.boolAttr(a,"val",!0)?"line-through":"none";break;case"b":t["font-weight"]=jt.boolAttr(a,"val",!0)?"bold":"normal";break;case"i":t["font-style"]=jt.boolAttr(a,"val",!0)?"italic":"normal";break;case"caps":t["text-transform"]=jt.boolAttr(a,"val",!0)?"uppercase":"none";break;case"smallCaps":t["font-variant"]=jt.boolAttr(a,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(a,t);break;case"ind":case"tblInd":this.parseIndentation(a,t);break;case"rFonts":this.parseFont(a,t);break;case"tblBorders":this.parseBorderProperties(a,n||t);break;case"tblCellSpacing":t["border-spacing"]=sr.valueOfMargin(a),t["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(a,t);break;case"bdr":t.border=sr.valueOfBorder(a);break;case"tcBorders":this.parseBorderProperties(a,t);break;case"vanish":jt.boolAttr(a,"val",!0)&&(t.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(a,n||t);break;case"tblLayout":t["table-layout"]=sr.valueOfTblLayout(a);break;case"vAlign":t["vertical-align"]=sr.valueOfTextAlignment(a);break;case"spacing":"pPr"==e.localName&&this.parseSpacing(a,t);break;case"wordWrap":jt.boolAttr(a,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=jt.boolAttr(a,"val",!0)?"none":"auto";break;case"lang":t.$lang=jt.attr(a,"val");break;case"rtl":case"bidi":jt.boolAttr(a,"val",!0)&&(t.direction="rtl");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn("DOCX: Unknown document element: ".concat(e.localName,".").concat(a.localName))}return t}parseUnderline(e,t){var n=jt.attr(e,"val");if(null!=n){switch(n){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":case"words":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"none":t["text-decoration"]="none"}var r=ir.colorAttr(e,"color");r&&(t["text-decoration-color"]=r)}}parseFont(e,t){var n=[jt.attr(e,"ascii"),sr.themeValue(e,"asciiTheme"),jt.attr(e,"eastAsia")].filter(e=>e).map(e=>Et(e));n.length>0&&(t["font-family"]=[...new Set(n)].join(", "))}parseIndentation(e,t){var n=jt.lengthAttr(e,"firstLine"),r=jt.lengthAttr(e,"hanging"),a=jt.lengthAttr(e,"left"),i=jt.lengthAttr(e,"start"),s=jt.lengthAttr(e,"right"),o=jt.lengthAttr(e,"end");n&&(t["text-indent"]=n),r&&(t["text-indent"]="-".concat(r)),(a||i)&&(t["margin-inline-start"]=a||i),(s||o)&&(t["margin-inline-end"]=s||o)}parseSpacing(e,t){var n=jt.lengthAttr(e,"before"),r=jt.lengthAttr(e,"after"),a=jt.intAttr(e,"line",null),i=jt.attr(e,"lineRule");if(n&&(t["margin-top"]=n),r&&(t["margin-bottom"]=r),null!==a)switch(i){case"auto":t["line-height"]="".concat((a/240).toFixed(2));break;case"atLeast":t["line-height"]="calc(100% + ".concat(a/20,"pt)");break;default:t["line-height"]=t["min-height"]="".concat(a/20,"pt")}}parseMarginProperties(e,t){for(const n of jt.elements(e))switch(n.localName){case"left":t["padding-left"]=sr.valueOfMargin(n);break;case"right":t["padding-right"]=sr.valueOfMargin(n);break;case"top":t["padding-top"]=sr.valueOfMargin(n);break;case"bottom":t["padding-bottom"]=sr.valueOfMargin(n)}}parseTrHeight(e,t){jt.attr(e,"hRule"),t.height=jt.lengthAttr(e,"val")}parseBorderProperties(e,t){for(const n of jt.elements(e))switch(n.localName){case"start":case"left":t["border-left"]=sr.valueOfBorder(n);break;case"end":case"right":t["border-right"]=sr.valueOfBorder(n);break;case"top":t["border-top"]=sr.valueOfBorder(n);break;case"bottom":t["border-bottom"]=sr.valueOfBorder(n)}}}const ar=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class ir{static colorAttr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"black";var a=jt.attr(e,t);if(a)return"auto"==a?r:ar.includes(a)?a:"#".concat(a);var i=jt.attr(e,"themeColor");return i?"var(--docx-".concat(i,"-color)"):n}}class sr{static themeValue(e,t){var n=jt.attr(e,t);return n?"var(--docx-".concat(n,"-font)"):null}static valueOfSize(e,t){var n=Mt.Dxa;switch(jt.attr(e,"type")){case"dxa":break;case"pct":n=Mt.Percent;break;case"auto":return"auto"}return jt.lengthAttr(e,t,n)}static valueOfMargin(e){return jt.lengthAttr(e,"w")}static valueOfBorder(e){var t=sr.parseBorderType(jt.attr(e,"val"));if("none"==t)return"none";var n=ir.colorAttr(e,"color"),r=jt.lengthAttr(e,"sz",Mt.Border);return"".concat(r," ").concat(t," ").concat("auto"==n?Zn:n)}static parseBorderType(e){switch(e){case"single":case"dashDotStroked":case"thick":case"thickThinLargeGap":case"thickThinMediumGap":case"thickThinSmallGap":case"thinThickLargeGap":case"thinThickMediumGap":case"thinThickSmallGap":case"thinThickThinLargeGap":case"thinThickThinMediumGap":case"thinThickThinSmallGap":case"threeDEmboss":case"threeDEngrave":case"wave":return"solid";case"dashed":case"dashSmallGap":return"dashed";case"dotDash":case"dotDotDash":case"dotted":return"dotted";case"double":case"doubleWave":case"triple":return"double";case"inset":return"inset";case"nil":case"none":return"none";case"outset":return"outset"}return"solid"}static valueOfTblLayout(e){return"fixed"==jt.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){const t=jt.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((e,n)=>"1"==t[n]).join(" ")}static valueOfJc(e){var t=jt.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n=jt.attr(e,"val");switch(n){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:n}static valueOfTextAlignment(e){var t=jt.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return null==e?t:null==t?e:"calc(".concat(e," + ").concat(t,")")}static classNameOftblLook(e){const t=jt.hexAttr(e,"val",0);let n="";return(jt.boolAttr(e,"firstRow")||32&t)&&(n+=" first-row"),(jt.boolAttr(e,"lastRow")||64&t)&&(n+=" last-row"),(jt.boolAttr(e,"firstColumn")||128&t)&&(n+=" first-col"),(jt.boolAttr(e,"lastColumn")||256&t)&&(n+=" last-col"),(jt.boolAttr(e,"noHBand")||512&t)&&(n+=" no-hband"),(jt.boolAttr(e,"noVBand")||1024&t)&&(n+=" no-vband"),n.trim()}}const or={pos:0,leader:"none",style:"left"};function lr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.75;const a=e.closest("p"),i=e.getBoundingClientRect(),s=a.getBoundingClientRect(),o=getComputedStyle(a),l=(null===t||void 0===t?void 0:t.length)>0?t.map(e=>({pos:cr(e.position),leader:e.leader,style:e.style})).sort((e,t)=>e.pos-t.pos):[or],c=l[l.length-1],u=s.width*r,h=cr(n);let p=c.pos+h;if(p<u)for(;p<u&&l.length<50;p+=h)l.push((0,d.A)((0,d.A)({},or),{},{pos:p}));const f=parseFloat(o.marginLeft),m=s.left+f,g=(i.left-m)*r,v=l.find(e=>"clear"!=e.style&&e.pos>g);if(null==v)return;let y=1;if("right"==v.style||"center"==v.style){const t=Array.from(a.querySelectorAll(".".concat(e.className))),n=t.indexOf(e)+1,i=document.createRange();i.setStart(e,1),n<t.length?i.setEndBefore(t[n]):i.setEndAfter(a);const o="center"==v.style?.5:1,l=i.getBoundingClientRect(),c=l.left+o*l.width-(s.left-f);y=v.pos-c*r}else y=v.pos-g;switch(e.innerHTML="&nbsp;",e.style.textDecoration="inherit",e.style.wordSpacing="".concat(y.toFixed(0),"pt"),v.leader){case"dot":case"middleDot":e.style.textDecoration="underline",e.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":e.style.textDecoration="underline"}}function cr(e){return parseFloat(e)}const dr="http://www.w3.org/2000/svg",ur="http://www.w3.org/1998/Math/MathML";class hr{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;var a;(this.document=e,this.options=r,this.className=r.className,this.rootSelector=r.inWrapper?".".concat(this.className,"-wrapper"):":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),n=n||t,pr(n),pr(t),n.appendChild(this.createComment("docxjs library predefined styles")),n.appendChild(this.renderDefaultStyle()),e.themePart&&(n.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(e.themePart,n)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),n.appendChild(this.createComment("docxjs document styles")),n.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),n.appendChild(this.createComment("docxjs document numbering styles")),n.appendChild(this.renderNumbering(e.numberingPart.domNumberings,n))),e.footnotesPart&&(this.footnoteMap=Pt(e.footnotesPart.notes,e=>e.id)),e.endnotesPart&&(this.endnoteMap=Pt(e.endnotesPart.notes,e=>e.id)),e.settingsPart)&&(this.defaultTabSize=null===(a=e.settingsPart.settings)||void 0===a?void 0:a.defaultTabStop);!r.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,n);var i=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(i)):fr(t,i),this.commentHighlight&&r.renderComments&&CSS.highlights.set("".concat(this.className,"-comments"),this.commentHighlight),this.postRenderTasks.forEach(e=>e()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(e,t){var n,r;const a={},i=null===(n=e.theme)||void 0===n?void 0:n.fontScheme;i&&(i.majorFont&&(a["--docx-majorHAnsi-font"]=i.majorFont.latinTypeface),i.minorFont&&(a["--docx-minorHAnsi-font"]=i.minorFont.latinTypeface));const s=null===(r=e.theme)||void 0===r?void 0:r.colorScheme;if(s)for(let[l,c]of Object.entries(s.colors))a["--docx-".concat(l,"-color")]="#".concat(c);const o=this.styleToString(".".concat(this.className),a);t.appendChild(this.createStyleElement(o))}renderFontTable(e,t){for(let n of e.fonts)for(let e of n.embedFontRefs)this.tasks.push(this.document.loadFont(e.id,e.key).then(r=>{const a={"font-family":Et(n.name),src:"url(".concat(r,")")};"bold"!=e.type&&"boldItalic"!=e.type||(a["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(a["font-style"]="italic");const i=this.styleToString("@font-face",a);t.appendChild(this.createComment("docxjs ".concat(n.name," font"))),t.appendChild(this.createStyleElement(i))}))}processStyleName(e){return e?"".concat(this.className,"_").concat(function(e){return null===e||void 0===e?void 0:e.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}(e)):this.className}processStyles(e){const t=Pt(e.filter(e=>null!=e.id),e=>e.id);for(const r of e.filter(e=>e.basedOn)){var n=t[r.basedOn];if(n){r.paragraphProps=Rt(r.paragraphProps,n.paragraphProps),r.runProps=Rt(r.runProps,n.runProps);for(const e of n.styles){const t=r.styles.find(t=>t.target==e.target);t?this.copyStyleProperties(e.values,t.values):r.styles.push((0,d.A)((0,d.A)({},e),{},{values:(0,d.A)({},e.values)}))}}else this.options.debug&&console.warn("Can't find base style ".concat(r.basedOn))}for(let r of e)r.cssName=this.processStyleName(r.id);return t}prodessNumberings(e){for(let n of e.filter(e=>e.pStyleName)){var t;const e=this.findStyle(n.pStyleName);null!==e&&void 0!==e&&null!==(t=e.paragraphProps)&&void 0!==t&&t.numbering&&(e.paragraphProps.numbering.level=n.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type==Xt.Table?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var n of t.children)n.cssStyle=this.copyStyleProperties(e.cellStyle,n.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(n)}copyStyleProperties(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return t;for(var r of(null==t&&(t={}),null==n&&(n=Object.getOwnPropertyNames(e)),n))e.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=e[r]);return t}createPageElement(e,t){var n=this.createElement("section",{className:e});return t&&(t.pageMargins&&(n.style.paddingLeft=t.pageMargins.left,n.style.paddingRight=t.pageMargins.right,n.style.paddingTop=t.pageMargins.top,n.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(n.style.width=t.pageSize.width),this.options.ignoreHeight||(n.style.minHeight=t.pageSize.height))),n}createSectionContent(e){var t=this.createElement("article");return e.columns&&e.columns.numberOfColumns&&(t.style.columnCount="".concat(e.columns.numberOfColumns),t.style.columnGap=e.columns.space,e.columns.separator&&(t.style.columnRule="1px solid black")),t}renderSections(e){const t=[];this.processElement(e);const n=this.splitBySection(e.children,e.props),r=this.groupByPageBreaks(n);let a=null;for(let s=0,o=r.length;s<o;s++){this.currentFootnoteIds=[];let n=r[s][0].sectProps;const l=this.createPageElement(this.className,n);this.renderStyleValues(e.cssStyle,l),this.options.renderHeaders&&this.renderHeaderFooter(n.headerRefs,n,t.length,a!=n,l);for(const e of r[s]){var i=this.createSectionContent(e.sectProps);this.renderElements(e.elements,i),l.appendChild(i),n=e.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,l),this.options.renderEndnotes&&s==o-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,l),this.options.renderFooters&&this.renderHeaderFooter(n.footerRefs,n,t.length,a!=n,l),t.push(l),a=n}return t}renderHeaderFooter(e,t,n,r,a){var i,s;if(e){var o=null!==(i=null!==(s=t.titlePage&&r?e.find(e=>"first"==e.type):null)&&void 0!==s?s:n%2==1?e.find(e=>"even"==e.type):null)&&void 0!==i?i:e.find(e=>"default"==e.type),l=o&&this.document.findPartByRelId(o.id,this.document.documentPart);if(l){this.currentPart=l,this.usedHederFooterParts.includes(l.path)||(this.processElement(l.rootElement),this.usedHederFooterParts.push(l.path));const[e]=this.renderElements([l.rootElement],a);null!==t&&void 0!==t&&t.pageMargins&&(l.rootElement.type===Xt.Header?(e.style.marginTop="calc(".concat(t.pageMargins.header," - ").concat(t.pageMargins.top,")"),e.style.minHeight="calc(".concat(t.pageMargins.top," - ").concat(t.pageMargins.header,")")):l.rootElement.type===Xt.Footer&&(e.style.marginBottom="calc(".concat(t.pageMargins.footer," - ").concat(t.pageMargins.bottom,")"),e.style.minHeight="calc(".concat(t.pageMargins.bottom," - ").concat(t.pageMargins.footer,")"))),this.currentPart=null}}}isPageBreakElement(e){return e.type==Xt.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"==e.break)}isPageBreakSection(e,t){var n,r,a,i,s,o;return!!e&&(!!t&&((null===(n=e.pageSize)||void 0===n?void 0:n.orientation)!=(null===(r=t.pageSize)||void 0===r?void 0:r.orientation)||(null===(a=e.pageSize)||void 0===a?void 0:a.width)!=(null===(i=t.pageSize)||void 0===i?void 0:i.width)||(null===(s=e.pageSize)||void 0===s?void 0:s.height)!=(null===(o=t.pageSize)||void 0===o?void 0:o.height)))}splitBySection(e,t){var n={sectProps:null,elements:[],pageBreak:!1},r=[n];for(let h of e){if(h.type==Xt.Paragraph){var a;const e=this.findStyle(h.styleName);null!==e&&void 0!==e&&null!==(a=e.paragraphProps)&&void 0!==a&&a.pageBreakBefore&&(n.sectProps=i,n.pageBreak=!0,n={sectProps:null,elements:[],pageBreak:!1},r.push(n))}if(n.elements.push(h),h.type==Xt.Paragraph){const e=h;var i=e.sectionProps,s=-1,o=-1;if(this.options.breakPages&&e.children&&(s=e.children.findIndex(e=>{var t,n;return-1!=(o=null!==(t=null===(n=e.children)||void 0===n?void 0:n.findIndex(this.isPageBreakElement.bind(this)))&&void 0!==t?t:-1)})),(i||-1!=s)&&(n.sectProps=i,n.pageBreak=-1!=s,n={sectProps:null,elements:[],pageBreak:!1},r.push(n)),-1!=s){let t=e.children[s],r=o<t.children.length-1;if(s<e.children.length-1||r){var l=h.children,c=(0,d.A)((0,d.A)({},h),{},{children:l.slice(s)});if(h.children=l.slice(0,s),n.elements.push(c),r){let e=t.children,n=(0,d.A)((0,d.A)({},t),{},{children:e.slice(0,o)});h.children.push(n),t.children=e.slice(o)}}}}}let u=null;for(let d=r.length-1;d>=0;d--)null==r[d].sectProps?r[d].sectProps=null!==u&&void 0!==u?u:t:u=r[d].sectProps;return r}groupByPageBreaks(e){let t,n=[];const r=[n];for(let a of e)n.push(a),(this.options.ignoreLastRenderedPageBreak||a.pageBreak||this.isPageBreakSection(t,a.sectProps))&&r.push(n=[]),t=a.sectProps;return r.filter(e=>e.length>0)}renderWrapper(e){return this.createElement("div",{className:"".concat(this.className,"-wrapper")},e)}renderDefaultStyle(){var e=this.className,t="\n.".concat(e,"-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n.").concat(e,"-wrapper>section.").concat(e," { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }");this.options.hideWrapperOnPrint&&(t="@media not print { ".concat(t," }"));var n="".concat(t,"\n.").concat(e," { color: black; hyphens: auto; text-underline-position: from-font; }\nsection.").concat(e," { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\nsection.").concat(e,">article { margin-bottom: auto; z-index: 1; }\nsection.").concat(e,">footer { z-index: 1; }\n.").concat(e," table { border-collapse: collapse; }\n.").concat(e," table td, .").concat(e," table th { vertical-align: top; }\n.").concat(e," p { margin: 0pt; min-height: 1em; }\n.").concat(e," span { white-space: pre-wrap; overflow-wrap: break-word; }\n.").concat(e," a { color: inherit; text-decoration: inherit; }\n.").concat(e," svg { fill: transparent; }\n");return this.options.renderComments&&(n+="\n.".concat(e,"-comment-ref { cursor: default; }\n.").concat(e,"-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }\n.").concat(e,"-comment-ref:hover~.").concat(e,"-comment-popover { display: block; }\n.").concat(e,"-comment-author,.").concat(e,"-comment-date { font-size: 0.875rem; color: #888; }\n")),this.createStyleElement(n)}renderNumbering(e,t){var n="",r=[];for(var a of e){var i="p.".concat(this.numberingClass(a.id,a.level)),s="none";if(a.bullet){let e="--".concat(this.className,"-").concat(a.bullet.src).toLowerCase();n+=this.styleToString("".concat(i,":before"),{content:"' '",display:"inline-block",background:"var(".concat(e,")")},a.bullet.style),this.tasks.push(this.document.loadNumberingImage(a.bullet.src).then(n=>{var r="".concat(this.rootSelector," { ").concat(e,": url(").concat(n,") }");t.appendChild(this.createStyleElement(r))}))}else if(a.levelText){let e=this.numberingCounter(a.id,a.level);const t=e+" "+(a.start-1);a.level>0&&(n+=this.styleToString("p.".concat(this.numberingClass(a.id,a.level-1)),{"counter-set":t})),r.push(t),n+=this.styleToString("".concat(i,":before"),(0,d.A)({content:this.levelTextToContent(a.levelText,a.suff,a.id,this.numFormatToCssValue(a.format)),"counter-increment":e},a.rStyle))}else s=this.numFormatToCssValue(a.format);n+=this.styleToString(i,(0,d.A)({display:"list-item","list-style-position":"inside","list-style-type":s},a.pStyle))}return r.length>0&&(n+=this.styleToString(this.rootSelector,{"counter-reset":r.join(" ")})),this.createStyleElement(n)}renderStyles(e){var t="";const n=this.styleMap,r=Pt(e.filter(e=>e.isDefault),e=>e.target);for(const l of e){var a=l.styles;if(l.linked){var i=l.linked&&n[l.linked];i?a=a.concat(i.styles):this.options.debug&&console.warn("Can't find linked style ".concat(l.linked))}for(const e of a){var s,o="".concat(null!==(s=l.target)&&void 0!==s?s:"",".").concat(l.cssName);l.target!=e.target&&(o+=" ".concat(e.target)),r[l.target]==l&&(o=".".concat(this.className," ").concat(l.target,", ")+o),t+=this.styleToString(o,e.values)}}return this.createStyleElement(t)}renderNotes(e,t,n){var r=e.map(e=>t[e]).filter(e=>e);if(r.length>0){var a=this.createElement("ol",null,this.renderElements(r));n.appendChild(a)}}renderElement(e){switch(e.type){case Xt.Paragraph:return this.renderParagraph(e);case Xt.BookmarkStart:return this.renderBookmarkStart(e);case Xt.BookmarkEnd:return null;case Xt.Run:return this.renderRun(e);case Xt.Table:return this.renderTable(e);case Xt.Row:return this.renderTableRow(e);case Xt.Cell:return this.renderTableCell(e);case Xt.Hyperlink:return this.renderHyperlink(e);case Xt.SmartTag:return this.renderSmartTag(e);case Xt.Drawing:return this.renderDrawing(e);case Xt.Image:return this.renderImage(e);case Xt.Text:case Xt.Text:return this.renderText(e);case Xt.DeletedText:return this.renderDeletedText(e);case Xt.Tab:return this.renderTab(e);case Xt.Symbol:return this.renderSymbol(e);case Xt.Break:return this.renderBreak(e);case Xt.Footer:return this.renderContainer(e,"footer");case Xt.Header:return this.renderContainer(e,"header");case Xt.Footnote:case Xt.Endnote:return this.renderContainer(e,"li");case Xt.FootnoteReference:return this.renderFootnoteReference(e);case Xt.EndnoteReference:return this.renderEndnoteReference(e);case Xt.NoBreakHyphen:return this.createElement("wbr");case Xt.VmlPicture:return this.renderVmlPicture(e);case Xt.VmlElement:return this.renderVmlElement(e);case Xt.MmlMath:return this.renderContainerNS(e,ur,"math",{xmlns:ur});case Xt.MmlMathParagraph:return this.renderContainer(e,"span");case Xt.MmlFraction:return this.renderContainerNS(e,ur,"mfrac");case Xt.MmlBase:return this.renderContainerNS(e,ur,e.parent.type==Xt.MmlMatrixRow?"mtd":"mrow");case Xt.MmlNumerator:case Xt.MmlDenominator:case Xt.MmlFunction:case Xt.MmlLimit:case Xt.MmlBox:return this.renderContainerNS(e,ur,"mrow");case Xt.MmlGroupChar:return this.renderMmlGroupChar(e);case Xt.MmlLimitLower:return this.renderContainerNS(e,ur,"munder");case Xt.MmlMatrix:return this.renderContainerNS(e,ur,"mtable");case Xt.MmlMatrixRow:return this.renderContainerNS(e,ur,"mtr");case Xt.MmlRadical:return this.renderMmlRadical(e);case Xt.MmlSuperscript:return this.renderContainerNS(e,ur,"msup");case Xt.MmlSubscript:return this.renderContainerNS(e,ur,"msub");case Xt.MmlDegree:case Xt.MmlSuperArgument:case Xt.MmlSubArgument:return this.renderContainerNS(e,ur,"mn");case Xt.MmlFunctionName:return this.renderContainerNS(e,ur,"ms");case Xt.MmlDelimiter:return this.renderMmlDelimiter(e);case Xt.MmlRun:return this.renderMmlRun(e);case Xt.MmlNary:return this.renderMmlNary(e);case Xt.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case Xt.MmlBar:return this.renderMmlBar(e);case Xt.MmlEquationArray:return this.renderMllList(e);case Xt.Inserted:return this.renderInserted(e);case Xt.Deleted:return this.renderDeleted(e);case Xt.CommentRangeStart:return this.renderCommentRangeStart(e);case Xt.CommentRangeEnd:return this.renderCommentRangeEnd(e);case Xt.CommentReference:return this.renderCommentReference(e);case Xt.AltChunk:return this.renderAltChunk(e)}return null}renderElements(e,t){if(null==e)return null;var n=e.flatMap(e=>this.renderElement(e)).filter(e=>null!=e);return t&&fr(t,n),n}renderContainer(e,t,n){return this.createElement(t,n,this.renderElements(e.children))}renderContainerNS(e,t,n,r){return this.createElementNS(t,n,r,this.renderElements(e.children))}renderParagraph(e){var t,n,r,a,i=this.renderContainer(e,"p");const s=this.findStyle(e.styleName);null!==(t=e.tabs)&&void 0!==t||(e.tabs=null===s||void 0===s||null===(n=s.paragraphProps)||void 0===n?void 0:n.tabs),this.renderClass(e,i),this.renderStyleValues(e.cssStyle,i),this.renderCommonProperties(i.style,e);const o=null!==(r=e.numbering)&&void 0!==r?r:null===s||void 0===s||null===(a=s.paragraphProps)||void 0===a?void 0:a.numbering;return o&&i.classList.add(this.numberingClass(o.id,o.level)),i}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderHyperlink(e){var t=this.renderContainer(e,"a");this.renderStyleValues(e.cssStyle,t);let n="";if(e.id){var r;const t=this.document.documentPart.rels.find(t=>t.id==e.id&&"External"===t.targetMode);n=null!==(r=null===t||void 0===t?void 0:t.target)&&void 0!==r?r:n}return e.anchor&&(n+="#".concat(e.anchor)),t.href=n,t}renderSmartTag(e){return this.renderContainer(e,"span")}renderCommentRangeStart(e){var t;if(!this.options.renderComments)return null;const n=new Range;null===(t=this.commentHighlight)||void 0===t||t.add(n);const r=this.createComment("start of comment #".concat(e.id));return this.later(()=>n.setStart(r,0)),this.commentMap[e.id]=n,r}renderCommentRangeEnd(e){if(!this.options.renderComments)return null;const t=this.commentMap[e.id],n=this.createComment("end of comment #".concat(e.id));return this.later(()=>null===t||void 0===t?void 0:t.setEnd(n,0)),n}renderCommentReference(e){var t;if(!this.options.renderComments)return null;var n=null===(t=this.document.commentsPart)||void 0===t?void 0:t.commentMap[e.id];if(!n)return null;const r=new DocumentFragment,a=this.createElement("span",{className:"".concat(this.className,"-comment-ref")},["\ud83d\udcac"]),i=this.createElement("div",{className:"".concat(this.className,"-comment-popover")});return this.renderCommentContent(n,i),r.appendChild(this.createComment("comment #".concat(n.id," by ").concat(n.author," on ").concat(n.date))),r.appendChild(a),r.appendChild(i),r}renderAltChunk(e){if(!this.options.renderAltChunks)return null;var t=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(e.id,this.currentPart).then(e=>{t.srcdoc=e})),t}renderCommentContent(e,t){t.appendChild(this.createElement("div",{className:"".concat(this.className,"-comment-author")},[e.author])),t.appendChild(this.createElement("div",{className:"".concat(this.className,"-comment-date")},[new Date(e.date).toLocaleString()])),this.renderElements(e.children,t)}renderDrawing(e){var t=this.renderContainer(e,"div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderStyleValues(e.cssStyle,t),t}renderImage(e){var t,n;let r=this.createElement("img"),a=null===(t=e.cssStyle)||void 0===t?void 0:t.transform;if(this.renderStyleValues(e.cssStyle,r),e.srcRect&&e.srcRect.some(e=>0!=e)){var[i,s,o,l]=e.srcRect;a="scale(".concat(1/(1-i-o),", ").concat(1/(1-s-l),")"),r.style["clip-path"]="rect(".concat((100*s).toFixed(2),"% ").concat((100*(1-o)).toFixed(2),"% ").concat((100*(1-l)).toFixed(2),"% ").concat((100*i).toFixed(2),"%)")}return e.rotation&&(a="rotate(".concat(e.rotation,"deg) ").concat(null!==a&&void 0!==a?a:"")),r.style.transform=null===(n=a)||void 0===n?void 0:n.trim(),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(e=>{r.src=e})),r}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderChanges?this.renderText(e):null}renderBreak(e){return"textWrapping"==e.break?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderElements(e.children)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML="&#x".concat(e.char,";"),t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent="".concat(this.currentFootnoteIds.length),t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent="".concat(this.currentEndnoteIds.length),t}renderTab(e){var t=this.createElement("span");if(t.innerHTML="&emsp;",this.options.experimental){var n;t.className=this.tabStopClass();var r=null===(n=function(e,t){var n=e.parent;for(;null!=n&&n.type!=t;)n=n.parent;return n}(e,Xt.Paragraph))||void 0===n?void 0:n.tabs;this.currentTabs.push({stops:r,span:t})}return t}renderBookmarkStart(e){return this.createElement("span",{id:e.name})}renderRun(e){if(e.fieldRun)return null;const t=this.createElement("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const n=this.createElement(e.verticalAlign);this.renderElements(e.children,n),t.appendChild(n)}else this.renderElements(e.children,t);return t}renderTable(e){let t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=this.createElement("colgroup");for(let n of e){let e=this.createElement("col");n.width&&(e.style.width=n.width),t.appendChild(e)}return t}renderTableRow(e){let t=this.createElement("tr");return this.currentCellPosition.col=0,e.gridBefore&&t.appendChild(this.renderTableCellPlaceholder(e.gridBefore)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),e.gridAfter&&t.appendChild(this.renderTableCellPlaceholder(e.gridAfter)),this.currentCellPosition.row++,t}renderTableCellPlaceholder(e){const t=this.createElement("td",{colSpan:e});return t.style.border="none",t}renderTableCell(e){let t=this.renderContainer(e,"td");const n=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[n]=t,t.rowSpan=1):this.currentVerticalMerge[n]&&(this.currentVerticalMerge[n].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[n]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){return this.renderContainer(e,"div")}renderVmlElement(e){var t,n=this.createSvgElement("svg");n.setAttribute("style",e.cssStyleText);const r=this.renderVmlChildElement(e);var a;null!==(t=e.imageHref)&&void 0!==t&&t.id&&this.tasks.push(null===(a=this.document)||void 0===a?void 0:a.loadDocumentImage(e.imageHref.id,this.currentPart).then(e=>r.setAttribute("href",e)));return n.appendChild(r),requestAnimationFrame(()=>{const e=n.firstElementChild.getBBox();n.setAttribute("width","".concat(Math.ceil(e.x+e.width))),n.setAttribute("height","".concat(Math.ceil(e.y+e.height)))}),n}renderVmlChildElement(e){const t=this.createSvgElement(e.tagName);Object.entries(e.attrs).forEach(e=>{let[n,r]=e;return t.setAttribute(n,r)});for(let n of e.children)n.type==Xt.VmlElement?t.appendChild(this.renderVmlChildElement(n)):t.appendChild(...Nt(this.renderElement(n)));return t}renderMmlRadical(e){var t;const n=e.children.find(e=>e.type==Xt.MmlBase);if(null!==(t=e.props)&&void 0!==t&&t.hideDegree)return this.createElementNS(ur,"msqrt",null,this.renderElements([n]));const r=e.children.find(e=>e.type==Xt.MmlDegree);return this.createElementNS(ur,"mroot",null,this.renderElements([n,r]))}renderMmlDelimiter(e){var t,n;const r=[];return r.push(this.createElementNS(ur,"mo",null,[null!==(t=e.props.beginChar)&&void 0!==t?t:"("])),r.push(...this.renderElements(e.children)),r.push(this.createElementNS(ur,"mo",null,[null!==(n=e.props.endChar)&&void 0!==n?n:")"])),this.createElementNS(ur,"mrow",null,r)}renderMmlNary(e){var t,n;const r=[],a=Pt(e.children,e=>e.type),i=a[Xt.MmlSuperArgument],s=a[Xt.MmlSubArgument],o=i?this.createElementNS(ur,"mo",null,Nt(this.renderElement(i))):null,l=s?this.createElementNS(ur,"mo",null,Nt(this.renderElement(s))):null,c=this.createElementNS(ur,"mo",null,[null!==(t=null===(n=e.props)||void 0===n?void 0:n.char)&&void 0!==t?t:"\u222b"]);return o||l?r.push(this.createElementNS(ur,"munderover",null,[c,l,o])):o?r.push(this.createElementNS(ur,"mover",null,[c,o])):l?r.push(this.createElementNS(ur,"munder",null,[c,l])):r.push(c),r.push(...this.renderElements(a[Xt.MmlBase].children)),this.createElementNS(ur,"mrow",null,r)}renderMmlPreSubSuper(e){const t=[],n=Pt(e.children,e=>e.type),r=n[Xt.MmlSuperArgument],a=n[Xt.MmlSubArgument],i=r?this.createElementNS(ur,"mo",null,Nt(this.renderElement(r))):null,s=a?this.createElementNS(ur,"mo",null,Nt(this.renderElement(a))):null,o=this.createElementNS(ur,"mo",null);return t.push(this.createElementNS(ur,"msubsup",null,[o,s,i])),t.push(...this.renderElements(n[Xt.MmlBase].children)),this.createElementNS(ur,"mrow",null,t)}renderMmlGroupChar(e){const t="bot"===e.props.verticalJustification?"mover":"munder",n=this.renderContainerNS(e,ur,t);return e.props.char&&n.appendChild(this.createElementNS(ur,"mo",null,[e.props.char])),n}renderMmlBar(e){const t=this.renderContainerNS(e,ur,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){const t=this.createElementNS(ur,"ms",null,this.renderElements(e.children));return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),t}renderMllList(e){const t=this.createElementNS(ur,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(let n of this.renderElements(e.children))t.appendChild(this.createElementNS(ur,"mtr",null,[this.createElementNS(ur,"mtd",null,[n])]));return t}renderStyleValues(e,t){for(let n in e)n.startsWith("$")?t.setAttribute(n.slice(1),e[n]):t.style[n]=e[n]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){var t;return e&&(null===(t=this.styleMap)||void 0===t?void 0:t[e])}numberingClass(e,t){return"".concat(this.className,"-num-").concat(e,"-").concat(t)}tabStopClass(){return"".concat(this.className,"-tab-stop")}styleToString(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="".concat(e," {\r\n");for(const a in t)a.startsWith("$")||(r+="  ".concat(a,": ").concat(t[a],";\r\n"));return n&&(r+=n),r+"}\r\n"}numberingCounter(e,t){return"".concat(this.className,"-num-").concat(e,"-").concat(t)}levelTextToContent(e,t,n,r){var a;var i=e.replace(/%\d*/g,e=>{let t=parseInt(e.substring(1),10)-1;return'"counter('.concat(this.numberingCounter(n,t),", ").concat(r,')"')});return'"'.concat(i).concat(null!==(a={tab:"\\9",space:"\\a0"}[t])&&void 0!==a?a:"",'"')}numFormatToCssValue(e){var t;return null!==(t={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e])&&void 0!==t?t:e}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;const t=document.createElement("div");t.style.width="100pt",e.appendChild(t);const n=100/t.offsetWidth;return e.removeChild(t),n}();for(let t of this.currentTabs)lr(t.span,t.stops,this.defaultTabSize,e)},500)}createElementNS(e,t,n,r){var a=e?this.htmlDocument.createElementNS(e,t):this.htmlDocument.createElement(t);return Object.assign(a,n),r&&fr(a,r),a}createElement(e,t,n){return this.createElementNS(void 0,e,t,n)}createSvgElement(e,t,n){return this.createElementNS(dr,e,t,n)}createStyleElement(e){return this.createElement("style",{innerHTML:e})}createComment(e){return this.htmlDocument.createComment(e)}later(e){this.postRenderTasks.push(e)}}function pr(e){e.innerHTML=""}function fr(e,t){t.forEach(t=>{return e.appendChild("string"===typeof(n=t)||n instanceof String?document.createTextNode(t):t);var n})}const mr={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};async function gr(e,t,n,r){const a=await function(e,t){const n=(0,d.A)((0,d.A)({},mr),t);return jn.load(e,new rr(n),n)}(e,r);return await async function(e,t,n,r){const a=(0,d.A)((0,d.A)({},mr),r),i=new hr(window.document);return await i.render(e,t,n,a)}(a,t,n,r),a}const vr=t=>{let{url:n}=t;const[r,a]=(0,e.useState)(!0),[i,s]=(0,e.useState)(""),o=(0,e.useRef)(null);return(0,e.useEffect)(()=>{let e=!0;return a(!0),s(""),(async()=>{try{const r=Array.isArray(n)?n:[n],i=async e=>{const t=await fetch(e);if(t.ok)return await t.blob();const n=e.includes("?")?"&":"?",r=await fetch("".concat(e).concat(n,"download=1"));if(!r.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));return await r.blob()};let s=null,l=null;for(const e of r)try{if(s=await i(e),s)break}catch(t){l=t}if(!s)throw l||new Error("Failed to fetch document");e&&o.current&&(o.current.innerHTML="",await gr(s,o.current,void 0,{className:"docx-preview",inWrapper:!1,ignoreWidth:!1,ignoreHeight:!1,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!1,trimXmlDeclaration:!0,useBase64URL:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0}),a(!1))}catch(r){console.error("DOCX fetch/render error:",r),e&&(s(r instanceof Error?r.message:"Failed to load DOCX"),a(!1))}})(),()=>{e=!1}},[n]),r?(0,x.jsx)("div",{style:{padding:20,textAlign:"center",color:"#666"},children:"Loading document..."}):i?(0,x.jsxs)("div",{style:{padding:20,textAlign:"center",color:"#d32f2f"},children:[(0,x.jsx)("div",{style:{marginBottom:8},children:"\u26a0\ufe0f Error loading document"}),(0,x.jsx)("div",{style:{fontSize:"0.9em"},children:i})]}):(0,x.jsx)("div",{style:{maxHeight:"70vh",overflowY:"auto",border:"1px solid #ddd",borderRadius:6,padding:12,background:"#fff"},children:(0,x.jsx)("div",{ref:o,style:{padding:8}})})},yr=e=>{let{isPdf:t,isDocx:n,viewerUrls:r,docUrl:a,needGraphAuth:i}=e;return(0,x.jsx)("div",{className:"viewer",style:{marginTop:12},children:a?t?(0,x.jsx)(ot,{url:r}):n?(0,x.jsx)(vr,{url:Array.isArray(r)?r[0]:r}):(0,x.jsx)("div",{className:"muted small",style:{padding:12,textAlign:"center",border:"1px solid #eee",borderRadius:6},children:"Preview not available for this file type. Use Download or Open in new tab."}):(0,x.jsx)("div",{className:"muted small",style:{padding:12,textAlign:"center"},children:i?"Please grant access to preview this SharePoint document.":"No document URL found for this item."})})},br=e=>{let{docUrl:t,openInNewTabUrl:n,proxiedDownloadUrl:r,originalUrl:a}=e;return t||a?(0,x.jsxs)("div",{className:"small",style:{marginTop:8,textAlign:"right"},children:[t&&(0,x.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",style:{marginRight:12},children:"Open in new tab \u2197"}),t&&(0,x.jsx)("a",{href:r,className:"btn ghost xs",children:"Download"}),a&&a!==t&&(0,x.jsxs)(x.Fragment,{children:[t&&(0,x.jsx)("span",{style:{margin:"0 8px",color:"#bbb"},children:"|"}),(0,x.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:"View in SharePoint"})]})]}):null},wr=e=>{let{ready:t,alreadyAcked:n,userName:r,ack:a,onAckChange:i,onAccept:s}=e;return!t||n?null:(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12,alignItems:"center"},children:[(0,x.jsxs)("label",{className:"small",children:[(0,x.jsx)("input",{type:"checkbox",checked:a,onChange:e=>i(e.target.checked)})," ",r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{children:"I "}),(0,x.jsx)("strong",{children:r}),(0,x.jsx)("span",{children:" have read and understood this document."})]}):"I have read and understood this document."]}),(0,x.jsx)("div",{style:{flex:1}}),(0,x.jsx)("button",{className:"btn accent sm",id:"btnAccept",onClick:s,disabled:!a,children:"I Accept"})]})},_r=e=>{let{onPrev:t,onNext:n,progressText:r}=e;return(0,x.jsxs)("div",{style:{marginTop:12},children:[(0,x.jsxs)("div",{className:"controls",children:[(0,x.jsx)("button",{className:"btn ghost sm",id:"btnPrev",onClick:t,children:"\u2190 Previous"}),(0,x.jsx)("div",{className:"spacer"}),(0,x.jsx)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:(0,x.jsx)("button",{className:"btn ghost sm",id:"btnNext",onClick:n,children:"Next \u2192"})})]}),(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,x.jsx)("i",{style:{width:r}})}),(0,x.jsxs)("div",{className:"muted small",style:{marginTop:8},children:[r," complete"]})]})};const Ar=e=>{try{window.dispatchEvent(new CustomEvent("sunbeth:busy:push",{detail:{label:e||""}}))}catch(t){}},Sr=()=>{try{window.dispatchEvent(new CustomEvent("sunbeth:busy:pop"))}catch(e){}};var Cr=__webpack_require__(6374);const xr=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["User.Read"];const t=w.msalInstance.getActiveAccount()||w.msalInstance.getAllAccounts()[0];if(!t)throw new Error("No active account for token acquisition");try{return(await w.msalInstance.acquireTokenSilent({account:t,scopes:e})).accessToken}catch(n){if("popup"===(0,Cr.o)()){return(await w.msalInstance.acquireTokenPopup({scopes:e})).accessToken}throw await w.msalInstance.acquireTokenRedirect({scopes:e}),new Error("Interactive redirect initiated for Graph token")}},Er=async(e,t,n,r,a)=>{if(!e||0===e.length)return;const i=await xr(["Mail.Send"]),s=((e,t)=>{const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n})(e,90);for(const o of s){const e={message:{subject:t,body:{contentType:"HTML",content:n},toRecipients:o.map(e=>({emailAddress:{address:e.address,name:e.name||e.address}})),ccRecipients:null!==a&&void 0!==a&&a.cc&&a.cc.length>0?a.cc.map(e=>({emailAddress:{address:e.address,name:e.name||e.address}})):void 0,bccRecipients:null!==a&&void 0!==a&&a.bcc&&a.bcc.length>0?a.bcc.map(e=>({emailAddress:{address:e.address,name:e.name||e.address}})):void 0,attachments:r&&r.length>0?r.map(e=>({"@odata.type":"#microsoft.graph.fileAttachment",name:e.name,contentType:e.contentType||"application/octet-stream",contentBytes:e.contentBytes})):void 0},saveToSentItems:!0},s=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){const e=await s.text().catch(()=>"");throw new Error("sendMail failed: ".concat(s.status," ").concat(s.statusText," \u2014 ").concat(e))}}},Tr=async(e,t,n,r,a)=>{if(!r||0===r.length)return void await Er(e,t,n,void 0,a);const i=e=>Math.floor(3*e.length/4),s=[];let o=[],l=0;for(const c of r){const e=i(c.contentBytes||"");(o.length+1>8||l+e>15728640)&&o.length>0&&(s.push(o),o=[],l=0),o.push(c),l+=e}if(o.length>0&&s.push(o),1!==s.length)for(let c=0;c<s.length;c++){const r=s[c],i="".concat(t," (part ").concat(c+1," of ").concat(s.length,")"),o="".concat(n,'<div style="margin-top:12px;color:#666;font-size:12px">Attachments: part ').concat(c+1," of ").concat(s.length,"</div>");await Er(e,i,o,r,a)}else await Er(e,t,n,s[0],a)},kr=async e=>{const t=await fetch(e,{cache:"no-store"});if(!t.ok)throw new Error("Fetch failed: ".concat(t.status," ").concat(t.statusText));const n=t.headers.get("content-type")||void 0,r=await t.arrayBuffer(),a=new Uint8Array(r);let i="";for(let s=0;s<a.length;s++)i+=String.fromCharCode(a[s]);return{contentBytes:btoa(i),contentType:n}},Pr=async e=>{try{const t=(0,P.Gi)(),n={batchId:e.batchId,documentId:e.documentId,email:(e.userPrincipalName||e.userEmail||e.user||e.userDisplay||"").toLowerCase()||e.email||""};console.log("[sendAcknowledgement] Payload to /api/ack:",n);const r=await fetch("".concat(t,"/api/ack"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),a=await r.text().catch(()=>"");console.log("[sendAcknowledgement] /api/ack response:",r.status,a),r.ok||(0,D.R8)("SQLite ack post failed",{status:r.status,body:a})}catch(o){(0,D.R8)("SQLite ack post failed (exception)",o)}try{const f=(0,P.Gi)(),m=String(e.batchId);console.log("[sendAcknowledgement] Checking completion for batch:",m);const g=await fetch("".concat(f,"/api/batches")),v=await g.json().catch(()=>[]);console.log("[sendAcknowledgement] Loaded batches:",v);const y=(Array.isArray(v)?v:[]).find(e=>String(e.toba_batchid||e.id)===m),[b,w]=await Promise.all([fetch("".concat(f,"/api/batches/").concat(encodeURIComponent(m),"/recipients")),fetch("".concat(f,"/api/batches/").concat(encodeURIComponent(m),"/documents"))]),_=await b.json().catch(()=>[]),A=await w.json().catch(()=>[]);console.log("[sendAcknowledgement] Recipients:",_),console.log("[sendAcknowledgement] Documents:",A);const S=Array.isArray(A)?A.length:0;if(0===S)return void console.warn("[sendAcknowledgement] No documents found for batch:",m);const C=String(e.userPrincipalName||e.userEmail||e.user||e.email||"").toLowerCase();if(C){const o=await fetch("".concat(f,"/api/batches/").concat(encodeURIComponent(m),"/acks?email=").concat(encodeURIComponent(C)),{cache:"no-store"}),h=await o.json().catch(()=>({ids:[]})),p=Array.isArray(null===h||void 0===h?void 0:h.ids)?h.ids.length:0;if(console.log("[sendAcknowledgement] User acks:",null===h||void 0===h?void 0:h.ids,"acked:",p,"docCount:",S),p>=S){const o="sunbeth:hrUserNotified:".concat(m,":").concat(C);try{if("1"===localStorage.getItem(o))return void console.log("[sendAcknowledgement] Already notified for user:",o)}catch(l){}let h=[];try{const e=(0,P.Gi)(),t=await fetch("".concat(e,"/api/notification-emails")),n=await t.json();h=Array.isArray(null===n||void 0===n?void 0:n.emails)?n.emails:[],console.log("[sendAcknowledgement] Loaded notificationEmails:",h)}catch(c){console.warn("[sendAcknowledgement] Failed to load notificationEmails:",c)}const p=h.filter(Boolean).map(e=>({address:e}));if(p.length>0){var t,n,r,a;console.log("[UserCompletionEmail] Recipients:",p.map(e=>e.address)),p.length||console.warn("[UserCompletionEmail] No admin recipients found in notificationEmails:",h);const l=[];try{const e=(0,P.Gi)();let t=null;for(const n of Array.isArray(A)?A:[])try{const r=String(n.toba_title||n.title||"document"),a=String(n.toba_fileurl||n.url||""),i=/sharepoint\.com\//i.test(a)||!!n.toba_driveid||!!n.toba_itemid||/sharepoint/i.test(String(n.toba_source||n.source||""));let s=a;if(i)try{t||(t=await xr(["Files.Read.All","Sites.Read.All"])),s=n.toba_driveid&&n.toba_itemid?"".concat(e,"/api/proxy/graph?driveId=").concat(encodeURIComponent(String(n.toba_driveid)),"&itemId=").concat(encodeURIComponent(String(n.toba_itemid)),"&token=").concat(encodeURIComponent(t),"&download=1"):"".concat(e,"/api/proxy/graph?url=").concat(encodeURIComponent(a),"&token=").concat(encodeURIComponent(t),"&download=1")}catch(c){console.warn("[sendAcknowledgement] Failed to get Graph token or file for doc:",n,c)}else s="".concat(e,"/api/proxy?url=").concat(encodeURIComponent(a));const{contentBytes:o,contentType:d}=await kr(s);l.push({name:r,contentBytes:o,contentType:d})}catch(c){console.warn("[sendAcknowledgement] Failed to build attachment for doc:",n,c)}}catch(c){console.warn("[sendAcknowledgement] Failed to build attachments:",c)}try{var i;const t=await fetch("".concat((0,P.Gi)(),"/api/batches/").concat(encodeURIComponent(m),"/completions"),{cache:"no-store"}),n=await t.json().catch(()=>[]),r=(Array.isArray(n)?n:[]).find(e=>String(e.email||"").toLowerCase()===C),a=["Email","Name","Department","JobTitle","Location","Business","PrimaryGroup","Documents","Status","CompletedAt"],s=r?[String(r.email||""),String(r.displayName||""),String(r.department||""),String(r.jobTitle||""),String(r.location||""),String(r.businessName||""),String(r.primaryGroup||""),String(null!==(i=r.total)&&void 0!==i?i:S),r.completed?"Completed":"Pending",r.completionAt?String(r.completionAt):(new Date).toISOString()]:[C,e.userDisplay||e.displayName||"","","","","","",String(S),"Completed",(new Date).toISOString()],o=e=>e.map(e=>/[,"\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e).join(","),c=[o(a),o(s)].join("\r\n"),d=btoa(unescape(encodeURIComponent(c)));l.push({name:"".concat(String((null===y||void 0===y?void 0:y.toba_name)||(null===y||void 0===y?void 0:y.name)||"batch"),"-").concat(C,"-completion.csv"),contentBytes:d,contentType:"text/csv"}),console.log("[sendAcknowledgement] Built CSV attachment for user:",C)}catch(c){console.warn("[sendAcknowledgement] Failed to build CSV attachment:",c)}let f,g=null;try{g=(Array.isArray(_)?_:[]).find(e=>String(e.email||e.user||"").toLowerCase()===C),console.log("[sendAcknowledgement] Found recipientRow:",g)}catch(c){console.warn("[sendAcknowledgement] Failed to find recipientRow:",c)}try{var s;const e=(0,P.Gi)();if(null!=(null===(s=g)||void 0===s?void 0:s.businessId)){const t=await fetch("".concat(e,"/api/businesses"),{cache:"no-store"}),n=await t.json().catch(()=>[]),r=(Array.isArray(n)?n:[]).find(e=>{var t,n,r;return String(null!==(t=null!==(n=null!==(r=e.id)&&void 0!==r?r:e.businessId)&&void 0!==n?n:e.ID)&&void 0!==t?t:e.toba_businessid)===String(g.businessId)});f=r?String(r.name||r.Title||r.title||r.code||"Business"):void 0,console.log("[sendAcknowledgement] Found businessName:",f)}}catch(c){console.warn("[sendAcknowledgement] Failed to find businessName:",c)}const{subject:v,bodyHtml:b}=(e=>{const t=(0,P.JH)(),n=(0,P.MV)(),r=(0,P.pU)();return{subject:"Batch Completion Notification: ".concat(e.batchName),bodyHtml:'\n    <div style="background:#f7f8fa;padding:24px">\n      <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="max-width:720px;margin:0 auto;background:#ffffff;border:1px solid #e9ecef;border-radius:10px;overflow:hidden">\n        <tr>\n          <td style="padding:16px 20px;border-bottom:1px solid #e9ecef;background:'.concat(r,';color:white">\n            <div style="display:flex;align-items:center;gap:12px">\n              ').concat(n?'<img src="'.concat(n,'" alt="').concat(t,'" style="height:28px;display:block;border:0"/>'):"",'\n              <strong style="font-family:Segoe UI,Tahoma,Arial,sans-serif;font-size:16px;line-height:1">').concat(t,'</strong>\n            </div>\n          </td>\n        </tr>\n        <tr>\n          <td style="padding:20px;font-family:Segoe UI,Tahoma,Arial,sans-serif;color:#111">\n            <h2 style="margin:0 0 12px 0;font-size:18px;color:#111">Batch Completion Notice</h2>\n            <p style="margin:0 0 12px 0">Dear Admin,</p>\n            <p style="margin:0 0 12px 0">We are pleased to inform you that the following user has completed all required acknowledgements for the batch <strong>').concat(e.batchName,'</strong>:</p>\n            <table role="presentation" cellpadding="0" cellspacing="0" style="margin:8px 0 16px 0;color:#333">\n              <tr><td style="padding:4px 8px 4px 0;color:#666">Name:</td><td style="padding:4px 0"><strong>').concat(e.userName||e.userEmail,'</strong></td></tr>\n              <tr><td style="padding:4px 8px 4px 0;color:#666">Email:</td><td style="padding:4px 0">').concat(e.userEmail,"</td></tr>\n              ").concat(e.completedOn?'<tr><td style="padding:4px 8px 4px 0;color:#666">Completed on:</td><td style="padding:4px 0"><strong>'.concat(new Date(e.completedOn).toLocaleString(),"</strong></td></tr>"):"","\n              ").concat(null!=e.totalDocuments?'<tr><td style="padding:4px 8px 4px 0;color:#666">Documents:</td><td style="padding:4px 0"><strong>'.concat(e.totalDocuments,"</strong></td></tr>"):"","\n              ").concat(e.department?'<tr><td style="padding:4px 8px 4px 0;color:#666">Department:</td><td style="padding:4px 0">'.concat(e.department,"</td></tr>"):"","\n              ").concat(e.jobTitle?'<tr><td style="padding:4px 8px 4px 0;color:#666">Job title:</td><td style="padding:4px 0">'.concat(e.jobTitle,"</td></tr>"):"","\n              ").concat(e.location?'<tr><td style="padding:4px 8px 4px 0;color:#666">Location:</td><td style="padding:4px 0">'.concat(e.location,"</td></tr>"):"","\n              ").concat(e.businessName?'<tr><td style="padding:4px 8px 4px 0;color:#666">Business:</td><td style="padding:4px 0">'.concat(e.businessName,"</td></tr>"):"","\n              ").concat(e.primaryGroup?'<tr><td style="padding:4px 8px 4px 0;color:#666">Primary group:</td><td style="padding:4px 0">'.concat(e.primaryGroup,"</td></tr>"):"",'\n            </table>\n            <p style="margin:0 0 12px 0">You may review the batch and user details in the Acknowledgement Portal.</p>\n            <p style="margin:16px 0 0 0">\n              <a href="').concat(e.appUrl,'" target="_blank" rel="noopener" style="display:inline-block;background:').concat(r,';color:#fff;text-decoration:none;padding:10px 14px;border-radius:6px;font-weight:600">Open Portal</a>\n            </p>\n            <p style="margin:24px 0 0 0;color:#666;font-size:12px">This is an automated notification from ').concat(t,". Please do not reply to this email.</p>\n          </td>\n        </tr>\n      </table>\n    </div>")}})({appUrl:window.location.origin,batchName:String((null===y||void 0===y?void 0:y.toba_name)||(null===y||void 0===y?void 0:y.name)||"Batch"),userEmail:C,userName:e.userDisplay||e.displayName||void 0,completedOn:(new Date).toISOString(),totalDocuments:S,department:(null===(t=g)||void 0===t?void 0:t.department)||void 0,jobTitle:(null===(n=g)||void 0===n?void 0:n.jobTitle)||void 0,location:(null===(r=g)||void 0===r?void 0:r.location)||void 0,businessName:f,primaryGroup:(null===(a=g)||void 0===a?void 0:a.primaryGroup)||void 0});console.log("[sendAcknowledgement] Email subject:",v);const w=[...(0,P.KB)(),C].filter(Boolean).map(e=>({address:e})),x=(0,P._V)().map(e=>({address:e}));try{await Tr(p,v,b,l.length?l:void 0,{cc:w,bcc:x}),console.log("[UserCompletionEmail] Email sent to admins:",p.map(e=>e.address))}catch(c){console.error("[UserCompletionEmail] sendEmailWithAttachmentChunks error:",c);let e="";if(c&&"object"===typeof c&&"message"in c)e=c.message;else try{e=JSON.stringify(c)}catch(d){e=String(c)}alert("[UserCompletionEmail] Failed to send admin notification: "+e)}try{localStorage.setItem(o,"1")}catch(u){}}else console.warn("[sendAcknowledgement] No admin recipients found in notificationEmails:",h)}}try{const e="sunbeth:hrBatchNotified:".concat(m);try{if("1"===localStorage.getItem(e))return}catch(h){}const t=(Array.isArray(_)?_:[]).map(e=>String(e.email||e.user||e.userPrincipalName||"").toLowerCase()).filter(e=>!!e),n=Array.from(new Set(t));let r=!0;for(const a of n)try{const e=await fetch("".concat(f,"/api/batches/").concat(encodeURIComponent(m),"/acks?email=").concat(encodeURIComponent(a)),{cache:"no-store"}),t=await e.json().catch(()=>({ids:[]}));if((Array.isArray(null===t||void 0===t?void 0:t.ids)?t.ids.length:0)<S){r=!1;break}}catch(p){r=!1;break}r&&n.length}catch(o){(0,D.R8)("Batch completion notify check failed",o)}}catch(o){(0,D.R8)("HR notify check failed",o)}};const Ir=()=>{const{id:t}=(0,F.g)(),{account:n,token:r,getToken:a}=(0,_.As)(),[i,s]=(0,e.useState)(!1),o=(0,e.useMemo)(()=>"Document ".concat(t),[t]),l=(0,F.Zp)(),c=(0,F.zy)(),d=new URLSearchParams(c.search).get("batchId")||void 0,{docs:u,index:h,progressText:p,alreadyAcked:f,ackCheckReady:m,setProgressText:g}=function(t,n,r,a){const[i,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(0),[c,d]=(0,e.useState)("\u2014"),[u,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{(async()=>{try{if(n){const e=n,i=await(0,L.getDocumentsByBatch)(e,null!==r&&void 0!==r?r:void 0);s(i);const c=i.findIndex(e=>e.toba_documentid===t);l(c>=0?c:0);try{const t=await(0,L.Pg)(e,null!==r&&void 0!==r?r:void 0,void 0,a);d("".concat(t.percent,"%"))}catch(o){}try{const n=await(0,L.DC)(e,null!==r&&void 0!==r?r:void 0,a);h(!!t&&n.includes(t))}catch(o){}finally{f(!0)}}else if(t){const n=await(0,L._L)(t);if(n){var e,i;const r={toba_documentid:String(n.toba_documentid||n.id||t),toba_title:n.toba_title||n.title||"Document ".concat(t),toba_version:String(n.toba_version||n.version||"1"),toba_requiressignature:!(null===(e=null!==(i=n.toba_requiressignature)&&void 0!==i?i:n.requiresSignature)||void 0===e||!e),toba_fileurl:n.toba_fileurl||n.url};s([r]),l(0),f(!0)}else f(!0)}else f(!0)}catch(o){f(!0)}})()},[n,t,r,a]),{docs:i,index:o,progressText:c,alreadyAcked:u,ackCheckReady:p,setIndex:l,setProgressText:d,setAlreadyAcked:h,setAckCheckReady:f}}(t,d,null!==r&&void 0!==r?r:void 0,(null===n||void 0===n?void 0:n.username)||void 0),v=((null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.username)||"").toString(),[y,b]=(0,e.useState)(0),{onAccept:w,toastMsg:A,showToast:S}=function(t){let{ack:n,id:r,title:a,username:i,displayName:s,batchIdFromQuery:o,index:l,docs:c,token:d,navigate:u,setProgressText:h}=t;const[p,f]=(0,e.useState)(""),[m,g]=(0,e.useState)(!1);return{onAccept:(0,e.useCallback)(async()=>{if(!n)return;try{if(!await ft(i||void 0,o||void 0))return}catch(t){return}const e={userDisplay:s,userEmail:i,userPrincipalName:i,email:i,documentId:r,documentTitle:a,batchId:o||"1",batchName:"unknown",ackmethod:"Clicked Accept"};try{Ar("Submitting your acknowledgement..."),f("Acknowledgement submitted"),g(!0),await Pr(e);try{const t=await(0,L.Pg)(e.batchId,null!==d&&void 0!==d?d:void 0,void 0,i||void 0);if(h("".concat(t.percent,"%")),t.percent>=100)u("/summary?batchId=".concat(e.batchId));else if(l<c.length-1){const t=c[l+1].toba_documentid;u("/document/".concat(t,"?batchId=").concat(e.batchId))}else u("/batch/".concat(e.batchId))}catch(t){}setTimeout(()=>g(!1),1200)}catch(t){u("/batch/".concat(e.batchId))}finally{Sr()}},[n,i,o,s,r,a,l,c,d,u,h]),toastMsg:p,showToast:m}}({ack:i,id:t,title:o,username:(null===n||void 0===n?void 0:n.username)||void 0,displayName:(null===n||void 0===n?void 0:n.name)||void 0,batchIdFromQuery:d,index:h,docs:u,token:r,navigate:l,setProgressText:g}),{prevDoc:C,nextDoc:E}=function(t,n,r,a){return{prevDoc:(0,e.useCallback)(()=>{if(!Array.isArray(t)||n<=0)return void a("/batch/".concat(r||""));const e=t[n-1].toba_documentid;a("/document/".concat(e,"?batchId=").concat(r))},[t,n,r,a]),nextDoc:(0,e.useCallback)(()=>{if(!Array.isArray(t)||n>=t.length-1)return void a("/batch/".concat(r||""));const e=t[n+1].toba_documentid;a("/document/".concat(e,"?batchId=").concat(r))},[t,n,r,a])}}(u,h,d,l),T=Array.isArray(u)&&h>=0&&h<u.length?u[h]:void 0,k=(null===T||void 0===T?void 0:T.toba_fileurl)||(null===T||void 0===T?void 0:T.url)||"",I=(0,P.Gi)(),R=I||"",N=a?async e=>{const t=await a(e);return null===t?void 0:t}:void 0,{docUrl:O,backupUrl:M,needGraphAuth:D}=function(t,n,r,a){const[i,s]=(0,e.useState)(""),[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{(async()=>{try{if(!t)return void s("");const a=(null===t||void 0===t?void 0:t.toba_driveid)||(null===t||void 0===t?void 0:t.driveId),i=(null===t||void 0===t?void 0:t.toba_itemid)||(null===t||void 0===t?void 0:t.itemId),o=(null===t||void 0===t?void 0:t.toba_source)||(null===t||void 0===t?void 0:t.source);d(!1);const c=(null===t||void 0===t?void 0:t.toba_fileurl)||(null===t||void 0===t?void 0:t.url)||"";if("string"===typeof c&&(n&&c.startsWith(n+"/api/files/")||c.startsWith("/api/files/"))){s(c);const e=(null===t||void 0===t?void 0:t.toba_originalurl)||(null===t||void 0===t?void 0:t.url)||"";return void l(e?n?"".concat(n,"/api/proxy?url=").concat(encodeURIComponent(e)):e:"")}if(n&&"sharepoint"===o&&a&&i)try{const e=await(null===r||void 0===r?void 0:r(["Files.Read.All","Sites.Read.All"]));if(e){s("".concat(n,"/api/proxy/graph?driveId=").concat(encodeURIComponent(a),"&itemId=").concat(encodeURIComponent(i),"&token=").concat(encodeURIComponent(e)));const r=(null===t||void 0===t?void 0:t.toba_originalurl)||(null===t||void 0===t?void 0:t.url)||"";return void l(r?n?"".concat(n,"/api/proxy?url=").concat(encodeURIComponent(r)):r:"")}}catch(e){return d(!0),s(""),void l("")}const u=(null===t||void 0===t?void 0:t.toba_fileurl)||(null===t||void 0===t?void 0:t.url)||"",h=/\.sharepoint\.com\//i.test(u)||/graph\.microsoft\.com\//i.test(u);if(n&&h)try{const e=await(null===r||void 0===r?void 0:r(["Files.Read.All","Sites.Read.All"]));if(e)return s("".concat(n,"/api/proxy/graph?url=").concat(encodeURIComponent(u),"&token=").concat(encodeURIComponent(e))),void l(n?"".concat(n,"/api/proxy?url=").concat(encodeURIComponent(u)):u)}catch(e){return d(!0),s(""),void l("")}s(n?"".concat(n,"/api/proxy?url=").concat(encodeURIComponent(u)):u),l(u)}catch(e){const r=(null===t||void 0===t?void 0:t.toba_fileurl)||(null===t||void 0===t?void 0:t.url)||"";s(n?"".concat(n,"/api/proxy?url=").concat(encodeURIComponent(r)):r),l(r)}})()},[t,n,a,r]),{docUrl:i,backupUrl:o,needGraphAuth:c,setNeedGraphAuth:d}}(T,R,N,y),j=function(t,n){const[r,a]=(0,e.useState)("");return(0,e.useEffect)(()=>{(async()=>{try{if(a(""),!t)return;const e=n&&"string"===typeof t&&t.startsWith(n),r="string"===typeof t&&t.startsWith("/api/");if(e||r){const r=e?t:(n||"")+t,i=r+(r.includes("?")?"&":"?")+"diag=1",s=await fetch(i,{cache:"no-store"}),o=await s.json().catch(()=>null),l=((null===o||void 0===o?void 0:o.mime)||(null===o||void 0===o?void 0:o.contentType)||s.headers.get("content-type")||"").toString();l&&a(l)}}catch(e){}})()},[t,n]),r}(O,R),{isPdf:B,isDocx:U,proxiedDownloadUrl:G,openInNewTabUrl:H,viewerUrls:z}=function(t,n,r,a){const{isPdf:i,isDocx:s,proxiedDownloadUrl:o,openInNewTabUrl:l,viewerUrls:c}=(0,e.useMemo)(()=>{const e=/\.pdf(\?|#|$)/i.test(t)||/\.pdf(\?|#|$)/i.test(n),i=/\.docx(\?|#|$)/i.test(t)||/\.docx(\?|#|$)/i.test(n);return{isPdf:e||/application\/pdf/i.test(r),isDocx:i||/vnd\.openxmlformats-officedocument\.wordprocessingml\.document/i.test(r),proxiedDownloadUrl:n?n+(n.includes("?")?"&":"?")+"download=1":"",openInNewTabUrl:n?n+(n.includes("?")?"&":"?")+"redir=1":"",viewerUrls:a&&a!==n?[n,a]:n}},[t,n,r,a]);return{isPdf:i,isDocx:s,proxiedDownloadUrl:o,openInNewTabUrl:l,viewerUrls:c}}(k,O,j,M),W=null===T||void 0===T?void 0:T.toba_originalurl;return(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsx)(_t,{title:o}),(0,x.jsx)(At,{show:!(!d||ut((null===n||void 0===n?void 0:n.username)||void 0,d))}),(0,x.jsx)(St,{visible:D,onGrant:async()=>{try{await(null===a||void 0===a?void 0:a(["Files.Read.All","Sites.Read.All"])),b(e=>e+1)}catch(e){}}}),(0,x.jsx)(yr,{isPdf:B,isDocx:U,viewerUrls:z,docUrl:O,needGraphAuth:D}),(0,x.jsx)(br,{docUrl:O,openInNewTabUrl:H,proxiedDownloadUrl:G,originalUrl:W}),(0,x.jsx)(wr,{ready:m,alreadyAcked:f,userName:v,ack:i,onAckChange:s,onAccept:w}),(0,x.jsx)(_r,{onPrev:C,onNext:E,progressText:p}),(0,x.jsx)(wt,{message:A,show:S})]})})},Rr=()=>{const{token:t,account:r}=(0,_.As)(),a=(0,F.zy)(),i=new URLSearchParams(a.search).get("batchId")||void 0,[s,o]=(0,e.useState)(null),[l,c]=(0,e.useState)("idle");(0,e.useEffect)(()=>{let e=!0;return(async()=>{if(i)try{const n=await(0,L.Pg)(i,null!==t&&void 0!==t?t:void 0,void 0,(null===r||void 0===r?void 0:r.username)||void 0);e&&o(n.percent)}catch(n){e&&o(null)}})(),()=>{e=!1}},[i,t,null===r||void 0===r?void 0:r.username]);const d=null!==s&&s>=100;return(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",style:{textAlign:"center"},children:[(0,x.jsx)("div",{className:"title",children:d?"\u2705 Batch Completed":"In Progress"}),(0,x.jsx)("div",{style:{fontWeight:700,color:"var(--primary)",marginTop:8},children:i||"\u2014"}),(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:d?"All documents acknowledged.":null===s?"Checking progress\u2026":"".concat(s,"% acknowledged. Keep going!")}),(0,x.jsx)("div",{style:{height:14}}),d&&(0,x.jsx)("div",{style:{marginBottom:12},children:(0,x.jsxs)("button",{className:"btn sm",onClick:async()=>{if(i&&r){c("sending");try{const e=await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,4641)).then(e=>e.getDocumentsByBatch(i));if(!Array.isArray(e)||0===e.length)throw new Error("No documents found for batch");for(const t of e)await Pr({batchId:i,documentId:t.toba_documentid||t.id||t.documentId,userDisplay:r.name,userEmail:r.username,userPrincipalName:r.username,email:r.username,ackmethod:"Nudge Admin (manual)"});c("sent"),await(0,ct.Q$)("Notification Sent","The admin has been notified that you have completed your batch.")}catch(e){c("error"),await(0,ct.Z2)("Notification Failed","There was a problem sending the notification. Please try again.")}}},disabled:"sending"===l||"sent"===l,children:["idle"===l&&"Notify Admin","sending"===l&&"Sending...","sent"===l&&"Notification Sent!","error"===l&&"Error, Try Again"]})}),(0,x.jsx)(n.N_,{to:"/",children:(0,x.jsx)("button",{className:"btn",children:"Return to Dashboard"})})]})})},Nr=()=>{const{id:t}=(0,F.g)(),{token:r,account:a}=(0,_.As)(),[i,s]=(0,e.useState)([]),[o,l]=(0,e.useState)([]);(0,e.useEffect)(()=>{t&&(async()=>{const e=await(0,L.getDocumentsByBatch)(t,null!==r&&void 0!==r?r:void 0);s(e);const n=await(0,L.DC)(t,null!==r&&void 0!==r?r:void 0,(null===a||void 0===a?void 0:a.username)||void 0);l(n)})()},[t,r,null===a||void 0===a?void 0:a.username]);const c=(0,e.useMemo)(()=>i.filter(e=>o.includes(e.toba_documentid)),[i,o]);return(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"title",children:"Completed Documents"}),(0,x.jsx)("div",{className:"muted small",children:"You can still view previously acknowledged documents."})]}),(0,x.jsx)(n.N_,{to:"/",children:(0,x.jsx)("button",{className:"btn ghost sm",children:"\u2190 Back to Dashboard"})})]}),(0,x.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),0===c.length?(0,x.jsx)("div",{className:"muted",style:{padding:12},children:"No acknowledged documents found."}):(0,x.jsx)("div",{className:"doc-list",children:c.map((e,r)=>(0,x.jsxs)("div",{className:"doc-row",children:[(0,x.jsxs)("div",{className:"doc-meta",children:[(0,x.jsx)("div",{className:"doc-icon",children:"PDF"}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{fontWeight:700},children:[r+1,". ",e.toba_title]}),(0,x.jsx)("div",{className:"muted small",children:e.toba_version||""})]})]}),(0,x.jsx)("div",{style:{textAlign:"right"},children:(0,x.jsx)(n.N_,{to:"/document/".concat(e.toba_documentid,"?batchId=").concat(t),children:(0,x.jsx)("button",{className:"btn sm",children:"View"})})})]},e.toba_documentid))})]})})},Or=()=>{const[t,n]=(0,e.useState)([]),[r,a]=(0,e.useState)(""),[i,s]=(0,e.useState)(!1),[o,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null),u=(0,P.Gi)()||"";(0,e.useEffect)(()=>{(async()=>{s(!0),d(null);try{const e=await fetch("".concat(u,"/api/notification-emails")),t=await e.json();n(Array.isArray(null===t||void 0===t?void 0:t.emails)?t.emails:[])}catch(e){d("Failed to load emails")}finally{s(!1)}})()},[]);const h=async e=>{l(!0),d(null);try{if(!(await fetch("".concat(u,"/api/notification-emails"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emails:e})})).ok)throw new Error("Save failed");n(e),d("Saved!")}catch(t){d("Failed to save")}finally{l(!1)}};return(0,x.jsxs)("div",{className:"card",style:{maxWidth:480,margin:"0 auto",padding:24},children:[(0,x.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:18},children:"Notification Emails"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:12},children:"These emails will receive admin notifications (batch completions, nudges, etc). Changes are saved instantly."}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16},children:[(0,x.jsx)("input",{type:"email",value:r,onChange:e=>a(e.target.value),placeholder:"admin@domain.com",style:{flex:1,padding:8,border:"1px solid #ddd",borderRadius:4},disabled:o}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>{const e=r.trim().toLowerCase();if(!e||!e.includes("@")||t.includes(e))return;const i=[...t,e];n(i),a(""),h(i)},disabled:o||!r.trim()||!r.includes("@")||t.includes(r.trim().toLowerCase()),children:"Add"})]}),i?(0,x.jsx)("div",{className:"small muted",children:"Loading..."}):0===t.length?(0,x.jsx)("div",{className:"small muted",children:"No notification emails set."}):(0,x.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:t.map(e=>(0,x.jsxs)("li",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[(0,x.jsx)("span",{style:{flex:1},children:e}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(e=>{const r=t.filter(t=>t!==e);n(r),h(r)})(e),disabled:o,children:"Remove"})]},e))}),c&&(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:c})]})},Mr=async(e,t)=>{try{const n="https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,mail,jobTitle,department,officeLocation,businessPhones,mobilePhone&$top=200",r=null!==t&&void 0!==t&&t.search&&t.search.trim()?n:"".concat(n,"&$orderby=displayName"),a=e=>e.replace(/'/g,"''"),i=null!==t&&void 0!==t&&t.search?"(startswith(displayName,'".concat(a(t.search),"') or startswith(userPrincipalName,'").concat(a(t.search),"') or startswith(mail,'").concat(a(t.search),"'))"):"";let s=i?"".concat(r,"&$filter=").concat(i):r;const o=[];for(;s;){const t=await fetch(s,{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json",ConsistencyLevel:"eventual"}});if(!t.ok){const e=await t.text().catch(()=>"");throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText).concat(e?" \u2014 "+e:""))}const n=await t.json(),r=Array.isArray(n.value)?n.value:[];o.push(...r),s=n["@odata.nextLink"]||""}let l=o;if(null!==t&&void 0!==t&&t.department&&(l=l.filter(e=>(e.department||"").toLowerCase().includes(t.department.toLowerCase()))),null!==t&&void 0!==t&&t.jobTitle&&(l=l.filter(e=>(e.jobTitle||"").toLowerCase().includes(t.jobTitle.toLowerCase()))),null!==t&&void 0!==t&&t.location&&(l=l.filter(e=>(e.officeLocation||"").toLowerCase().includes(t.location.toLowerCase()))),null!==t&&void 0!==t&&t.search&&t.search.trim()){const e=e=>(e.displayName||e.userPrincipalName||"").toString();l=l.slice().sort((t,n)=>e(t).localeCompare(e(n),void 0,{sensitivity:"base"}))}return(0,D.pq)("graphUserService: fetched users",{count:l.length,filters:t}),l}catch(n){throw(0,D.z3)("graphUserService: failed to fetch users",n),n}},Fr=async e=>{try{let t="https://graph.microsoft.com/v1.0/groups?$select=id,displayName,description,mail,groupTypes&$orderby=displayName&$top=200";const n=[];for(;t;){const r=await fetch(t,{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json",ConsistencyLevel:"eventual"}});if(!r.ok){const e=await r.text().catch(()=>"");throw new Error("Graph API error: ".concat(r.status," ").concat(r.statusText).concat(e?" \u2014 "+e:""))}const a=await r.json(),i=Array.isArray(a.value)?a.value:[];n.push(...i),t=a["@odata.nextLink"]||null}const r=await Promise.all(n.map(async t=>{try{const n=await fetch("https://graph.microsoft.com/v1.0/groups/".concat(t.id,"/members/$count"),{headers:{Authorization:"Bearer ".concat(e),ConsistencyLevel:"eventual"}});n.ok&&(t.memberCount=parseInt(await n.text()))}catch(n){}return t}));return(0,D.pq)("graphUserService: fetched groups",{count:r.length}),r}catch(t){throw(0,D.z3)("graphUserService: failed to fetch groups",t),t}},Dr=async(e,t)=>{try{const n=[];let r="https://graph.microsoft.com/v1.0/groups/".concat(t,"/members?$select=id,displayName,userPrincipalName,mail,jobTitle,department&$top=200");for(;r;){const t=await fetch(r,{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText));const a=await t.json(),i=(a.value||[]).filter(e=>"#microsoft.graph.user"===e["@odata.type"]);n.push(...i),r=a["@odata.nextLink"]||null}return(0,D.pq)("graphUserService: fetched group members",{groupId:t,count:n.length}),n}catch(n){throw(0,D.z3)("graphUserService: failed to fetch group members",n),n}},Lr=async e=>{try{const t=await fetch("https://graph.microsoft.com/v1.0/users?$select=department,jobTitle,officeLocation&$top=999",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText));const n=(await t.json()).value,r=[...new Set(n.map(e=>e.department).filter(Boolean))].sort(),a=[...new Set(n.map(e=>e.jobTitle).filter(Boolean))].sort(),i=[...new Set(n.map(e=>e.officeLocation).filter(Boolean))].sort();return(0,D.pq)("graphUserService: fetched organization structure",{departments:r.length,jobTitles:a.length,locations:i.length}),{departments:r,jobTitles:a,locations:i}}catch(t){return(0,D.z3)("graphUserService: failed to fetch organization structure",t),{departments:[],jobTitles:[],locations:[]}}},jr=t=>{let{onSelectionChange:n}=t;const{getToken:r,login:a,account:i}=(0,_.As)(),[s,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[u,h]=(0,e.useState)("users"),[p,f]=(0,e.useState)([]),[m,g]=(0,e.useState)([]),[v,y]=(0,e.useState)({departments:[],jobTitles:[],locations:[]}),[b,w]=(0,e.useState)({}),[A,S]=(0,e.useState)(""),[C,E]=(0,e.useState)(new Set),[T,k]=(0,e.useState)(new Set),[P,I]=(0,e.useState)(1),[R,N]=(0,e.useState)(1),[O,M]=(0,e.useState)(""),F=50,D=async()=>{o(!0),c(null);try{const e=await r(["User.Read.All","Group.Read.All"]);if(!e)throw new Error("No token available");const[t,n,a]=await Promise.all([Mr(e,b),Fr(e),Lr(e)]);f(t),g(n),y(a)}catch(e){console.error("Failed to load user/group data:",e);const t="string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:"",n=t.includes("No active account")?"Please sign in to continue.":"Ask your admin to grant Microsoft Graph permissions (User.Read.All and Group.Read.All) to this app.";c("".concat(t||"Failed to load user data."," ").concat(n).trim()),(0,ct.P0)("Failed to load user data. ".concat(n),"error")}finally{o(!1)}};(0,e.useEffect)(()=>{D(),I(1),N(1)},[b]),(0,e.useEffect)(()=>{const e=setTimeout(()=>{w(e=>(0,d.A)((0,d.A)({},e),{},{search:A||void 0}))},300);return()=>clearTimeout(e)},[A]),(0,e.useEffect)(()=>{n({users:Array.from(C).map(e=>p.find(t=>t.id===e)).filter(Boolean),groups:Array.from(T).map(e=>m.find(t=>t.id===e)).filter(Boolean)})},[C,T,p,m]);const L=e=>{const t=new Set(C);t.has(e)?t.delete(e):t.add(e),E(t)};return(0,x.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:8,padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:16},children:"Assign to Users & Groups"}),(0,x.jsxs)("div",{style:{marginBottom:12},children:[!i&&(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#fff3cd",padding:8,borderRadius:6,border:"1px solid #ffeeba"},children:[(0,x.jsx)("span",{children:"You're not signed in."}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>a().then(()=>D()),children:"Sign in"})]}),l&&(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#f8d7da",padding:8,borderRadius:6,border:"1px solid #f5c6cb",marginTop:8},children:[(0,x.jsx)("span",{style:{flex:1},children:l}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>D(),children:"Retry"})]})]}),(0,x.jsx)("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"1px solid #e0e0e0"},children:["users","groups","structure"].map(e=>(0,x.jsx)("button",{className:u===e?"btn sm":"btn ghost sm",onClick:()=>h(e),children:"users"===e?"Users (".concat(p.length,")"):"groups"===e?"Groups (".concat(m.length,")"):"Filters"},e))}),s&&(0,x.jsx)("div",{className:"small muted",children:"Loading..."}),"structure"===u&&(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",children:"Search:"}),(0,x.jsx)("input",{type:"text",placeholder:"Name, email...",value:A,onChange:e=>S(e.target.value),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",children:"Department:"}),(0,x.jsxs)("select",{value:b.department||"",onChange:e=>w((0,d.A)((0,d.A)({},b),{},{department:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,x.jsx)("option",{value:"",children:"All Departments"}),v.departments.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",children:"Job Title:"}),(0,x.jsxs)("select",{value:b.jobTitle||"",onChange:e=>w((0,d.A)((0,d.A)({},b),{},{jobTitle:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,x.jsx)("option",{value:"",children:"All Titles"}),v.jobTitles.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",children:"Location:"}),(0,x.jsxs)("select",{value:b.location||"",onChange:e=>w((0,d.A)((0,d.A)({},b),{},{location:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,x.jsx)("option",{value:"",children:"All Locations"}),v.locations.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]})]}),"users"===u&&(0,x.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[(0,x.jsx)("div",{style:{marginBottom:12},children:(0,x.jsx)("input",{type:"text",placeholder:"Search users (name or email)",value:A,onChange:e=>S(e.target.value),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4}})}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>E(new Set(p.map(e=>e.id))),children:"Select All"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>E(new Set),children:"Clear"}),(0,x.jsxs)("span",{className:"small muted",children:["Selected: ",C.size]})]}),p.slice(0,P*F).map(e=>(0,x.jsxs)("div",{onClick:()=>L(e.id),role:"button",style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0",cursor:"pointer"},children:[(0,x.jsx)("input",{type:"checkbox",checked:C.has(e.id),onClick:e=>e.stopPropagation(),onChange:()=>L(e.id)}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:500},children:e.displayName}),(0,x.jsx)("div",{className:"small muted",children:e.userPrincipalName}),e.department&&(0,x.jsxs)("div",{className:"small muted",children:[e.department," \u2022 ",e.jobTitle]})]})]},e.id)),P*F<p.length&&(0,x.jsxs)("div",{style:{padding:8,textAlign:"center"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>I(e=>e+1),children:"Load more"}),(0,x.jsxs)("div",{className:"small muted",style:{marginTop:6},children:[Math.min(P*F,p.length)," of ",p.length]})]})]}),"groups"===u&&(0,x.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[(0,x.jsx)("div",{style:{marginBottom:12},children:(0,x.jsx)("input",{type:"text",placeholder:"Search groups",value:O,onChange:e=>{M(e.target.value),N(1)},style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4}})}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>k(new Set(m.map(e=>e.id))),children:"Select All"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>k(new Set),children:"Clear"}),(0,x.jsxs)("span",{className:"small muted",children:["Selected: ",T.size]})]}),m.filter(e=>{if(!O.trim())return!0;const t=O.toLowerCase();return(e.displayName||"").toLowerCase().includes(t)||(e.description||"").toLowerCase().includes(t)||(e.mail||"").toLowerCase().includes(t)}).slice(0,R*F).map(e=>(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0"},children:[(0,x.jsx)("input",{type:"checkbox",checked:T.has(e.id),onChange:()=>(e=>{const t=new Set(T);t.has(e)?t.delete(e):t.add(e),k(t)})(e.id)}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:500},children:e.displayName}),e.description&&(0,x.jsx)("div",{className:"small muted",children:e.description}),(0,x.jsxs)("div",{className:"small muted",children:[e.memberCount||0," members"]})]})]},e.id)),R*F<m.length&&(0,x.jsxs)("div",{style:{padding:8,textAlign:"center"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>N(e=>e+1),children:"Load more"}),(0,x.jsxs)("div",{className:"small muted",style:{marginTop:6},children:[Math.min(R*F,m.length)," of ",m.length]})]})]})]})},Br=e=>{let{title:t,value:n,change:r,color:a="var(--primary)",icon:i="\ud83d\udcca"}=e;return(0,x.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center",background:"linear-gradient(135deg, #fff 0%, #f8f9fa 100%)"},children:[(0,x.jsx)("div",{style:{fontSize:24,marginBottom:8},children:i}),(0,x.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:a,marginBottom:4},children:n}),(0,x.jsx)("div",{style:{fontSize:14,color:"#666",marginBottom:4},children:t}),r&&(0,x.jsx)("div",{style:{fontSize:12,color:r.startsWith("+")?"#28a745":r.startsWith("-")?"#dc3545":"#666",fontWeight:500},children:r})]})},Ur=e=>{let{data:t,type:n,height:r=200}=e;return(0,x.jsxs)("div",{style:{height:r,border:"1px solid #e0e0e0",borderRadius:8,padding:16,background:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,color:"#666"},children:["\ud83d\udcc8 ","line"===n?"Trend":"Bar"," Chart (",t.length," data points)",(0,x.jsx)("div",{className:"small",style:{marginLeft:8},children:"Interactive charts with Chart.js/D3 would render here"})]})},Gr=e=>{let{data:t,columns:n}=e;return(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{style:{backgroundColor:"#f8f9fa"},children:n.map(e=>(0,x.jsx)("th",{style:{padding:12,textAlign:"left",borderBottom:"2px solid #dee2e6",fontWeight:600},children:e.label},e.key))})}),(0,x.jsx)("tbody",{children:t.map((e,t)=>(0,x.jsx)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:n.map(t=>(0,x.jsx)("td",{style:{padding:12},children:t.format?t.format(e[t.key]):e[t.key]},t.key))},t))})]})})};const Hr=t=>{let{onFilterChange:n,liveOptions:r}=t;const[a,i]=(0,e.useState)({dateRange:"30d",businessId:"all",department:"all",group:"all",status:"all",batchType:"all"}),s=(e,t)=>{const r=(0,d.A)((0,d.A)({},a),{},{[e]:t});i(r),n(r)};return(0,x.jsxs)("div",{style:{display:"flex",gap:16,padding:16,backgroundColor:"#f8f9fa",borderRadius:8,marginBottom:24,flexWrap:"wrap"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Date Range:"}),(0,x.jsxs)("select",{value:a.dateRange,onChange:e=>s("dateRange",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,x.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,x.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,x.jsx)("option",{value:"1y",children:"Last year"})]})]}),r&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Business:"}),(0,x.jsxs)("select",{value:a.businessId,onChange:e=>s("businessId",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"all",children:"All Businesses"}),r.businesses.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Department:"}),(0,x.jsxs)("select",{value:a.department,onChange:e=>s("department",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"all",children:"All Departments"}),r.departments.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Group:"}),(0,x.jsxs)("select",{value:a.group,onChange:e=>s("group",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"all",children:"All Groups"}),r.groups.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Status:"}),(0,x.jsxs)("select",{value:a.status,onChange:e=>s("status",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"all",children:"All Statuses"}),(0,x.jsx)("option",{value:"completed",children:"Completed"}),(0,x.jsx)("option",{value:"pending",children:"Pending"}),(0,x.jsx)("option",{value:"overdue",children:"Overdue"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Batch Type:"}),(0,x.jsxs)("select",{value:a.batchType,onChange:e=>s("batchType",e.target.value),className:"form-control",children:[(0,x.jsx)("option",{value:"all",children:"All Types"}),(0,x.jsx)("option",{value:"policy",children:"Policy Updates"}),(0,x.jsx)("option",{value:"training",children:"Training Materials"}),(0,x.jsx)("option",{value:"compliance",children:"Compliance Documents"})]})]}),(0,x.jsx)("div",{style:{alignSelf:"end"},children:(0,x.jsx)("button",{className:"btn ghost sm",children:"\ud83d\udcca Export Report"})})]})},zr=()=>{const[t,n]=(0,e.useState)(!1),[r,a]=(0,e.useState)(null),[i,s]=(0,e.useState)({}),[o,l]=(0,e.useState)({businesses:[],departments:[],groups:[]}),[c,u]=(0,e.useState)([]),[h,p]=(0,e.useState)([]),f="https://sunbeth-ack-portal-backend.vercel.app/".replace(/\/$/,""),m=async()=>{n(!0);try{try{const t=[],r=i.businessId;r&&"all"!==r&&t.push("businessId=".concat(encodeURIComponent(r)));const s=i.department;s&&"all"!==s&&t.push("department=".concat(encodeURIComponent(s)));const o=i.group;o&&"all"!==o&&t.push("primaryGroup=".concat(encodeURIComponent(o)));const c=t.length?"?".concat(t.join("&")):"",[h,m,g,v,y,b,w]=await Promise.all([fetch("".concat(f,"/api/stats").concat(c)).then(e=>e.json()),fetch("".concat(f,"/api/recipients").concat(c)).then(e=>e.json()),(0,L.Xr)().catch(()=>[]),fetch("".concat(f,"/api/compliance").concat(c)).then(e=>e.json()).catch(()=>[]),fetch("".concat(f,"/api/doc-stats").concat(c)).then(e=>e.json()).catch(()=>[]),fetch("".concat(f,"/api/trends").concat(c)).then(e=>e.json()).catch(()=>({completions:[],newBatches:[],activeUsers:[]})),fetch("".concat(f,"/api/activity/recent?limit=20")).then(e=>e.json()).catch(()=>[])]);u(Array.isArray(m)?m:[]),p(Array.isArray(w)?w:[]);const _=new Set,A=new Set;for(const e of Array.isArray(m)?m:[])e.department&&_.add(String(e.department)),e.primaryGroup&&A.add(String(e.primaryGroup));const S=Array.isArray(g)?g.map(e=>({id:String(e.id||e.toba_businessid||""),name:String(e.name||e.toba_name||"")})):[];l({businesses:S,departments:Array.from(_).sort(),groups:Array.from(A).sort()});const C={kpis:(0,d.A)((0,d.A)({},h),{},{lastUpdated:(new Date).toISOString()}),compliance:Array.isArray(v)?v:[],trends:Array.isArray(b.completions)?b.completions.map((e,t)=>{var n,r,a,i;return{date:e.date,completions:Number(e.count||0),newBatches:Number((null===(n=b.newBatches)||void 0===n||null===(r=n[t])||void 0===r?void 0:r.count)||0),activeUsers:Number((null===(a=b.activeUsers)||void 0===a||null===(i=a[t])||void 0===i?void 0:i.count)||0)}}):[],documents:Array.isArray(y)?y:[]};a(C);try{window.__analyticsData=(0,d.A)((0,d.A)({},C),{},{__recipients:Array.isArray(m)?m:[]})}catch(e){}return void n(!1)}catch(t){return a({kpis:{totalBatches:0,activeBatches:0,totalUsers:0,completionRate:0,overdueBatches:0,avgCompletionTime:0,lastUpdated:(new Date).toISOString()},compliance:[],trends:[],documents:[]}),void n(!1)}a({kpis:{totalBatches:0,activeBatches:0,totalUsers:0,completionRate:0,overdueBatches:0,avgCompletionTime:0,lastUpdated:(new Date).toISOString()},compliance:[],trends:[],documents:[]});try{window.__analyticsData=null}catch(r){}n(!1)}catch(s){console.error("Failed to load analytics data:",s),n(!1)}};return(0,e.useEffect)(()=>{m()},[i]),t?(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,x.jsx)("div",{style:{fontSize:24,marginBottom:16},children:"\ud83d\udcca"}),(0,x.jsx)("div",{children:"Loading analytics dashboard..."}),(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:"Fetching data from local SQLite API"})]})}):r?(0,x.jsxs)("div",{className:"container",children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{style:{margin:0,fontSize:28,color:"var(--primary)"},children:"\ud83d\udcca Analytics Dashboard"}),(0,x.jsxs)("p",{className:"small muted",children:["Last updated: ",new Date(r.kpis.lastUpdated).toLocaleString()]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>m(),children:"\ud83d\udd04 Refresh"}),(0,x.jsx)("button",{className:"btn ghost sm",children:"\ud83d\udccb Schedule Report"}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>function(){try{const e=window.__analyticsData;if(!e)return void console.warn("No analytics data to export");if(Array.isArray(e.__recipients)&&e.__recipients.length>0){const t=e.__recipients.map(e=>({displayName:e.displayName||e.toba_DisplayName||e.email||e.toba_Email,email:e.email||e.toba_Email,department:e.department||e.toba_Department||"",group:e.primaryGroup||e.toba_PrimaryGroup||""}));qr("recipients.csv",Wr(t,["displayName","email","department","group"]))}if(Array.isArray(e.documents)&&e.documents.length>0){qr("documents.csv",Wr(e.documents,["documentName","batchName","totalAssigned","acknowledged","pending","avgTimeToComplete"]))}}catch(e){console.warn("CSV export failed",e)}}(),children:"\ud83d\udce4 Export CSV"})]})]}),(0,x.jsx)(Hr,{onFilterChange:s,liveOptions:o}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:32},children:[(0,x.jsx)(Br,{title:"Total Batches",value:r.kpis.totalBatches,change:"+5 this month",icon:"\ud83d\udccb"}),(0,x.jsx)(Br,{title:"Active Batches",value:r.kpis.activeBatches,color:"#17a2b8",icon:"\u26a1"}),(0,x.jsx)(Br,{title:"Assigned Recipients",value:Number(r.kpis.totalUsers).toLocaleString(),color:"#28a745",icon:"\ud83d\udc65"}),(0,x.jsx)(Br,{title:"Completion Rate",value:"".concat(r.kpis.completionRate,"%"),color:"#ffc107",icon:"\u2705"}),(0,x.jsx)(Br,{title:"Overdue Batches",value:r.kpis.overdueBatches,color:"#dc3545",icon:"\u26a0\ufe0f"}),(0,x.jsx)(Br,{title:"Avg. Completion Time",value:"".concat(r.kpis.avgCompletionTime," days"),color:"#6f42c1",icon:"\u23f1\ufe0f"})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:24,marginBottom:32},children:[(0,x.jsxs)("div",{className:"card",style:{padding:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udcc8 Completion Trends (30 days)"}),(0,x.jsx)(Ur,{data:r.trends,type:"line",height:250})]}),(0,x.jsxs)("div",{className:"card",style:{padding:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83c\udfaf Compliance Status"}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#d4edda",borderRadius:6},children:[(0,x.jsx)("span",{children:"Compliant"}),(0,x.jsxs)("strong",{style:{color:"#155724"},children:[r.kpis.completionRate,"%"]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#fff3cd",borderRadius:6},children:[(0,x.jsx)("span",{children:"Pending"}),(0,x.jsxs)("strong",{style:{color:"#856404"},children:[Math.max(0,100-r.kpis.completionRate),"%"]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#f8d7da",borderRadius:6},children:[(0,x.jsx)("span",{children:"Overdue"}),(0,x.jsxs)("strong",{style:{color:"#721c24"},children:[r.kpis.overdueBatches,"%"]})]})]})]})]}),(0,x.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83c\udfe2 Department Compliance Overview"}),0===r.compliance.length?(0,x.jsx)("div",{className:"small muted",children:"No live compliance breakdown yet."}):(0,x.jsx)(Gr,{data:r.compliance,columns:[{key:"department",label:"Department"},{key:"totalUsers",label:"Total Users",format:e=>e.toLocaleString()},{key:"completed",label:"Completed",format:e=>e.toLocaleString()},{key:"pending",label:"Pending",format:e=>e.toLocaleString()},{key:"overdue",label:"Overdue",format:e=>e.toLocaleString()},{key:"completionRate",label:"Completion Rate",format:e=>(0,x.jsxs)("span",{style:{color:e>=90?"#28a745":e>=75?"#ffc107":"#dc3545",fontWeight:"bold"},children:[e,"%"]})}]})]}),c&&c.length>0&&(0,x.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udc65 Recipients (Filtered)"}),(0,x.jsx)(Gr,{data:c.map(e=>({displayName:e.displayName||e.toba_DisplayName||e.email||e.toba_Email,email:e.email||e.toba_Email,department:e.department||e.toba_Department||"\u2014",group:e.primaryGroup||e.toba_PrimaryGroup||"\u2014"})),columns:[{key:"displayName",label:"Name"},{key:"email",label:"Email"},{key:"department",label:"Department"},{key:"group",label:"Group"}]})]}),(0,x.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udcc4 Document Performance"}),0===r.documents.length?(0,x.jsx)("div",{className:"small muted",children:"No live document stats yet."}):(0,x.jsx)(Gr,{data:r.documents,columns:[{key:"documentName",label:"Document"},{key:"batchName",label:"Batch"},{key:"totalAssigned",label:"Assigned",format:e=>e.toLocaleString()},{key:"acknowledged",label:"Acknowledged",format:e=>e.toLocaleString()},{key:"pending",label:"Pending",format:e=>e.toLocaleString()},{key:"avgTimeToComplete",label:"Avg. Time",format:e=>"".concat(e," days")}]})]}),(0,x.jsxs)("div",{className:"card",style:{padding:20},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udd04 Recent Activity"}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[0===h.length&&(0,x.jsx)("div",{className:"small muted",children:"No recent activity yet."}),h.map((e,t)=>{const n=e.type||("acknowledged"===e.action?"success":(e.action,"info")),r=function(e){if(!e)return"";const t=Date.parse(e);if(isNaN(t))return new Date(e).toLocaleString();const n=Date.now()-t,r=Math.floor(n/1e3);if(r<60)return"".concat(r,"s ago");const a=Math.floor(r/60);if(a<60)return"".concat(a," min ago");const i=Math.floor(a/60);if(i<24)return"".concat(i," hr").concat(1===i?"":"s"," ago");const s=Math.floor(i/24);return"".concat(s," day").concat(1===s?"":"s"," ago")}(e.timestamp),a=e.user||"System",i=e.document||e.batch||"";return(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,backgroundColor:"#f8f9fa",borderRadius:6,borderLeft:"4px solid ".concat("success"===n?"#28a745":"warning"===n?"#ffc107":"info"===n?"#17a2b8":"#6c757d")},children:[(0,x.jsx)("div",{style:{fontSize:12,color:"#666",minWidth:70},children:r}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("strong",{children:a})," ",e.action," ",i&&(0,x.jsx)("em",{children:i})]}),(0,x.jsx)("div",{style:{fontSize:10,padding:"2px 6px",backgroundColor:"success"===n?"#d4edda":"warning"===n?"#fff3cd":"info"===n?"#d1ecf1":"#e2e3e5",color:"success"===n?"#155724":"warning"===n?"#856404":"info"===n?"#0c5460":"#383d41",borderRadius:4,textTransform:"uppercase",fontWeight:"bold"},children:n})]},t)})]})]})]}):(0,x.jsx)("div",{className:"container",children:(0,x.jsx)("div",{className:"card",children:(0,x.jsx)("div",{style:{color:"#dc3545"},children:"Failed to load analytics data"})})})};function Wr(e,t){const n=e=>'"'+String(null!==e&&void 0!==e?e:"").replace(/"/g,'""')+'"',r=t.map(n).join(","),a=e.map(e=>t.map(t=>n(e[t])).join(",")).join("\n");return r+"\n"+a}function qr(e,t){const n=new Blob([t],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=e,a.click(),URL.revokeObjectURL(r)}var Vr={version:"0.18.5"},Kr=1200,Yr=1252,Xr=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qr={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$r=function(e){-1!=Xr.indexOf(e)&&(Yr=Qr[0]=e)};var Jr=function(e){Kr=e,$r(e)};function Zr(){Jr(1200),$r(1252)}function ea(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var ta,na=function(e){return String.fromCharCode(e)},ra=function(e){return String.fromCharCode(e)};var aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ia(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)i=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=aa.charAt(i)+aa.charAt(s)+aa.charAt(o)+aa.charAt(l);return t}function sa(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=aa.indexOf(e.charAt(l++))<<2|(i=aa.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=aa.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=aa.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var oa=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),la=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ca(e){return oa?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function da(e){return oa?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var ua=function(e){return oa?la(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function ha(e){if("undefined"===typeof ArrayBuffer)return ua(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function pa(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var fa=oa?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:la(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var ma=/\u0000/g,ga=/[\u0001-\u0006]/g;function va(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function ya(e,t){var n=""+e;return n.length>=t?n:Ii("0",t-n.length)+n}function ba(e,t){var n=""+e;return n.length>=t?n:Ii(" ",t-n.length)+n}function wa(e,t){var n=""+e;return n.length>=t?n:n+Ii(" ",t-n.length)}var _a=Math.pow(2,32);function Aa(e,t){return e>_a||e<-_a?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Ii("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Ii("0",t-n.length)+n}(Math.round(e),t)}function Sa(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Ca=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xa=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ea={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ta={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ka={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pa(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,l=1,c=0,d=0,u=Math.floor(a);c<t&&(o=(u=Math.floor(a))*s+i,d=u*c+l,!(a-u<5e-8));)a=1/(a-u),i=s,s=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=i):(d=c,o=s)),!n)return[0,r*o,d];var h=Math.floor(r*o/d);return[h,r*o-h*d,d]}function Ia(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Ra=new Date(1899,11,31,0,0,0),Na=Ra.getTime(),Oa=new Date(1900,2,1,0,0,0);function Ma(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Oa&&(n+=864e5),(n-(Na+6e4*(e.getTimezoneOffset()-Ra.getTimezoneOffset())))/864e5}function Fa(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Da(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=Fa(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=Fa(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Fa(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function La(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Da(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return ai(14,Ma(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ja(e,t,n,r){var a,i="",s=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return xa[n.m-1][1];case 5:return xa[n.m-1][0];default:return xa[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return Ca[n.q][0];default:return Ca[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=ya(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):ya(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?ya(a,c):""}function Ba(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var Ua=/%/g;function Ga(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Ga(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Ha=/# (\?+)( ?)\/( ?)(\d+)/;var za=/^#*0*\.([0#]+)/,Wa=/\).*[0#]/,qa=/\(###\) ###\\?-####/;function Va(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Ka(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Ya(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Xa(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Wa)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Xa("n",r,n):"("+Xa("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Ja(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Ua,""),a=t.length-r.length;return Ja(e,r,n*Math.pow(10,2*a))+Ii("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return Ga(t,n);if(36===t.charCodeAt(0))return"$"+Xa(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Aa(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Aa(n,0))&&(a=""),a.length>t.length?a:Va(t.substr(0,t.length-a.length))+a;if(i=t.match(Ha))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Ii(" ",e[1].length+1+e[4].length):ba(s,e[1].length)+e[2]+"/"+e[3]+ya(o,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+Aa(l,t.length-t.indexOf("0"));if(i=t.match(za))return a=Ka(n,i[1].length).replace(/^([^\.]+)$/,"$1."+Va(i[1])).replace(/\.$/,"."+Va(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Ii("0",Va(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+Ka(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Ba(Aa(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Xa(e,t,-n):Ba(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+ya(Ya(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Xa(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=va(Xa(e,t.replace(/[\\-]/g,""),n)),s=0,va(va(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(qa))return"("+(a=Xa(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Pa(l,Math.pow(10,s)-1,!1),a=""+c," "==(d=Ja("n",i[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],(d=wa(o[2],s)).length<i[4].length&&(d=Va(i[4].substr(i[4].length-d.length))+d),a+=d;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Pa(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?ba(o[1],s)+i[2]+"/"+i[3]+wa(o[2],s):Ii(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Aa(n,0),t.length<=a.length?a:Va(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=t.indexOf(".")-s,h=t.length-a.length-u;return Va(t.substr(0,u)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Ya(n,i[1].length),n<0?"-"+Xa(e,t,-n):Ba(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ya(0,3-e.length):"")+e})+"."+ya(s,i[1].length);switch(t){case"###,##0.00":return Xa(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var p=Ba(Aa(l,0));return"0"!==p?c+p:"";case"###,###.00":return Xa(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Xa(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Qa(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Qa(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function $a(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Wa)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?$a("n",r,n):"("+$a("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Ja(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(Ua,""),a=t.length-r.length;return Ja(e,r,n*Math.pow(10,2*a))+Ii("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return Qa(t,n);if(36===t.charCodeAt(0))return"$"+$a(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+ya(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:Va(t.substr(0,t.length-a.length))+a;if(i=t.match(Ha))return function(e,t,n){return n+(0===t?"":""+t)+Ii(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+ya(l,t.length-t.indexOf("0"));if(i=t.match(za))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+Va(i[1])).replace(/\.$/,"."+Va(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Ii("0",Va(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Ba(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):Ba(""+n)+"."+Ii("0",i[1].length);if(i=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=va($a(e,t.replace(/[\\-]/g,""),n)),s=0,va(va(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(qa))return"("+(a=$a(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Pa(l,Math.pow(10,s)-1,!1),a=""+c," "==(d=Ja("n",i[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],(d=wa(o[2],s)).length<i[4].length&&(d=Va(i[4].substr(i[4].length-d.length))+d),a+=d;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Pa(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?ba(o[1],s)+i[2]+"/"+i[3]+wa(o[2],s):Ii(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:Va(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var u=t.indexOf(".")-s,h=t.length-a.length-u;return Va(t.substr(0,u)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):Ba(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ya(0,3-e.length):"")+e})+"."+ya(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ba(""+l);return"0"!==p?c+p:"";default:if(t.match(/\.[0#?]*$/))return $a(e,t.slice(0,t.lastIndexOf(".")),n)+Va(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ja(e,t,n){return(0|n)===n?$a(e,t,n):Xa(e,t,n)}var Za=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ei(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Sa(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Za))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ti=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ni(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function ri(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(ti),o=n[1].match(ti);return ni(t,s)?[r,n[0]]:ni(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function ai(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Ea)[e])&&(r=n.table&&n.table[Ta[e]]||Ea[Ta[e]]),null==r&&(r=ka[e]||"General")}if(Sa(r,0))return La(t,n);t instanceof Date&&(t=Ma(t,n.date1904));var a=ri(r,t);if(Sa(a[1]))return La(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Sa(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c),f="("===p||")"===p?p:"t";o[o.length]={t:f,v:p},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Ia(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Ia(t,n)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"\u4e0a":var m={t:d,v:d};if(null==a&&(a=Ia(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,h="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Za)){if(null==a&&null==(a=Ia(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ei(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,v=0,y=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=ja(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(d=o[b].t)||"D"===d||(" "===d||"t"===d)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=La(t,n)}var _,A,S="";if(w.length>0){40==w.charCodeAt(0)?(_=t<0&&45===w.charCodeAt(0)?-t:t,A=Ja("n",w,_)):(A=Ja("n",w,_=t<0&&r>1?-t:t),_<0&&o[0]&&"t"==o[0].t&&(A=A.substr(1),o[0].v="-"+o[0].v)),b=A.length-1;var C=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){C=c;break}var x=o.length;if(C===o.length&&-1===A.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=A.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=A.substr(0,b+1),b=-1),o[c].t="t",x=c);b>=0&&x<o.length&&(o[x].v=A.substr(0,b+1)+o[x].v)}else if(C!==o.length&&-1===A.indexOf("E")){for(b=A.indexOf(".")-1,c=C;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===C?o[c].v.indexOf(".")-1:o[c].v.length-1,S=o[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(S=A.charAt(b--)+S);o[c].v=S,o[c].t="t",x=c}for(b>=0&&x<o.length&&(o[x].v=A.substr(0,b+1)+o[x].v),b=A.indexOf(".")+1,c=C;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===C)){for(i=o[c].v.indexOf(".")>-1&&c===C?o[c].v.indexOf(".")+1:0,S=o[c].v.substr(0,i);i<o[c].v.length;++i)b<A.length&&(S+=A.charAt(b++));o[c].v=S,o[c].t="t",x=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(_=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Ja(o[c].t,o[c].v,_),o[c].t="t");var E="";for(c=0;c!==o.length;++c)null!=o[c]&&(E+=o[c].v);return E}(a[1],t,n,a[0])}function ii(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Ea[n]){if(Ea[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Ea[t]=e,t}function si(e){for(var t=0;392!=t;++t)void 0!==e[t]&&ii(e[t],t)}function oi(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Ea=e}var li=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var ci=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],l=n[5],c=n[6],d=n[7],u=n[8],h=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=-1^n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^f[e[w++]^y>>>24]^p[e[w++]]^h[e[w++]]^u[e[w++]]^d[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=-1^n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),di=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){io(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=A(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(oa&&Buffer.isBuffer(e)?e.toString("binary"):A(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};h(d);var u,p=0;for(a=0;a<r.length;++a){var f=r[a];f!==o&&f!==o+"--"||(p++&&ce(d,r.slice(u,a),n),u=a)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,p=512,f=[],m=e.slice(0,512);io(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:p=512;break;case 4:p=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==p&&io(m=e.slice(0,p),28);var b=e.slice(0,p);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var w=m.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var _=-1,S=0;S<109&&!((_=m.read_shift(4,"i"))<0);++S)f[S]=_;var C=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,p);c(o,a,C,p,f);var x=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],l=[],c=r-1,d=0,u=0,h=0,p=0;for(d=0;d<a;++d)if(o=[],(h=d+t)>=a&&(h-=a),!s[h]){l=[];var f=[];for(u=h;u>=0;){f[u]=!0,s[u]=!0,o[o.length]=u,l.push(e[u]);var m=n[Math.floor(4*u/r)];if(r<4+(p=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+r);if(!e[m])break;if(f[u=$s(e[m],p)])break}i[h]={nodes:o,data:Es([l])}}return i}(C,i,f,p);x[i].name="!Directory",r>0&&s!==v&&(x[s].name="!MiniFAT"),x[f[0]].name="!FAT",x.fat_addrs=f,x.ssz=p;var E=[],T=[],k=[];!function(e,t,n,r,a,i,s,o){for(var c,h=0,p=r.length?2:0,f=t[e].data,m=0,g=0;m<f.length;m+=128){var y=f.slice(m,m+128);io(y,64),g=y.read_shift(2),c=ks(y,0,g-p),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=u(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=u(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,a>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=d(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=l(b,t[h].data,(t[o]||{}).data))),b.content&&io(b.content,0),i[c]=b,s.push(b)}}(i,x,C,E,r,{},T,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,l=n.length,c=[],d=[];r<l;++r)c[r]=d[r]=r,t[r]=n[r];for(;o<d.length;++o)a=e[r=d[o]].L,i=e[r].R,s=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==i&&c[i]!==i&&(c[r]=c[i])),-1!==s&&(c[s]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],d.lastIndexOf(a)<o&&d.push(a)),-1!==i&&r!=c[r]&&(c[i]=c[r],d.lastIndexOf(i)<o&&d.push(i));for(r=1;r<l;++r)c[r]===r&&(-1!==i&&c[i]!==i?c[r]=c[i]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(T,k,E),E.shift();var P={FileIndex:T,FullPaths:k};return t&&t.raw&&(P.raw={header:b,sectors:C}),P}function l(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*g,s*g+g)),a-=g,s=$s(n,4*s);return 0===i.length?oo(0):fa(i).slice(0,e.size)}function c(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var l=0;l<o&&(i=$s(s,4*l))!==v;++l)a.push(i);c($s(s,r-4),t-1,n,r,a)}}function d(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,s.push(e[l]);var d=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[d])break;l=$s(e[d],c)}return{nodes:i,data:Es([s])}}function u(e,t){return new Date(1e3*(Qs(e,t+4)/1e7*Math.pow(2,32)+Qs(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(di.find(e,"/"+t))return;var n=oo(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),p(e)}(e)}function p(e,t){h(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(s=0;s<e.FullPaths.length;++s)d[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&u.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<u.length;++s){var p=n(u[s][0]);(i=d[p])||(u.push([p,{name:r(p).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),d[p]=!0)}for(u.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<u.length;++s)e.FullPaths[s]=u[s][0],e.FileIndex[s]=u[s][1];for(s=0;s<u.length;++s){var f=e.FileIndex[s],m=e.FullPaths[s];if(f.name=r(m).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||w,0===s)f.C=u.length>1?1:-1,f.size=0,f.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<u.length&&n(e.FullPaths[c])!=m;++c);for(f.C=c>=u.length?-1:c,c=s+1;c<u.length&&n(e.FullPaths[c])!=n(m);++c);f.R=c>=u.length?-1:c,f.type=1}else n(e.FullPaths[s+1]||"")==n(m)&&(f.R=s+1),f.type=2}}}function f(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=oa&&Buffer.isBuffer(c)?c.toString("binary"):A(c),u=0,h=Math.min(1024,d.length),p=0,f=0;f<=h;++f)(p=d.charCodeAt(f))>=32&&p<128&&++u;var m=u>=4*h/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(m?le(d):oe(d))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(p(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=oo(1),o=n.compression?8:0,l=0;0;var c=0,d=0,u=0,h=0,p=e.FullPaths[0],f=p,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(f=e.FullPaths[c].slice(p.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=f){var y=u,b=oo(f.length);for(d=0;d<f.length;++d)b.write_shift(1,127&f.charCodeAt(d));b=b.slice(0,b.l),g[h]=ci.buf(m.content,0);var w=m.content;8==o&&(w=S(w)),(s=oo(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),m.mt?a(s,m.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:g[h]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),u+=s.length,r.push(s),u+=b.length,r.push(b),u+=w.length,r.push(w),8&l&&((s=oo(12)).write_shift(-4,g[h]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),u+=s.l,r.push(s)),(s=oo(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[h]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++h}return s=oo(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,u),s.write_shift(2,0),fa([fa(r),fa(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),i=oo(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,_.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,_.FATSECT);l(r[3]),l(r[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(r[6]+7>>3);511&i.l;)i.write_shift(-4,_.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&i.l;)i.write_shift(-4,_.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){u=e.FileIndex[s],0===s&&(u.start=u.size?u.start-1:v);var f=0===s&&n.root||u.name;if(d=2*(f.length+1),i.write_shift(64,f,"utf16le"),i.write_shift(2,d),i.write_shift(1,u.type),i.write_shift(1,u.color),i.write_shift(-4,u.L),i.write_shift(-4,u.R),i.write_shift(-4,u.C),u.clsid)i.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,u.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,u.start),i.write_shift(4,u.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((u=e.FileIndex[s]).size>=4096)if(i.l=u.start+1<<9,oa&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((u=e.FileIndex[s]).size>0&&u.size<4096)if(oa&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(oa)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",_={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function A(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function S(e){return m?m.deflateRawSync(e):Y(e)}var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function T(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var k="undefined"!==typeof Uint8Array,P=k?new Uint8Array(256):[],I=0;I<256;++I)P[I]=T(I);function R(e,t){var n=P[255&e];return t<=8?n>>>8-t:(n=n<<8|P[e>>8&255],t<=16?n>>>16-t:(n=n<<8|P[e>>16&255])>>>24-t)}function N(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function M(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function F(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function D(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function L(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function j(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function G(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(oa){var i=da(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(k){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function H(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function z(e,t,n){var r=1,a=0,i=0,s=0,o=0,l=e.length,c=k?new Uint16Array(32):H(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<n;++i)e[i]=0;l=e.length;var d=k?new Uint16Array(l):H(l);for(i=0;i<l;++i)c[a=e[i]]++,r<a&&(r=a),d[i]=0;for(c[0]=0,i=1;i<=r;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(d[i]=c[o+16]++);var u=0;for(i=0;i<l;++i)if(0!=(u=e[i]))for(o=R(d[i],r)>>r-u,s=(1<<r+4-u)-1;s>=0;--s)t[o|s<<u]=15&u|i<<4;return r}var W=k?new Uint16Array(512):H(512),q=k?new Uint16Array(32):H(32);if(!k){for(var V=0;V<512;++V)W[V]=0;for(V=0;V<32;++V)q[V]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);z(e,q,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);z(n,W,288)}();var K=function(){for(var e=k?new Uint8Array(32768):[],t=0,n=0;t<E.length-1;++t)for(;n<E[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=k?new Uint8Array(259):[];for(t=0,n=0;t<x.length-1;++t)for(;n<x[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=k?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=L(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=L(n,a,+!(i+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[i],d=-1,u=0;if((d=s[l=32767&(l<<5^c)])&&((d|=-32768&i)>i&&(d-=32768),d<i))for(;t[d+u]==t[i+u]&&u<250;)++u;if(u>2){(c=r[u])<=22?a=B(n,a,P[c+1]>>1)-1:(B(n,a,3),B(n,a+=5,P[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(U(n,a,u-x[c]),a+=h),c=e[i-d],a=B(n,a,P[c]>>3),a-=3;var p=c<4?0:c-2>>1;p>0&&(U(n,a,i-d-E[c]),a+=p);for(var f=0;f<u;++f)s[l]=32767&i,l=32767&(l<<5^t[i]),++i;o-=u-1}else c<=143?c+=48:a=j(n,a,1),a=B(n,a,P[c]),s[l]=32767&i,++i}a=B(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function Y(e){var t=oo(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var X=k?new Uint16Array(32768):H(32768),Q=k?new Uint16Array(32768):H(32768),$=k?new Uint16Array(128):H(128),J=1,Z=1;function ee(e,t){var n=M(e,t)+257,r=M(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=k?new Uint8Array(19):H(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=k?new Uint8Array(8):H(8),d=k?new Uint8Array(8):H(8),u=s.length,h=0;h<a;++h)s[C[h]]=i=O(e,t),l<i&&(l=i),c[i]++,t+=3;var p=0;for(c[0]=0,h=1;h<=l;++h)d[h]=p=p+c[h-1]<<1;for(h=0;h<u;++h)0!=(p=s[h])&&(o[h]=d[p]++);var f=0;for(h=0;h<u;++h)if(0!=(f=s[h])){p=P[o[h]]>>8-f;for(var m=(1<<7-f)-1;m>=0;--m)$[p|m<<f]=7&f|h<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(p=$[F(e,t)]),p>>>=3){case 16:for(i=3+N(e,t),t+=2,p=g[g.length-1];i-- >0;)g.push(p);break;case 17:for(i=3+O(e,t),t+=3;i-- >0;)g.push(0);break;case 18:for(i=11+F(e,t),t+=7;i-- >0;)g.push(0);break;default:g.push(p),l<p&&(l=p)}var v=g.slice(0,n),y=g.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)y[h]=0;return J=z(v,X,286),Z=z(y,Q,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[ca(t),2];for(var n=0,r=0,a=da(t||1<<18),i=0,s=a.length>>>0,o=0,l=0;0==(1&r);)if(r=O(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=J,l=Z);;){!t&&s<i+32767&&(s=(a=G(a,i+32767)).length);var c=D(e,n,o),d=r>>>1==1?W[c]:X[c];if(n+=15&d,0===((d>>>=4)>>>8&255))a[i++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=i+x[d];u>0&&(h+=D(e,n,u),n+=u),c=D(e,n,l),n+=15&(d=r>>>1==1?q[c]:Q[c]);var p=(d>>>=4)<4?0:d-2>>1,f=E[d];for(p>0&&(f+=D(e,n,p),n+=p),!t&&s<h&&(s=(a=G(a,h+100)).length);i<h;)a[i]=a[i-f],++i}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,m>0)for(!t&&s<i+m&&(s=(a=G(a,i+m)).length);m-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;io(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),d=n.read_shift(2),u=n.read_shift(2),p=n.read_shift(2);n.l+=8;var f=n.read_shift(4),m=i(n.slice(n.l+d,n.l+d+u));n.l+=d+u+p;var g=n.l;n.l=f+4,ae(n,l,c,r,m),n.l=g}return r}function ae(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),p="",f=0;f<u;++f)p+=String.fromCharCode(e[e.l++]);if(h){var g=i(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),d!=n&&ne(y,"Bad uncompressed size: "+n+" != "+d),de(r,p,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function oe(e){for(var t=ia(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,l=i.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(s,s+o),(s+=o)<i.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=ua(sa(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return ua(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var d=de(e,a.slice(n.length),r,{unsafe:!0});s&&(d.ctype=s)}function de(e,t,n,a){var i=a&&a.unsafe;i||h(e);var s=!i&&di.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||di.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(ga);for(i=i.replace(ma,""),o&&(i=i.replace(ga,"!")),s=0;s<n.length;++s){if((o?n[s].replace(ga,"!"):n[s]).replace(ma,"")==i)return e.FileIndex[s];if((o?r[s].replace(ga,"!"):r[s]).replace(ma,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||oa&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(ua(sa(t)),n);case"binary":return o(ua(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=f(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:A(r);case"base64":return ia("string"==typeof r?r:A(r));case"buffer":if(oa)return Buffer.isBuffer(r)?r:la(r);case"array":return"string"==typeof r?ua(r):r}return r},t.writeFile=function(t,n,r){s();var a=f(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var n=di.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var a=di.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){p(e,!0)},ReadShift:Zs,CheckField:ao,prep_blob:io,bconcat:fa,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:Y,_inflateRaw:te,consts:_},t}();let ui;function hi(e){return"string"===typeof e?ha(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function pi(e,t,n){if("undefined"!==typeof ui&&ui.writeFileSync)return n?ui.writeFileSync(e,t,n):ui.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=ha(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?$i(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([hi(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=pa(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function fi(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function mi(e,t){for(var n=[],r=fi(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function gi(e){for(var t=[],n=fi(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function vi(e){for(var t=[],n=fi(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var yi=new Date(1899,11,30,0,0,0);function bi(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(yi.getTime()+6e4*(e.getTimezoneOffset()-yi.getTimezoneOffset())))/864e5}var wi=new Date,_i=yi.getTime()+6e4*(wi.getTimezoneOffset()-yi.getTimezoneOffset()),Ai=wi.getTimezoneOffset();function Si(e){var t=new Date;return t.setTime(24*e*60*60*1e3+_i),t.getTimezoneOffset()!==Ai&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ai)),t}var Ci=new Date("2017-02-19T19:06:09.000Z"),xi=isNaN(Ci.getFullYear())?new Date("2/19/17"):Ci,Ei=2017==xi.getFullYear();function Ti(e,t){var n=new Date(e);if(Ei)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==xi.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function ki(e,t){if(oa&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return $i(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return $i(ea(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return $i(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return $i(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(i){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Pi(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Pi(e[n]));return t}function Ii(e,t){for(var n="";n.length<t;)n+=e;return n}function Ri(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var Ni=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oi(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Ni.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Mi(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=oa?la(n):function(e){for(var t=[],n=0,r=e.length+250,a=ca(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=ca(65535),r=65530)}return t.push(a.slice(0,n)),fa(t)}(n),di.utils.cfb_add(e,t,r);di.utils.cfb_add(e,t,n)}else e.file(t,n)}function Fi(){return di.utils.cfb_new()}var Di='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var Li={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ji=gi(Li),Bi=/[&<>'"]/g,Ui=/[\u0000-\u0008\u000b-\u001f]/g;function Gi(e){return(e+"").replace(Bi,function(e){return ji[e]}).replace(Ui,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Hi(e){return Gi(e).replace(/ /g,"_x0020_")}var zi=/[\u0000-\u001f]/g;function Wi(e){return(e+"").replace(Bi,function(e){return ji[e]}).replace(/\n/g,"<br/>").replace(zi,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function qi(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vi(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Ki(e){var t,n,r,a=ca(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function Yi(e){return la(e,"binary").toString("utf8")}var Xi="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Qi=oa&&(Yi(Xi)==Vi(Xi)&&Yi||Ki(Xi)==Vi(Xi)&&Ki)||Vi,$i=oa?function(e){return la(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Ji=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var Zi=/(^\s|\s$|\n)/;function es(e,t){return"<"+e+(t.match(Zi)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ts(e){return fi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ns(e,t,n){return"<"+e+(null!=n?ts(n):"")+(null!=t?(t.match(Zi)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function rs(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}var as="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",is="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",ss="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",os="http://schemas.openxmlformats.org/package/2006/content-types",ls="http://schemas.openxmlformats.org/package/2006/relationships",cs="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",ds="http://purl.org/dc/elements/1.1/",us="http://purl.org/dc/terms/",hs="http://purl.org/dc/dcmitype/",ps="http://schemas.openxmlformats.org/officeDocument/2006/relationships",fs="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",ms="http://www.w3.org/2001/XMLSchema-instance",gs="http://www.w3.org/2001/XMLSchema",vs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ys="urn:schemas-microsoft-com:office:office",bs="urn:schemas-microsoft-com:office:excel",ws="urn:schemas-microsoft-com:office:spreadsheet",_s="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",As="http://macVmlSchemaUri",Ss="urn:schemas-microsoft-com:vml",Cs="http://www.w3.org/TR/REC-html40";var xs=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Es=oa?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:la(e)})):xs(e)}:xs,Ts=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(Ys(e,a)));return r.join("").replace(ma,"")},ks=oa?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(ma,""):Ts(e,t,n)}:Ts,Ps=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},Is=oa?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Ps(e,t,n)}:Ps,Rs=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(Ks(e,a)));return r.join("")},Ns=oa?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Rs(e,t,n)}:Rs,Os=function(e,t){var n=Qs(e,t);return n>0?Ns(e,t+4,t+4+n-1):""},Ms=Os,Fs=function(e,t){var n=Qs(e,t);return n>0?Ns(e,t+4,t+4+n-1):""},Ds=Fs,Ls=function(e,t){var n=2*Qs(e,t);return n>0?Ns(e,t+4,t+4+n-1):""},js=Ls,Bs=function(e,t){var n=Qs(e,t);return n>0?ks(e,t+4,t+4+n):""},Us=Bs,Gs=function(e,t){var n=Qs(e,t);return n>0?Ns(e,t+4,t+4+n):""},Hs=Gs,zs=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},Ws=zs,qs=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Vs(){ks=function(e,t,n){return ta.utils.decode(1200,e.slice(t,n)).replace(ma,"")},Ns=function(e,t,n){return ta.utils.decode(65001,e.slice(t,n))},Ms=function(e,t){var n=Qs(e,t);return n>0?ta.utils.decode(Yr,e.slice(t+4,t+4+n-1)):""},Ds=function(e,t){var n=Qs(e,t);return n>0?ta.utils.decode(Kr,e.slice(t+4,t+4+n-1)):""},js=function(e,t){var n=2*Qs(e,t);return n>0?ta.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},Us=function(e,t){var n=Qs(e,t);return n>0?ta.utils.decode(1200,e.slice(t+4,t+4+n)):""},Hs=function(e,t){var n=Qs(e,t);return n>0?ta.utils.decode(65001,e.slice(t+4,t+4+n)):""}}oa&&(Ms=function(e,t){if(!Buffer.isBuffer(e))return Os(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Ds=function(e,t){if(!Buffer.isBuffer(e))return Fs(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},js=function(e,t){if(!Buffer.isBuffer(e))return Ls(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Us=function(e,t){if(!Buffer.isBuffer(e))return Bs(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Hs=function(e,t){if(!Buffer.isBuffer(e))return Gs(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Ws=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):zs(e,t)},qs=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ta&&Vs();var Ks=function(e,t){return e[t]},Ys=function(e,t){return 256*e[t+1]+e[t]},Xs=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Qs=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Js=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Zs(e,t){var n,r,a,i,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,oa&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Ys(this,o)),o+=2;e*=2;break;case"utf8":l=Ns(this,this.l,this.l+e);break;case"utf16le":e*=2,l=ks(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ta)return Zs.call(this,e,"dbcs");l=ta.utils.decode(Kr,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Ms(this,this.l),e=4+Qs(this,this.l);break;case"lpstr-cp":l=Ds(this,this.l),e=4+Qs(this,this.l);break;case"lpwstr":l=js(this,this.l),e=4+2*Qs(this,this.l);break;case"lpp4":e=4+Qs(this,this.l),l=Us(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Qs(this,this.l),l=Hs(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Ks(this,this.l+e++));)c.push(na(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Ys(this,this.l+e));)c.push(na(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ks(this,o),this.l=o+1,i=Zs.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(na(Ys(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ta){l=ta.utils.decode(Kr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Ks(this,o),this.l=o+1,i=Zs.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(na(Ks(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=Ks(this,this.l),this.l++,n;case 2:return n=("i"===t?Xs:Ys)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?$s:Js)(this,this.l),this.l+=4,n):(r=Qs(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?Ws(this,this.l):Ws([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Is(this,this.l,e)}}return this.l+=e,l}var eo=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},to=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},no=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function ro(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)no(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof ta&&874==Yr)for(a=0;a!=t.length;++a){var i=ta.utils.encode(Yr,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,eo(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,to(this,t,this.l)}}return this.l+=r,this}function ao(e,t){var n=Is(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function io(e,t){e.l=t,e.read_shift=Zs,e.chk=ao,e.write_shift=ro}function so(e,t){e.l+=t}function oo(e){var t=ca(e);return io(t,0),t}function lo(){var e=[],t=oa?256:2048,n=function(e){var t=oo(e);return io(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),fa(e)},_bufs:e}}function co(e,t,n,r){var a,i=+t;if(!isNaN(i)){r||(r=xu[i].p||(n||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,128+(127&i)),s.write_shift(1,i>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&qs(n)&&e.push(n)}}function uo(e,t,n){var r=Pi(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ho(e,t,n){var r=Pi(e);return r.s=uo(r.s,t.s,n),r.e=uo(r.e,t.s,n),r}function po(e,t){if(e.cRel&&e.c<0)for(e=Pi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Pi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=wo(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function fo(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?po(e.s,t.biff)+":"+po(e.e,t.biff):(e.s.rRel?"":"$")+go(e.s.r)+":"+(e.e.rRel?"":"$")+go(e.e.r):(e.s.cRel?"":"$")+yo(e.s.c)+":"+(e.e.cRel?"":"$")+yo(e.e.c)}function mo(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function go(e){return""+(e+1)}function vo(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function yo(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bo(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function wo(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function _o(e){var t=e.indexOf(":");return-1==t?{s:bo(e),e:bo(e)}:{s:bo(e.slice(0,t)),e:bo(e.slice(t+1))}}function Ao(e,t){return"undefined"===typeof t||"number"===typeof t?Ao(e.s,e.e):("string"!==typeof e&&(e=wo(e)),"string"!==typeof t&&(t=wo(t)),e==t?e:e+":"+t)}function So(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function Co(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=ai(e.z,n?bi(t):t)}catch(r){}try{return e.w=ai((e.XF||{}).numFmtId||(n?14:0),n?bi(t):t)}catch(r){return""+t}}function xo(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?sl[e.v]||e.v:Co(e,void 0==t?e.v:t))}function Eo(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function To(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?bo(r.origin):r.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=So(i["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==s&&(c.e.r=s=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if("undefined"!==typeof t[u][h]){var p={v:t[u][h]},f=s+u,m=o+h;if(c.s.r>f&&(c.s.r=f),c.s.c>m&&(c.s.c=m),c.e.r<f&&(c.e.r=f),c.e.c<m&&(c.e.c=m),!t[u][h]||"object"!==typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(p.v)&&(p.f=t[u][h][1],p.v=p.v[0]),null===p.v)if(p.f)p.t="n";else if(r.nullError)p.t="e",p.v=0;else{if(!r.sheetStubs)continue;p.t="z"}else"number"===typeof p.v?p.t="n":"boolean"===typeof p.v?p.t="b":p.v instanceof Date?(p.z=r.dateNF||Ea[14],r.cellDates?(p.t="d",p.w=ai(p.z,bi(p.v))):(p.t="n",p.v=bi(p.v),p.w=ai(p.z,p.v))):p.t="s";else p=t[u][h];if(a)i[f]||(i[f]=[]),i[f][m]&&i[f][m].z&&(p.z=i[f][m].z),i[f][m]=p;else{var g=wo({c:m,r:f});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return c.s.c<1e7&&(i["!ref"]=Ao(c)),i}function ko(e,t){return To(null,e,t)}function Po(e,t){return t||(t=oo(4)),t.write_shift(4,e),t}function Io(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Ro(e,t){var n=!1;return null==t&&(n=!0,t=oo(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function No(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Oo(e,t){var n=e.l,r=e.read_shift(1),a=Io(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(No(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var Mo=Oo;function Fo(e,t){var n=!1;return null==t&&(n=!0,t=oo(23+4*e.t.length)),t.write_shift(1,1),Ro(e.t,t),t.write_shift(4,1),function(e,t){t||(t=oo(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function Do(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Lo(e,t){return null==t&&(t=oo(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function jo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Bo(e,t){return null==t&&(t=oo(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Uo=Io,Go=Ro;function Ho(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function zo(e,t){var n=!1;return null==t&&(n=!0,t=oo(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var Wo=Io,qo=Ho,Vo=zo;function Ko(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?Ws([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):$s(t,0)>>2;return n?a/100:a}function Yo(e,t){null==t&&(t=oo(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function Xo(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Qo=Xo,$o=function(e,t){return t||(t=oo(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Jo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zo(e,t){return(t||oo(8)).write_shift(8,e,"f")}function el(e,t){if(t||(t=oo(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var tl=80,nl={1:{n:"CodePage",t:2},2:{n:"Category",t:tl},3:{n:"PresentationFormat",t:tl},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:tl},15:{n:"Company",t:tl},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:tl},27:{n:"ContentStatus",t:tl},28:{n:"Language",t:tl},29:{n:"Version",t:tl},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},rl={1:{n:"CodePage",t:2},2:{n:"Title",t:tl},3:{n:"Subject",t:tl},4:{n:"Author",t:tl},5:{n:"Keywords",t:tl},6:{n:"Comments",t:tl},7:{n:"Template",t:tl},8:{n:"LastAuthor",t:tl},9:{n:"RevNumber",t:tl},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:tl},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function al(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var il=Pi(al([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),sl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ol={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ll={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cl(e,t){var n,r=function(e){for(var t=[],n=fi(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(ol),a=[];a[a.length]=Di,a[a.length]=ns("Types",null,{xmlns:os,"xmlns:xsd":gs,"xmlns:xsi":ms}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return ns("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=ns("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:ll[r][t.bookType]||ll[r].xlsx}))},s=function(n){(e[n]||[]).forEach(function(e){a[a.length]=ns("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ll[n][t.bookType]||ll[n].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=ns("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var dl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ul(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function hl(e){var t=[Di,ns("Relationships",null,{xmlns:ls})];return fi(e["!id"]).forEach(function(n){t[t.length]=ns("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function pl(e,t,n,r,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,i?a.TargetMode=i:[dl.HLINK,dl.XPATH,dl.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function fl(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function ml(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function gl(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Vr.version+"</meta:generator></office:meta></office:document-meta>"}var vl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function yl(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=Gi(t),r[r.length]=n?ns(e,t,n):es(e,t))}function bl(e,t){var n=t||{},r=[Di,ns("cp:coreProperties",null,{"xmlns:cp":as,"xmlns:dc":ds,"xmlns:dcterms":us,"xmlns:dcmitype":hs,"xmlns:xsi":ms})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&yl("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:rs(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&yl("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:rs(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=vl.length;++i){var s=vl[i],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&yl(s[0],o,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var wl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_l=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Al(e){var t=[],n=ns;return e||(e={}),e.Application="SheetJS",t[t.length]=Di,t[t.length]=ns("Properties",null,{xmlns:ss,"xmlns:vt":fs}),wl.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=Gi(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Gi(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Sl(e){var t=[Di,ns("Properties",null,{xmlns:is,"xmlns:vt":fs})];if(!e)return t.join("");var n=1;return fi(e).forEach(function(r){++n,t[t.length]=ns("property",function(e,t){switch(typeof e){case"string":var n=ns("vt:lpwstr",Gi(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return ns((0|e)==e?"vt:i4":"vt:r8",Gi(String(e)));case"boolean":return ns("vt:bool",e?"true":"false")}if(e instanceof Date)return ns("vt:filetime",rs(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Gi(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xl(e,t){var n=oo(4),r=oo(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=oo(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var i=oo(8);return i.write_shift(4,n),i.write_shift(4,r),i}(t);break;case 31:case 80:for((r=oo(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return fa([n,r])}var El=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Tl(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function kl(e,t,n){var r=oo(8),a=[],i=[],s=8,o=0,l=oo(8),c=oo(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){(c=oo(8)).write_shift(4,0),a.unshift(c);var d=[oo(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=oo(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=fa(d),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(El.indexOf(e[o][0])>-1||_l.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],p=0;if(t){var f=n[p=+t[e[o][0]]];if("version"==f.p&&"string"==typeof h){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}l=xl(f.t,h)}else{var g=Tl(h);-1==g&&(g=31,h=String(h)),l=xl(g,h)}i.push(l),(c=oo(8)).write_shift(4,t?p:2+o),a.push(c),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return r.write_shift(4,s),r.write_shift(4,i.length),fa([r].concat(a).concat(i))}function Pl(e,t,n,r,a,i){var s=oo(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,di.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=kl(e,n,r);if(o.push(l),a){var c=kl(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return fa(o)}function Il(e,t){return 1===e.read_shift(t)}function Rl(e,t){return t||(t=oo(2)),t.write_shift(2,+!!e),t}function Nl(e){return e.read_shift(2,"u")}function Ol(e,t){return t||(t=oo(2)),t.write_shift(2,e),t}function Ml(e,t,n){return n||(n=oo(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function Fl(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=Kr;(n&&n.biff>=8&&(Kr=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return Kr=i,s}function Dl(e){var t=e.t||"",n=oo(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=oo(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),fa([n,r])}function Ll(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function jl(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Ll(e,r,n)}function Bl(e,t,n){if(n.biff>5)return jl(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ul(e,t,n){return n||(n=oo(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Gl(e,t){t||(t=oo(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Hl(e){var t=oo(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==i)Gl(r=r.slice(1),t);else if(2&i){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var o=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&i&&Gl(a>-1?r.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function zl(e,t,n,r){return r||(r=oo(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function Wl(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function ql(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function Vl(e,t){return t||(t=oo(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Kl(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var i=oo(a);return i.write_shift(2,r),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Yl(e,t){var n=!t||t.biff>=8?2:1,r=oo(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function Xl(e,t,n,r){var a=n&&5==n.biff;r||(r=oo(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return null==i.l&&(i.l=i.length),i}function Ql(e,t,n,r){var a=n&&5==n.biff;r||(r=oo(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function $l(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Fl(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(Wl(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function Jl(e){var t=oo(24),n=bo(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return fa([t,Hl(e[1])])}function Zl(e){var t=e[1].Tooltip,n=oo(10+2*(t.length+1));n.write_shift(2,2048);var r=bo(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function ec(e,t,n){if(!n.cellStyles)return so(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var tc=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=gi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=ko(function(t,n){var r=[],a=ca(1);switch(n.type){case"base64":a=ua(sa(t));break;case"binary":a=ua(t);break;case"buffer":case"array":a=t}io(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,d=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(d=a.read_shift(2));var u=a.read_shift(2),h=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var p=[],f={},m=Math.min(a.length,2==i?521:d-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((f={}).name=ta.utils.decode(h,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,f.type=String.fromCharCode(a.read_shift(1)),2==i||l||(f.offset=a.read_shift(4)),f.len=a.read_shift(1),2==i&&(f.offset=a.read_shift(2)),f.dec=a.read_shift(1),f.name.length&&p.push(f),2!=i&&(a.l+=l?13:14),f.type){case"B":o&&8==f.len||!n.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==a[a.l]&&(a.l=d-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=d;var v=0,y=0;for(r[0]=[],y=0;y!=p.length;++y)r[0][y]=p[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=p.length;++y){var b=a.slice(a.l,a.l+p[y].len);a.l+=p[y].len,io(b,0);var w=ta.utils.decode(h,b);switch(p[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==p[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=p[y].len;break;case"0":if("_NullFlags"===p[y].name)break;default:throw new Error("DBF Unsupported data type "+p[y].type)}}else a.l+=u;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=p,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Eo(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&Jr(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=lo(),s=_h(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,p=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++h;else if(null!=o[d]){if(++h,"number"===typeof o[d]&&(o[d]=o[d].toString(10)),"string"!==typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}var f=So(e["!ref"]),m=[],g=[],v=[];for(d=0;d<=f.e.c-f.s.c;++d){var y="",b="",w=0,_=[];for(u=0;u<l.length;++u)null!=l[u][d]&&_.push(l[u][d]);if(0!=_.length&&null!=o[d]){for(u=0;u<_.length;++u){switch(typeof _[u]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=_[u]instanceof Date?"D":"C"}w=Math.max(w,String(_[u]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>w&&(w=c[d].DBF.len),"B"==y&&"N"==b&&(y="N",v[d]=c[d].DBF.dec,w=c[d].DBF.len),g[d]="C"==y||"N"==b?w:r[y]||0,p+=g[d],m[d]=y}else m[d]="?"}var A=i.next(32);for(A.write_shift(4,318902576),A.write_shift(4,l.length),A.write_shift(2,296+32*h),A.write_shift(2,p),d=0;d<4;++d)A.write_shift(4,0);for(A.write_shift(4,(+t[Yr]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var S=i.next(32),C=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,C,"sbcs"),S.write_shift(1,"?"==m[d]?"C":m[d],"sbcs"),S.write_shift(4,u),S.write_shift(1,g[d]||r[m[d]]||0),S.write_shift(1,v[d]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),u+=g[d]||r[m[d]]||0}var x=i.next(264);for(x.write_shift(4,13),d=0;d<65;++d)x.write_shift(4,0);for(d=0;d<l.length;++d){var E=i.next(p);for(E.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(m[u]){case"L":E.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":E.write_shift(8,l[d][u]||0,"f");break;case"N":var T="0";for("number"==typeof l[d][u]&&(T=l[d][u].toFixed(v[u]||0)),h=0;h<g[u]-T.length;++h)E.write_shift(1,32);E.write_shift(1,T,"sbcs");break;case"D":l[d][u]?(E.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var k=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(E.write_shift(1,k,"sbcs"),h=0;h<g[u]-k.length;++h)E.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),nc=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+fi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?ra(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:ra(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],p=null,f={},m=[],g=[],v=[],y=0;for(+a.codepage>=0&&Jr(+a.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),_=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),A=_[0];if(w.length>0)switch(A){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==_[1].charAt(0)&&h.push(w.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,C=!1,x=!1,E=!1,T=-1,k=-1;for(d=1;d<_.length;++d)switch(_[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(_[d].slice(1))-1,C=!0;break;case"Y":for(o=parseInt(_[d].slice(1))-1,C||(l=0),i=u.length;i<=o;++i)u[i]=[];break;case"K":'"'===(b=_[d].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Ri(b))?isNaN(Oi(b).getDate())||(b=Ti(b)):(b=Ri(b),null!==p&&ei(p)&&(b=Si(b))),"undefined"!==typeof ta&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=ta.utils.decode(a.codepage,b)),S=!0;break;case"E":E=!0;var P=Kc(_[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],P];break;case"S":x=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":T=parseInt(_[d].slice(1))-1;break;case"C":k=parseInt(_[d].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(S&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=b:u[o][l]=b,p=null),x){if(E)throw new Error("SYLK shared formula cannot have own formula");var I=T>-1&&u[T][k];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Qc(I[1],{r:o-T,c:l-k})}break;case"F":var R=0;for(d=1;d<_.length;++d)switch(_[d].charAt(0)){case"X":l=parseInt(_[d].slice(1))-1,++R;break;case"Y":for(o=parseInt(_[d].slice(1))-1,i=u.length;i<=o;++i)u[i]=[];break;case"M":y=parseInt(_[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":p=h[parseInt(_[d].slice(1))];break;case"W":for(v=_[d].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),g[i-1]=0===y?{hidden:!0}:{wch:y},bc(g[i-1]);break;case"C":g[l=parseInt(_[d].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(_[d].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=Ac(y)):0===y&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}R<1&&(p=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(f["!rows"]=m),g.length>0&&(f["!cols"]=g),a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),[u,f]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(sa(e),t);case"binary":return a(e,t);case"buffer":return a(oa&&Buffer.isBuffer(e)?e.toString("binary"):pa(e),t);case"array":return a(ki(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=ko(r,t);return fi(i).forEach(function(e){s[e]=i[e]}),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Xc(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Eo(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=So(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=gc(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=vc(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*_c(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var u=o.s.c;u<=o.e.c;++u){var h=wo({r:d,c:u});(n=l?(e[d]||[])[u]:e[h])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,d,u))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),rc=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),l=o[0],c=o[1],d=n[++i]||"";1&(d.match(/["]/g)||[]).length&&i<n.length-1;)d+="\n"+n[++i];switch(d=d.trim(),+l){case-1:if("BOT"===d){s[++r]=[],a=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?s[r][a]=!0:"FALSE"===d?s[r][a]=!1:isNaN(Ri(c))?isNaN(Oi(c).getDate())?s[r][a]=c:s[r][a]=Ti(c):s[r][a]=Ri(c),++a;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),s[r][a++]=""!==d?d:null}if("EOD"===d)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return ko(function(t,n){switch(n.type){case"base64":return e(sa(t),n);case"binary":return e(t,n);case"buffer":return e(oa&&Buffer.isBuffer(t)?t.toString("binary"):pa(t),n);case"array":return e(ki(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=So(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=wo({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var d=r.w;d||null==r.v||(d=r.v),null==d?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,d,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=ai(r.z||Ea[14],bi(Ti(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,n){return Eo(t(e,n),n)},to_sheet:t,from_sheet:n}}(),ac=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return ko(function(t,n){for(var r=t.split("\n"),a=-1,i=-1,s=0,o=[];s!==r.length;++s){var l=r[s].trim().split(":");if("cell"===l[0]){var c=bo(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,i=c.c,l[2]){case"t":o[a][i]=e(l[3]);break;case"v":o[a][i]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[a][i]=!!+l[4]:o[a][i]=+l[4],"vtf"==l[2]&&(o[a][i]=[o[a][i],d])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],i="",s=_o(e["!ref"]),o=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(i=wo({r:l,c:c}),(n=o?(e[l]||[])[c]:e[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var d=bi(Ti(n.v));a[2]="vtc",a[3]="nd",a[4]=""+d,a[5]=n.w||ai(n.z||Ea[14],d);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return Eo(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,i,a,o(e),s].join("\n")}}}(),ic=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Ri(e))?isNaN(Oi(e).getDate())?t[n][r]=e:t[n][r]=Ti(e):t[n][r]=Ri(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,h=a.charCodeAt(0),p=!1,f=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?Ea[e]:e;return t=t.replace(li,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(d,u),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Ri(t)))if(!isNaN(Oi(t).getDate())||g&&t.match(g)){r.z=n.dateNF||Ea[14];var a=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(li)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":i=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==i?d:c+"T"+d}(0,n.dateNF,t.match(g)||[]),a=1),n.cellDates?(r.t="d",r.v=Ti(t,a)):(r.t="n",r.v=bi(Ti(t,a))),!1!==n.cellText&&(r.w=ai(r.z,r.v instanceof Date?bi(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][l]=r):i[wo({c:l,r:o})]=r),d=u+1,m=e.charCodeAt(d),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),f==h)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(f=e.charCodeAt(u)){case 34:34===m&&(p=!p);break;case h:case 10:case 13:if(!p&&v())break e}return u-d>0&&v(),i["!ref"]=Ao(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):ko(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){a[c]=[];var d=0;for(e(i[c].slice(0,o).trim(),a,c,d,r),d=1;d<=(i[c].length-o)/10+1;++d)e(i[c].slice(o+10*(d-1),o+10*d).trim(),a,c,d,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:fh(e,t);switch(t.type){case"base64":n=sa(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ta?ta.utils.decode(t.codepage,e):oa&&Buffer.isBuffer(e)?e.toString("binary"):pa(e);break;case"array":n=ki(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Qi(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Qi(n):"binary"==t.type&&"undefined"!==typeof ta&&t.codepage&&(n=ta.utils.decode(t.codepage,ta.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?ac.to_sheet("string"==t.type?n:Qi(n),t):i(n,t)}return{to_workbook:function(e,t){return Eo(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=So(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=wo({r:i,c:o});if((t=a?(e[i]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(xo(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var sc=function(){function e(e,t,n){if(e){io(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,l=i.f&&i.f(e,s,n);if(e.l=o,t(l,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",s="",o=0,l={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:u=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Ea[14],r.cellDates&&(e[1].t="d",e[1].v=Si(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=Ao(u),l[i]=a,c.push(i),a=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var d=r.dense?(a[e[0].r]||[])[e[0].c]:a[wo(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[wo(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Ao(u),l[i]=a,c.push(i),a=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[wo(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(i=e[1])}},r)}if(a["!ref"]=Ao(u),l[s||i]=a,c.push(s||i),!d.length)return{SheetNames:c,Sheets:l};for(var p={},f=[],m=0;m<d.length;++m)l[c[m]]?(f.push(d[m]||c[m]),p[d[m]]=l[d[m]]||l[c[m]]):(f.push(d[m]),p[d[m]]={"!ref":"A1"});return{SheetNames:f,Sheets:p}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=oo(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=oo(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=oo(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?yo(t):go(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,n,r){var a=oo(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function h(e,t){var n=d(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function p(e,t,n,r){var a=oo(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,l=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),o+=16383+(s?32768:0),a.write_shift(2,o),a}function f(e,t){var n=d(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=oo(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Nl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){io(e,0);var n=[],r=0,a="",i="",s="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),p=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(h+p+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var f="";u=e[e.l++];)f+=String.fromCharCode(u);n.push('"'+f.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:d=n.pop(),s=n.pop(),n.push(["AND","OR"][u-20]+"("+s+","+d+")");break;default:if(u<32&&c[u])d=n.pop(),s=n.pop(),n.push(s+c[u]+d);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(r=l[u][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[u][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=d(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=d(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=d(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:f},40:{n:"FORMULA28",f:function(e,t){var n=f(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&Jr(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=lo(),o=So(e["!ref"]),l=Array.isArray(e),c=[];Eu(r,0,function(e){var t=oo(2);return t.write_shift(2,e),t}(1030)),Eu(r,6,function(e){var t=oo(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var d=Math.min(o.e.r,8191),u=o.s.r;u<=d;++u)for(var h=go(u),p=o.s.c;p<=o.e.c;++p){u===o.s.r&&(c[p]=yo(p));var f=c[p]+h,m=l?(e[u]||[])[p]:e[f];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?Eu(r,13,i(u,p,m.v)):Eu(r,14,s(u,p,m.v));else Eu(r,15,a(u,p,xo(m).slice(0,239)))}return Eu(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&Jr(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=lo();Eu(r,0,function(e){var t=oo(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var l=_o(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&Eu(r,27,g(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=So(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),f=l.s.r;f<=h;++f)for(var m=go(f),v=l.s.c;v<=l.e.c;++v){f===l.s.r&&(d[v]=yo(v));var y=d[v]+m,b=c?(o[f]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)Eu(r,23,p(f,v,s,b.v));else Eu(r,22,u(f,v,s,xo(b).slice(0,239)))}++s}}return Eu(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(ua(sa(e)),n);case"binary":return t(ua(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var oc=/^\s|\s$|[\t\n\r]/;function lc(e,t){if(!t.bookSST)return"";var n=[Di];n[n.length]=ns("sst",null,{xmlns:vs[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(oc)&&(i+=' xml:space="preserve"'),i+=">"+Gi(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var cc=function(e,t){var n=!1;return null==t&&(n=!0,t=oo(15+4*e.t.length)),t.write_shift(1,0),Ro(e.t,t),n?t.slice(0,t.l):t};function dc(e){var t=lo();co(t,159,function(e,t){return t||(t=oo(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)co(t,19,cc(e[n]));return co(t,160),t.end()}function uc(e){if("undefined"!==typeof ta)return ta.utils.encode(Yr,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function hc(e){var t,n,r=0,a=uc(e),i=a.length+1;for((t=ca(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var pc=function(){function e(e,n){switch(n.type){case"base64":return t(sa(e),n);case"binary":return t(e,n);case"buffer":return t(oa&&Buffer.isBuffer(e)?e.toString("binary"):pa(e),n);case"array":return t(ki(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,i.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[wo({r:t,c:o})]=c}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)}),n["!ref"]=Ao(a),n}return{to_workbook:function(t,n){return Eo(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=So(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=wo({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(xo(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function fc(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var mc=6;function gc(e){return Math.floor((e+Math.round(128/mc)/256)*mc)}function vc(e){return Math.floor((e-5)/mc*100+.5)/100}function yc(e){return Math.round((e*mc+5)/mc*256)/256}function bc(e){e.width?(e.wpx=gc(e.width),e.wch=vc(e.wpx),e.MDW=mc):e.wpx?(e.wch=vc(e.wpx),e.width=yc(e.wch),e.MDW=mc):"number"==typeof e.wch&&(e.width=yc(e.wch),e.wpx=gc(e.width),e.MDW=mc),e.customWidth&&delete e.customWidth}var wc=96;function _c(e){return 96*e/wc}function Ac(e){return e*wc/96}function Sc(e,t){var n,r=[Di,ns("styleSheet",null,{xmlns:vs[0],"xmlns:vt":fs})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=ns("numFmt",null,{numFmtId:r,formatCode:Gi(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=ns("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=ns("cellXfs",null),e.forEach(function(e){t[t.length]=ns("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=ns("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Cc(e,t,n){n||(n=oo(6+4*t.length)),n.write_shift(2,e),Ro(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function xc(e,t){t||(t=oo(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=oo(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),el(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),Ro(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Ec,Tc=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],kc=so;function Pc(e,t){t||(t=oo(84)),Ec||(Ec=gi(Tc));var n=Ec[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(el({auto:1},t),el({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ic(e,t,n){n||(n=oo(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Rc(e,t){return t||(t=oo(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Nc=so;function Oc(e){var t;co(e,613,Po(1)),co(e,46,(t||(t=oo(51)),t.write_shift(1,0),Rc(0,t),Rc(0,t),Rc(0,t),Rc(0,t),Rc(0,t),t.length>t.l?t.slice(0,t.l):t)),co(e,614)}function Mc(e){var t,n;co(e,619,Po(1)),co(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=oo(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),zo(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),co(e,620)}function Fc(e){co(e,508,function(e,t,n){var r=oo(2052);return r.write_shift(4,e),zo(t,r),zo(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),co(e,509)}function Dc(e,t){var n=lo();return co(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(co(e,615,Po(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&co(e,44,Cc(r,t[r]))}),co(e,616))}}(n,e.SSF),function(e){co(e,611,Po(1)),co(e,43,xc({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),co(e,612)}(n),function(e){co(e,603,Po(2)),co(e,45,Pc({patternType:"none"})),co(e,45,Pc({patternType:"gray125"})),co(e,604)}(n),Oc(n),function(e){co(e,626,Po(1)),co(e,47,Ic({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),co(e,627)}(n),function(e,t){co(e,617,Po(t.length)),t.forEach(function(t){co(e,47,Ic(t,0))}),co(e,618)}(n,t.cellXfs),Mc(n),function(e){co(e,505,Po(0)),co(e,506)}(n),Fc(n),co(n,279),n.end()}function Lc(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Di];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function jc(){var e=lo();return co(e,332),co(e,334,Po(1)),co(e,335,function(e){var t=oo(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ro(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),co(e,336),co(e,339,function(e,t){var n=oo(8+2*t.length);return n.write_shift(4,e),Ro(t,n),n.slice(0,n.l)}(1,"XLDAPR")),co(e,52),co(e,35,Po(514)),co(e,4096,Po(0)),co(e,4097,Ol(1)),co(e,36),co(e,53),co(e,340),co(e,337,function(e,t){var n=oo(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),co(e,51,function(e){var t=oo(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),co(e,338),co(e,333),e.end()}function Bc(){var e=[Di];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Uc=1024;function Gc(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[ns("xml",null,{"xmlns:v":Ss,"xmlns:o":ys,"xmlns:x":bs,"xmlns:mv":As}).replace(/\/>/,">"),ns("o:shapelayout",ns("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ns("v:shapetype",[ns("v:stroke",null,{joinstyle:"miter"}),ns("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Uc<1e3*e;)Uc+=1e3;return t.forEach(function(e){var t=bo(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?ns("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=ns("v:fill",r,n);++Uc,a=a.concat(["<v:shape"+ts({id:"_x0000_s"+Uc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,ns("v:shadow",null,{on:"t",obscured:"t"}),ns("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",es("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),es("x:AutoFill","False"),es("x:Row",String(t.r)),es("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Hc(e){var t=[Di,ns("comments",null,{xmlns:vs[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=Gi(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(Gi(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(es("t",Gi(a[0]||"")));else{for(var i="Comment:\n    "+a[0]+"\n",s=1;s<a.length;++s)i+="Reply:\n    "+a[s]+"\n";t.push(es("t",Gi(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function zc(e,t,n){var r=[Di,ns("ThreadedComments",null,{xmlns:cs}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(i,s){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?a=o.id:o.parentId=a,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),r.push(ns("threadedComment",es("text",i.t||""),o))}else delete i.ID})}),r.push("</ThreadedComments>"),r.join("")}var Wc=Io;function qc(e){var t=lo(),n=[];return co(t,628),co(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),co(t,632,function(e){return Ro(e.slice(0,54))}(e.a)))})}),co(t,631),co(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:bo(e[0]),e:bo(e[0])};co(t,635,function(e,t){return null==t&&(t=oo(36)),t.write_shift(4,e[1].iauthor),$o(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&co(t,637,Fo(r)),co(t,636),delete r.iauthor})}),co(t,634),co(t,629),t.end()}var Vc=["xlsb","xlsm","xlam","biff8","xla"];var Kc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,s?o+=t.r:--o,n+(i?"":"$")+yo(l)+(s?"":"$")+go(o)}return function(r,a){return t=a,r.replace(e,n)}}(),Yc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xc=function(){return function(e,t){return e.replace(Yc,function(e,n,r,a,i,s){var o=vo(a)-(r?0:t.c),l=mo(s)-(i?0:t.r);return n+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function Qc(e,t){return e.replace(Yc,function(e,n,r,a,i,s){return n+("$"==r?r+a:yo(vo(a)+t.c))+("$"==i?i+s:go(mo(s)+t.r))})}function $c(e){e.l+=1}function Jc(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function Zc(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return ed(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=Jc(e,2),o=Jc(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ed(e){var t=Jc(e,2),n=Jc(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function td(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=Jc(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=Jc(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function nd(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function rd(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function ad(e){return[e.read_shift(1),e.read_shift(1)]}function id(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Il(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=sl[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Jo(e);break;case 2:n[1]=Bl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function sd(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?Qo:ql)(e,8));return a}function od(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=id(e,n.biff);return s}function ld(e,t,n){return e.l+=2,[nd(e)]}function cd(e){return e.l+=6,[]}function dd(e){return e.l+=2,[Nl(e),1&e.read_shift(2)]}var ud=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var hd={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:so},3:{n:"PtgAdd",f:$c},4:{n:"PtgSub",f:$c},5:{n:"PtgMul",f:$c},6:{n:"PtgDiv",f:$c},7:{n:"PtgPower",f:$c},8:{n:"PtgConcat",f:$c},9:{n:"PtgLt",f:$c},10:{n:"PtgLe",f:$c},11:{n:"PtgEq",f:$c},12:{n:"PtgGe",f:$c},13:{n:"PtgGt",f:$c},14:{n:"PtgNe",f:$c},15:{n:"PtgIsect",f:$c},16:{n:"PtgUnion",f:$c},17:{n:"PtgRange",f:$c},18:{n:"PtgUplus",f:$c},19:{n:"PtgUminus",f:$c},20:{n:"PtgPercent",f:$c},21:{n:"PtgParen",f:$c},22:{n:"PtgMissArg",f:$c},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Fl(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,sl[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Jo(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[Rd[a],Id[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?Id:Pd)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,td(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,Zc(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:so},40:{n:"PtgMemNoMem",f:so},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return ed(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=Jc(e,2),s=Jc(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,td(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,Zc(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},pd={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fd={1:{n:"PtgElfLel",f:dd},2:{n:"PtgElfRw",f:ld},3:{n:"PtgElfCol",f:ld},6:{n:"PtgElfRwV",f:ld},7:{n:"PtgElfColV",f:ld},10:{n:"PtgElfRadical",f:ld},11:{n:"PtgElfRadicalS",f:cd},13:{n:"PtgElfColS",f:cd},15:{n:"PtgElfColSV",f:cd},16:{n:"PtgElfRadicalLel",f:dd},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:ud[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},md={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:rd},33:{n:"PtgAttrBaxcel",f:rd},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),ad(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),ad(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function gd(e,t,n,r){if(r.biff<8)return so(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=od(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=sd(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(so(e,t)),i}function vd(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=hd[a]||hd[pd[a]],24!==a&&25!==a||(r=(24===a?fd:md)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):so(e,t);return s}function yd(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var bd={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wd(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function _d(e,t,n){var r=wd(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function Ad(e,t,n,r,a){var i,s,o,l,c=a&&a.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,p=0,f="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=u.pop(),s=u.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Ii(" ",e[0][m][1][1]);break;case 1:g=Ii("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}u.push(s+bd[b[0]]+i);break;case"PtgIsect":i=u.pop(),s=u.pop(),u.push(s+" "+i);break;case"PtgUnion":i=u.pop(),s=u.pop(),u.push(s+","+i);break;case"PtgRange":i=u.pop(),s=u.pop(),u.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=uo(b[1][1],d,a),u.push(po(o,c));break;case"PtgRefN":o=n?uo(b[1][1],n,a):b[1][1],u.push(po(o,c));break;case"PtgRef3d":h=b[1][1],o=uo(b[1][2],d,a);f=_d(r,h,a);u.push(f+"!"+po(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],_=b[1][1];w||(w=0);var A=0==(w&=127)?[]:u.slice(-w);u.length-=w,"User"===_&&(_=A.shift()),u.push(_+"("+A.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=ho(b[1][1],n?{s:n}:d,a),u.push(fo(l,a));break;case"PtgArea":l=ho(b[1][1],d,a),u.push(fo(l,a));break;case"PtgArea3d":h=b[1][1],l=b[1][2],f=_d(r,h,a),u.push(f+"!"+fo(l,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":p=b[1][2];var S=(r.names||[])[p-1]||(r[0]||[])[p],C=S?S.Name:"SH33TJSNAME"+String(p);C&&"_xlfn."==C.slice(0,6)&&!a.xlfn&&(C=C.slice(6)),u.push(C);break;case"PtgNameX":var x,E=b[1][1];if(p=b[1][2],!(a.biff<=5)){var T="";if(14849==((r[E]||[])[0]||[])[0]||(1025==((r[E]||[])[0]||[])[0]?r[E][p]&&r[E][p].itab>0&&(T=r.SheetNames[r[E][p].itab-1]+"!"):T=r.SheetNames[p-1]+"!"),r[E]&&r[E][p])T+=r[E][p].Name;else if(r[0]&&r[0][p])T+=r[0][p].Name;else{var k=(wd(r,E,a)||"").split(";;");k[p-1]?T=k[p-1]:T+="SH33TJSERRX"}u.push(T);break}E<0&&(E=-E),r[E]&&(x=r[E][p]),x||(x={Name:"SH33TJSERRY"}),u.push(x.Name);break;case"PtgParen":var P="(",I=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:P=Ii(" ",e[0][m][1][1])+P;break;case 3:P=Ii("\r",e[0][m][1][1])+P;break;case 4:I=Ii(" ",e[0][m][1][1])+I;break;case 5:I=Ii("\r",e[0][m][1][1])+I;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}u.push(P+u.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[wo(o)]){var N=r.sharedf[wo(o)];u.push(Ad(N,d,R,r,a))}else{var O=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){u.push(Ad(s[1],d,R,r,a)),O=!0;break}O||u.push(b[1])}break;case"PtgArray":u.push("{"+yd(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var M=!0;switch((b=e[0][m])[1][0]){case 4:M=!1;case 0:g=Ii(" ",b[1][1]);break;case 5:M=!1;case 1:g=Ii("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((M?g:"")+u.pop()+(M?"":g)),m=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function Sd(e,t,n,r,a){var i=zl(t,n,a),s=function(e){if(null==e){var t=oo(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Zo("number"==typeof e?e:0)}(e.v),o=oo(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=oo(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return fa([i,s,o,l])}function Cd(e,t,n){var r=e.read_shift(4),a=vd(e,r,n),i=e.read_shift(4);return[a,i>0?gd(e,i,a,n):null]}var xd=Cd,Ed=Cd,Td=Cd,kd=Cd,Pd={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Id={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Rd={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Nd(e){return("of:="+e.replace(Yc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Od(e){return e.replace(/\./,"!")}var Md="undefined"!==typeof Map;function Fd(e,t,n){var r=0,a=e.length;if(n){if(Md?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var i=Md?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(Md?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function Dd(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(mc=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=vc(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=yc(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function Ld(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function jd(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,i=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){ii(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=i;++a)if(e[a].numFmtId===r)return a;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Bd(e,t,n){if(e&&e["!ref"]){var r=So(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var Ud=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Gd=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Hd(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",i=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=sl[e.v];break;case"d":r&&r.cellDates?a=Ti(e.v,-1).toISOString():((e=Pi(e)).t="n",a=""+(e.v=bi(Ti(e.v)))),"undefined"===typeof e.z&&(e.z=Ea[14]);break;default:a=e.v}var o=es("v",Gi(a)),l={r:t},c=jd(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=es("v",""+Fd(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=s),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ns("f",Gi(e.f),d)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),ns("c",o,l)}function zd(e,t,n,r){var a,i=[Di,ns("worksheet",null,{xmlns:vs[0],"xmlns:r":ps})],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",d=So(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Ao(d)}r||(r={}),l["!comments"]=[];var u=[];!function(e,t,n,r,a){var i=!1,s={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(d){}i=!0,s.codeName=$i(Gi(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ns("outlinePr",null,c)}(i||o)&&(a[a.length]=ns("sheetPr",o,s))}(l,n,e,t,i),i[i.length]=ns("dimension",null,{ref:c}),i[i.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ns("sheetViews",ns("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(i[i.length]=ns("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ns("col",null,Dd(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,a=[],i=[],s=So(e["!ref"]),o="",l="",c=[],d=0,u=0,h=e["!rows"],p=Array.isArray(e),f={r:l},m=-1;for(u=s.s.c;u<=s.e.c;++u)c[u]=yo(u);for(d=s.s.r;d<=s.e.r;++d){for(i=[],l=go(d),u=s.s.c;u<=s.e.c;++u){n=c[u]+l;var g=p?(e[d]||[])[u]:e[n];void 0!==g&&null!=(o=Hd(g,n,e,t))&&i.push(o)}(i.length>0||h&&h[d])&&(f={r:l},h&&h[d]&&((r=h[d]).hidden&&(f.hidden=1),m=-1,r.hpx?m=_c(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(f.ht=m,f.customHeight=1),r.level&&(f.outlineLevel=r.level)),a[a.length]=ns("row",i.join(""),f))}if(h)for(;d<h.length;++d)h&&h[d]&&(f={r:d+1},(r=h[d]).hidden&&(f.hidden=1),m=-1,r.hpx?m=_c(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(f.ht=m,f.customHeight=1),r.level&&(f.outlineLevel=r.level),a[a.length]=ns("row","",f));return a.join("")}(l,t,0,0),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return Ud.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),Gd.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=hc(e.password).toString(16).toUpperCase()),ns("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:Ao(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,s=_o(a);s.s.r==s.e.r&&(s.e.r=_o(t["!ref"]).e.r,a=Ao(s));for(var o=0;o<i.length;++o){var l=i[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),ns("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Ao(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,p,f=-1,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=pl(r,-1,Gi(e[1].Target).replace(/#.*$/,""),dl.HLINK),h["r:id"]="rId"+m),(f=e[1].Target.indexOf("#"))>-1&&(h.location=Gi(e[1].Target.slice(f+1))),e[1].Tooltip&&(h.tooltip=Gi(e[1].Tooltip)),i[i.length]=ns("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(Ld(p=l["!margins"]),ns("pageMargins",null,p))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(i[i.length]=es("ignoredErrors",ns("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(m=pl(r,-1,"../drawings/drawing"+(e+1)+".xml",dl.DRAW),i[i.length]=ns("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=u),l["!comments"].length>0&&(m=pl(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dl.VML),i[i.length]=ns("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Wd(e,t,n,r){var a=function(e,t,n){var r=oo(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;a.hpx?i=20*_c(a.hpx):a.hpt&&(i=20*a.hpt),r.write_shift(2,i),r.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,p=d<<10;p<d+1<<10;++p)c.c=p,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[wo(c)])&&(u<0&&(u=p),h=p);u<0||(++o,r.write_shift(4,u),r.write_shift(4,h))}var f=r.l;return r.l=l,r.write_shift(4,o),r.l=f,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&co(e,0,a)}var qd=Qo,Vd=$o;function Kd(e){return[jo(e),Jo(e),"n"]}var Yd=Qo,Xd=$o;var Qd=["left","right","top","bottom","header","footer"];function $d(e,t,n,r,a,i,s){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Pi(t)).z=t.z||Ea[14],t.v=bi(Ti(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=jd(a.cellXfs,t,a),t.l&&i["!links"].push([wo(l),t.l]),t.c&&i["!comments"].push([wo(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Fd(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?co(e,18,function(e,t,n){return null==n&&(n=oo(8)),Bo(t,n),n.write_shift(4,t.v),n}(0,l)):co(e,7,function(e,t,n){return null==n&&(n=oo(12)),Lo(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?co(e,17,function(e,t,n){return null==n&&(n=oo(8+4*e.v.length)),Bo(t,n),Ro(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):co(e,6,function(e,t,n){return null==n&&(n=oo(12+4*e.v.length)),Lo(t,n),Ro(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?co(e,13,function(e,t,n){return null==n&&(n=oo(8)),Bo(t,n),Yo(e.v,n),n}(t,l)):co(e,2,function(e,t,n){return null==n&&(n=oo(12)),Lo(t,n),Yo(e.v,n),n}(t,l)):s?co(e,16,function(e,t,n){return null==n&&(n=oo(12)),Bo(t,n),Zo(e.v,n),n}(t,l)):co(e,5,function(e,t,n){return null==n&&(n=oo(16)),Lo(t,n),Zo(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?co(e,15,function(e,t,n){return null==n&&(n=oo(5)),Bo(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):co(e,4,function(e,t,n){return null==n&&(n=oo(9)),Lo(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?co(e,14,function(e,t,n){return null==n&&(n=oo(8)),Bo(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):co(e,3,function(e,t,n){return null==n&&(n=oo(9)),Lo(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?co(e,12,function(e,t,n){return null==n&&(n=oo(4)),Bo(t,n)}(0,l)):co(e,1,function(e,t,n){return null==n&&(n=oo(8)),Lo(t,n)}(0,l)),!0}function Jd(e,t){var n,r;t&&t["!merges"]&&(co(e,177,(n=t["!merges"].length,null==r&&(r=oo(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){co(e,176,Xd(t))}),co(e,178))}function Zd(e,t){t&&t["!cols"]&&(co(e,390),t["!cols"].forEach(function(t,n){t&&co(e,60,function(e,t,n){null==n&&(n=oo(18));var r=Dd(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))}),co(e,391))}function eu(e,t){t&&t["!ref"]&&(co(e,648),co(e,649,function(e){var t=oo(24);return t.write_shift(4,4),t.write_shift(4,1),$o(e,t),t}(So(t["!ref"]))),co(e,650))}function tu(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=pl(n,-1,t[1].Target.replace(/#.*$/,""),dl.HLINK);co(e,494,function(e,t){var n=oo(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));$o({s:bo(e[0]),e:bo(e[0])},n),Vo("rId"+t,n);var r=e[1].Target.indexOf("#");return Ro((-1==r?"":e[1].Target.slice(r+1))||"",n),Ro(e[1].Tooltip||"",n),Ro("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function nu(e,t,n){co(e,133),co(e,137,function(e,t,n){null==n&&(n=oo(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),co(e,138),co(e,134)}function ru(e,t){var n,r;t["!protect"]&&co(e,535,(n=t["!protect"],null==r&&(r=oo(66)),r.write_shift(2,n.password?hc(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function au(e,t,n,r){var a=lo(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=i;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(u){}var l,c,d=So(s["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],co(a,129),(n.vbaraw||s["!outline"])&&co(a,147,function(e,t,n){null==n&&(n=oo(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return el({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Go(e,n),n.slice(0,n.l)}(o,s["!outline"])),co(a,148,Vd(d)),nu(a,0,n.Workbook),Zd(a,s),function(e,t,n,r){var a,i=So(t["!ref"]||"A1"),s="",o=[];co(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=c;++d){s=go(d),Wd(e,t,i,d);var u=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(o[h]=yo(h)),a=o[h]+s;var p=l?(t[d]||[])[h]:t[a];u=!!p&&$d(e,p,d,h,r,t,u)}}co(e,146)}(a,s,0,t),ru(a,s),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],i="string"===typeof a.ref?a.ref:Ao(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=_o(i);o.s.r==o.e.r&&(o.e.r=_o(t["!ref"]).e.r,i=Ao(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),co(e,161,$o(So(i))),co(e,162)}}(a,s,n,e),Jd(a,s),tu(a,s,r),s["!margins"]&&co(a,476,(l=s["!margins"],null==c&&(c=oo(48)),Ld(l),Qd.forEach(function(e){Zo(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||eu(a,s),function(e,t,n,r){if(t["!comments"].length>0){var a=pl(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",dl.VML);co(e,551,Vo("rId"+a)),t["!legacy"]=a}}(a,s,e,r),co(a,130),a.end()}var iu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var su="][*?/\\".split("");function ou(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return su.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function lu(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=a,r=!!e.vbaraw,t.forEach(function(e,a){ou(e);for(var i=0;i<a;++i)if(e==t[i])throw new Error("Duplicate Sheet Name: "+e);if(r){var s=n&&n[a]&&n[a].CodeName||e;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}});for(var i=0;i<e.SheetNames.length;++i)Bd(e.Sheets[e.SheetNames[i]],e.SheetNames[i],i)}function cu(e){var t=[Di];t[t.length]=ns("workbook",null,{xmlns:vs[0],"xmlns:r":ps});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(iu.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ns("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&a[i]&&a[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Gi(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=ns("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=ns("definedName",Gi(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function du(e,t){return t||(t=oo(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vo(e.strRelID,t),Ro(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function uu(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,a=t.Workbook.Sheets,i=0,s=-1,o=-1;i<a.length;++i)!a[i]||!a[i].Hidden&&-1==s?s=i:1==a[i].Hidden&&-1==o&&(o=i);if(!(o>s))co(e,135),co(e,158,(n=s,r||(r=oo(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),co(e,136)}}function hu(e,t){var n=lo();return co(n,131),co(n,128,function(e,t){t||(t=oo(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return Ro("SheetJS",t),Ro(Vr.version,t),Ro(Vr.version,t),Ro("7262",t),t.length>t.l?t.slice(0,t.l):t}()),co(n,153,function(e,t){t||(t=oo(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Go(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),uu(n,e),function(e,t){co(e,143);for(var n=0;n!=t.SheetNames.length;++n)co(e,156,du({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));co(e,144)}(n,e),co(n,132),n.end()}function pu(e,t,n,r,a){return(".bin"===t.slice(-4)?au:zd)(e,n,r,a)}function fu(e,t,n){return(".bin"===t.slice(-4)?qc:Hc)(e,n)}function mu(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return fi(Cl).map(function(e){for(var t=0;t<vl.length;++t)if(vl[t][1]==e)return vl[t];for(t=0;t<wl.length;++t)if(wl[t][1]==e)return wl[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(es(Cl[r[1]]||r[1],a))}}),ns("DocumentProperties",n.join(""),{xmlns:ys})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&fi(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<vl.length;++r)if(t==vl[r][1])return;for(r=0;r<wl.length;++r)if(t==wl[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var i=e[t],s="string";"number"==typeof i?(s="float",i=String(i)):!0===i||!1===i?(s="boolean",i=i?"1":"0"):i=String(i),a.push(ns(Hi(t),i,{"dt:dt":s}))}}),t&&fi(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],i="string";"number"==typeof r?(i="float",r=String(r)):!0===r||!1===r?(i="boolean",r=r?"1":"0"):r instanceof Date?(i="dateTime.tz",r=r.toISOString()):r=String(r),a.push(ns(Hi(n),r,{"dt:dt":i}))}}),"<"+r+' xmlns="'+ys+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function gu(e){return ns("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xc(e.Ref,{r:0,c:0})})}function vu(e,t,n,r,a,i,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Gi(Xc(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=bo(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Gi(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Gi(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],d=0;d!=c.length;++d)c[d].s.c==s.c&&c[d].s.r==s.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=sl[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Ea[14]);break;case"s":u="String",h=((e.v||"")+"").replace(Bi,function(e){return ji[e]}).replace(zi,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var p=jd(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var f=null!=e.v?h:"",m="z"==e.t?"":'<Data ss:Type="'+u+'">'+f+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map(function(e){var t=ns("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return ns("Comment",t,{"ss:Author":e.a})}).join("")),ns("Cell",m,o)}function yu(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ac(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function bu(e,t,n){var r=[],a=n.SheetNames[e],i=n.Sheets[a],s=i?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||i.push(gu(o)))}return i.join("")}(i,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=i?function(e,t){if(!e["!ref"])return"";var n=So(e["!ref"]),r=e["!merges"]||[],a=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,t){bc(e);var n=!!e.width,r=Dd(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=gc(r.width)),e.hidden&&(a["ss:Hidden"]="1"),i.push(ns("Column",null,a))});for(var s=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[yu(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var d=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c)&&!(r[a].s.r>o)&&!(r[a].e.c<c)&&!(r[a].e.r<o)){r[a].s.c==c&&r[a].s.r==o||(d=!0);break}if(!d){var u={r:o,c:c},h=wo(u),p=s?(e[o]||[])[c]:e[h];l.push(vu(p,h,e,t,0,0,u))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ns("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ns("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ns("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(ns("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(es("ProtectContents","True")),e["!protect"].objects&&a.push(es("ProtectObjects","True")),e["!protect"].scenarios&&a.push(es("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(es("EnableSelection","UnlockedCells")):a.push(es("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":ns("WorksheetOptions",a.join(""),{xmlns:bs})}(i,0,e,n)),r.join("")}function wu(e,t){t||(t={}),e.SSF||(e.SSF=Pi(Ea)),e.SSF&&(oi(),si(e.SSF),t.revssf=vi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],jd(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(mu(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(ns("Worksheet",bu(r,t,e),{"ss:Name":Gi(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(ns("NumberFormat",null,{"ss:Format":Gi(Ea[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(ns("Style",r.join(""),a))}),ns("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(gu(a)))}return ns("Names",n.join(""))}(e),Di+ns("Workbook",n.join(""),{xmlns:ws,"xmlns:o":ys,"xmlns:x":bs,"xmlns:ss":ws,"xmlns:dt":_s,"xmlns:html":Cs})}var _u="e0859ff2f94f6810ab9108002b27b3d9",Au="02d5cdd59c2e1b10939708002b2cf9ae",Su="05d5cdd59c2e1b10939708002b2cf9ae";function Cu(e,t){var n=t||{},r=di.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return di.utils.cfb_add(r,a,Fu(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],i=[],s=0,o=mi(nl,"n"),l=mi(rl,"n");if(e.Props)for(n=fi(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=fi(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<i.length;++s)El.indexOf(i[s][0])>-1||_l.indexOf(i[s][0])>-1||null!=i[s][1]&&c.push(i[s]);a.length&&di.utils.cfb_add(t,"/\x05SummaryInformation",Pl(a,_u,l,rl)),(r.length||c.length)&&di.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Pl(r,Au,o,nl,c.length?c:null,Su))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&di.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,di.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var xu={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[Do(e)]}},2:{f:function(e){return[Do(e),Ko(e),"n"]}},3:{f:function(e){return[Do(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Do(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Do(e),Jo(e),"n"]}},6:{f:function(e){return[Do(e),Io(e),"str"]}},7:{f:function(e){return[Do(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=Do(e);a.r=n["!row"];var i=[a,Io(e),"str"];if(n.cellFormula){e.l+=2;var s=Ed(e,r-e.l,n);i[3]=Ad(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=Do(e);a.r=n["!row"];var i=[a,Jo(e),"n"];if(n.cellFormula){e.l+=2;var s=Ed(e,r-e.l,n);i[3]=Ad(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=Do(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=Ed(e,r-e.l,n);i[3]=Ad(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=Do(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=Ed(e,r-e.l,n);i[3]=Ad(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[jo(e)]}},13:{f:function(e){return[jo(e),Ko(e),"n"]}},14:{f:function(e){return[jo(e),e.read_shift(1),"e"]}},15:{f:function(e){return[jo(e),e.read_shift(1),"b"]}},16:{f:Kd},17:{f:function(e){return[jo(e),Io(e),"str"]}},18:{f:function(e){return[jo(e),e.read_shift(4),"s"]}},19:{f:Oo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Wo(e),s=Td(e,0,n),o=Ho(e);e.l=r;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=il[r];l&&(t.rgb=fc(l));break;case 2:t.rgb=fc([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Io(e),r}},44:{f:function(e,t){return[e.read_shift(2),Io(e)]}},45:{f:kc},46:{f:Nc},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ec},62:{f:function(e){return[Do(e),Oo(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=wo(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:so,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=Uo(e,t-19),n}},148:{f:qd,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Io(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=qo(e,t-8),n.name=Io(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Qo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Yd},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Io(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$l},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=Xo(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=xd(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[Qo(e,16)];if(n.cellFormula){var i=kd(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Qd.forEach(function(n){t[n]=Jo(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=Qo(e,16),a=Ho(e),i=Io(e),s=Io(e),o=Io(e);e.l=n;var l={rfx:r,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Wc},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=Qo(e,16);return t.rfx=n.s,t.ref=wo(n.s),e.l+=16,t}},636:{T:-1},637:{f:Mo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Io(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Eu(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&qs(n)&&e.push(n)}}function Tu(e,t,n){return e||(e=oo(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function ku(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?bi(Ti(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?Eu(e,2,function(e,t,n){var r=oo(9);return Tu(r,e,t),r.write_shift(2,n),r}(n,r,a)):Eu(e,3,function(e,t,n){var r=oo(15);return Tu(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void Eu(e,5,function(e,t,n,r){var a=oo(9);return Tu(a,e,t),Ml(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void Eu(e,4,function(e,t,n){var r=oo(8+2*n.length);return Tu(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}Eu(e,1,Tu(null,n,r))}function Pu(e,t){var n=t||{};for(var r=lo(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(a=i);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Eu(r,4==n.biff?1033:3==n.biff?521:9,Kl(0,16,n)),function(e,t,n,r){var a,i=Array.isArray(t),s=So(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ao(s)}for(var c=s.s.r;c<=s.e.r;++c){o=go(c);for(var d=s.s.c;d<=s.e.c;++d){c===s.s.r&&(l[d]=yo(d)),a=l[d]+o;var u=i?(t[c]||[])[d]:t[a];u&&ku(e,u,c,d)}}}(r,e.Sheets[e.SheetNames[a]],0,n),Eu(r,10),r.end()}function Iu(e,t,n){Eu(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=oo(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function Ru(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&Eu(e,125,function(e,t){var n=oo(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(Dd(r,t),r))})}}function Nu(e,t,n,r,a){var i=16+jd(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)Eu(e,6,Sd(t,n,r,0,i));else switch(t.t){case"d":case"n":Eu(e,515,function(e,t,n,r){var a=oo(14);return zl(e,t,r,a),Zo(n,a),a}(n,r,"d"==t.t?bi(Ti(t.v)):t.v,i));break;case"b":case"e":Eu(e,517,function(e,t,n,r,a,i){var s=oo(8);return zl(e,t,r,s),Ml(n,i,s),s}(n,r,t.v,i,0,t.t));break;case"s":case"str":if(a.bookSST)Eu(e,253,function(e,t,n,r){var a=oo(10);return zl(e,t,r,a),a.write_shift(4,n),a}(n,r,Fd(a.Strings,t.v,a.revStrings),i));else Eu(e,516,function(e,t,n,r,a){var i=!a||8==a.biff,s=oo(+i+8+(1+i)*n.length);return zl(e,t,r,s),s.write_shift(2,n.length),i&&s.write_shift(1,1),s.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),i,a));break;default:Eu(e,513,zl(n,r,i))}else Eu(e,513,zl(n,r,i))}function Ou(e,t,n){var r,a=lo(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),d=8==t.biff,u="",h=[],p=So(s["!ref"]||"A1"),f=d?65536:16384;if(p.e.c>255||p.e.r>=f){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,f-1)}Eu(a,2057,Kl(0,16,t)),Eu(a,13,Ol(1)),Eu(a,12,Ol(100)),Eu(a,15,Rl(!0)),Eu(a,17,Rl(!1)),Eu(a,16,Zo(.001)),Eu(a,95,Rl(!0)),Eu(a,42,Rl(!1)),Eu(a,43,Rl(!1)),Eu(a,130,Ol(1)),Eu(a,128,function(e){var t=oo(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),Eu(a,131,Rl(!1)),Eu(a,132,Rl(!1)),d&&Ru(a,s["!cols"]),Eu(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=oo(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(p,t)),d&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){u=go(m);for(var g=p.s.c;g<=p.e.c;++g){m===p.s.r&&(h[g]=yo(g)),r=h[g]+u;var v=c?(s[m]||[])[g]:s[r];v&&(Nu(a,v,m,g,t),d&&v.l&&s["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||i;return d&&Eu(a,574,function(e){var t=oo(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),d&&(s["!merges"]||[]).length&&Eu(a,229,function(e){var t=oo(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Vl(e[n],t);return t}(s["!merges"])),d&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Eu(e,440,Jl(r)),r[1].Tooltip&&Eu(e,2048,Zl(r))}delete t["!links"]}(a,s),Eu(a,442,Ul(y)),d&&function(e,t){var n=oo(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Eu(e,2151,n),(n=oo(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Vl(So(t["!ref"]||"A1"),n),n.write_shift(4,4),Eu(e,2152,n)}(a,s),Eu(a,10),a.end()}function Mu(e,t,n){var r=lo(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=8==n.biff,l=5==n.biff;(Eu(r,2057,Kl(0,5,n)),"xla"==n.bookType&&Eu(r,135),Eu(r,225,o?Ol(1200):null),Eu(r,193,function(e,t){t||(t=oo(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&Eu(r,191),l&&Eu(r,192),Eu(r,226),Eu(r,92,function(e,t){var n=!t||8==t.biff,r=oo(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),Eu(r,66,Ol(o?1200:1252)),o&&Eu(r,353,Ol(0)),o&&Eu(r,448),Eu(r,317,function(e){for(var t=oo(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&Eu(r,211),o&&e.vbaraw)&&Eu(r,442,Ul(s.CodeName||"ThisWorkbook"));Eu(r,156,Ol(17)),Eu(r,25,Rl(!1)),Eu(r,18,Rl(!1)),Eu(r,19,Ol(0)),o&&Eu(r,431,Rl(!1)),o&&Eu(r,444,Ol(0)),Eu(r,61,function(){var e=oo(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Eu(r,64,Rl(!1)),Eu(r,141,Ol(0)),Eu(r,34,Rl("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&qi(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Eu(r,14,Rl(!0)),o&&Eu(r,439,Rl(!1)),Eu(r,218,Ol(0)),Iu(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&Eu(e,1054,Xl(a,t[a],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)Eu(e,224,Ql({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Eu(e,224,Ql(n,0,t))})}(r,n),o&&Eu(r,352,Rl(!1));var c,d=r.end(),u=lo();o&&Eu(u,140,(c||(c=oo(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return Eu(e,t,n,a);var i=t;if(!isNaN(i)){for(var s=n.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((d=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;d.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(u,252,function(e){var t=oo(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=Dl(e[r]);var a=fa([t].concat(n));return a.parts=[t.length].concat(n.map(function(e){return e.length})),a}(n.Strings)),Eu(u,10);var h=u.end(),p=lo(),f=0,m=0;for(m=0;m<e.SheetNames.length;++m)f+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=d.length+f+h.length;for(m=0;m<e.SheetNames.length;++m){Eu(p,133,Yl({pos:g,hs:(i[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},n)),g+=t[m].length}var v=p.end();if(f!=v.length)throw new Error("BS8 "+f+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),h.length&&y.push(h),fa(y)}function Fu(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])_o(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Pi(Ea)),e&&e.SSF&&(oi(),si(e.SSF),n.revssf=vi(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,uh(n),n.cellXfs=[],jd(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=Ou(a,n,e);return r.unshift(Mu(e,r,n)),fa(r)}(e,t);case 4:case 3:case 2:return Pu(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Du(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>s)&&!(a[c].e.r<n||a[c].e.c<s)){if(a[c].s.r<n||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var d=wo({r:n,c:s}),u=r.dense?(e[n]||[])[s]:e[d],h=u&&null!=u.v&&(u.h||Wi(u.w||(xo(u),u.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":u&&(p["data-t"]=u&&u.t||"z",null!=u.v&&(p["data-v"]=u.v),null!=u.z&&(p["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),p.id=(r.id||"sjs")+"-"+d,i.push(ns("td",h,p))}}return"<tr>"+i.join("")+"</tr>"}var Lu='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ju="</body></html>";function Bu(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Uu(e,t){var n=t||{},r=null!=n.header?n.header:Lu,a=null!=n.footer?n.footer:ju,i=[r],s=_o(e["!ref"]);n.dense=Array.isArray(e),i.push(Bu(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(Du(e,s,o,n));return i.push("</table>"+a),i.join("")}function Gu(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?bo(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=_o(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==a&&(c.e.r=a=d.e.r+1)}var u=[],h=0,p=e["!rows"]||(e["!rows"]=[]),f=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);f<o.length&&m<l;++f){var w=o[f];if(zu(w)){if(r.display)continue;p[m]={hidden:!0}}var _=w.children;for(g=v=0;g<_.length;++g){var A=_[g];if(!r.display||!zu(A)){var S=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):Ji(A.innerHTML),C=A.getAttribute("data-z")||A.getAttribute("z");for(h=0;h<u.length;++h){var x=u[h];x.s.c==v+i&&x.s.r<m+a&&m+a<=x.e.r&&(v=x.e.c+1-i,h=-1)}b=+A.getAttribute("colspan")||1,((y=+A.getAttribute("rowspan")||1)>1||b>1)&&u.push({s:{r:m+a,c:v+i},e:{r:m+a+(y||1)-1,c:v+i+(b||1)-1}});var E={t:"s",v:S},T=A.getAttribute("data-t")||A.getAttribute("t")||"";null!=S&&(0==S.length?E.t=T||"z":r.raw||0==S.trim().length||"s"==T||("TRUE"===S?E={t:"b",v:!0}:"FALSE"===S?E={t:"b",v:!1}:isNaN(Ri(S))?isNaN(Oi(S).getDate())||(E={t:"d",v:Ti(S)},r.cellDates||(E={t:"n",v:bi(E.v)}),E.z=r.dateNF||Ea[14]):E={t:"n",v:Ri(S)})),void 0===E.z&&null!=C&&(E.z=C);var k="",P=A.getElementsByTagName("A");if(P&&P.length)for(var I=0;I<P.length&&(!P[I].hasAttribute("href")||"#"==(k=P[I].getAttribute("href")).charAt(0));++I);k&&"#"!=k.charAt(0)&&(E.l={Target:k}),r.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+i]=E):e[wo({c:v+i,r:m+a})]=E,c.e.c<v+i&&(c.e.c=v+i),v+=b}}++m}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ao(c),m>=l&&(e["!fullref"]=Ao((c.e.r=o.length-f+m-1+a,c))),e}function Hu(e,t){return Gu((t||{}).dense?[]:{},e,t)}function zu(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var Wu=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ts({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Di+t}}(),qu=function(){var e=function(e){return Gi(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,a){var i=[];i.push('      <table:table table:name="'+Gi(r.SheetNames[a])+'" table:style-name="ta1">\n');var s=0,o=0,l=_o(n["!ref"]||"A1"),c=n["!merges"]||[],d=0,u=Array.isArray(n);if(n["!cols"])for(o=0;o<=l.e.c;++o)i.push("        <table:table-column"+(n["!cols"][o]?' table:style-name="co'+n["!cols"][o].ods+'"':"")+"></table:table-column>\n");var h="",p=n["!rows"]||[];for(s=0;s<l.s.r;++s)h=p[s]?' table:style-name="ro'+p[s].ods+'"':"",i.push("        <table:table-row"+h+"></table:table-row>\n");for(;s<=l.e.r;++s){for(h=p[s]?' table:style-name="ro'+p[s].ods+'"':"",i.push("        <table:table-row"+h+">\n"),o=0;o<l.s.c;++o)i.push(t);for(;o<=l.e.c;++o){var f=!1,m={},g="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>o)&&!(c[d].s.r>s)&&!(c[d].e.c<o)&&!(c[d].e.r<s)){c[d].s.c==o&&c[d].s.r==s||(f=!0),m["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,m["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(f)i.push("          <table:covered-table-cell/>\n");else{var v=wo({r:s,c:o}),y=u?(n[s]||[])[o]:n[v];if(y&&y.f&&(m["table:formula"]=Gi(Nd(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=_o(y.F);m["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,m["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":g=y.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=y.v?"true":"false";break;case"n":g=y.w||String(y.v||0),m["office:value-type"]="float",m["office:value"]=y.v||0;break;case"s":case"str":g=null==y.v?"":y.v,m["office:value-type"]="string";break;case"d":g=y.w||Ti(y.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=Ti(y.v).toISOString(),m["table:style-name"]="ce1";break;default:i.push(t);continue}var w=e(g);if(y.l&&y.l.Target){var _=y.l.Target;"#"==(_="#"==_.charAt(0)?"#"+Od(_.slice(1)):_).charAt(0)||_.match(/^\w+:/)||(_="../"+_),w=ns("text:a",w,{"xlink:href":_.replace(/&/g,"&amp;")})}i.push("          "+ns("table:table-cell",ns("text:p",w,{}),m)+"\n")}else i.push(t)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,t){var r=[Di],a=ts({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=ts({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+i+">\n"),r.push(gl().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;bc(a),a.ods=n;var i=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(n(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function Vu(e,t){if("fods"==t.bookType)return qu(e,t);var n=Fi(),r="",a=[],i=[];return Mi(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Mi(n,r="content.xml",qu(e,t)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),Mi(n,r="styles.xml",Wu(e,t)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),Mi(n,r="meta.xml",Di+gl()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),Mi(n,r="manifest.rdf",function(e){var t=[Di];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(fl(e[n][0],e[n][1])),t.push(ml("",e[n][0]));return t.push(fl("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),a.push([r,"application/rdf+xml"]),Mi(n,r="META-INF/manifest.xml",function(e){var t=[Di];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function Ku(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Yu(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):ua($i(e))}function Xu(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function Qu(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function $u(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Ju(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function Zu(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=Qu(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Qu(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var c={data:r,type:s};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function eh(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push($u(8*n+e.type)),2==e.type&&t.push($u(e.data.length)),t.push(e.data))})}),Xu(t)}function th(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=Qu(e,r),i=Zu(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:Ju(i[1][0].data),messages:[]};i[2].forEach(function(t){var n=Zu(t.data),a=Ju(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=i[3])?void 0:t[0])&&(s.merge=Ju(i[3][0].data)>>>0>0),n.push(s)}return n}function nh(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:$u(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:$u(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:$u(e.data.length)}],n[2].push({data:eh(e.meta),type:2})});var a=eh(n);t.push($u(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),Xu(t)}function rh(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Qu(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Xu(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var d=Xu(a);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function ah(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(rh(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Xu(t)}function ih(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var i=$u(r),s=i.length;t.push(i),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,a[0]=0,a[1]=255&s,a[2]=s>>8&255,a[3]=s>>16&255,n+=r}return Xu(t)}function sh(e,t){var n=new Uint8Array(32),r=Ku(n),a=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),i|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,a)}function oh(e,t){var n=new Uint8Array(32),r=Ku(n),a=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,a)}function lh(e){return Qu(Zu(e)[1][0].data)}function ch(e,t,n){var r,a,i,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(i=e[8])?void 0:i[0])?void 0:s.data)&&Ju(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Ku(e[7][0].data),c=0,d=[],u=Ku(e[4][0].data),h=0,p=[],f=0;f<t.length;++f)if(null!=t[f]){var m,g;switch(l.setUint16(2*f,c,!0),u.setUint16(2*f,h,!0),typeof t[f]){case"string":m=sh({t:"s",v:t[f]},n),g=oh({t:"s",v:t[f]},n);break;case"number":m=sh({t:"n",v:t[f]},n),g=oh({t:"n",v:t[f]},n);break;case"boolean":m=sh({t:"b",v:t[f]},n),g=oh({t:"b",v:t[f]},n);break;default:throw new Error("Unsupported value "+t[f])}d.push(m),c+=m.length,p.push(g),h+=g.length,++o}else l.setUint16(2*f,65535,!0),u.setUint16(2*f,65535);for(e[2][0].data=$u(o);f<e[7][0].data.length/2;++f)l.setUint16(2*f,65535,!0),u.setUint16(2*f,65535,!0);return e[6][0].data=Xu(d),e[3][0].data=Xu(p),o}function dh(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function uh(e){dh([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function hh(e,t){return"ods"==t.bookType?Vu(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=_o(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ao(r)));var i=_h(n,{range:r,header:1}),s=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&s.push(e)})});var o={},l=[],c=di.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&th(ah(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:Ju(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var d=l.filter(function(e){return e>1}).map(function(e){return[e,$u(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&th(ah(t.content)).forEach(function(e){e.messages.forEach(function(t){d.forEach(function(t){e.messages.some(function(e){return 11006!=Ju(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var u,h=di.find(c,o[1].location),p=th(ah(h.content)),f=0;f<p.length;++f){var m=p[f];1==m.id&&(u=m)}var g=lh(Zu(u.messages[0].data)[1][0].data);for(p=th(ah((h=di.find(c,o[g].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==g&&(u=m);for(g=lh(Zu(u.messages[0].data)[2][0].data),p=th(ah((h=di.find(c,o[g].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==g&&(u=m);for(g=lh(Zu(u.messages[0].data)[2][0].data),p=th(ah((h=di.find(c,o[g].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==g&&(u=m);var v=Zu(u.messages[0].data);v[6][0].data=$u(r.e.r+1),v[7][0].data=$u(r.e.c+1);for(var y=lh(v[46][0].data),b=di.find(c,o[y].location),w=th(ah(b.content)),_=0;_<w.length&&w[_].id!=y;++_);if(w[_].id!=y)throw"Bad ColumnRowUIDMapArchive";var A=Zu(w[_].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var S=0;S<=r.e.c;++S){var C=[];C[1]=C[2]=[{type:0,data:$u(S+420690)}],A[1].push({type:2,data:eh(C)}),A[2].push({type:0,data:$u(S)}),A[3].push({type:0,data:$u(S)})}A[4]=[],A[5]=[],A[6]=[];for(var x=0;x<=r.e.r;++x)(C=[])[1]=C[2]=[{type:0,data:$u(x+726270)}],A[4].push({type:2,data:eh(C)}),A[5].push({type:0,data:$u(x)}),A[6].push({type:0,data:$u(x)});w[_].messages[0].data=eh(A),b.content=ih(nh(w)),b.size=b.content.length,delete v[46];var E=Zu(v[4][0].data);E[7][0].data=$u(r.e.r+1);var T=lh(Zu(E[1][0].data)[2][0].data);if((w=th(ah((b=di.find(c,o[T].location)).content)))[0].id!=T)throw"Bad HeaderStorageBucket";var k=Zu(w[0].messages[0].data);for(x=0;x<i.length;++x){var P=Zu(k[2][0].data);P[1][0].data=$u(x),P[4][0].data=$u(i[x].length),k[2][x]={type:k[2][0].type,data:eh(P)}}w[0].messages[0].data=eh(k),b.content=ih(nh(w)),b.size=b.content.length;var I=lh(E[2][0].data);if((w=th(ah((b=di.find(c,o[I].location)).content)))[0].id!=I)throw"Bad HeaderStorageBucket";for(k=Zu(w[0].messages[0].data),S=0;S<=r.e.c;++S)(P=Zu(k[2][0].data))[1][0].data=$u(S),P[4][0].data=$u(r.e.r+1),k[2][S]={type:k[2][0].type,data:eh(P)};w[0].messages[0].data=eh(k),b.content=ih(nh(w)),b.size=b.content.length;var R=lh(E[4][0].data);!function(){for(var e,t=di.find(c,o[R].location),n=th(ah(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==R&&(e=a)}var i=Zu(e.messages[0].data);i[3]=[];var l=[];s.forEach(function(e,t){l[1]=[{type:0,data:$u(t)}],l[2]=[{type:0,data:$u(1)}],l[3]=[{type:2,data:Yu(e)}],i[3].push({type:2,data:eh(l)})}),e.messages[0].data=eh(i);var d=ih(nh(n));t.content=d,t.size=t.content.length}();var N=Zu(E[3][0].data),O=N[1][0];delete N[2];var M=Zu(O.data),F=lh(M[2][0].data);!function(){for(var e,t=di.find(c,o[F].location),n=th(ah(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==F&&(e=l)}var d=Zu(e.messages[0].data);delete d[6],delete N[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var h=0,p=0;p<=r.e.r;++p){var f=Zu(u);h+=ch(f,i[p],s),f[1][0].data=$u(p),d[5].push({data:eh(f),type:2})}d[1]=[{type:0,data:$u(r.e.c+1)}],d[2]=[{type:0,data:$u(r.e.r+1)}],d[3]=[{type:0,data:$u(h)}],d[4]=[{type:0,data:$u(r.e.r+1)}],e.messages[0].data=eh(d);var m=ih(nh(n));t.content=m,t.size=t.content.length}(),O.data=eh(M),E[3][0].data=eh(N),v[4][0].data=eh(E),u.messages[0].data=eh(v);var D=ih(nh(p));return h.content=D,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){Uc=1024,e&&!e.SSF&&(e.SSF=Pi(Ea));e&&e.SSF&&(oi(),si(e.SSF),t.revssf=vi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Md?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=Vc.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uh(t=t||{});var i=Fi(),s="",o=0;t.cellXfs=[],jd(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Mi(i,s="docProps/core.xml",bl(e.Props,t)),a.coreprops.push(s),pl(t.rels,2,s,dl.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Mi(i,s,Al(e.Props)),a.extprops.push(s),pl(t.rels,3,s,dl.EXT_PROPS),e.Custprops!==e.Props&&fi(e.Custprops||{}).length>0&&(Mi(i,s="docProps/custom.xml",Sl(e.Custprops)),a.custprops.push(s),pl(t.rels,4,s,dl.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];(u||{})["!type"];if(Mi(i,s="xl/worksheets/sheet"+o+"."+n,pu(o-1,s,t,e,d)),a.sheets.push(s),pl(t.wbrels,-1,"worksheets/sheet"+o+"."+n,dl.WS[0]),u){var h=u["!comments"],p=!1,f="";h&&h.length>0&&(Mi(i,f="xl/comments"+o+"."+n,fu(h,f,t)),a.comments.push(f),pl(d,-1,"../comments"+o+"."+n,dl.CMNT),p=!0),u["!legacy"]&&p&&Mi(i,"xl/drawings/vmlDrawing"+o+".vml",Gc(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&Mi(i,ul(s),hl(d))}null!=t.Strings&&t.Strings.length>0&&(Mi(i,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?dc:lc)(e,n)}(t.Strings,s,t)),a.strs.push(s),pl(t.wbrels,-1,"sharedStrings."+n,dl.SST));Mi(i,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?hu:cu)(e,n)}(e,s,t)),a.workbooks.push(s),pl(t.rels,1,s,dl.WB),Mi(i,s="xl/theme/theme1.xml",Lc(e.Themes,t)),a.themes.push(s),pl(t.wbrels,-1,"theme/theme1.xml",dl.THEME),Mi(i,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?Dc:Sc)(e,n)}(e,s,t)),a.styles.push(s),pl(t.wbrels,-1,"styles."+n,dl.STY),e.vbaraw&&r&&(Mi(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),pl(t.wbrels,-1,"vbaProject.bin",dl.VBA));return Mi(i,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?jc:Bc)()}(s)),a.metadata.push(s),pl(t.wbrels,-1,"metadata."+n,dl.XLMETA),Mi(i,"[Content_Types].xml",cl(a,t)),Mi(i,"_rels/.rels",hl(t.rels)),Mi(i,"xl/_rels/workbook."+n+".rels",hl(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):ph(e,t)}function ph(e,t){Uc=1024,e&&!e.SSF&&(e.SSF=Pi(Ea)),e&&e.SSF&&(oi(),si(e.SSF),t.revssf=vi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Md?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Vc.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uh(t=t||{});var i=Fi(),s="",o=0;if(t.cellXfs=[],jd(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Mi(i,s="docProps/core.xml",bl(e.Props,t)),a.coreprops.push(s),pl(t.rels,2,s,dl.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Mi(i,s,Al(e.Props)),a.extprops.push(s),pl(t.rels,3,s,dl.EXT_PROPS),e.Custprops!==e.Props&&fi(e.Custprops||{}).length>0&&(Mi(i,s="docProps/custom.xml",Sl(e.Custprops)),a.custprops.push(s),pl(t.rels,4,s,dl.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(Mi(i,s="xl/worksheets/sheet"+o+"."+n,zd(o-1,t,e,u)),a.sheets.push(s),pl(t.wbrels,-1,"worksheets/sheet"+o+"."+n,dl.WS[0]),h){var p=h["!comments"],f=!1,m="";if(p&&p.length>0){var g=!1;p.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Mi(i,m="xl/threadedComments/threadedComment"+o+"."+n,zc(p,d,t)),a.threadedcomments.push(m),pl(u,-1,"../threadedComments/threadedComment"+o+"."+n,dl.TCMNT)),Mi(i,m="xl/comments"+o+"."+n,Hc(p)),a.comments.push(m),pl(u,-1,"../comments"+o+"."+n,dl.CMNT),f=!0}h["!legacy"]&&f&&Mi(i,"xl/drawings/vmlDrawing"+o+".vml",Gc(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Mi(i,ul(s),hl(u))}return null!=t.Strings&&t.Strings.length>0&&(Mi(i,s="xl/sharedStrings."+n,lc(t.Strings,t)),a.strs.push(s),pl(t.wbrels,-1,"sharedStrings."+n,dl.SST)),Mi(i,s="xl/workbook."+n,cu(e)),a.workbooks.push(s),pl(t.rels,1,s,dl.WB),Mi(i,s="xl/theme/theme1.xml",Lc(e.Themes,t)),a.themes.push(s),pl(t.wbrels,-1,"theme/theme1.xml",dl.THEME),Mi(i,s="xl/styles."+n,Sc(e,t)),a.styles.push(s),pl(t.wbrels,-1,"styles."+n,dl.STY),e.vbaraw&&r&&(Mi(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),pl(t.wbrels,-1,"vbaProject.bin",dl.VBA)),Mi(i,s="xl/metadata."+n,Bc()),a.metadata.push(s),pl(t.wbrels,-1,"metadata."+n,dl.XLMETA),d.length>1&&(Mi(i,s="xl/persons/person.xml",function(e){var t=[Di,ns("personList",null,{xmlns:cs,"xmlns:x":vs[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(ns("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),a.people.push(s),pl(t.wbrels,-1,"persons/person.xml",dl.PEOPLE)),Mi(i,"[Content_Types].xml",cl(a,t)),Mi(i,"_rels/.rels",hl(t.rels)),Mi(i,"xl/_rels/workbook.xml.rels",hl(t.wbrels)),delete t.revssf,delete t.ssf,i}function fh(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=sa(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function mh(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return pi(t.file,di.write(e,{type:oa?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return di.write(e,t)}function gh(e,t){var n={},r=oa?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?di.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(ha(a))}return t.password&&"undefined"!==typeof encrypt_agile?mh(encrypt_agile(a,t.password),t):"file"===t.type?pi(t.file,a):"string"==t.type?Qi(a):a}function vh(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return ia($i(r));case"binary":return $i(r);case"string":return e;case"file":return pi(t.file,r,"utf8");case"buffer":return oa?la(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):vh(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?ia(n):"string"==t.type?Qi(n):n;case"file":return pi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function bh(e,t){Zr(),lu(e);var n=Pi(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=bh(e,n);return n.type="array",ha(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return vh(wu(e,n),n);case"slk":case"sylk":return vh(nc.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return vh(Uu(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return ia(e);case"binary":case"string":return e;case"file":return pi(t.file,e,"binary");case"buffer":return oa?la(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(xh(e.Sheets[e.SheetNames[a]],n),n);case"csv":return vh(Ch(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return vh(rc.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return yh(tc.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return vh(ic.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return vh(pc.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return vh(ac.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return vh(Vu(e,n),n);case"wk1":return yh(sc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return yh(sc.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),yh(Fu(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return mh(Cu(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Pi(t||{});return gh(hh(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function wh(e,t,n,r,a,i,s,o){var l=go(n),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(g){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var p=t.s.c;p<=t.e.c;++p){var f=s?e[n][p]:e[r[p]+l];if(void 0!==f&&void 0!==f.t){var m=f.v;switch(f.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+f.t)}if(null!=i[p]){if(null==m)if("e"==f.t&&null===m)h[i[p]]=null;else if(void 0!==c)h[i[p]]=c;else{if(!d||null!==m)continue;h[i[p]]=null}else h[i[p]]=d&&("n"!==f.t||"n"===f.t&&!1!==o.rawNumbers)?m:xo(f,m,o);null!=m&&(u=!1)}}else{if(void 0===c)continue;null!=i[p]&&(h[i[p]]=c)}}return{row:h,isempty:u}}function _h(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof d){case"string":l=So(d);break;case"number":(l=So(e["!ref"])).s.r=d;break;default:l=d}r>0&&(a=0);var u=go(l.s.r),h=[],p=[],f=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],_=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=yo(y),n=g?e[v][y]:e[h[y]+u],r){case 1:i[y]=y-l.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=xo(n,null,c),m=b[s]||0){do{o=s+"_"+m++}while(b[o]);b[s]=m,b[o]=1}else b[s]=1;i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(_[v]||{}).hidden){var A=wh(e,l,v,h,r,i,g,c);(!1===A.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(p[f++]=A.row)}return p.length=f,p}var Ah=/"/g;function Sh(e,t,n,r,a,i,s,o){for(var l=!0,c=[],d="",u=go(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var p=o.dense?(e[n]||[])[h]:e[r[h]+u];if(null==p)d="";else if(null!=p.v){l=!1,d=""+(o.rawNumbers&&"n"==p.t?p.v:xo(p,null,o));for(var f=0,m=0;f!==d.length;++f)if((m=d.charCodeAt(f))===a||m===i||34===m||o.forceQuotes){d='"'+d.replace(Ah,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==p.f||p.F?d="":(l=!1,(d="="+p.f).indexOf(",")>=0&&(d='"'+d.replace(Ah,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(s)}function Ch(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=So(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),d="",u=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],p=r.skipHidden&&e["!rows"]||[],f=a.s.c;f<=a.e.c;++f)(h[f]||{}).hidden||(u[f]=yo(f));for(var m=0,g=a.s.r;g<=a.e.r;++g)(p[g]||{}).hidden||null!=(d=Sh(e,a,g,u,s,l,i,r))&&(r.strip&&(d=d.replace(c,"")),(d||!1!==r.blankrows)&&n.push((m++?o:"")+d));return delete r.dense,n.join("")}function xh(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Ch(e,t);if("undefined"==typeof ta||"string"==t.type)return n;var r=ta.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Eh(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?bo(a.origin):a.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var u=So(s["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+i)}else-1==o&&(o=0,d.e.r=t.length-1+i);var h=a.header||[],p=0;t.forEach(function(e,t){fi(e).forEach(function(n){-1==(p=h.indexOf(n))&&(h[p=h.length]=n);var c=e[n],d="z",u="",f=wo({c:l+p,r:o+t+i});r=Th(s,f),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",a.cellDates||(d="n",c=bi(c)),u=a.dateNF||Ea[14]):null===c&&a.nullError&&(d="e",c=0),r?(r.t=d,r.v=c,delete r.w,delete r.R,u&&(r.z=u)):s[f]=r={t:d,v:c},u&&(r.z=u)):s[f]=c})}),d.e.c=Math.max(d.e.c,l+h.length-1);var f=go(o);if(i)for(p=0;p<h.length;++p)s[yo(p+l)+f]={t:"s",v:h[p]};return s["!ref"]=Ao(d),s}function Th(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=bo(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Th(e,wo("number"!=typeof t?t:{r:t,c:n||0}))}function kh(){return{SheetNames:[],Sheets:{}}}function Ph(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(ou(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function Ih(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var Rh={encode_col:yo,encode_row:go,encode_cell:wo,encode_range:Ao,decode_col:vo,decode_row:mo,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:bo,decode_range:_o,format_cell:xo,sheet_add_aoa:To,sheet_add_json:Eh,sheet_add_dom:Gu,aoa_to_sheet:ko,json_to_sheet:function(e,t){return Eh(null,e,t)},table_to_sheet:Hu,table_to_book:function(e,t){return Eo(Hu(e,t),t)},sheet_to_csv:Ch,sheet_to_txt:xh,sheet_to_json:_h,sheet_to_html:Uu,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=So(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=yo(a);for(var d=i.s.r;d<=i.e.r;++d)for(s=go(d),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=c?(e[d]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:_h,sheet_get_cell:Th,book_new:kh,book_append_sheet:Ph,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Ih,cell_set_internal_link:function(e,t,n){return Ih(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:So(t),i="string"==typeof t?t:Ao(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=Th(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Vr.version;async function Nh(){const e=[];try{const o="a8337154-a8a8-400d-8817-c03ade433449",l="3493b8fa-b849-45bc-b23e-7d0384e4fa46",c=!0,d="https://sunbeth-ack-portal-backend.vercel.app/";e.push({name:"Env: REACT_APP_CLIENT_ID",ok:!!o,detail:o||"MISSING"}),e.push({name:"Env: REACT_APP_TENANT_ID",ok:!!l,detail:l||"MISSING"}),e.push({name:"Env: REACT_APP_ENABLE_SQLITE",ok:!0,detail:c?"true (enabled)":"false (disabled)"}),e.push({name:"Env: REACT_APP_API_BASE",ok:!c||!!d,detail:d||"MISSING (required if SQLite enabled)"});const u=w.msalInstance.getAllAccounts();e.push({name:"MSAL: getAllAccounts",ok:Array.isArray(u)&&u.length>0,detail:"accounts=".concat(u.length)});let h=u&&u[0];if(!h)return e.push({name:"MSAL: No signed-in account",ok:!1,detail:"No account found. Please sign in."}),e;e.push({name:"MSAL: account",ok:!0,detail:h.username||h.homeAccountId||"unknown"});let p=null;try{p=await xr(["User.Read"]),e.push({name:"Graph token",ok:!0,detail:"token length=".concat(p.length)})}catch(r){e.push({name:"Graph token",ok:!1,detail:String(r)})}try{const t=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(p)}});if(t.ok){const n=await t.json();e.push({name:"Graph: GET /me",ok:!0,detail:"id=".concat(n.id," displayName=").concat(n.displayName)})}else e.push({name:"Graph: GET /me",ok:!1,detail:"status=".concat(t.status)})}catch(r){(0,D.z3)("Graph /me fetch failed",r),e.push({name:"Graph: GET /me",ok:!1,detail:String(r)})}try{const t=await xr(["Group.Read.All"]),n=await fetch("https://graph.microsoft.com/v1.0/groups?$top=1",{headers:{Authorization:"Bearer ".concat(t)}});e.push({name:"Graph: GET /groups",ok:n.ok,detail:n.ok?"ok":"status=".concat(n.status)})}catch(r){e.push({name:"Graph: GET /groups",ok:!1,detail:"Group.Read.All not consented?"})}try{const t=await xr(["User.Read.All"]),n=await fetch("https://graph.microsoft.com/v1.0/users?$top=1",{headers:{Authorization:"Bearer ".concat(t)}});e.push({name:"Graph: GET /users",ok:n.ok,detail:n.ok?"ok":"status=".concat(n.status)})}catch(r){e.push({name:"Graph: GET /users",ok:!1,detail:"User.Read.All not consented?"})}try{const r=await xr(["Sites.Read.All","Files.Read.All"]),i=await fetch("https://graph.microsoft.com/v1.0/sites?search=*",{headers:{Authorization:"Bearer ".concat(r)}}),s=i.ok;if(e.push({name:"Graph: GET /sites",ok:s,detail:s?"ok":"status=".concat(i.status)}),s)try{var t,n;const a=await i.json(),s=null===a||void 0===a||null===(t=a.value)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.id;if(s){const t=await fetch("https://graph.microsoft.com/v1.0/sites/".concat(s,"/drives?$top=1"),{headers:{Authorization:"Bearer ".concat(r)}});e.push({name:"Graph: GET site drives",ok:t.ok,detail:t.ok?"ok":"status=".concat(t.status)})}}catch(a){}}catch(r){e.push({name:"Graph: SharePoint access",ok:!1,detail:"Sites.Read.All and Files.Read.All not consented?"})}try{const t=await xr(["Files.ReadWrite.All","Sites.Read.All"]);e.push({name:"Graph: Upload scope check",ok:!!t,detail:"Files.ReadWrite.All acquired"})}catch(i){e.push({name:"Graph: Upload scope check",ok:!1,detail:"Files.ReadWrite.All not consented?"})}try{const t=await xr(["Mail.Send"]);e.push({name:"Graph: Mail.Send scope",ok:!!t,detail:"Mail.Send acquired"})}catch(s){e.push({name:"Graph: Mail.Send scope",ok:!1,detail:"Mail.Send not consented?"})}if(c&&d)try{const t=await fetch("".concat(d.replace(/\/$/,""),"/api/health"));t.ok?e.push({name:"SQLite API: Health check",ok:!0,detail:"API responding"}):e.push({name:"SQLite API: Health check",ok:!1,detail:"status=".concat(t.status)})}catch(r){e.push({name:"SQLite API: Health check",ok:!1,detail:"Connection failed: ".concat(String(r))})}else c?e.push({name:"SQLite API: Health check",ok:!1,detail:"Enabled but REACT_APP_API_BASE not configured"}):e.push({name:"SQLite API: Skipped",ok:!0,detail:"Disabled"})}catch(o){(0,D.z3)("Health check failed",o),e.push({name:"Health check",ok:!1,detail:String(o)})}try{const t=e.filter(e=>!e.ok&&e.name.startsWith("Graph"));if(t.length){const n=t.map(e=>e.name.includes("groups")?"Group.Read.All":e.name.includes("/users")?"User.Read.All":e.name.includes("Upload")?"Files.ReadWrite.All":e.name.includes("/sites")||e.name.includes("drives")?"Sites.Read.All":e.name.includes("Mail.Send")?"Mail.Send":"User.Read").filter((e,t,n)=>n.indexOf(e)===t);e.push({name:"Grant these scopes",ok:!1,detail:n.join(", ")})}}catch(l){}return e}try{window.__sunbethRunDiagnostics=Nh}catch(Pp){}const Oh=new class{constructor(){this.logs=[],this.stepStartTimes=new Map}startStep(e,t,n){this.stepStartTimes.set(e,Date.now()),this.log("info",e,"Started: ".concat(t),n)}endStep(e,t,n){const r=this.stepStartTimes.get(e),a=r?Date.now()-r:void 0;this.stepStartTimes.delete(e),this.log("success",e,"Completed: ".concat(t),n,a)}log(e,t,n,r,a){const i={timestamp:(new Date).toISOString(),level:e,step:t,message:n,data:r,duration:a};this.logs.push(i);const s="[".concat(e.toUpperCase(),"] ").concat(t,": ").concat(n);switch(e){case"error":console.error(s,r);break;case"warn":console.warn(s,r);break;case"debug":console.debug(s,r);break;case"success":console.info("\u2705 ".concat(s).concat(a?" (".concat(a,"ms)"):""),r);break;default:console.info(s,r)}try{window.dispatchEvent(new CustomEvent("sunbeth:batchLog",{detail:i}))}catch(o){}}error(e,t,n){this.log("error",e,t,{error:(null===n||void 0===n?void 0:n.message)||n})}warn(e,t,n){this.log("warn",e,t,n)}info(e,t,n){this.log("info",e,t,n)}debug(e,t,n){this.log("debug",e,t,n)}success(e,t,n){this.log("success",e,t,n)}getLogs(){return[...this.logs]}getLogsForStep(e){return this.logs.filter(t=>t.step===e)}clearLogs(){this.logs=[],this.stepStartTimes.clear()}exportLogs(){return JSON.stringify(this.logs,null,2)}},Mh=t=>{let{isVisible:n,onClose:r}=t;const[a,i]=(0,e.useState)([]),[s,o]=(0,e.useState)("all"),[l,c]=(0,e.useState)("all"),[d,u]=(0,e.useState)(!0),h=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=e=>{i(t=>[...t,e.detail])};return window.addEventListener("sunbeth:batchLog",e),i(Oh.getLogs()),()=>{window.removeEventListener("sunbeth:batchLog",e)}},[]),(0,e.useEffect)(()=>{d&&h.current&&h.current.scrollIntoView({behavior:"smooth"})},[a,d]);const p=a.filter(e=>("all"===s||e.level===s)&&("all"===l||e.step===l)),f=Array.from(new Set(a.map(e=>e.step))).sort(),m=e=>{switch(e){case"error":return"#ff4444";case"warn":return"#ffaa00";case"success":return"#44aa44";case"debug":return"#888888";default:return"#4488ff"}},g=e=>{switch(e){case"error":return"\u274c";case"warn":return"\u26a0\ufe0f";case"success":return"\u2705";case"debug":return"\ud83d\udd0d";default:return"\u2139\ufe0f"}};return n?(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,x.jsxs)("div",{style:{backgroundColor:"#1e1e1e",color:"#ffffff",borderRadius:"8px",padding:"20px",width:"90%",maxWidth:"1200px",height:"80%",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #333"},children:[(0,x.jsx)("h2",{style:{margin:0,color:"#ffffff"},children:"Batch Creation Debug Console"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,x.jsx)("button",{onClick:()=>{i([]),Oh.clearLogs()},style:{padding:"8px 16px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear Logs"}),(0,x.jsx)("button",{onClick:()=>{const e=JSON.stringify(a,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="batch-creation-logs-".concat((new Date).toISOString(),".json"),r.click(),URL.revokeObjectURL(n)},style:{padding:"8px 16px",backgroundColor:"#4488ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Export Logs"}),(0,x.jsx)("button",{onClick:r,style:{padding:"8px 16px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{marginRight:"8px"},children:"Level:"}),(0,x.jsxs)("select",{value:s,onChange:e=>o(e.target.value),style:{padding:"4px 8px",backgroundColor:"#333",color:"white",border:"1px solid #555",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"all",children:"All"}),(0,x.jsx)("option",{value:"info",children:"Info"}),(0,x.jsx)("option",{value:"success",children:"Success"}),(0,x.jsx)("option",{value:"warn",children:"Warning"}),(0,x.jsx)("option",{value:"error",children:"Error"}),(0,x.jsx)("option",{value:"debug",children:"Debug"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{marginRight:"8px"},children:"Step:"}),(0,x.jsxs)("select",{value:l,onChange:e=>c(e.target.value),style:{padding:"4px 8px",backgroundColor:"#333",color:"white",border:"1px solid #555",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"all",children:"All Steps"}),f.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),(0,x.jsx)("div",{style:{marginLeft:"auto"},children:(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked)}),"Auto-scroll"]})}),(0,x.jsxs)("div",{style:{color:"#ccc"},children:["Showing ",p.length," of ",a.length," logs"]})]}),(0,x.jsxs)("div",{style:{flex:1,backgroundColor:"#0d1117",border:"1px solid #333",borderRadius:"4px",padding:"10px",overflow:"auto",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"13px",lineHeight:"1.4"},children:[0===p.length?(0,x.jsx)("div",{style:{color:"#888",textAlign:"center",padding:"20px"},children:"No logs to display"}):p.map((e,t)=>(0,x.jsxs)("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"error"===e.level?"rgba(255,68,68,0.1)":"warn"===e.level?"rgba(255,170,0,0.1)":"success"===e.level?"rgba(68,170,68,0.1)":"rgba(68,136,255,0.05)",border:"1px solid ".concat(m(e.level),"20"),borderRadius:"4px",borderLeft:"4px solid ".concat(m(e.level))},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("span",{children:g(e.level)}),(0,x.jsx)("span",{style:{color:m(e.level),fontWeight:"bold"},children:e.level.toUpperCase()}),(0,x.jsxs)("span",{style:{color:"#888",fontSize:"11px"},children:["[",e.step,"]"]}),e.duration&&(0,x.jsxs)("span",{style:{color:"#888",fontSize:"11px"},children:["(",e.duration,"ms)"]})]}),(0,x.jsx)("span",{style:{color:"#666",fontSize:"11px"},children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,x.jsx)("div",{style:{color:"#e6e6e6",marginBottom:"4px"},children:e.message}),e.data&&(0,x.jsxs)("details",{style:{marginTop:"8px"},children:[(0,x.jsx)("summary",{style:{color:"#888",cursor:"pointer",fontSize:"11px",userSelect:"none"},children:"Show Data"}),(0,x.jsx)("pre",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#161b22",border:"1px solid #333",borderRadius:"4px",overflow:"auto",fontSize:"11px",color:"#c9d1d9"},children:JSON.stringify(e.data,null,2)})]})]},t)),(0,x.jsx)("div",{ref:h})]})]})}):null};var Fh=__webpack_require__(4239);const Dh=["Admin","Manager","Employee"],Lh=()=>{const t=(0,P.Kr)(),{account:n}=(0,_.As)(),[r,a]=(0,e.useState)([]),[i,s]=(0,e.useState)({}),[o,l]=(0,e.useState)(!1),[c,u]=(0,e.useState)("role"),[h,p]=(0,e.useState)(""),[f,m]=(0,e.useState)({}),[g,v]=(0,e.useState)([]),[y,b]=(0,e.useState)(""),[w,A]=(0,e.useState)({}),[S,C]=(0,e.useState)({departments:[],jobTitles:[],locations:[]}),[E,T]=(0,e.useState)([]),[k,I]=(0,e.useState)(!1),[R,N]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{try{const n=await(0,Fh.PQ)();a(n);const r={};for(const e of Dh){const t=await(0,Fh.bn)(e),a={};for(const e of n)a[e.key]=!1;t.forEach(e=>{a[e.permKey]=!!e.value}),r[e]=a}if(s(r),t){const e=await(0,L.O0)(),t=Array.from(new Set(e.map(e=>e.email.toLowerCase())));v(t)}try{const e=await(async()=>{try{var e,t;return await(null===(e=(t=(0,_.As)()).getToken)||void 0===e?void 0:e.call(t,["User.Read.All"]))}catch(n){return}})();if(e){const t=await Lr(e);C(t)}}catch(e){}}catch(n){(0,ct.P0)("Failed to load RBAC matrix","error")}})()},[t]);const O=async e=>{l(!0);try{const t=await(0,Fh.ug)(e),n={};r.forEach(e=>n[e.key]=!1),t.forEach(e=>n[e.permKey]=!!e.value),m(n)}catch(Pp){(0,ct.P0)("Failed to load user overrides","error")}finally{l(!1)}},M=async()=>{N(null);const e=y.trim();if(e){I(!0);try{var t,n;const r=await(null===(t=(n=(0,_.As)()).getToken)||void 0===t?void 0:t.call(n,["User.Read.All"]));if(!r)throw new Error("Sign in to search directory");const a=await Mr(r,{search:e,department:w.department,jobTitle:w.jobTitle,location:w.location});T(Array.isArray(a)?a.slice(0,100):[])}catch(r){N("string"===typeof(null===r||void 0===r?void 0:r.message)?r.message:"Search failed"),T([])}finally{I(!1)}}else T([])};(0,e.useEffect)(()=>{const e=setTimeout(()=>{M()},500);return()=>clearTimeout(e)},[y,w.department,w.jobTitle,w.location]);const F=(0,e.useMemo)(()=>{const e={};for(const t of r){const n=t.category||"General";(e[n]=e[n]||[]).push(t)}return e},[r]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12,borderBottom:"1px solid #eee"},children:[(0,x.jsx)("button",{className:"role"===c?"btn sm":"btn ghost sm",onClick:()=>u("role"),children:"By Role"}),(0,x.jsx)("button",{className:"user"===c?"btn sm":"btn ghost sm",onClick:()=>u("user"),children:"By User"})]}),"role"===c&&(0,x.jsxs)("div",{style:{display:"grid",gap:16},children:[Object.keys(F).map(e=>(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:e}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"table",style:{minWidth:600},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{style:{textAlign:"left"},children:"Permission"}),Dh.map(e=>(0,x.jsx)("th",{style:{textAlign:"center"},children:e},e))]})}),(0,x.jsx)("tbody",{children:F[e].map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[(0,x.jsx)("div",{style:{fontWeight:500},children:e.label}),(0,x.jsx)("div",{className:"small muted",children:e.description})]}),Dh.map(t=>{var n;return(0,x.jsx)("td",{style:{textAlign:"center"},children:(0,x.jsx)("input",{type:"checkbox",checked:!(null===(n=i[t])||void 0===n||!n[e.key]),onChange:n=>s(r=>(0,d.A)((0,d.A)({},r),{},{[t]:(0,d.A)((0,d.A)({},r[t]||{}),{},{[e.key]:n.target.checked})}))})},t)})]},e.key))})]})})]},e)),(0,x.jsx)("div",{style:{display:"flex",gap:8},children:Dh.map(e=>(0,x.jsxs)("button",{className:"btn sm",onClick:()=>(async e=>{l(!0);try{await(0,Fh.R8)(e,i[e]||{}),(0,ct.P0)("Saved ".concat(e," permissions"),"success")}catch(t){(0,ct.P0)("Failed to save role permissions","error")}finally{l(!1)}})(e),disabled:o,children:["Save ",e]},e))})]}),"user"===c&&(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,x.jsx)("input",{type:"email",placeholder:"user@domain.com",value:h,onChange:e=>p(e.target.value)}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>O(h),disabled:o,children:"Load"}),g.length>0&&(0,x.jsxs)("select",{value:h,onChange:e=>{p(e.target.value),O(e.target.value)},children:[(0,x.jsx)("option",{value:"",children:"Select known user\u2026"}),g.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(null===n||void 0===n?void 0:n.username)&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{p(n.username),O(n.username)},children:"Use my email"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsx)("div",{className:"small",style:{marginBottom:8},children:"Search directory"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8},children:[(0,x.jsx)("input",{placeholder:"Search by name or email",value:y,onChange:e=>b(e.target.value)}),(0,x.jsx)("button",{className:"btn sm",onClick:M,disabled:k,children:"Search"})]}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[(0,x.jsxs)("select",{value:w.department||"",onChange:e=>A(t=>(0,d.A)((0,d.A)({},t),{},{department:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All departments"}),S.departments.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsxs)("select",{value:w.jobTitle||"",onChange:e=>A(t=>(0,d.A)((0,d.A)({},t),{},{jobTitle:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All job titles"}),S.jobTitles.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsxs)("select",{value:w.location||"",onChange:e=>A(t=>(0,d.A)((0,d.A)({},t),{},{location:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All locations"}),S.locations.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),R&&(0,x.jsx)("div",{className:"small",style:{color:"#d33",marginTop:6},children:R}),k&&(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"Searching..."}),!k&&E.length>0&&(0,x.jsx)("div",{style:{maxHeight:220,overflowY:"auto",marginTop:8,display:"grid",gap:6},children:E.map(e=>{const t=(e.mail||e.userPrincipalName||"").trim();return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.displayName||t||e.id}),(0,x.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t})]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{p(t),O(t),u("user")},children:"Load"})]},e.id)})})]}),r.length>0&&(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[Object.keys(F).map(e=>(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:e}),(0,x.jsx)("div",{style:{display:"grid",gap:8},children:F[e].map(e=>(0,x.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:!!f[e.key],onChange:t=>m(n=>(0,d.A)((0,d.A)({},n),{},{[e.key]:t.target.checked}))}),(0,x.jsx)("span",{children:e.label}),(0,x.jsxs)("span",{className:"muted",children:["\u2014 ",e.description]})]},e.key))})]},e)),(0,x.jsx)("div",{children:(0,x.jsx)("button",{className:"btn sm",onClick:async()=>{const e=h.trim().toLowerCase();if(e&&e.includes("@")){l(!0);try{await(0,Fh.sR)(e,f),(0,ct.P0)("Saved user overrides","success")}catch(t){(0,ct.P0)("Failed to save user overrides","error")}finally{l(!1)}}else(0,ct.P0)("Enter a valid user email","warning")},disabled:o||!h,children:"Save User Overrides"})})]})]})]})},jh=t=>{let{canEdit:n}=t;const{getToken:r,login:a,account:i}=(0,_.As)(),[s,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(!1),[u,h]=(0,e.useState)(""),[p,f]=(0,e.useState)("Manager"),m=(0,P.Kr)(),[g,v]=(0,e.useState)(""),[y,b]=(0,e.useState)([]),[w,A]=(0,e.useState)(!1),[S,C]=(0,e.useState)(null),[E,T]=(0,e.useState)({}),[k,I]=(0,e.useState)({departments:[],jobTitles:[],locations:[]}),[R,N]=(0,e.useState)(new Set),O=(0,e.useCallback)(async()=>{if(m)try{const e=await(0,L.O0)();o(Array.isArray(e)?e:[])}catch(e){o([])}else o([])},[m]);(0,e.useEffect)(()=>{O()},[m]),(0,e.useEffect)(()=>{(async()=>{try{const e=await r(["User.Read.All"]);if(!e)return;const t=await Lr(e);I(t)}catch(e){}})()},[r]);const M=(0,e.useCallback)(async()=>{if(C(null),g.trim()){A(!0);try{const e=await r(["User.Read.All"]);if(!e)throw new Error("Sign-in required");const t=await Mr(e,{search:g.trim(),department:E.department,jobTitle:E.jobTitle,location:E.location});b(Array.isArray(t)?t.slice(0,200):[])}catch(e){C("string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:"Failed to search users"),b([])}finally{A(!1)}}else b([])},[E.department,E.jobTitle,E.location,r,g]);(0,e.useEffect)(()=>{const e=setTimeout(()=>{M()},450);return()=>clearTimeout(e)},[g,E.department,E.jobTitle,E.location,M]);const F=async(e,t)=>{if(!n||!m)return;const r=(e.mail||e.userPrincipalName||"").trim().toLowerCase();if(r){c(!0);try{const n=s.find(e=>(e.email||"").toLowerCase()===r);if(n){if(n.role===t)return(0,ct.P0)("".concat(e.displayName||r," already ").concat(t),"info"),void c(!1);try{await(0,L.EO)(n.id)}catch(a){}}await(0,L.rd)(r,t),await O(),(0,ct.P0)("Assigned ".concat(t," to ").concat(e.displayName||r),"success")}catch(Pp){(0,ct.P0)("Failed to assign role","error")}finally{c(!1)}}else(0,ct.P0)("User has no email/UPN","warning")},D=async e=>{if(n&&m&&0!==R.size){c(!0);try{for(const t of Array.from(R)){const n=y.find(e=>e.id===t);n&&await F(n,e)}N(new Set),(0,ct.P0)("Assigned ".concat(e," to ").concat(R.size," user(s)"),"success")}catch(t){(0,ct.P0)("Bulk assign failed","error")}finally{c(!1)}}},j=s.reduce((e,t)=>{const n=t.role||"Unknown";return(e[n]=e[n]||[]).push(t),e},{});return m?(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"card",style:{padding:12,marginBottom:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Find users"}),(0,x.jsx)("div",{className:"small muted",children:"Search your directory and assign Admin/Manager"})]}),!i&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>a(),children:"Sign in"})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,marginTop:8},children:[(0,x.jsx)("input",{placeholder:"Search by name or email",value:g,onChange:e=>v(e.target.value)}),(0,x.jsx)("button",{className:"btn sm",onClick:M,disabled:w,children:"Search"})]}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:8},children:[(0,x.jsxs)("select",{value:E.department||"",onChange:e=>T(t=>(0,d.A)((0,d.A)({},t),{},{department:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All departments"}),k.departments.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsxs)("select",{value:E.jobTitle||"",onChange:e=>T(t=>(0,d.A)((0,d.A)({},t),{},{jobTitle:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All job titles"}),k.jobTitles.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsxs)("select",{value:E.location||"",onChange:e=>T(t=>(0,d.A)((0,d.A)({},t),{},{location:e.target.value||void 0})),children:[(0,x.jsx)("option",{value:"",children:"All locations"}),k.locations.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]})]}),R.size>0&&(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",marginTop:8},children:[(0,x.jsxs)("span",{children:[R.size," selected"]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>D("Manager"),disabled:!n||l,children:"Assign Manager"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>D("Admin"),disabled:!n||l,children:"Assign Admin"})]}),S&&(0,x.jsx)("div",{className:"small",style:{color:"#d33",marginTop:6},children:S}),w&&(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"Loading..."}),!w&&y.length>0&&(0,x.jsx)("div",{style:{marginTop:8,maxHeight:220,overflowY:"auto",display:"grid",gap:6},children:y.map(e=>{const t=(e.mail||e.userPrincipalName||"").trim(),r=s.find(e=>(e.email||"").toLowerCase()===(t||"").toLowerCase());return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto auto",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{type:"checkbox",checked:R.has(e.id),onChange:()=>{return t=e.id,void N(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t}}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.displayName||t||e.id}),(0,x.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t}),r&&(0,x.jsx)("span",{className:"badge",style:{marginTop:4},children:r.role})]}),!r&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>F(e,"Manager"),disabled:!n||l,children:"Assign Manager"}),!r&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>F(e,"Admin"),disabled:!n||l,children:"Assign Admin"}),r&&(0,x.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,x.jsxs)("button",{className:"btn ghost sm",onClick:()=>F(e,"Admin"===r.role?"Manager":"Admin"),disabled:!n||l,children:["Change to ","Admin"===r.role?"Manager":"Admin"]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{c(!0),await(0,L.EO)(r.id),await O(),(0,ct.P0)("Role removed","success")}catch(e){(0,ct.P0)("Failed to remove role","error")}finally{c(!1)}},disabled:!n||l,children:"Remove"})]})]},e.id)})})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:12},children:[(0,x.jsx)("input",{type:"email",placeholder:"user@domain.com",value:u,onChange:e=>h(e.target.value),style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),(0,x.jsxs)("select",{value:p,onChange:e=>f(e.target.value),style:{padding:8,border:"1px solid #ddd",borderRadius:6},children:[(0,x.jsx)("option",{value:"Manager",children:"Manager"}),(0,x.jsx)("option",{value:"Admin",children:"Admin"})]}),(0,x.jsx)("button",{className:"btn sm",onClick:async()=>{if(!n||!m)return;const e=u.trim().toLowerCase();if(e&&e.includes("@")){c(!0);try{await(0,L.rd)(e,p),h(""),await O(),(0,ct.P0)("Role added","success")}catch(t){(0,ct.P0)("Failed to add role","error")}finally{c(!1)}}else(0,ct.P0)("Enter a valid email","warning")},disabled:!n||l,children:"Add"}),!n&&(0,x.jsx)("span",{className:"small muted",children:"Read-only"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{const e=[["email","role"]].concat(s.map(e=>[e.email,e.role])),t=e.map(e=>e.map(e=>'"'+String(null!==e&&void 0!==e?e:"").replace(/"/g,'""')+'"').join(",")).join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="roles.csv",a.click(),URL.revokeObjectURL(r)},title:"Export current role assignments as CSV",children:"Export CSV"})]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:12},children:["Admin","Manager"].map(e=>(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsxs)("div",{style:{fontWeight:700,marginBottom:6},children:[e,"s"]}),Array.isArray(j[e])&&j[e].length>0?(0,x.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:j[e].map(e=>(0,x.jsxs)("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f2f2f2"},children:[(0,x.jsx)("span",{className:"small",children:e.email}),n&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{if(n&&m){c(!0);try{await(0,L.EO)(e),await O(),(0,ct.P0)("Role removed","success")}catch(t){(0,ct.P0)("Failed to remove role","error")}finally{c(!1)}}})(e.id),disabled:l,children:"Remove"})]},e.id))}):(0,x.jsxs)("div",{className:"small muted",children:["No ",e.toLowerCase(),"s assigned"]})]},e))})]}):(0,x.jsx)("div",{className:"small muted",children:"Enable SQLite to manage roles."})},Bh=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)},Uh=e=>{if(!e||0===e.length)return new Blob([""],{type:"text/csv;charset=utf-8"});const t=Object.keys(e[0]),n=[t.join(",")];for(const r of e){const e=t.map(e=>{const t=null==r[e]?"":String(r[e]),n=/[",\n]/.test(t),a=t.replace(/"/g,'""');return n?'"'.concat(a,'"'):a}).join(",");n.push(e)}return new Blob([n.join("\n")],{type:"text/csv;charset=utf-8"})},Gh=()=>{const e=Rh.book_new();Rh.book_append_sheet(e,Rh.json_to_sheet([{Field:"email",Required:"Yes",Notes:"Primary key. Valid email address."},{Field:"name",Required:"No",Notes:"Full name (optional)."},{Field:"phone",Required:"No",Notes:"Phone number (optional)."},{Field:"status",Required:"No",Notes:"invited | active | disabled (default: invited for new records)"}]),"READ_ME");Rh.book_append_sheet(e,Rh.json_to_sheet([{email:"user1@example.com",name:"Ada Lovelace",phone:"+2348100000000",status:"invited"},{email:"user2@example.com",name:"Grace Hopper",phone:"+2348100000001",status:"active"}]),"ExternalUsers");const t=bh(e,{bookType:"xlsx",type:"array"});Bh(new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"external-users-template.xlsx")},Hh=()=>{Bh(Uh([{email:"user1@example.com",name:"Ada Lovelace",phone:"+2348100000000",status:"invited"},{email:"user2@example.com",name:"Grace Hopper",phone:"+2348100000001",status:"active"}]),"external-users-template.csv")},zh=()=>{const e=Rh.book_new();Rh.book_append_sheet(e,Rh.json_to_sheet([{Field:"name",Required:"Yes",Notes:"Business display name. Used for upsert if code is missing."},{Field:"code",Required:"No",Notes:"Unique short code (preferred upsert key)."},{Field:"description",Required:"No",Notes:"Optional description."},{Field:"isActive",Required:"No",Notes:"true|false or 1|0 (default: true for new records)"}]),"READ_ME");Rh.book_append_sheet(e,Rh.json_to_sheet([{name:"Retail",code:"RET",description:"Retail business unit",isActive:!0},{name:"Wholesale",code:"WHO",description:"Wholesale unit",isActive:1}]),"Businesses");const t=bh(e,{bookType:"xlsx",type:"array"});Bh(new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"businesses-template.xlsx")},Wh=()=>{Bh(Uh([{name:"Retail",code:"RET",description:"Retail business unit",isActive:!0},{name:"Wholesale",code:"WHO",description:"Wholesale unit",isActive:1}]),"businesses-template.csv")},qh=()=>{const e=Rh.book_new();Rh.book_append_sheet(e,Rh.json_to_sheet([{Section:"ExternalUsers",Notes:"email (required), name, phone, status: invited|active|disabled"},{Section:"Businesses",Notes:"name (required), code (preferred), description, isActive: true|false|1|0"}]),"README"),Rh.book_append_sheet(e,Rh.json_to_sheet([{email:"user1@example.com",name:"Ada Lovelace",phone:"+2348100000000",status:"invited"}]),"ExternalUsers"),Rh.book_append_sheet(e,Rh.json_to_sheet([{name:"Retail",code:"RET",description:"Retail business unit",isActive:!0}]),"Businesses");const t=bh(e,{bookType:"xlsx",type:"array"});Bh(new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"import-templates.xlsx")},Vh=t=>{let{canEdit:n=!0}=t;const r=(0,P.Gi)()||"",[a,i]=(0,e.useState)(!1),[s,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(""),[u,h]=(0,e.useState)(""),[p,f]=(0,e.useState)(50),[m,g]=(0,e.useState)(0),[v,y]=(0,e.useState)(""),[b,w]=(0,e.useState)(""),[_,A]=(0,e.useState)(""),[S,C]=(0,e.useState)(!1),E=async()=>{i(!0);try{const e=new URL("".concat(r,"/api/external-users"));l.trim()&&e.searchParams.set("q",l.trim()),u&&e.searchParams.set("status",u),e.searchParams.set("limit",String(p)),e.searchParams.set("offset",String(m));const t=await fetch(e.toString(),{cache:"no-store"}),n=await t.json();o(Array.isArray(null===n||void 0===n?void 0:n.users)?n.users:[])}catch(e){(0,ct.P0)("Failed to load users","error")}finally{i(!1)}};(0,e.useEffect)(()=>{E()},[l,u,p,m]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8,flexWrap:"wrap"},children:[(0,x.jsx)("input",{placeholder:"Search email, name, phone",value:l,onChange:e=>{c(e.target.value),g(0)}}),(0,x.jsxs)("select",{value:u,onChange:e=>{h(e.target.value),g(0)},children:[(0,x.jsx)("option",{value:"",children:"All statuses"}),(0,x.jsx)("option",{value:"invited",children:"Invited"}),(0,x.jsx)("option",{value:"active",children:"Active"}),(0,x.jsx)("option",{value:"disabled",children:"Disabled"})]}),(0,x.jsxs)("select",{value:p,onChange:e=>f(Number(e.target.value)),children:[(0,x.jsx)("option",{value:25,children:"25"}),(0,x.jsx)("option",{value:50,children:"50"}),(0,x.jsx)("option",{value:100,children:"100"})]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>g(e=>Math.max(0,e-p)),disabled:0===m,children:"Prev"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>g(e=>e+p),children:"Next"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{E()},children:"Refresh"})]}),n&&(0,x.jsxs)("div",{className:"card",style:{padding:12,marginBottom:12},children:[(0,x.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Invite external user"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:8},children:[(0,x.jsx)("input",{type:"email",placeholder:"user@domain.com",value:v,onChange:e=>y(e.target.value)}),(0,x.jsx)("input",{placeholder:"Name (optional)",value:b,onChange:e=>w(e.target.value)}),(0,x.jsx)("input",{placeholder:"Phone (optional)",value:_,onChange:e=>A(e.target.value)}),(0,x.jsx)("button",{className:"btn sm",onClick:async()=>{try{const e=v.trim().toLowerCase();if(!e||!e.includes("@"))return void(0,ct.P0)("Enter a valid email","warning");if(!(await fetch("".concat(r,"/api/external-users/invite"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,name:b,phone:_})})).ok)throw new Error("invite_failed");y(""),w(""),A(""),(0,ct.P0)("Invite sent","success"),E()}catch(e){(0,ct.P0)("Invite failed","error")}},children:"Invite"})]})]}),(0,x.jsxs)("div",{className:"card",style:{padding:12,marginBottom:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Bulk upload"}),(0,x.jsx)("div",{className:"small muted",children:"Upload External Users from CSV or Excel. You can also invite individuals above."})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn ghost xs",onClick:Gh,children:"Template (Excel)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:Hh,children:"Template (CSV)"})]})]}),(0,x.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>{var t;return(async t=>{if(t){C(!0);try{const e=new FormData;e.append("file",t,t.name);const n=await fetch("".concat(r,"/api/external-users/bulk-upload"),{method:"POST",body:e}),a=await n.json().catch(()=>({}));if(!n.ok)throw new Error((null===a||void 0===a?void 0:a.error)||"bulk_upload_failed");if((0,ct.P0)("Bulk uploaded: ".concat((null===a||void 0===a?void 0:a.inserted)||0," inserted, ").concat((null===a||void 0===a?void 0:a.updated)||0," updated"),"success"),Array.isArray(null===a||void 0===a?void 0:a.errors)&&a.errors.length>0){const e=Object.keys(a.errors[0]),t=[e.join(",")].concat(a.errors.map(t=>e.map(e=>{const n=null==t[e]?"":String(t[e]),r=/[",\n]/.test(n),a=n.replace(/"/g,'""');return r?'"'.concat(a,'"'):a}).join(","))),n=new Blob([t.join("\n")],{type:"text/csv;charset=utf-8"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="external-users-errors.csv",i.click(),URL.revokeObjectURL(r),(0,ct.P0)("".concat(a.errors.length," row(s) had issues. Downloaded error report."),"warning")}E()}catch(e){(0,ct.P0)("Bulk upload failed","error")}finally{C(!1)}}})((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},disabled:S}),S&&(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"Uploading..."})]}),a?(0,x.jsx)("div",{className:"small muted",children:"Loading..."}):0===s.length?(0,x.jsx)("div",{className:"small muted",children:"No users found."}):(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"table",style:{minWidth:800},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Email"}),(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Phone"}),(0,x.jsx)("th",{children:"Status"}),(0,x.jsx)("th",{children:"MFA"}),(0,x.jsx)("th",{children:"Created"}),(0,x.jsx)("th",{children:"Last Login"}),n&&(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:s.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:e.email}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{value:e.name||"",onChange:t=>o(n=>n.map(n=>n.id===e.id?(0,d.A)((0,d.A)({},n),{},{name:t.target.value}):n)),disabled:!n})}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{value:e.phone||"",onChange:t=>o(n=>n.map(n=>n.id===e.id?(0,d.A)((0,d.A)({},n),{},{phone:t.target.value}):n)),disabled:!n})}),(0,x.jsx)("td",{children:(0,x.jsxs)("select",{value:(e.status||"").toLowerCase(),onChange:t=>o(n=>n.map(n=>n.id===e.id?(0,d.A)((0,d.A)({},n),{},{status:t.target.value}):n)),disabled:!n,children:[(0,x.jsx)("option",{value:"invited",children:"invited"}),(0,x.jsx)("option",{value:"active",children:"active"}),(0,x.jsx)("option",{value:"disabled",children:"disabled"})]})}),(0,x.jsx)("td",{children:(0,x.jsx)("input",{type:"checkbox",checked:!!e.mfa_enabled,onChange:t=>o(n=>n.map(n=>n.id===e.id?(0,d.A)((0,d.A)({},n),{},{mfa_enabled:t.target.checked}):n)),disabled:!n})}),(0,x.jsx)("td",{className:"small muted",children:e.created_at?new Date(e.created_at).toLocaleString():""}),(0,x.jsx)("td",{className:"small muted",children:e.last_login?new Date(e.last_login).toLocaleString():""}),n&&(0,x.jsx)("td",{children:(0,x.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async(e,t)=>{try{if(!(await fetch("".concat(r,"/api/external-users/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("update_failed");(0,ct.P0)("Saved","success"),E()}catch(n){(0,ct.P0)("Update failed","error")}})(e.id,{name:e.name,phone:e.phone,status:e.status,mfa_enabled:!!e.mfa_enabled}),children:"Save"}),"invited"===(e.status||"").toLowerCase()&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{try{if(!(await fetch("".concat(r,"/api/external-users/resend"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)throw new Error("resend_failed");(0,ct.P0)("Invite resent","success")}catch(t){(0,ct.P0)("Resend failed","error")}})(e.email),children:"Resend invite"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{try{if(!window.confirm("Delete this external user?"))return;if(!(await fetch("".concat(r,"/api/external-users/").concat(e),{method:"DELETE"})).ok)throw new Error("delete_failed");(0,ct.P0)("Deleted","success"),E()}catch(t){(0,ct.P0)("Delete failed","error")}})(e.id),children:"Delete"})]})})]},e.id))})]})})]})},Kh=()=>{const t=(0,P.Gi)()||"",[n,r]=(0,e.useState)(!1);return(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Businesses Bulk Upload"}),(0,x.jsx)("div",{className:"small muted",children:"Upload Businesses from CSV or Excel."})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn ghost xs",onClick:zh,children:"Template (Excel)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:Wh,children:"Template (CSV)"})]})]}),(0,x.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>{var n;return(async n=>{if(n){r(!0);try{const e=new FormData;e.append("file",n,n.name);const r=await fetch("".concat(t,"/api/businesses/bulk-upload"),{method:"POST",body:e}),a=await r.json().catch(()=>({}));if(!r.ok)throw new Error((null===a||void 0===a?void 0:a.error)||"bulk_upload_failed");if((0,ct.P0)("Processed: ".concat((null===a||void 0===a?void 0:a.inserted)||0," inserted, ").concat((null===a||void 0===a?void 0:a.updated)||0," updated"),"success"),Array.isArray(null===a||void 0===a?void 0:a.errors)&&a.errors.length>0){const e=Object.keys(a.errors[0]),t=[e.join(",")].concat(a.errors.map(t=>e.map(e=>{const n=null==t[e]?"":String(t[e]),r=/[",\n]/.test(n),a=n.replace(/"/g,'""');return r?'"'.concat(a,'"'):a}).join(","))),n=new Blob([t.join("\n")],{type:"text/csv;charset=utf-8"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="businesses-errors.csv",i.click(),URL.revokeObjectURL(r),(0,ct.P0)("".concat(a.errors.length," row(s) had issues. Downloaded error report."),"warning")}}catch(e){(0,ct.P0)("Bulk upload failed","error")}finally{r(!1)}}})((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)},disabled:n}),n&&(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"Uploading..."})]})},Yh=[25,50,100,200],Xh=()=>{const t=(0,P.Gi)()||"",[n,r]=(0,e.useState)(!1),[a,i]=(0,e.useState)(null),[s,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)(""),[h,p]=(0,e.useState)(""),[f,m]=(0,e.useState)(""),[g,v]=(0,e.useState)(""),[y,b]=(0,e.useState)(""),[w,_]=(0,e.useState)(""),[A,S]=(0,e.useState)(50),[C,E]=(0,e.useState)(1),[T,k]=(0,e.useState)(!1),I=(0,e.useRef)(null),[R,N]=(0,e.useState)(null),[O,M]=(0,e.useState)({key:"id",dir:"desc"}),[F,D]=(0,e.useState)(!1),L=(0,e.useRef)(null);(0,e.useEffect)(()=>{if(F){const e=window.setTimeout(()=>{try{var e;null===(e=L.current)||void 0===e||e.focus()}catch(t){}},50);return()=>window.clearTimeout(e)}},[F]);const j=(0,e.useMemo)(()=>{const e={limit:String(A),offset:String((C-1)*A)};return l.trim()&&(e.q=l.trim()),d&&(e.event=d),h.trim()&&(e.email=h.trim()),f&&(e.result=f),g.trim()&&(e.ip=g.trim()),y&&(e.since=(e=>{if(!e)return"";const t=new Date(e);return t.setHours(0,0,0,0),t.toISOString()})(y)),w&&(e.until=(e=>{if(!e)return"";const t=new Date(e);return t.setHours(23,59,59,999),t.toISOString()})(w)),e},[l,d,h,f,g,y,w,C,A]),U=async()=>{r(!0),i(null);try{const e=new URLSearchParams(j).toString(),n=await fetch("".concat(t,"/api/audit-logs?").concat(e),{cache:"no-store"});if(!n.ok)throw new Error("HTTP ".concat(n.status));const r=await n.json(),a=[...Array.isArray(null===r||void 0===r?void 0:r.logs)?r.logs:[]].sort((e,t)=>{const{key:n,dir:r}=O;let a=e[n],i=t[n];return"ts"===n&&(a=new Date(e.ts).getTime(),i=new Date(t.ts).getTime()),a<i?"asc"===r?-1:1:a>i?"asc"===r?1:-1:0});o(a)}catch(e){i("Failed to load audit logs")}finally{r(!1)}};(0,e.useEffect)(()=>{const e=setTimeout(()=>{E(1),U()},250);return()=>clearTimeout(e)},[j]),(0,e.useEffect)(()=>{if(!y&&!w){const e=new Date,t=new Date(e);t.setDate(e.getDate()-7);const n=e=>String(e).padStart(2,"0"),r=e=>"".concat(e.getFullYear(),"-").concat(n(e.getMonth()+1),"-").concat(n(e.getDate()));b(r(t)),_(r(e))}},[]),(0,e.useEffect)(()=>{if(T){const e=window.setInterval(()=>{U()},3e4);return I.current=e,()=>{window.clearInterval(e),I.current=null}}return I.current&&(window.clearInterval(I.current),I.current=null),()=>{}},[T]);const G=e=>{const t=new Date(e).getTime(),n=Date.now()-t,r=Math.floor(n/1e3);if(r<60)return"".concat(r,"s ago");const a=Math.floor(r/60);if(a<60)return"".concat(a,"m ago");const i=Math.floor(a/60);if(i<24)return"".concat(i,"h ago");const s=Math.floor(i/24);return"".concat(s,"d ago")},H=function(e){const t={ok:{bg:"#e8f5e9",fg:"#1b5e20",bd:"#c8e6c9"},warn:{bg:"#fff8e1",fg:"#8d6e63",bd:"#ffe0b2"},error:{bg:"#ffebee",fg:"#b71c1c",bd:"#ffcdd2"},info:{bg:"#e3f2fd",fg:"#0d47a1",bd:"#bbdefb"}},n=t[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"]||t.info;return(0,x.jsx)("span",{className:"small",style:{background:n.bg,color:n.fg,border:"1px solid ".concat(n.bd),padding:"2px 6px",borderRadius:999},children:e})},z=e=>{const t=String(e||"").toLowerCase();return"ok"===t?H("ok","ok"):t.includes("rate")||t.includes("limit")?H(t,"warn"):t.includes("locked")||t.includes("invalid")||t.includes("error")?H(t,"error"):H(t||"\u2014","info")},W=e=>{if("all"===e)return b(""),void _("");const t=new Date,n=new Date(t);"24h"===e?(n.setDate(t.getDate()),n.setHours(t.getHours()-24)):(n.setDate(t.getDate()-e),n.setHours(0,0,0,0));const r=e=>String(e).padStart(2,"0"),a=e=>"".concat(e.getFullYear(),"-").concat(r(e.getMonth()+1),"-").concat(r(e.getDate()));b(a(n)),_(a(t))},q=async e=>{try{await navigator.clipboard.writeText(e)}catch(t){}},V=e=>{let{label:t,onClick:n,active:r,title:a}=e;return(0,x.jsx)("button",{className:r?"btn sm":"btn ghost sm",onClick:n,title:a,style:{borderRadius:999},children:t})},K=e=>{if(!e)return"";try{const t=JSON.parse(e);return"object"===typeof t?JSON.stringify(t):String(e)}catch(t){return String(e)}},Y=(d?1:0)+(h?1:0)+(f?1:0)+(g?1:0)+(y?1:0)+(w?1:0);return(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap",marginBottom:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,color:"var(--primary)"},children:"Audit Logs"}),(0,x.jsx)("div",{className:"small muted",children:"Security events for external auth (login/reset/MFA/onboard)"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,x.jsx)("input",{placeholder:"Search (event/email/result/ip/details)",value:l,onChange:e=>c(e.target.value),style:{minWidth:240,width:360,maxWidth:"40vw",padding:6,border:"1px solid #ddd",borderRadius:6}}),(0,x.jsxs)("button",{className:"btn ghost sm",onClick:()=>D(!0),title:"Open filters",children:["Filters",Y?" (".concat(Y,")"):""]}),(0,x.jsx)("select",{value:A,onChange:e=>{S(Number(e.target.value)),E(1)},children:Yh.map(e=>(0,x.jsxs)("option",{value:e,children:[e,"/page"]},e))}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{U()},disabled:n,title:"Reload data",children:"Refresh"}),(0,x.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("input",{type:"checkbox",checked:T,onChange:e=>k(e.target.checked)})," Auto refresh"]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>{const e=e=>{const t=String(null!==e&&void 0!==e?e:"").replace(/"/g,'""');return'"'.concat(t,'"')},t=s.map(t=>[t.id,t.ts,t.event,t.email,t.ip||"",t.result||"",K(t.details)].map(e).join(",")).join("\n"),n=["id","ts","event","email","ip","result","details"].map(e=>'"'.concat(e,'"')).join(",")+"\n"+t,r=new Blob([n],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download="audit-logs.csv",i.click(),URL.revokeObjectURL(a)},disabled:0===s.length,children:"Export CSV"})]})]}),a&&(0,x.jsx)("div",{className:"small",style:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#b71c1c",padding:10,borderRadius:6,marginBottom:8},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsx)("span",{children:a}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{U()},children:"Retry"})]})}),n&&(0,x.jsx)("div",{className:"small",style:{marginBottom:8},children:(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,x.jsx)("i",{style:{width:"60%"}})})}),(0,x.jsx)("div",{style:{overflowX:"auto"},children:(0,x.jsxs)("table",{className:"small",style:{width:"100%",borderCollapse:"collapse"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{textAlign:"left",position:"sticky",top:0,background:"#fff",zIndex:1},children:[(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee",cursor:"pointer"},onClick:()=>M(e=>({key:"ts",dir:"asc"===e.dir?"desc":"asc"})),children:"Time"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"},children:"Event"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"},children:"Email"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"},children:"IP"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"},children:"Result"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"},children:"Details"}),(0,x.jsx)("th",{style:{padding:8,borderBottom:"1px solid #eee"}})]})}),(0,x.jsxs)("tbody",{children:[0===s.length&&!n&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:7,className:"small muted",style:{padding:12},children:"No audit entries."})}),s.map(e=>(0,x.jsxs)("tr",{style:{background:"ok"===(e.result||"").toLowerCase()?"transparent":"rgba(255, 235, 238, 0.3)"},children:[(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5",whiteSpace:"nowrap"},children:(0,x.jsx)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:(0,x.jsx)("span",{title:new Date(e.ts).toLocaleString(),children:G(e.ts)})})}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5"},children:e.event}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("span",{children:e.email}),e.email&&(0,x.jsx)("button",{className:"btn ghost sm",title:"Copy email",onClick:()=>q(e.email),children:"Copy"})]})}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("span",{children:e.ip||""}),e.ip&&(0,x.jsx)("button",{className:"btn ghost sm",title:"Copy IP",onClick:()=>e.ip&&q(e.ip),children:"Copy"})]})}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5"},children:z(e.result)}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5",maxWidth:420,overflow:"hidden",textOverflow:"ellipsis"},children:K(e.details)}),(0,x.jsx)("td",{style:{padding:8,borderBottom:"1px solid #f5f5f5"},children:(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>N(e),children:"View"})})]},e.id))]})]})}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:12},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>E(e=>Math.max(1,e-1)),disabled:C<=1,children:"Prev"}),(0,x.jsxs)("div",{className:"small muted",children:["Page ",C]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>E(e=>e+1),disabled:s.length<A,children:"Next"})]}),(0,x.jsx)(B,{open:F,onClose:()=>D(!1),title:"Filters",maxWidth:"90vw",children:(0,x.jsxs)("div",{className:"small",style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,x.jsx)("input",{ref:L,placeholder:"Event (e.g., login)",value:d,onChange:e=>u(e.target.value)}),(0,x.jsx)("input",{placeholder:"Email",value:h,onChange:e=>p(e.target.value)}),(0,x.jsx)("input",{placeholder:"Result (ok/error/locked)",value:f,onChange:e=>m(e.target.value)}),(0,x.jsx)("input",{placeholder:"IP",value:g,onChange:e=>v(e.target.value)}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small muted",children:"Since"}),(0,x.jsx)("input",{type:"date",value:y,onChange:e=>b(e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small muted",children:"Until"}),(0,x.jsx)("input",{type:"date",value:w,onChange:e=>_(e.target.value)})]})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,x.jsx)("span",{className:"muted",children:"Quick ranges:"}),(0,x.jsx)(V,{label:"24h",active:!!y&&!!w&&(new Date).getTime()-new Date(y).getTime()<=864e5,onClick:()=>W("24h")}),(0,x.jsx)(V,{label:"7d",active:!!y&&!!w&&(new Date).getTime()-new Date(y).getTime()<=6048e5,onClick:()=>W(7)}),(0,x.jsx)(V,{label:"30d",active:!!y&&!!w&&(new Date).getTime()-new Date(y).getTime()<=2592e6,onClick:()=>W(30)}),(0,x.jsx)(V,{label:"All",active:!y&&!w,onClick:()=>W("all")})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"small muted",style:{marginBottom:6},children:"Events"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[["login","password_reset_request","password_reset","mfa_setup","mfa_verify","onboard_set_password"].map(e=>(0,x.jsx)(V,{label:e,active:d===e,onClick:()=>u(e)},e)),d&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>u(""),children:"Clear event"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"small muted",style:{marginBottom:6},children:"Result"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[["ok","error","invalid_password","invalid_code","locked","rate_limited"].map(e=>(0,x.jsx)(V,{label:e,active:f===e,onClick:()=>m(e)},e)),f&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>m(""),children:"Clear result"})]})]}),(0,x.jsxs)("div",{style:{position:"sticky",bottom:0,background:"#fff",paddingTop:8,display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{c(""),u(""),p(""),m(""),v(""),b(""),_("")},children:"Reset all"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>D(!1),children:"Close"}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>D(!1),children:"Apply & Close"})]})]})]})}),(0,x.jsx)(B,{open:!!R,onClose:()=>N(null),title:"Audit Entry",children:R&&(0,x.jsxs)("div",{className:"small",style:{display:"grid",rowGap:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Time:"})," ",new Date(R.ts).toLocaleString()," (",G(R.ts),")"]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Event:"})," ",R.event]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Email:"})," ",R.email]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>q(R.email),children:"Copy"})]}),R.ip&&(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"IP:"})," ",R.ip]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>q(R.ip),children:"Copy"})]}),R.result&&(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"Result:"})," ",z(R.result)]}),R.ua&&(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"User Agent:"})," ",(0,x.jsx)("span",{style:{wordBreak:"break-all"},children:R.ua})]}),R.details&&(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{marginBottom:4},children:(0,x.jsx)("strong",{children:"Details"})}),(0,x.jsx)("pre",{style:{background:"#f8f9fa",padding:8,borderRadius:6,maxHeight:320,overflow:"auto"},children:(()=>{try{return JSON.stringify(JSON.parse(R.details),null,2)}catch(e){return R.details}})()})]})]})})]})},Qh=t=>{let{canEdit:n}=t;const{account:r}=(0,_.As)(),{refresh:a}=k(),i="admin_settings",[s,o]=(0,e.useState)({enableUpload:!1,requireSig:!1,autoReminder:!0,reminderDays:3,allowBulkAssignment:!0,requireApproval:!1}),[l,c]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)(!1),m=(0,P.Gi)()||"",[g,v]=(0,e.useState)({fileId:null,url:null,name:null}),[y,b]=(0,e.useState)(!1);(0,e.useEffect)(()=>{try{const e=localStorage.getItem(i);if(e){const t=JSON.parse(e);o(e=>(0,d.A)((0,d.A)({},e),t))}}catch(e){}},[]),(0,e.useEffect)(()=>{(async()=>{try{if(h(!0),!m)return void c(!1);const e=await fetch("".concat(m,"/api/settings/external-support"),{cache:"no-store"}),t=await e.json();c(!(null===t||void 0===t||!t.enabled))}catch(e){c(!1)}finally{h(!1)}})()},[m]),(0,e.useEffect)(()=>{(async()=>{try{var e,t;if(!m)return;const n=await fetch("".concat(m,"/api/settings/legal-consent"),{cache:"no-store"}),r=await n.json();v({fileId:null!==(e=null===r||void 0===r?void 0:r.fileId)&&void 0!==e?e:null,url:null!==r&&void 0!==r&&r.url?m+r.url:null,name:null!==(t=null===r||void 0===r?void 0:r.name)&&void 0!==t?t:null})}catch(n){}})()},[m]);return(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,x.jsx)("h3",{style:{margin:0,fontSize:16},children:"System Settings"}),(0,x.jsx)("div",{className:"card",style:{padding:16},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"External User Support"}),(0,x.jsx)("div",{className:"small muted",children:"When disabled, external login, onboarding, and related UI/routes are hidden."})]}),(0,x.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:!!l,disabled:u||p||!n,onChange:e=>(async e=>{if(n&&m){f(!0);try{if(!(await fetch("".concat(m,"/api/settings/external-support"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:e})})).ok)throw new Error("save_failed");c(e);try{await a()}catch(t){}ct.Ay.toast("External user support ".concat(e?"enabled":"disabled"))}catch(Pp){ct.Ay.toast("Failed to save external support setting")}finally{f(!1)}}})(e.target.checked)}),(0,x.jsx)("span",{children:l?"Enabled":"Disabled"})]})]})}),(0,x.jsx)("div",{className:"card",style:{padding:16},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Legal Consent Document"}),(0,x.jsx)("div",{className:"small muted",children:"PDF shown to users from the consent dialog. Applies globally."}),null!==g&&void 0!==g&&g.url?(0,x.jsxs)("div",{className:"small",style:{marginTop:6},children:["Current: ",(0,x.jsxs)("a",{href:g.url,target:"_blank",rel:"noreferrer",children:[g.name||"document.pdf"," \u2197"]})]}):(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"Not set"})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("label",{className:"btn sm",style:{cursor:n?"pointer":"not-allowed",opacity:n?1:.6},children:[y?"Uploading\u2026":null!==g&&void 0!==g&&g.fileId?"Replace PDF":"Upload PDF",(0,x.jsx)("input",{type:"file",accept:"application/pdf",style:{display:"none"},disabled:!n||y,onChange:async e=>{try{const t=e.target.files&&e.target.files[0];if(!t||!m)return;b(!0);const n=new FormData;n.append("file",t);const r=await fetch("".concat(m,"/api/files/upload"),{method:"POST",body:n}),a=await r.json();if(!r.ok||null===a||void 0===a||!a.id)return void(0,ct.P0)("Upload failed","error");if(!(await fetch("".concat(m,"/api/settings/legal-consent"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:a.id})})).ok)return void(0,ct.P0)("Save failed","error");v({fileId:a.id,url:"".concat(m,"/api/files/").concat(a.id),name:t.name}),(0,ct.P0)("Legal document saved","success")}catch(t){(0,ct.P0)("Upload failed","error")}finally{b(!1);try{e.target.value=""}catch(n){}}}})]}),(null===g||void 0===g?void 0:g.fileId)&&(0,x.jsx)("button",{className:"btn ghost sm",style:{marginLeft:8},disabled:!n||y,onClick:async()=>{try{if(!m)return;b(!0);if(!(await fetch("".concat(m,"/api/settings/legal-consent"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:null})})).ok)return void(0,ct.P0)("Failed to clear","error");v({fileId:null,url:null,name:null}),(0,ct.P0)("Cleared legal document","success")}catch(e){(0,ct.P0)("Failed to clear","error")}finally{b(!1)}},children:"Clear"})]})]})}),(0,x.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:s.enableUpload,onChange:e=>o((0,d.A)((0,d.A)({},s),{},{enableUpload:e.target.checked})),disabled:!n}),(0,x.jsx)("span",{className:"small",children:"Enable document upload"})]}),(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:s.requireSig,onChange:e=>o((0,d.A)((0,d.A)({},s),{},{requireSig:e.target.checked})),disabled:!n}),(0,x.jsx)("span",{className:"small",children:"Require digital signatures"})]}),(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:s.autoReminder,onChange:e=>o((0,d.A)((0,d.A)({},s),{},{autoReminder:e.target.checked})),disabled:!n}),(0,x.jsx)("span",{className:"small",children:"Auto-send reminders"})]}),(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:s.allowBulkAssignment,onChange:e=>o((0,d.A)((0,d.A)({},s),{},{allowBulkAssignment:e.target.checked})),disabled:!n}),(0,x.jsx)("span",{className:"small",children:"Allow bulk assignments"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("span",{className:"small",children:"Reminder frequency:"}),(0,x.jsxs)("select",{value:s.reminderDays,onChange:e=>o((0,d.A)((0,d.A)({},s),{},{reminderDays:parseInt(e.target.value)})),disabled:!n,children:[(0,x.jsx)("option",{value:1,children:"Daily"}),(0,x.jsx)("option",{value:3,children:"Every 3 days"}),(0,x.jsx)("option",{value:7,children:"Weekly"}),(0,x.jsx)("option",{value:14,children:"Bi-weekly"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8,alignItems:"center",flexWrap:"wrap"},children:[n&&(0,x.jsx)("button",{className:"btn",onClick:()=>{if(n)try{localStorage.setItem(i,JSON.stringify(s)),ct.Ay.toast("Settings saved")}catch(e){console.warn(e)}},children:"Save Settings"}),!n&&(0,x.jsx)("span",{className:"small muted",children:"Read-only access"}),n&&(0,x.jsx)("button",{className:"btn ghost",onClick:async()=>{try{var e;if(!(0,P.Kr)())return void(0,ct.vc)("SQLite disabled","Enable SQLite (REACT_APP_ENABLE_SQLITE=true) and set REACT_APP_API_BASE to seed.");if(null===r||void 0===r||!r.username)return void(0,ct.p_)("Sign in required","Sign in first to seed data for your account.");const t=(0,P.Gi)(),n=await fetch("".concat(t,"/api/seed?email=").concat(encodeURIComponent(r.username)),{method:"POST"});if(!n.ok)throw new Error("Seed failed");const a=await n.json().catch(()=>({}));(0,ct.Q$)("SQLite seeded","BatchId: <b>".concat(null!==(e=null===a||void 0===a?void 0:a.batchId)&&void 0!==e?e:"n/a","</b>"))}catch(t){(0,ct.Z2)("Seed failed","Unable to seed demo data.")}},title:"Seed SQLite with a demo batch, docs, and recipients for your account",children:"Seed SQLite (for me)"}),n&&(0,x.jsx)("button",{className:"btn ghost",onClick:async()=>{try{await xr(["User.Read"]),await xr(["Group.Read.All"]),await xr(["Sites.Read.All","Files.ReadWrite.All"]),await xr(["Mail.Send"]),(0,ct.P0)("Core Graph permissions granted")}catch(e){(0,ct.P0)("Grant permissions failed","error")}},title:"Request common Microsoft Graph permissions in one go",children:"Grant Core Permissions"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"Environment & Feature Flags"}),(0,x.jsxs)("div",{className:"small",style:{display:"grid",gridTemplateColumns:"1fr 2fr",rowGap:4,columnGap:8},children:[(0,x.jsx)("div",{children:"SQLite Enabled"}),(0,x.jsx)("div",{children:(0,P.Kr)()?"true":"false"}),(0,x.jsx)("div",{children:"API Base"}),(0,x.jsx)("div",{children:String((0,P.Gi)()||"\u2014")}),(0,x.jsx)("div",{children:"Admin Light Mode"}),(0,x.jsx)("div",{children:(0,P.G8)()?"true":"false"}),(0,x.jsx)("div",{children:"Modal Selectors (default)"}),(0,x.jsx)("div",{children:(0,P.s8)()?"true":"false"})]})]})]})},$h=t=>{let{onAdd:n}=t;const r=(0,P.Gi)()||"",[a,i]=(0,e.useState)(!1),[s,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)(new Set),h=(0,e.useCallback)(async()=>{if(r){i(!0);try{const e=await fetch("".concat(r,"/api/library/list").concat(l?"?q=".concat(encodeURIComponent(l)):"")),t=await e.json(),n=Array.isArray(null===t||void 0===t?void 0:t.files)?t.files:[];o(n.map(e=>({id:Number(e.id),name:String(e.name||"file"),url:"".concat(r).concat(e.url),size:Number(e.size)||void 0,uploadedAt:e.uploadedAt||e.uploaded_at||void 0})))}catch(e){o([])}finally{i(!1)}}},[r,l]);(0,e.useEffect)(()=>{h()},[h]);return(0,x.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:8,padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:16},children:"Library (Server)"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Pick from previously saved files (recent first). Served from the app server for reliability."}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,marginBottom:8},children:[(0,x.jsx)("input",{placeholder:"Search library...",value:l,onChange:e=>c(e.target.value)}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:h,disabled:a,children:"Refresh"})]}),a?(0,x.jsx)("div",{className:"small muted",children:"Loading..."}):0===s.length?(0,x.jsx)("div",{className:"small muted",children:"No files found."}):(0,x.jsx)("div",{style:{maxHeight:240,overflowY:"auto",display:"grid",gap:6},children:s.map(e=>{return(0,x.jsxs)("label",{className:"small",style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:8,alignItems:"center",padding:"6px 8px",borderBottom:"1px solid #f5f5f5"},children:[(0,x.jsx)("input",{type:"checkbox",checked:d.has(e.id),onChange:()=>{return t=e.id,void u(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t}}),(0,x.jsxs)("div",{style:{overflow:"hidden"},children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,x.jsxs)("div",{className:"muted",style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("span",{children:(t=e.size,!t||t<=0?"":t<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1024/1024).toFixed(1)," MB"))}),e.uploadedAt&&(0,x.jsxs)("span",{children:["\u2022 ",new Date(e.uploadedAt).toLocaleString()]}),(0,x.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:"Preview \u2197"})]})]}),(0,x.jsx)("span",{className:"badge",children:"local"})]},e.id);var t})}),(0,x.jsx)("div",{style:{marginTop:8,textAlign:"right"},children:(0,x.jsx)("button",{className:"btn sm",onClick:()=>{const e=s.filter(e=>d.has(e.id));if(0===e.length)return;const t=e.map(e=>({title:e.name,url:e.url,version:1,requiresSignature:!1,source:"local",localFileId:e.id,localUrl:e.url}));n(t),u(new Set)},disabled:0===d.size,children:"Add selected"})})]})},Jh=()=>(0,P.Gi)()||"",Zh=()=>(0,P.Kr)()&&!!Jh(),ep=t=>{let{canEdit:n,onEdit:r,onClone:a}=t;const[i,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(!1),[c,u]=(0,e.useState)({}),[h,p]=(0,e.useState)({open:!1,rows:[]}),f=async()=>{if(Zh())try{const e=await fetch("".concat(Jh(),"/api/batches")),t=await e.json();s(Array.isArray(t)?t:[])}catch(e){s([])}};(0,e.useEffect)(()=>{f()},[]);return Zh()?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{maxHeight:420,overflowY:"auto",border:"1px solid #eee",borderRadius:6},children:0===i.length?(0,x.jsx)("div",{className:"small muted",style:{padding:8},children:"No batches."}):i.map(e=>{const t=!!c[e.toba_batchid];return(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.9fr 0.9fr 0.7fr 1.4fr auto",gap:8,alignItems:"center",padding:8,borderBottom:"1px solid #f5f5f5"},children:t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("input",{defaultValue:e.toba_name,onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.toba_batchid]:(0,d.A)((0,d.A)({},n[e.toba_batchid]||{}),{},{name:t.target.value})}))}),(0,x.jsx)("input",{type:"date",defaultValue:e.toba_startdate||"",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.toba_batchid]:(0,d.A)((0,d.A)({},n[e.toba_batchid]||{}),{},{startDate:t.target.value})}))}),(0,x.jsx)("input",{type:"date",defaultValue:e.toba_duedate||"",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.toba_batchid]:(0,d.A)((0,d.A)({},n[e.toba_batchid]||{}),{},{dueDate:t.target.value})}))}),(0,x.jsxs)("select",{defaultValue:e.toba_status||"1",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.toba_batchid]:(0,d.A)((0,d.A)({},n[e.toba_batchid]||{}),{},{status:t.target.value})})),children:[(0,x.jsx)("option",{value:"1",children:"Active"}),(0,x.jsx)("option",{value:"0",children:"Inactive"})]}),(0,x.jsx)("input",{placeholder:"Description",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.toba_batchid]:(0,d.A)((0,d.A)({},n[e.toba_batchid]||{}),{},{description:t.target.value})}))}),(0,x.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>u(t=>{const n=(0,d.A)({},t);return delete n[e.toba_batchid],n}),children:"Cancel"}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>(async e=>{const t=c[e];if(t){l(!0);try{const n={name:t.name,startDate:t.startDate||null,dueDate:t.dueDate||null,status:t.status?Number(t.status):1,description:t.description||null};if(!(await fetch("".concat(Jh(),"/api/batches/").concat(encodeURIComponent(e)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("update_failed");u(t=>{const n=(0,d.A)({},t);return delete n[e],n}),await f(),(0,ct.P0)("Batch updated","success")}catch(n){(0,ct.P0)("Failed to update batch","error")}finally{l(!1)}}})(e.toba_batchid),disabled:!n||o,children:"Save"})]})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.toba_name}),(0,x.jsx)("div",{className:"small muted",children:e.toba_startdate||"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:e.toba_duedate||"\u2014"}),(0,x.jsx)("span",{className:"badge",style:{background:"1"===(e.toba_status||"1")?"#d4edda":"#e2e3e5",color:"1"===(e.toba_status||"1")?"#155724":"#383d41"},children:"1"===(e.toba_status||"1")?"Active":"Inactive"}),(0,x.jsx)("div",{className:"small muted"}),(0,x.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,x.jsx)("a",{href:"/batch/".concat(e.toba_batchid),children:(0,x.jsx)("button",{className:"btn ghost sm",children:"View"})}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{try{const t=await fetch("".concat(Jh(),"/api/recipients")),n=await t.json(),r=(Array.isArray(n)?n:[]).filter(t=>String(t.batchId)===String(e));p({open:!0,forBatch:e,rows:r})}catch(t){p({open:!0,forBatch:e,rows:[]})}})(e.toba_batchid),children:"Recipients"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>r(e.toba_batchid),disabled:!n,children:"Edit"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>a(e.toba_batchid),disabled:!n,children:"Clone"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{if(!n||!Zh())return;if(await(0,ct.ZD)("Delete this batch?","This will remove its documents, recipients, and acknowledgements.","Delete","Cancel",{icon:"warning"})){l(!0);try{if(!(await fetch("".concat(Jh(),"/api/batches/").concat(encodeURIComponent(e)),{method:"DELETE"})).ok)throw new Error("delete_failed");await f(),(0,ct.P0)("Batch deleted","success")}catch(t){(0,ct.P0)("Failed to delete batch","error")}finally{l(!1)}}})(e.toba_batchid),disabled:!n||o,children:"Delete"})]})]})},e.toba_batchid)})}),(0,x.jsx)(B,{open:h.open,onClose:()=>p({open:!1,rows:[]}),title:"Recipients for Batch ".concat(h.forBatch||""),width:700,children:0===h.rows.length?(0,x.jsx)("div",{className:"small muted",children:"No recipients found."}):(0,x.jsx)("div",{style:{maxHeight:360,overflowY:"auto",display:"grid",gap:8},children:h.rows.map((e,t)=>(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.6fr 1fr 1fr 1fr",gap:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:500},children:e.displayName||e.email}),(0,x.jsx)("div",{className:"small muted",children:e.email})]}),(0,x.jsx)("div",{className:"small muted",children:e.department||"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:e.jobTitle||"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:e.primaryGroup||"\u2014"})]},t))})})]}):(0,x.jsx)("div",{className:"small muted",children:"Enable SQLite to manage batches."})},tp=()=>(0,P.Gi)()||"",np=()=>(0,P.Kr)()&&!!tp(),rp=t=>{let{canEdit:n}=t;const[r,a]=(0,e.useState)([]),[i,s]=(0,e.useState)(!1),[o,l]=(0,e.useState)({name:"",code:"",isActive:!0,description:""}),[c,u]=(0,e.useState)({}),h=async()=>{if(np())try{const e=await fetch("".concat(tp(),"/api/businesses")),t=await e.json();a(Array.isArray(t)?t:[])}catch(e){a([])}};(0,e.useEffect)(()=>{h()},[]);return np()?(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr 1fr auto",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{placeholder:"Name",value:o.name,onChange:e=>l((0,d.A)((0,d.A)({},o),{},{name:e.target.value}))}),(0,x.jsx)("input",{placeholder:"Code (optional)",value:o.code,onChange:e=>l((0,d.A)((0,d.A)({},o),{},{code:e.target.value}))}),(0,x.jsx)("input",{placeholder:"Description",value:o.description,onChange:e=>l((0,d.A)((0,d.A)({},o),{},{description:e.target.value}))}),(0,x.jsx)("button",{className:"btn sm",onClick:async()=>{if(!n||!np())return;const e=o.name.trim();if(e){s(!0);try{await(0,L.LM)({name:e,code:o.code||void 0,isActive:!!o.isActive,description:o.description||void 0}),l({name:"",code:"",isActive:!0,description:""}),await h(),(0,ct.P0)("Business created","success")}catch(t){(0,ct.P0)("Failed to create business","error")}finally{s(!1)}}else(0,ct.P0)("Enter a business name","warning")},disabled:!n||i,children:"Add"})]}),(0,x.jsx)("div",{style:{maxHeight:260,overflowY:"auto",border:"1px solid #eee",borderRadius:6},children:0===r.length?(0,x.jsx)("div",{className:"small muted",style:{padding:8},children:"No businesses."}):r.map(e=>{const t=null!=c[e.id];return(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr 1fr auto auto",gap:8,alignItems:"center",padding:8,borderBottom:"1px solid #f5f5f5"},children:t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("input",{defaultValue:e.name,onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.id]:(0,d.A)((0,d.A)({},n[e.id]),{},{name:t.target.value})}))}),(0,x.jsx)("input",{defaultValue:e.code||"",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.id]:(0,d.A)((0,d.A)({},n[e.id]),{},{code:t.target.value})}))}),(0,x.jsx)("input",{defaultValue:e.description||"",onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.id]:(0,d.A)((0,d.A)({},n[e.id]),{},{description:t.target.value})}))}),(0,x.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("input",{type:"checkbox",defaultChecked:!!e.isActive,onChange:t=>u(n=>(0,d.A)((0,d.A)({},n),{},{[e.id]:(0,d.A)((0,d.A)({},n[e.id]),{},{isActive:t.target.checked})}))})," Active"]}),(0,x.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>u(t=>{const n=(0,d.A)({},t);return delete n[e.id],n}),children:"Cancel"}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>(async e=>{if(!n||!np())return;const t=c[e];if(t){s(!0);try{await(0,L.AK)(e,t),u(t=>{const n=(0,d.A)({},t);return delete n[e],n}),await h(),(0,ct.P0)("Business updated","success")}catch(r){(0,ct.P0)("Failed to update business","error")}finally{s(!1)}}})(e.id),disabled:i,children:"Save"})]})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,x.jsx)("div",{className:"small muted",children:e.code||"\u2014"}),(0,x.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.description||"\u2014"}),(0,x.jsx)("span",{className:"badge",style:{background:e.isActive?"#d4edda":"#e2e3e5",color:e.isActive?"#155724":"#383d41"},children:e.isActive?"Active":"Inactive"}),(0,x.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>u(t=>(0,d.A)((0,d.A)({},t),{},{[e.id]:{}})),disabled:!n,children:"Edit"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{if(!n||!np())return;if(await(0,ct.ZD)("Delete this business?","This will unassign it from any recipients.","Delete","Cancel",{icon:"warning"})){s(!0);try{await(0,L.G4)(e),await h(),(0,ct.P0)("Business deleted","success")}catch(t){(0,ct.P0)("Failed to delete business","error")}finally{s(!1)}}})(e.id),disabled:!n,children:"Delete"})]})]})},e.id)})})]}):(0,x.jsx)("div",{className:"small muted",children:"Enable SQLite to manage businesses."})},ap=async(e,t,n,r,a,i,s)=>{const o=r||(n instanceof File?n.name:"upload-".concat(Date.now())),l=a?"".concat(a.replace(/^\/+|\/+$/g,""),"/").concat(encodeURIComponent(o)):encodeURIComponent(o);return n.size&&n.size<=4194304?await(async()=>{const r=s&&"root"!==s?"items/".concat(s,":/").concat(encodeURIComponent(o),":/content"):"root:/".concat(l,":/content"),a=await fetch("https://graph.microsoft.com/v1.0/drives/".concat(t,"/").concat(r),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":n.type||"application/octet-stream"},body:n});if(!a.ok){const e=await a.text().catch(()=>"");throw new Error("Simple upload failed: ".concat(a.status," ").concat(a.statusText," \u2014 ").concat(e))}return await a.json()})():await(async()=>{var r;const a=s&&"root"!==s?"items/".concat(s,":/").concat(encodeURIComponent(o),":/createUploadSession"):"root:/".concat(l,":/createUploadSession"),c=await fetch("https://graph.microsoft.com/v1.0/drives/".concat(t,"/").concat(a),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"rename",name:o}})});if(!c.ok){const e=await c.text().catch(()=>"");throw new Error("Create upload session failed: ".concat(c.status," ").concat(c.statusText," \u2014 ").concat(e))}const d=(await c.json()).uploadUrl,u=null!==(r=n.size)&&void 0!==r?r:0;let h=0,p=0;for(;p<u;){const e=Math.min(p+5242880,u),t=n.slice(p,e),r="bytes ".concat(p,"-").concat(e-1,"/").concat(u),a=await fetch(d,{method:"PUT",headers:{"Content-Length":String(e-p),"Content-Range":r},body:t});if(!a.ok&&202!==a.status){const e=await a.text().catch(()=>"");throw new Error("Chunk upload failed: ".concat(a.status," ").concat(a.statusText," \u2014 ").concat(e))}if(h=e,i&&i(Math.round(h/u*100)),201===a.status||200===a.status){return await a.json()}p=e}throw new Error("Upload session did not return a completed item.")})()},ip=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root";try{const r="root"===n?"https://graph.microsoft.com/v1.0/drives/".concat(t,"/root/children"):"https://graph.microsoft.com/v1.0/drives/".concat(t,"/items/").concat(n,"/children"),a="".concat(r,"?$select=id,name,folder,file,webUrl,size,createdDateTime,lastModifiedDateTime,parentReference&$top=200"),i=await fetch(a,{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("SharePoint API error: ".concat(i.status," ").concat(i.statusText));return(await i.json()).value||[]}catch(r){throw(0,D.z3)("sharepointService: failed to fetch folder items",r),r}},sp=t=>{let{onDocumentSelect:n,canUpload:r=!1}=t;const{getToken:a,login:i,account:s}=(0,_.As)(),[o,l]=(0,e.useState)(!1),[c,u]=(0,e.useState)([]),[h,p]=(0,e.useState)(""),[f,m]=(0,e.useState)([]),[g,v]=(0,e.useState)(""),[y,b]=(0,e.useState)([]),[w,A]=(0,e.useState)(new Set),[S,C]=(0,e.useState)(""),[E,T]=(0,e.useState)("browse"),[k,P]=(0,e.useState)(!1),[I,R]=(0,e.useState)(null),[N,O]=(0,e.useState)([]),[M,F]=(0,e.useState)([]),[L,j]=(0,e.useState)("root"),[B,U]=(0,e.useState)([{id:"root",name:"Root"}]),[G,H]=(0,e.useState)(null),[z,W]=(0,e.useState)(!1),[q,V]=(0,e.useState)(!1),[K,Y]=(0,e.useState)("all"),X=52428800,Q="sp:favorites",[$,J]=(0,e.useState)(()=>{try{const e=localStorage.getItem(Q);return e?new Set(JSON.parse(e)):new Set}catch(e){return new Set}}),Z=e=>e.id||e.webUrl||e.name||"",ee=e=>{const t=Z(e),n=new Set($),r=!n.has(t);r?n.add(t):n.delete(t),(e=>{J(new Set(e));try{localStorage.setItem(Q,JSON.stringify(Array.from(e)))}catch(t){}})(n);try{e.id&&A(t=>{const n=new Set(t);return r?n.add(e.id):n.delete(e.id),n})}catch(a){}},te=e=>{const t=(e||"").toLowerCase();return t.endsWith(".pdf")?"\ud83d\udcd5":t.endsWith(".doc")||t.endsWith(".docx")?"\ud83d\udcdd":t.endsWith(".xls")||t.endsWith(".xlsx")?"\ud83d\udcca":t.endsWith(".ppt")||t.endsWith(".pptx")?"\ud83d\udcd1":t.endsWith(".txt")?"\ud83d\udcc4":t.endsWith(".html")||t.endsWith(".htm")?"\ud83c\udf10":"\ud83d\udcc1"},ne=async()=>{l(!0),H(null);try{const e=await a(["Sites.Read.All","Files.Read.All"]);if(!e)throw new Error("No token available");const t=await(async e=>{try{const t=await fetch("https://graph.microsoft.com/v1.0/sites?search=*&$select=id,displayName,webUrl,description&$top=50",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("SharePoint API error: ".concat(t.status," ").concat(t.statusText));const n=(await t.json()).value;return(0,D.pq)("sharepointService: fetched sites",{count:n.length}),n}catch(t){throw(0,D.z3)("sharepointService: failed to fetch sites",t),t}})(e);u(t)}catch(e){console.error("Failed to load SharePoint sites:",e),H("Failed to load SharePoint sites. Ensure you are signed in and have granted Sites.Read.All and Files.Read.All.")}finally{l(!1)}},re=async e=>{l(!0),H(null);try{const t=await a(["Sites.Read.All","Files.Read.All"]);if(!t)throw new Error("No token available");const n=await(async(e,t)=>{const n=t,r=async()=>{const r="https://graph.microsoft.com/v1.0/sites/".concat(n,"/lists?$filter=drive ne null&$select=id,displayName,webUrl&$expand=drive($select=id,driveType,name,webUrl)"),a=await fetch(r,{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok){const e=await a.text().catch(()=>"");throw new Error("Lists fallback failed: ".concat(a.status," ").concat(a.statusText).concat(e?" \u2014 "+e:""))}const i=((await a.json()).value||[]).filter(e=>e.drive&&("documentLibrary"===e.drive.driveType||e.drive.id)).map(e=>{var t,n,r,a;return{id:(null===(t=e.drive)||void 0===t?void 0:t.id)||e.id,name:(null===(n=e.drive)||void 0===n?void 0:n.name)||e.displayName,displayName:e.displayName||(null===(r=e.drive)||void 0===r?void 0:r.name),description:"",webUrl:e.webUrl,driveType:(null===(a=e.drive)||void 0===a?void 0:a.driveType)||"documentLibrary"}});return(0,D.pq)("sharepointService: fetched document libraries (lists fallback)",{siteId:t,count:i.length}),i};try{const i="https://graph.microsoft.com/v1.0/sites/".concat(n,"/drives?$select=id,name,webUrl,driveType&$top=200"),s=await fetch(i,{headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok){const e=await s.text().catch(()=>"");(0,D.pq)("sharepointService: drives listing not ok, attempting lists fallback",{status:s.status});try{return await r()}catch(a){throw new Error("Drives listing failed: ".concat(s.status," \u2014 ").concat(e||s.statusText,". Fallback error: ").concat(a.message))}}let o=((await s.json()).value||[]||[]).filter(e=>"documentLibrary"===e.driveType).map(e=>({id:e.id,name:e.name,displayName:e.name,description:"",webUrl:e.webUrl,driveType:e.driveType}));return 0===o.length&&((0,D.pq)("sharepointService: drives empty, attempting lists fallback"),o=await r()),(0,D.pq)("sharepointService: fetched document libraries (drives)",{siteId:t,count:o.length}),o}catch(i){(0,D.z3)("sharepointService: failed to fetch document libraries",i);try{return await r()}catch(s){throw i}}})(t,e);m(n)}catch(t){console.error("Failed to load document libraries:",t);const e="string"===typeof(null===t||void 0===t?void 0:t.message)?t.message:"";H("Failed to load document libraries.".concat(e?" "+e:""))}finally{l(!1)}},ae=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root";l(!0),H(null);try{const n=await a(["Sites.Read.All","Files.Read.All"]);if(!n)throw new Error("No token available");const r=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root",r=arguments.length>3?arguments[3]:void 0;try{let a="root"===n?"https://graph.microsoft.com/v1.0/drives/".concat(t,"/root/children"):"https://graph.microsoft.com/v1.0/drives/".concat(t,"/items/").concat(n,"/children");a+="?$select=id,name,webUrl,size,createdDateTime,lastModifiedDateTime,file,createdBy,lastModifiedBy,parentReference",a+="&$expand=thumbnails&$top=200",r&&(a="https://graph.microsoft.com/v1.0/drives/".concat(t,"/search(q='").concat(encodeURIComponent(r),"')"),a+="?$select=id,name,webUrl,size,createdDateTime,lastModifiedDateTime,file,createdBy,lastModifiedBy,parentReference");const i=await fetch(a,{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("SharePoint API error: ".concat(i.status," ").concat(i.statusText));const s=(await i.json()).value.filter(e=>e.file),o=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/html"],l=s.filter(e=>e.file&&o.includes(e.file.mimeType));return(0,D.pq)("sharepointService: fetched documents",{driveId:t,folderId:n,count:l.length,searchQuery:r}),l}catch(a){throw(0,D.z3)("sharepointService: failed to fetch documents",a),a}}(n,e,t,S);b(r)}catch(n){console.error("Failed to load documents:",n),H("Failed to load documents.")}finally{l(!1)}};(0,e.useEffect)(()=>{ne()},[]),(0,e.useEffect)(()=>{h&&(re(h),v(""),b([]))},[h]),(0,e.useEffect)(()=>{g&&(ae(g,"root"),(async()=>{try{const e=await a(["Sites.Read.All","Files.Read.All"]);if(!e)throw new Error("No token available");const t=await ip(e,g,"root");F(t),j("root"),U([{id:"root",name:"Root"}])}catch(e){console.error("Failed to load folder items",e)}})())},[g,S]),(0,e.useEffect)(()=>{g&&"browse"===E&&ae(g,L||"root")},[L,E]),(0,e.useEffect)(()=>{const e=Array.from(w).map(e=>y.find(t=>t.id===e)).filter(Boolean);n(e)},[w,y]),(0,e.useEffect)(()=>{r||"upload"!==E||T("browse")},[r,E]);const ie=e=>{const t=new Set(w);t.has(e)?t.delete(e):t.add(e),A(t)},se=async(e,t)=>{try{const n=await a(["Sites.Read.All","Files.Read.All"]);if(!n)throw new Error("No token available");const r=await ip(n,g,e);F(r),j(e),U(n=>{const r=n.findIndex(t=>t.id===e);return r>=0?n.slice(0,r+1):[...n,{id:e,name:t}]})}catch(n){console.error("Failed to navigate folder",n)}},oe=async e=>{const t=e?Array.from(e):[];if(t.length&&g){P(!0),R(0),O([]);try{const e=await a(["Files.ReadWrite.All","Sites.Read.All"]);if(!e)throw new Error("No token available");const r=[];for(let a=0;a<t.length;a++){const i=t[a];if(i.size>X)O(e=>[...e,{name:i.name,progress:0,error:"File exceeds ".concat(Math.round(50),"MB limit")}]);else{O(e=>[...e,{name:i.name,progress:0}]);try{const t=await ap(e,g,i,i.name,void 0,e=>{R(e),O(t=>{const n=[...t],r=n.findIndex(e=>e.name===i.name);return r>=0&&(n[r]=(0,d.A)((0,d.A)({},n[r]),{},{progress:e})),n})},L);r.push(t),b(e=>[{id:t.id,name:t.name,webUrl:t.webUrl,size:t.size||i.size,createdDateTime:t.createdDateTime||(new Date).toISOString(),lastModifiedDateTime:t.lastModifiedDateTime||(new Date).toISOString(),file:t.file||{mimeType:i.type||"application/octet-stream"},parentReference:t.parentReference},...e]),A(e=>new Set(e).add(t.id))}catch(n){const e="string"===typeof(null===n||void 0===n?void 0:n.message)?n.message:"Upload failed";O(t=>{const n=[...t],r=n.findIndex(e=>e.name===i.name);return r>=0&&(n[r]=(0,d.A)((0,d.A)({},n[r]),{},{error:e})),n})}}}(0,ct.P0)("Uploaded ".concat(r.length," file(s)"),"success"),T("browse")}catch(r){console.error("Upload failed",r),(0,ct.P0)("Upload failed","error")}finally{P(!1),R(null)}}};return(0,x.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:8,padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:16},children:"SharePoint Documents"}),(0,x.jsxs)("div",{style:{marginBottom:12},children:[!s&&(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#fff3cd",padding:8,borderRadius:6,border:"1px solid #ffeeba"},children:[(0,x.jsx)("span",{children:"You're not signed in."}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>i().then(()=>ne()),children:"Sign in"})]}),G&&(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#f8d7da",padding:8,borderRadius:6,border:"1px solid #f5c6cb",marginTop:8},children:[(0,x.jsx)("span",{style:{flex:1},children:G}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>ne(),children:"Retry"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"1px solid #e0e0e0"},children:[(0,x.jsx)("button",{className:"browse"===E?"btn sm":"btn ghost sm",onClick:()=>T("browse"),children:"Browse"}),r&&(0,x.jsx)("button",{className:"upload"===E?"btn sm":"btn ghost sm",onClick:()=>T("upload"),children:"Upload"})]}),o&&(0,x.jsx)("div",{className:"small muted",children:"Loading..."}),(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{className:"small",children:"SharePoint Site:"}),(0,x.jsxs)("select",{value:h,onChange:e=>p(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,x.jsx)("option",{value:"",children:"Select a site..."}),c.map(e=>(0,x.jsx)("option",{value:e.id,children:e.displayName},e.id))]})]}),h&&(0,x.jsxs)("div",{style:{marginBottom:16},children:[(0,x.jsx)("label",{className:"small",children:"Document Library:"}),(0,x.jsxs)("select",{value:g,onChange:e=>v(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,x.jsx)("option",{value:"",children:"Select a library..."}),f.map(e=>(0,x.jsx)("option",{value:e.id,children:e.displayName},e.id))]})]}),g&&"browse"===E&&(0,x.jsx)("div",{style:{marginBottom:16},children:(0,x.jsx)("input",{type:"text",placeholder:"Search documents...",value:S,onChange:e=>C(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4}})}),"browse"===E&&(0,x.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[g&&(0,x.jsx)("div",{className:"small",style:{marginBottom:8},children:B.map((e,t)=>(0,x.jsxs)("span",{children:[t>0&&" / ",(0,x.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),se(e.id,e.name)},children:e.name})]},e.id))}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",marginBottom:8,flexWrap:"wrap"},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,x.jsx)("input",{type:"checkbox",checked:q,onChange:e=>V(e.target.checked)}),"Favorites only"]}),(0,x.jsxs)("select",{value:K,onChange:e=>Y(e.target.value),children:[(0,x.jsx)("option",{value:"all",children:"All types"}),(0,x.jsx)("option",{value:"pdf",children:"PDF"}),(0,x.jsx)("option",{value:"word",children:"Word"}),(0,x.jsx)("option",{value:"excel",children:"Excel"}),(0,x.jsx)("option",{value:"ppt",children:"PowerPoint"}),(0,x.jsx)("option",{value:"text",children:"Text/HTML"})]})]}),g&&M.filter(e=>e.folder).map(e=>{var t,n;return(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 8px",borderBottom:"1px solid #f5f5f5"},children:[(0,x.jsxs)("button",{className:"btn ghost sm",onClick:()=>se(e.id,e.name),children:["\ud83d\udcc1 ",e.name]}),(0,x.jsxs)("span",{className:"small muted",children:[null!==(t=null===(n=e.folder)||void 0===n?void 0:n.childCount)&&void 0!==t?t:0," items"]})]},e.id)}),y.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>A(new Set(y.map(e=>e.id))),children:"Select All"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>A(new Set),children:"Clear"}),(0,x.jsxs)("span",{className:"small muted",children:["Selected: ",w.size]})]}),y.filter(e=>!q||$.has(Z(e))).filter(e=>{const t=(e.name||"").toLowerCase();return"all"===K||("pdf"===K?t.endsWith(".pdf"):"word"===K?t.endsWith(".doc")||t.endsWith(".docx"):"excel"===K?t.endsWith(".xls")||t.endsWith(".xlsx"):"ppt"===K?t.endsWith(".ppt")||t.endsWith(".pptx"):"text"!==K||(t.endsWith(".txt")||t.endsWith(".html")||t.endsWith(".htm")))}).map(e=>(0,x.jsxs)("div",{onClick:()=>ie(e.id),role:"button",style:{display:"grid",gridTemplateColumns:"auto auto 1fr auto",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0",cursor:"pointer"},children:[(0,x.jsx)("button",{className:"btn ghost sm",title:$.has(Z(e))?"Unpin":"Pin",onClick:t=>{t.stopPropagation(),ee(e)},children:$.has(Z(e))?"\u2b50":"\u2606"}),(0,x.jsx)("span",{"aria-hidden":!0,children:te(e.name)}),(0,x.jsxs)("div",{style:{minWidth:0},children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,x.jsxs)("div",{className:"small muted",children:[e.size?(e.size/1024).toFixed(1)+" KB":"",e.lastModifiedDateTime?" \u2022 Modified ".concat(new Date(e.lastModifiedDateTime).toLocaleDateString()):""]}),(0,x.jsx)("a",{href:e.webUrl,target:"_blank",rel:"noopener noreferrer",className:"small",style:{color:"#0066cc"},onClick:e=>e.stopPropagation(),children:"View in SharePoint \u2197"})]}),(0,x.jsx)("input",{type:"checkbox",checked:w.has(e.id),onClick:e=>e.stopPropagation(),onChange:()=>ie(e.id)})]},e.id))]})]}),r&&"upload"===E&&(0,x.jsxs)("div",{children:[!g&&(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Select a site and library to enable uploads."}),g&&(0,x.jsxs)("div",{style:{marginBottom:12},children:[(0,x.jsx)("label",{className:"small",children:"Target folder:"}),(0,x.jsxs)("select",{value:L,onChange:e=>j(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,x.jsx)("option",{value:"root",children:"/ (root)"}),M.filter(e=>e.folder).map(e=>(0,x.jsxs)("option",{value:e.id,children:["/ ",e.name]},e.id))]})]}),(0,x.jsxs)("div",{onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),g&&!k&&W(!0)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),W(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),W(!1);const t=e.dataTransfer.files;t&&t.length>0&&oe(t)},style:{border:"2px dashed "+(z?"var(--primary)":"#ccc"),background:z?"rgba(0,0,0,0.02)":"transparent",padding:16,borderRadius:8,textAlign:"center",opacity:!g||k?.6:1,pointerEvents:!g||k?"none":"auto"},children:[(0,x.jsx)("div",{className:"small",style:{marginBottom:8},children:"Drag and drop files here"}),(0,x.jsx)("div",{className:"small muted",children:"or"}),(0,x.jsx)("div",{style:{marginTop:8},children:(0,x.jsxs)("label",{className:"btn ghost sm",style:{cursor:!g||k?"not-allowed":"pointer"},children:["Browse files",(0,x.jsx)("input",{type:"file",multiple:!0,disabled:!g||k,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.html",onChange:e=>oe(e.target.files),style:{display:"none"}})]})}),(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:"Allowed: PDF, Word, Excel, PowerPoint, Text, HTML"})]}),k&&(0,x.jsxs)("div",{className:"small",style:{marginTop:8},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsx)("span",{children:"Uploading..."}),(0,x.jsxs)("span",{children:[null!==I&&void 0!==I?I:0,"%"]})]}),(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",style:{marginTop:6},children:(0,x.jsx)("i",{style:{width:"".concat(null!==I&&void 0!==I?I:0,"%")}})})]}),N.length>0&&(0,x.jsx)("div",{style:{marginTop:8},children:N.map((e,t)=>(0,x.jsxs)("div",{className:"small",style:{display:"grid",gap:4,marginBottom:6},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,x.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),e.error?(0,x.jsx)("span",{style:{color:"#d33"},children:e.error}):(0,x.jsxs)("span",{children:[e.progress,"%"]})]}),!e.error&&(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,x.jsx)("i",{style:{width:"".concat(e.progress,"%")}})})]},t))}),(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:"Files are uploaded into the selected folder. Large files use a chunked upload session."})]})]})},op=e=>{const{canUploadDocuments:t,sqliteEnabled:n,editingBatchId:r,batchForm:a,setBatchForm:i,useModalSelectors:s,setUseModalSelectors:o,modalToggleKey:l,setUsersModalOpen:c,setDocsModalOpen:u,importBusy:h,importTotal:p,importDone:f,importRows:m,businesses:g,mappingUsers:v,expandGroupsForMapping:y,applyBusinessToAll:b,defaultBusinessId:w,setDefaultBusinessId:_,saveBatch:A}=e;return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{style:{fontSize:18,marginBottom:16},children:r?"Edit Batch":"Create New Batch"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"batchName",children:"Batch Name:"}),(0,x.jsx)("input",{id:"batchName",type:"text",value:a.name,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{name:e.target.value})),placeholder:"Q1 2025 - Code of Conduct",style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"batchDescription",children:"Description:"}),(0,x.jsx)("input",{id:"batchDescription",type:"text",value:a.description,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{description:e.target.value})),placeholder:"Annual policy acknowledgement",style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"batchStart",children:"Start Date:"}),(0,x.jsx)("input",{id:"batchStart",type:"date",value:a.startDate,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{startDate:e.target.value})),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"batchDue",children:"Due Date:"}),(0,x.jsx)("input",{id:"batchDue",type:"date",value:a.dueDate,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{dueDate:e.target.value})),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsx)("div",{className:"small muted",children:"Choose how you want to select recipients and documents."}),(0,x.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:s,onChange:e=>{o(e.target.checked);try{localStorage.setItem(l,e.target.checked?"true":"false")}catch(t){}}}),"Use modal selectors"]})]}),s?(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,marginBottom:24},children:[(0,x.jsxs)("div",{className:"card",style:{padding:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Assign to Users & Groups"}),(0,x.jsxs)("div",{className:"small muted",children:[a.selectedUsers.length," users, ",a.selectedGroups.length," groups selected"]})]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>c(!0),children:"Edit selection"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Documents"}),(0,x.jsxs)("div",{className:"small muted",children:[a.selectedDocuments.length," document(s) selected"]})]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>u(!0),children:"Choose documents"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Business Mapping"}),(0,x.jsx)("div",{className:"small muted",children:"Assign selected users to businesses"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("span",{className:"small muted",children:"Default:"}),(0,x.jsxs)("select",{value:String(w),onChange:e=>_(e.target.value?Number(e.target.value):""),children:[(0,x.jsx)("option",{value:"",children:"\u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,x.jsx)("span",{className:"small muted",children:"Apply to all:"}),(0,x.jsxs)("select",{onChange:e=>b(e.target.value?Number(e.target.value):null),defaultValue:"",children:[(0,x.jsx)("option",{value:"",children:"\u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),n&&g.length>0?(0,x.jsx)("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,maxHeight:200,overflowY:"auto"},children:v.map(t=>{var n;const r=(t.mail||t.userPrincipalName||"").trim().toLowerCase(),a=null!==(n=e.businessMap[r])&&void 0!==n?n:"";return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{style:{overflow:"hidden"},children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.displayName}),(0,x.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r})]}),(0,x.jsxs)("select",{value:String(a),onChange:t=>e.setUserBusiness(r,t.target.value?Number(t.target.value):null),children:[(0,x.jsx)("option",{value:"",children:"\u2014 No business \u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]})]},t.id)})}):(0,x.jsx)("div",{className:"small muted",style:{marginTop:8},children:n?"No businesses found.":"Enable SQLite to load businesses."})]})]}):(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:24,marginBottom:24},children:[(0,x.jsx)(jr,{onSelectionChange:e=>i((0,d.A)((0,d.A)({},a),{},{selectedUsers:e.users,selectedGroups:e.groups}))}),h&&(0,x.jsxs)("div",{className:"small",style:{background:"#fff8e1",border:"1px solid #ffe0b2",padding:8,borderRadius:6},children:["Importing to Library... ",f,"/",p,(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",style:{marginTop:6},children:(0,x.jsx)("i",{style:{width:"".concat(p?Math.round(f/p*100):0,"%")}})}),m.length>0&&(0,x.jsx)("div",{style:{marginTop:6,maxHeight:120,overflowY:"auto",display:"grid",gap:4},children:m.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,x.jsx)("span",{className:"badge",style:{background:"failed"===e.status?"#f8d7da":"deduped"===e.status?"#e2e3e5":"#d4edda",color:"#333"},children:e.status})]},t))})]}),(0,x.jsx)($h,{onAdd:t=>i(n=>(0,d.A)((0,d.A)({},n),{},{selectedDocuments:e.mergeDocuments(n.selectedDocuments,t)}))}),(0,x.jsx)(sp,{canUpload:!!t,onDocumentSelect:async t=>{try{const s=(0,P.Gi)()||"",o=await xr(["Sites.Read.All","Files.Read.All"]);e.setImportBusy(!0),e.setImportTotal(t.length),e.setImportDone(()=>0),e.setImportRows(()=>[]);const l=[];let c=0,u=0;for(const i of t){var n;const t=null===i||void 0===i||null===(n=i.parentReference)||void 0===n?void 0:n.driveId,d=null===i||void 0===i?void 0:i.id,h=i.name;if(s&&t&&d&&o)try{var r;const n=await fetch("".concat(s,"/api/library/save-graph"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({driveId:t,itemId:d,name:h})}),a=await n.json().catch(()=>null),u=null!==a&&void 0!==a&&a.url?"".concat(s).concat(a.url):void 0,p={title:h,url:i.webUrl,version:1,requiresSignature:!1,driveId:t,itemId:d,source:"sharepoint",localFileId:null!==(r=null===a||void 0===a?void 0:a.id)&&void 0!==r?r:null,localUrl:u||null};l.push(p),e.setImportRows(e=>[...e,{name:h,status:null!==a&&void 0!==a&&a.deduped?"deduped":"saved"}]),null!==a&&void 0!==a&&a.deduped&&c++}catch(a){l.push({title:h,url:i.webUrl,version:1,requiresSignature:!1,driveId:t,itemId:d,source:"sharepoint",localFileId:null,localUrl:null}),e.setImportRows(e=>[...e,{name:h,status:"failed"}]),u++}finally{e.setImportDone(e=>e+1)}else l.push({title:h,url:i.webUrl,version:1,requiresSignature:!1,driveId:t,itemId:d,source:"sharepoint"}),e.setImportDone(e=>e+1),e.setImportRows(e=>[...e,{name:h,status:"failed"}]),u++}i(t=>(0,d.A)((0,d.A)({},t),{},{selectedDocuments:e.mergeDocuments(t.selectedDocuments,l)})),(0,ct.P0)("Imported ".concat(l.length-u," \u2022 deduped ").concat(c).concat(u?" \u2022 failed ".concat(u):""),u?"warning":"success")}catch(s){i(n=>(0,d.A)((0,d.A)({},n),{},{selectedDocuments:e.mergeDocuments(n.selectedDocuments,t.map(e=>{var t;return{title:e.name,url:e.webUrl,version:1,requiresSignature:!1,driveId:null===e||void 0===e||null===(t=e.parentReference)||void 0===t?void 0:t.driveId,itemId:null===e||void 0===e?void 0:e.id,source:"sharepoint"}}))}))}finally{e.setImportBusy(!1)}}}),(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Selected Documents"}),(0,x.jsxs)("div",{className:"small muted",children:[a.selectedDocuments.length," document(s)"]})]})}),0===a.selectedDocuments.length?(0,x.jsx)("div",{className:"small muted",children:"No documents selected yet. Use Library or SharePoint above."}):(0,x.jsx)("div",{style:{maxHeight:240,overflowY:"auto",display:"grid",gap:6},children:a.selectedDocuments.map((t,n)=>(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{style:{minWidth:0},children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:["sharepoint"===t.source&&(0,x.jsx)("span",{className:"badge",children:"sharepoint"}),t.localUrl&&(0,x.jsx)("span",{className:"badge",children:"local"}),"sharepoint"===t.source&&t.localUrl&&(0,x.jsx)("span",{className:"badge",title:"Server backup created",children:"backed up"}),(t.localUrl||t.url)&&(0,x.jsx)("a",{href:t.localUrl||t.url,target:"_blank",rel:"noreferrer",className:"small",children:"View \u2197"})]})]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>e.removeSelectedDoc(n),title:"Remove from batch",children:"\u2715"})]},n))})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Business Mapping"}),(0,x.jsx)("div",{className:"small muted",children:"Assign each selected user to a business"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,x.jsx)("span",{className:"small muted",children:"Default:"}),(0,x.jsxs)("select",{value:String(w),onChange:e=>_(e.target.value?Number(e.target.value):""),children:[(0,x.jsx)("option",{value:"",children:"\u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,x.jsx)("span",{className:"small muted",children:"Apply to all:"}),(0,x.jsxs)("select",{onChange:e=>b(e.target.value?Number(e.target.value):null),defaultValue:"",children:[(0,x.jsx)("option",{value:"",children:"\u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]}),a.selectedGroups.length>0&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:y,title:"Load members of selected groups for per-user mapping",children:"Expand groups for mapping"}),(0,x.jsxs)("span",{className:"small muted",children:["Users to map: ",v.length]})]})]}),!n&&(0,x.jsx)("div",{className:"small muted",children:"Enable SQLite to load businesses."}),n&&0===g.length&&(0,x.jsx)("div",{className:"small muted",children:"No businesses found."}),n&&g.length>0&&(0,x.jsx)("div",{style:{maxHeight:260,overflowY:"auto",display:"grid",gap:8},children:v.map(t=>{var n;const r=(t.mail||t.userPrincipalName||"").trim().toLowerCase(),a=null!==(n=e.businessMap[r])&&void 0!==n?n:"";return(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.displayName}),(0,x.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r})]}),(0,x.jsxs)("select",{value:String(a),onChange:t=>e.setUserBusiness(r,t.target.value?Number(t.target.value):null),children:[(0,x.jsx)("option",{value:"",children:"\u2014 No business \u2014"}),g.map(e=>(0,x.jsx)("option",{value:e.id,children:e.name},e.id))]})]},t.id)})})]})]}),(0,x.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:16,borderRadius:8},children:[(0,x.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:16},children:"Batch Summary"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"small muted",children:"Assigned Users:"}),(0,x.jsx)("div",{style:{fontWeight:"bold"},children:a.selectedUsers.length+a.selectedGroups.reduce((e,t)=>e+(t.memberCount||0),0)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"small muted",children:"Documents:"}),(0,x.jsx)("div",{style:{fontWeight:"bold"},children:a.selectedDocuments.length})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"small muted",children:"Duration:"}),(0,x.jsx)("div",{style:{fontWeight:"bold"},children:a.startDate&&a.dueDate?Math.ceil((new Date(a.dueDate).getTime()-new Date(a.startDate).getTime())/864e5)+" days":"Not set"})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:16,marginTop:16,alignItems:"center",flexWrap:"wrap"},children:[(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:a.notifyByEmail,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{notifyByEmail:e.target.checked}))}),(0,x.jsx)("span",{className:"small",children:"Email notification (Microsoft Graph)"})]}),(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,opacity:.6},title:"Requires Teams Chat.ReadWrite; coming soon",children:[(0,x.jsx)("input",{type:"checkbox",checked:a.notifyByTeams,onChange:e=>i((0,d.A)((0,d.A)({},a),{},{notifyByTeams:e.target.checked})),disabled:!0}),(0,x.jsx)("span",{className:"small",children:"Teams message (optional)"})]})]}),(0,x.jsxs)("div",{style:{marginTop:16,display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn",onClick:A,disabled:!a.name||!a.startDate||!a.dueDate||0===a.selectedDocuments.length||0===a.selectedUsers.length&&0===a.selectedGroups.length,children:r?"Save Changes":"Create Batch"}),(0,x.jsx)("button",{className:"btn ghost",onClick:()=>{i({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),e.setBusinessMap({}),_("")},children:r?"Cancel Edit":"Reset Form"}),(0,x.jsx)("button",{className:"btn ghost",title:"Preview expanded recipients",onClick:async()=>{try{const e=new Set;for(const n of a.selectedUsers){const t=(n.mail||n.userPrincipalName||"").trim();t&&e.add(t.toLowerCase())}if(a.selectedGroups.length>0){const t=await xr(["Group.Read.All","User.Read"]),n=await Promise.all(a.selectedGroups.map(e=>Dr(t,e.id).catch(()=>[]))),r=[].concat(...n);for(const a of r){const t=(a.mail||a.userPrincipalName||"").trim();t&&e.add(t.toLowerCase())}}const t=e.size;(0,ct.P0)("Recipient preview: ".concat(t," unique addresses"),"info")}catch(e){(0,ct.P0)("Failed to preview recipients","error")}},children:"Preview Recipients"}),(0,x.jsx)("button",{className:"btn ghost",title:"Grant Graph permissions",onClick:async()=>{try{await xr(["User.Read.All","Group.Read.All"]),await xr(["Mail.Send"]),await xr(["Sites.Read.All","Files.ReadWrite.All"]),(0,ct.P0)("Permissions granted (if consented)","success")}catch(e){(0,ct.P0)("Permission grant failed","error")}},children:"Grant Permissions"})]})]})]})},lp=()=>(0,x.jsx)("div",{children:(0,x.jsx)(Kh,{})}),cp=()=>{var t,n,r,a,i;const{role:s,canSeeAdmin:o,canEditAdmin:l,isSuperAdmin:c,perms:u}=(0,S.ec)(),{account:h}=(0,_.As)(),{externalSupport:p}=k(),[f,m]=(0,e.useState)("overview"),[g,v]=(0,e.useState)(null),[y,b]=(0,e.useState)(new Set),[w,A]=(0,e.useState)(new Set),[C,E]=(0,e.useState)("unknown"),T=async()=>{try{if(!we)return void E("unknown");const e="https://sunbeth-ack-portal-backend.vercel.app/".replace(/\/$/,""),t=await fetch("".concat(e,"/api/health"),{cache:"no-store"});E(t.ok?"ok":"down")}catch(e){E("down")}};(0,e.useEffect)(()=>{T()},[]);const[I,R]=(0,e.useState)(!1),[N,O]=(0,e.useState)(null),[M,F]=(0,e.useState)(!1),[D,j]=(0,e.useState)({}),U="sunbeth:admin:useModalSelectors",G=(0,P.G8)(),H=(()=>{const e=(0,P.s8)()?"true":"false";return"true"===e||"false"!==e})(),[z,W]=(0,e.useState)(()=>{try{const e=localStorage.getItem(U);if("true"===e)return!0;if("false"===e)return!1}catch(e){}return H}),[q,V]=(0,e.useState)(!1),[K,Y]=(0,e.useState)(!1),[X,Q]=(0,e.useState)(!1),[$,J]=(0,e.useState)(!1),[Z,ee]=(0,e.useState)(0),[te,ne]=(0,e.useState)(0),[re,ae]=(0,e.useState)([]),[ie,se]=(0,e.useState)(""),[oe,le]=(0,e.useState)(""),[ce,de]=(0,e.useState)(""),ue=(e,t)=>{const n=new Map,r=e=>{const t=(e=>{if(e.driveId&&e.itemId)return"sp:".concat(e.driveId,":").concat(e.itemId);if(null!=e.localFileId)return"local:".concat(e.localFileId);const t=(e.title||"").toLowerCase().trim(),n=(e.url||"").split("?")[0].toLowerCase().trim();return t||n||Math.random().toString(36).slice(2)})(e);n.has(t)?n.set(t,((e,t)=>{var n,r,a;const i=e=>"sharepoint"===e.source||/sharepoint\.com\//i.test(e.url),s=i(t)?t.url:i(e)?e.url:e.url||t.url;return{title:t.title&&t.title.length>(e.title||"").length?t.title:e.title||t.title||"Document",url:s,version:null!==(n=t.version)&&void 0!==n?n:e.version,requiresSignature:(null!==(r=t.requiresSignature)&&void 0!==r?r:e.requiresSignature)||!1,driveId:t.driveId||e.driveId,itemId:t.itemId||e.itemId,source:i(t)||i(e)?"sharepoint":t.source||e.source,localFileId:null!==(a=null!=t.localFileId?t.localFileId:e.localFileId)&&void 0!==a?a:null,localUrl:t.localUrl||e.localUrl||null}})(n.get(t),e)):n.set(t,(0,d.A)({},e))};return e.forEach(r),t.forEach(r),Array.from(n.values())},he=["User.Read","User.Read.All","Group.Read.All","Mail.Send"],pe=async()=>{const e={};for(const n of he)try{await xr([n]),e[n]=!0}catch(t){e[n]=!1}j(e)};(0,e.useEffect)(()=>{G||pe().catch(()=>{})},[G]);const[fe,me]=(0,e.useState)({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),[ge,ve]=(0,e.useState)([]);(0,e.useEffect)(()=>{ve(fe.selectedUsers)},[fe.selectedUsers]);const ye=async e=>{const t=fe.selectedDocuments[e];if(me(t=>(0,d.A)((0,d.A)({},t),{},{selectedDocuments:t.selectedDocuments.filter((t,n)=>n!==e)})),!g||!t)return;const n=e=>(e||"").trim().toLowerCase().replace(/\/$/,"").replace(/\?.*$/,""),r=n(t.url),a=n(t.localUrl||void 0),i=await(async()=>{try{const i=(0,P.Gi)(),s=await fetch("".concat(i,"/api/batches/").concat(encodeURIComponent(g),"/documents"),{cache:"no-store"}),o=await s.json().catch(()=>[]);if(!Array.isArray(o)||0===o.length)return!1;const l=[];for(const c of o){var e;const i=Number(c.id||c.toba_documentid||c.toba_id||c.ID);if(!Number.isFinite(i))continue;const s=n(c.url||c.webUrl||c.toba_originalurl||c.toba_fileurl),o=n(c.localUrl||c.toba_localurl),d=!!r&&s===r||!!a&&s===a,u=!!a&&o===a||!!r&&o===r,h=t.driveId&&t.itemId&&(c.driveId===t.driveId||c.toba_driveid===t.driveId)&&(c.itemId===t.itemId||c.toba_itemid===t.itemId),p=null!=t.localFileId&&(null!==(e=c.localFileId)&&void 0!==e?e:c.toba_localfileid)===t.localFileId;(d||u||h||p)&&l.push(i)}if(0===l.length)return!1;return!!(await fetch("".concat(i,"/api/batches/").concat(encodeURIComponent(g),"/documents"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:l})})).ok&&(r&&A(e=>{const t=new Set(e);return t.delete(r),t}),!0)}catch(i){return!1}})();if(i)return void(0,ct.P0)("Removed document from batch","success");await(async()=>{try{const e=(0,P.Gi)(),n=[];if(t.url&&n.push(t.url),t.localUrl&&!n.includes(t.localUrl)&&n.push(t.localUrl),0===n.length)return!1;return!!(await fetch("".concat(e,"/api/batches/").concat(encodeURIComponent(g),"/documents"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:n})})).ok&&(r&&A(e=>{const t=new Set(e);return t.delete(r),t}),!0)}catch(Pp){return!1}})()?(0,ct.P0)("Removed document from batch","success"):(0,ct.P0)("Removed locally, but server removal failed","warning")};if(!o)return(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsx)("h2",{style:{color:"#d63384",margin:0},children:"Access Denied"}),(0,x.jsx)("p",{children:"You do not have permission to access the Admin Panel."}),(0,x.jsxs)("p",{className:"small muted",children:["Current role: ",s]})]})});const be=(()=>{const e=[{id:"overview",label:"Overview",icon:"\ud83d\udcca"}];return(c||null!==u&&void 0!==u&&u.manageSettings)&&(e.push({id:"settings",label:"Settings",icon:"\u2699\ufe0f"}),e.push({id:"policies",label:"Policies",icon:"\ud83d\udcdc"})),(c||null!==u&&void 0!==u&&u.manageRoles||null!==u&&void 0!==u&&u.managePermissions)&&e.push({id:"rbac",label:"Permission",icon:"\ud83d\udd10"}),c&&e.push({id:"notificationEmails",label:"Notification Emails",icon:"\u2709\ufe0f"}),e.push({id:"manage",label:"Manage",icon:"\ud83e\uddf0"},...c||null!==u&&void 0!==u&&u.createBatch||null!==u&&void 0!==u&&u.editBatch?[{id:"batch",label:"Create Batch",icon:"\ud83d\udcdd"}]:[],...c||null!==u&&void 0!==u&&u.viewAnalytics?[{id:"analytics",label:"Analytics",icon:"\ud83d\udcc8"}]:[]),(c||null!==u&&void 0!==u&&u.viewDebugLogs)&&e.push({id:"audit",label:"Audit Logs",icon:"\ud83d\udee1\ufe0f"}),e})(),we=(0,P.Kr)(),[_e,Ae]=(0,e.useState)(null),[Se,Ce]=(0,e.useState)([]),[xe,Ee]=(0,e.useState)({}),[Te,ke]=(0,e.useState)("");(0,e.useEffect)(()=>{we&&(async()=>{try{const e=(0,P.Gi)(),t=await fetch("".concat(e,"/api/stats"));if(!t.ok)throw new Error("stats_failed");const n=await t.json();Ae(n)}catch(e){}})()},[we]),(0,e.useEffect)(()=>{we&&(async()=>{try{const e=await(0,L.Xr)(),t=(Array.isArray(e)?e:[]).map(e=>{var t,n,r,a,i,s,o,l,c,d;return{id:Number(null!==(t=null!==(n=null!==(r=e.id)&&void 0!==r?r:e.businessId)&&void 0!==n?n:e.ID)&&void 0!==t?t:e.toba_businessid),name:String(null!==(a=null!==(i=null!==(s=null!==(o=null!==(l=e.name)&&void 0!==l?l:e.Title)&&void 0!==o?o:e.title)&&void 0!==s?s:e.toba_name)&&void 0!==i?i:e.code)&&void 0!==a?a:"Business"),code:null!==(c=e.code)&&void 0!==c?c:e.toba_code,isActive:!!(null!==(d=e.isActive)&&void 0!==d?d:e.toba_isactive)}}).filter(e=>Number.isFinite(e.id)&&!!e.name);Ce(t)}catch(e){console.warn("Failed to load businesses",e),Ce([])}})()},[we]);return(0,x.jsxs)("div",{className:"container",children:[(0,x.jsxs)("div",{className:"card",children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{style:{margin:0,fontSize:24,color:"var(--primary)"},children:"Admin Panel"}),(0,x.jsxs)("p",{className:"small muted",children:["Role: ",s," \u2022 ",l?"Full Access":"Read Only"]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[we&&(0,x.jsxs)("div",{className:"small",title:"SQLite API health",style:{display:"flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #eee",borderRadius:999},children:[(0,x.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:"ok"===C?"#28a745":"down"===C?"#dc3545":"#ffc107"}}),(0,x.jsxs)("span",{children:["API: ","ok"===C?"OK":"down"===C?"Down":"\u2014"]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:T,style:{marginLeft:6},children:"Refresh"})]}),(c||(null===u||void 0===u?void 0:u.exportAnalytics))&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{await(async()=>{const e="https://sunbeth-ack-portal-backend.vercel.app/".replace(/\/$/,""),[t,n]=await Promise.all([fetch("".concat(e,"/api/batches")),fetch("".concat(e,"/api/recipients"))]),r=await t.json().catch(()=>[]),a=await n.json().catch(()=>[]),i=[];for(const b of Array.isArray(r)?r:[]){const t=String(b.toba_batchid||b.id);if(t)try{const n=await fetch("".concat(e,"/api/batches/").concat(encodeURIComponent(t),"/documents")),r=await n.json();for(const e of Array.isArray(r)?r:[])i.push((0,d.A)({batchId:t},e))}catch(y){}}const s=(Array.isArray(r)?r:[]).map(e=>({id:String(e.toba_batchid||e.id),name:String(e.toba_name||e.name||""),startDate:e.toba_startdate||e.startDate||"",dueDate:e.toba_duedate||e.dueDate||"",status:null!=e.toba_status?String(e.toba_status):null!=e.status?String(e.status):"",description:e.description||""})),o=i.map(e=>{var t;return{id:String(e.toba_documentid||e.id||""),batchId:String(e.batchId||e.toba_batchid||""),title:String(e.toba_title||e.title||""),url:String(e.toba_fileurl||e.url||""),version:Number(e.toba_version||e.version||1),requiresSignature:!!(null!==(t=e.toba_requiressignature)&&void 0!==t?t:e.requiresSignature),driveId:e.toba_driveid||e.driveId||"",itemId:e.toba_itemid||e.itemId||"",source:e.toba_source||e.source||""}}),l=(Array.isArray(a)?a:[]).map(e=>({id:Number(e.id),batchId:Number(e.batchId),businessId:null!=e.businessId?Number(e.businessId):"",email:String(e.email||e.user||""),displayName:String(e.displayName||""),department:e.department||"",jobTitle:e.jobTitle||"",location:e.location||"",primaryGroup:e.primaryGroup||""})),c=Rh.book_new(),u=Rh.json_to_sheet(s),h=Rh.json_to_sheet(o),p=Rh.json_to_sheet(l);Rh.book_append_sheet(c,u,"Batches"),Rh.book_append_sheet(c,h,"Documents"),Rh.book_append_sheet(c,p,"Recipients");const f=bh(c,{bookType:"xlsx",type:"array"}),m=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),g=URL.createObjectURL(m),v=document.createElement("a");v.href=g,v.download="sunbeth-ack-analytics.xlsx",v.click(),URL.revokeObjectURL(g)})()}catch(e){console.warn("Excel export failed",e),(0,ct.P0)("Excel export failed","error")}},children:"Export Excel"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{R(!0),O(null);try{O(await Nh())}catch(e){O([{name:"Health check",ok:!1,detail:String(e)}])}},children:"System Health"}),(c||(null===u||void 0===u?void 0:u.viewDebugLogs))&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>V(!0),title:"Open batch creation debug console",children:"\ud83d\udd0d Debug Logs"}),we&&l&&(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{const e=(0,P.Gi)(),t=(null===h||void 0===h?void 0:h.username)||"seed.user@sunbeth.com";if(!(await fetch("".concat(e,"/api/seed?email=").concat(encodeURIComponent(t)),{method:"POST"})).ok)throw new Error("seed_failed");(0,ct.P0)("Seeded demo data","success")}catch(e){(0,ct.P0)("Seed failed","error")}},children:"Seed Data"})]})]}),(0,x.jsx)("div",{style:{display:"flex",gap:4,marginBottom:24,borderBottom:"2px solid #f0f0f0"},children:be.map(e=>(0,x.jsxs)("button",{className:f===e.id?"btn sm":"btn ghost sm",onClick:()=>m(e.id),style:{borderRadius:"8px 8px 0 0"},children:[e.icon," ",e.label]},e.id))}),"overview"===f&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{style:{fontSize:18,marginBottom:16},children:"System Overview"}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,x.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"var(--primary)"},children:null!==(t=null===_e||void 0===_e?void 0:_e.activeBatches)&&void 0!==t?t:"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:"Active Batches"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#28a745"},children:null!==(n=null===_e||void 0===_e||null===(r=_e.totalUsers)||void 0===r||null===(a=r.toLocaleString)||void 0===a?void 0:a.call(r))&&void 0!==n?n:"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:"Total Users"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#ffc107"},children:_e?"".concat(_e.completionRate,"%"):"\u2014"}),(0,x.jsx)("div",{className:"small muted",children:"Completion Rate"})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,x.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#17a2b8"},children:null!==(i=null===_e||void 0===_e?void 0:_e.overdueBatches)&&void 0!==i?i:0}),(0,x.jsx)("div",{className:"small muted",children:"Overdue Batches"})]})]}),(0,x.jsxs)("div",{className:"card",style:{marginTop:16,padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,color:"var(--primary)"},children:"Permissions Status"}),(0,x.jsx)("div",{className:"muted small",children:"Required Microsoft Graph scopes"})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>pe(),children:"Refresh"}),(0,x.jsx)("button",{className:"btn sm",onClick:async()=>{try{F(!0);for(const t of he)try{await xr([t])}catch(e){}await pe(),(0,ct.P0)("Permission prompts completed","success")}finally{F(!1)}},disabled:M,children:"Grant All"})]})]}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:8},children:he.map(e=>(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,border:"1px solid #eee",borderRadius:6},children:[(0,x.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:D[e]?"#28a745":"#dc3545"}}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:e}),!D[e]&&(0,x.jsxs)("button",{className:"btn ghost sm",onClick:async()=>{try{await xr([e])}catch(t){}await pe()},children:["Grant ",e]}),D[e]&&(0,x.jsx)("div",{className:"small muted",children:"Granted"})]})]},e))})]})]}),"settings"===f&&(0,x.jsx)(Qh,{canEdit:!!(c||null!==u&&void 0!==u&&u.manageSettings)}),"policies"===f&&(0,x.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Recurring Policies"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Define annual or recurring acknowledgements at the document level; applies to all employees by default."}),(0,x.jsx)(e.Suspense,{fallback:(0,x.jsx)("div",{className:"small muted",children:"Loading policies\u2026"}),children:e.createElement(__webpack_require__(776).A)})]}),(c||(null===u||void 0===u?void 0:u.manageSettings))&&(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{style:{margin:"0 0 4px 0",fontSize:16},children:"Consent Reports"}),(0,x.jsx)("div",{className:"small muted",children:"Download a court-ready PDF or a JSON export of consent receipts. Use filters to narrow the report."})]})}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:8,marginTop:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"reportEmail",children:"Filter Email"}),(0,x.jsx)("input",{id:"reportEmail",value:ie,onChange:e=>se(e.target.value),placeholder:"user@company.com"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"reportSince",children:"Since (UTC)"}),(0,x.jsx)("input",{id:"reportSince",type:"datetime-local",value:oe,onChange:e=>le(e.target.value)})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"reportUntil",children:"Until (UTC)"}),(0,x.jsx)("input",{id:"reportUntil",type:"datetime-local",value:ce,onChange:e=>de(e.target.value)})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[(0,x.jsx)("button",{className:"btn sm",onClick:()=>{try{const e=(0,P.Gi)()||"",t=(null===h||void 0===h?void 0:h.username)||"",n=new URLSearchParams({adminEmail:t});ie.trim()&&n.set("email",ie.trim()),oe.trim()&&n.set("since",new Date(oe).toISOString()),ce.trim()&&n.set("until",new Date(ce).toISOString()),n.set("format","pdf");const r="".concat(e,"/api/admin/consents/report?").concat(n.toString());window.open(r,"_blank")}catch(e){}},children:"Download PDF Report"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>{try{const e=(0,P.Gi)()||"",t=(null===h||void 0===h?void 0:h.username)||"",n=new URLSearchParams({adminEmail:t});ie.trim()&&n.set("email",ie.trim()),oe.trim()&&n.set("since",new Date(oe).toISOString()),ce.trim()&&n.set("until",new Date(ce).toISOString());const r="".concat(e,"/api/admin/consents/export?").concat(n.toString());window.open(r,"_blank")}catch(e){}},children:"Download JSON"})]})]})]}),"manage"===f&&(0,x.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,x.jsx)("div",{className:"card",style:{padding:16},children:(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{style:{margin:"0 0 4px 0",fontSize:16},children:"Import Templates"}),(0,x.jsx)("div",{className:"small muted",children:"Download enterprise-ready templates for bulk operations."})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)("button",{className:"btn sm",onClick:qh,title:"Download a workbook containing all import templates",children:"All (Excel)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:Gh,children:"External Users (Excel)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:Hh,children:"External Users (CSV)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:zh,children:"Businesses (Excel)"}),(0,x.jsx)("button",{className:"btn ghost xs",onClick:Wh,children:"Businesses (CSV)"})]})]})}),p&&(c||(null===u||void 0===u?void 0:u.manageRoles)||(null===u||void 0===u?void 0:u.manageRecipients))&&(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"External Users"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Invite, bulk upload, update, disable, or delete external users."}),(0,x.jsx)(Vh,{canEdit:l})]}),(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Batches"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"View, edit, or delete batches. Deleting a batch removes its documents, recipients, and acknowledgements."}),(0,x.jsx)(ep,{canEdit:l,onEdit:e=>(async e=>{try{if(!we)return;const r=(0,P.Gi)(),a=await fetch("".concat(r,"/api/batches")),i=await a.json(),s=(Array.isArray(i)?i:[]).find(t=>String(t.toba_batchid||t.id||t.batchId||t.ID)===String(e));if(!s)throw new Error("batch_not_found");let o=[];try{const t=await fetch("".concat(r,"/api/batches/").concat(encodeURIComponent(e),"/documents"));o=await t.json()}catch(t){o=[]}let l=[];try{const t=await fetch("".concat(r,"/api/recipients")),n=await t.json();l=(Array.isArray(n)?n:[]).filter(t=>String(t.batchId)===String(e))}catch(n){l=[]}const c=(o||[]).map(e=>{var t;return{title:e.title||e.name||e.toba_title||"Document",url:e.url||e.webUrl||e.toba_fileurl,version:Number(e.version||e.toba_version||1),requiresSignature:!!(null!==(t=e.requiresSignature)&&void 0!==t?t:e.toba_requiressignature),driveId:e.driveId||e.toba_driveid||void 0,itemId:e.itemId||e.toba_itemid||void 0,source:e.source||e.toba_source||(e.driveId||e.toba_driveid?"sharepoint":void 0),localFileId:e.localFileId||e.toba_localfileid||null,localUrl:e.localUrl||e.toba_localurl||null}}),d=(l||[]).map(e=>({id:e.email||e.user||e.userPrincipalName||e.id||e.email,displayName:e.displayName||e.email,userPrincipalName:e.email,department:e.department,jobTitle:e.jobTitle})),u=[],h={};for(const e of l){const t=String(e.email||e.user||"").toLowerCase();t&&(h[t]=null!=e.businessId?Number(e.businessId):null)}b(new Set((l||[]).map(e=>String(e.email||e.user||"").trim().toLowerCase()).filter(Boolean))),A(new Set((o||[]).map(e=>String(e.url||e.webUrl||"").trim()).filter(Boolean))),me({name:String(s.toba_name||s.name||""),startDate:s.toba_startdate||s.startDate||"",dueDate:s.toba_duedate||s.dueDate||"",description:String(s.description||""),selectedUsers:d,selectedGroups:u,selectedDocuments:c,notifyByEmail:!0,notifyByTeams:!1}),Ee(h),ke(""),v(String(e)),m("batch"),(0,ct.P0)("Loaded batch into editor","success")}catch(r){console.error("Failed to load batch for editing",r),(0,ct.P0)("Failed to open batch for editing","error")}})(e),onClone:e=>(async e=>{try{if(!we)return;const r=(0,P.Gi)(),a=await fetch("".concat(r,"/api/batches")),i=await a.json(),s=(Array.isArray(i)?i:[]).find(t=>String(t.toba_batchid||t.id||t.batchId||t.ID)===String(e));if(!s)throw new Error("batch_not_found");let o=[];try{const t=await fetch("".concat(r,"/api/batches/").concat(encodeURIComponent(e),"/documents"));o=await t.json()}catch(t){o=[]}let l=[];try{const t=await fetch("".concat(r,"/api/recipients")),n=await t.json();l=(Array.isArray(n)?n:[]).filter(t=>String(t.batchId)===String(e))}catch(n){l=[]}const c=(o||[]).map(e=>{var t;return{title:e.title||e.name||e.toba_title||"Document",url:e.url||e.webUrl||e.toba_fileurl,version:Number(e.version||e.toba_version||1),requiresSignature:!!(null!==(t=e.requiresSignature)&&void 0!==t?t:e.toba_requiressignature),driveId:e.driveId||e.toba_driveid||void 0,itemId:e.itemId||e.toba_itemid||void 0,source:e.source||e.toba_source||(e.driveId||e.toba_driveid?"sharepoint":void 0),localFileId:e.localFileId||e.toba_localfileid||null,localUrl:e.localUrl||e.toba_localurl||null}}),d=(l||[]).map(e=>({id:e.email||e.user||e.userPrincipalName||e.id||e.email,displayName:e.displayName||e.email,userPrincipalName:e.email,department:e.department,jobTitle:e.jobTitle})),u=[],h={};for(const e of l){const t=String(e.email||e.user||"").toLowerCase();t&&(h[t]=null!=e.businessId?Number(e.businessId):null)}me({name:(String(s.toba_name||s.name||"")+" (Copy)").trim(),startDate:"",dueDate:"",description:String(s.description||""),selectedUsers:d,selectedGroups:u,selectedDocuments:c,notifyByEmail:!0,notifyByTeams:!1}),Ee(h),ke(""),v(null),b(new Set),A(new Set),m("batch"),(0,ct.P0)("Prepared clone in editor","success")}catch(r){console.error("Failed to clone batch",r),(0,ct.P0)("Failed to clone batch","error")}})(e)})]}),(c||(null===u||void 0===u?void 0:u.manageBusinesses))&&(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Businesses"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Create, edit, or delete businesses. Deleting a business will unassign it from any recipients mapped to it."}),(0,x.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,x.jsx)(lp,{}),(0,x.jsx)("div",{className:"divider"}),(0,x.jsx)(rp,{canEdit:l})]})]})]}),"notificationEmails"===f&&(0,x.jsx)(Or,{}),"rbac"===f&&(0,x.jsxs)("div",{style:{display:"grid",gap:16},children:[(c||(null===u||void 0===u?void 0:u.manageRoles))&&(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Roles"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Manage Admin and Manager assignments without editing .env. Top-level access is configured via environment variables."}),(0,x.jsx)(jh,{canEdit:l,isSuperAdmin:c})]}),(c||(null===u||void 0===u?void 0:u.managePermissions))&&(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Permissions Matrix"}),(0,x.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Configure what each role can do, and set per-user overrides when needed."}),(0,x.jsx)(Lh,{})]}),!(c||null!==u&&void 0!==u&&u.manageRoles)&&!(c||null!==u&&void 0!==u&&u.managePermissions)&&(0,x.jsx)("div",{className:"card",style:{padding:16},children:(0,x.jsx)("div",{className:"small muted",children:"You don\u2019t have permission to view Permission settings."})})]}),"batch"===f&&(0,x.jsx)(op,{isSuperAdmin:c,canUploadDocuments:!!(c||null!==u&&void 0!==u&&u.uploadDocuments),sqliteEnabled:we,editingBatchId:g,batchForm:fe,setBatchForm:me,useModalSelectors:z,setUseModalSelectors:W,modalToggleKey:U,usersModalOpen:K,setUsersModalOpen:Y,docsModalOpen:X,setDocsModalOpen:Q,importBusy:$,importTotal:Z,importDone:te,importRows:re,setImportBusy:J,setImportTotal:ee,setImportDone:ne,setImportRows:ae,businesses:Se,mappingUsers:ge,expandGroupsForMapping:async()=>{try{if(0===fe.selectedGroups.length)return;const e=await xr(["Group.Read.All","User.Read"]),t=await Promise.all(fe.selectedGroups.map(t=>Dr(e,t.id).catch(()=>[]))),n=[].concat(...t),r=new Map,a=e=>{const t=(e.mail||e.userPrincipalName||"").trim().toLowerCase();t&&(r.has(t)||r.set(t,e))};fe.selectedUsers.forEach(a),n.forEach(a),ve(Array.from(r.values())),(0,ct.P0)("Loaded ".concat(n.length," member(s) from selected group(s)"),"success")}catch(e){(0,ct.P0)("Failed to expand groups for mapping","error")}},businessMap:xe,setUserBusiness:(e,t)=>{const n=(e||"").trim().toLowerCase();n&&Ee(e=>(0,d.A)((0,d.A)({},e),{},{[n]:t}))},applyBusinessToAll:e=>{const t={};for(const n of ge){const r=(n.mail||n.userPrincipalName||"").trim().toLowerCase();r&&(t[r]=e)}Ee(t)},setBusinessMap:Ee,defaultBusinessId:Te,setDefaultBusinessId:ke,mergeDocuments:ue,removeSelectedDoc:ye,saveBatch:async()=>{try{var e,t,n,r;if(Ar("Creating your batch..."),!(0,P.Kr)())return void await(0,ct.p_)("SQLite disabled","Enable SQLite (REACT_APP_ENABLE_SQLITE=true) and set REACT_APP_API_BASE.");const u=(0,P.Gi)();if(!fe.name.trim())return void await(0,ct.vc)("Missing batch name","Batch name is required");console.log("\ud83d\ude80 Starting comprehensive batch creation process...",{batchName:fe.name,selectedDocs:fe.selectedDocuments.length,selectedUsers:fe.selectedUsers.length,selectedGroups:fe.selectedGroups.length,isEditing:!!g});const h=new Map,p=new Map,f=(e,t,n)=>{const r=(e||"").trim();if(!r)return;const a=r.toLowerCase();if(h.has(a)||h.set(a,{address:r,name:t}),n){const e=p.get(a)||new Set;e.add(n),p.set(a,e)}};for(const e of fe.selectedUsers)f(e.mail||e.userPrincipalName||"",e.displayName);if(fe.selectedGroups.length>0)try{const e=await xr(["Group.Read.All","User.Read"]),t=await Promise.all(fe.selectedGroups.map(t=>Dr(e,t.id).then(e=>({gid:t.id,members:e})).catch(()=>({gid:t.id,members:[]}))));for(const{gid:n,members:r}of t)for(const e of r)f(e.mail||e.userPrincipalName||"",e.displayName,n)}catch(o){console.warn("Failed to expand group members for notifications",o)}const m=Array.from(h.values()),_=new Map;for(const e of fe.selectedUsers){const t=(e.mail||e.userPrincipalName||"").trim().toLowerCase();t&&_.set(t,e)}const{subject:S,bodyHtml:C}=(e=>{const t=(0,P.JH)(),n=(0,P.MV)(),r=(0,P.pU)();return{subject:"Action required: ".concat(e.batchName),bodyHtml:'\n    <div style="background:#f7f8fa;padding:24px">\n      <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="max-width:720px;margin:0 auto;background:#ffffff;border:1px solid #e9ecef;border-radius:10px;overflow:hidden">\n        <tr>\n          <td style="padding:16px 20px;border-bottom:1px solid #e9ecef;background:'.concat(r,';color:white">\n            <div style="display:flex;align-items:center;gap:12px">\n              ').concat(n?'<img src="'.concat(n,'" alt="').concat(t,'" style="height:28px;display:block;border:0"/>'):"",'\n              <strong style="font-family:Segoe UI,Tahoma,Arial,sans-serif;font-size:16px;line-height:1">').concat(t,'</strong>\n            </div>\n          </td>\n        </tr>\n        <tr>\n          <td style="padding:20px 20px 8px 20px;font-family:Segoe UI,Tahoma,Arial,sans-serif;color:#111">\n            <h2 style="margin:0 0 12px 0;font-size:18px;color:#111">New acknowledgement assigned</h2>\n            <p style="margin:0 0 12px 0">You have been assigned: <strong>').concat(e.batchName,"</strong>.</p>\n            ").concat(e.description?'<p style="margin:0 0 12px 0;color:#444">'.concat(e.description,"</p>"):"",'\n            <table role="presentation" cellpadding="0" cellspacing="0" style="margin:12px 0;color:#333">\n              ').concat(e.startDate?'<tr><td style="padding:4px 8px 4px 0;color:#666">Start:</td><td style="padding:4px 0"><strong>'.concat(new Date(e.startDate).toLocaleDateString(),"</strong></td></tr>"):"","\n              ").concat(e.dueDate?'<tr><td style="padding:4px 8px 4px 0;color:#666">Due:</td><td style="padding:4px 0"><strong>'.concat(new Date(e.dueDate).toLocaleDateString(),"</strong></td></tr>"):"",'\n            </table>\n            <p style="margin:16px 0 0 0">\n              <a href="').concat(e.appUrl,'" target="_blank" rel="noopener" style="display:inline-block;background:').concat(r,';color:#fff;text-decoration:none;padding:10px 14px;border-radius:6px;font-weight:600">Open Acknowledgement Portal</a>\n            </p>\n            <p style="margin:16px 0 0 0;color:#666;font-size:12px">If the button doesn\u2019t work, copy and paste this link into your browser:<br/><span style="word-break:break-all;color:#555">').concat(e.appUrl,'</span></p>\n          </td>\n        </tr>\n        <tr>\n          <td style="padding:16px 20px;border-top:1px solid #e9ecef;background:#fafbfc;color:#666;font-family:Segoe UI,Tahoma,Arial,sans-serif;font-size:12px">\n            <div>This message was sent by ').concat(t," via Microsoft Graph.</div>\n            <div>Please do not reply to this automated notification.</div>\n          </td>\n        </tr>\n      </table>\n    </div>")}})({appUrl:window.location.origin,batchName:fe.name,startDate:fe.startDate,dueDate:fe.dueDate,description:fe.description});let x=m;if(g){const e=e=>!y.has((e||"").trim().toLowerCase()),t=m.filter(t=>e(t.address));x=t}const E=fe.selectedDocuments.map(e=>{var t,n,r;return{title:e.title,url:e.url,version:null!==(t=e.version)&&void 0!==t?t:1,requiresSignature:!!e.requiresSignature,driveId:e.driveId||null,itemId:e.itemId||null,source:e.source||null,localFileId:null!==(n=e.localFileId)&&void 0!==n?n:null,localUrl:null!==(r=e.localUrl)&&void 0!==r?r:null}}),T=m.map(e=>{var t;const n=(e.address||"").toLowerCase(),r=_.get(n);let a;const i=p.get(n);if(i&&i.size>0){const e=i.values().next().value,t=fe.selectedGroups.find(t=>t.id===e);null!==t&&void 0!==t&&t.displayName&&(a=t.displayName)}return{businessId:null!==(t=xe[n])&&void 0!==t?t:""!==Te?Number(Te):null,user:n,email:n,userEmail:n,userPrincipalName:n,displayName:e.name||void 0,department:(null===r||void 0===r?void 0:r.department)||void 0,jobTitle:(null===r||void 0===r?void 0:r.jobTitle)||void 0,location:(null===r||void 0===r?void 0:r.officeLocation)||void 0,primaryGroup:a||void 0}});let k,I=!1,R={};if(g){k=g;if(!(await fetch("".concat(u,"/api/batches/").concat(encodeURIComponent(k)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:fe.name,startDate:fe.startDate||null,dueDate:fe.dueDate||null,description:fe.description||null,status:1})})).ok)throw new Error("batch_update_failed")}else{var a,i,s;if(0===E.length)return void await(0,ct.vc)("No documents selected","Select at least one document");if(0===T.length)return void await(0,ct.vc)("No recipients selected","Select at least one recipient (user or group)");const e=await fetch("".concat(u,"/api/batches/full"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batch:{name:fe.name,startDate:fe.startDate||null,dueDate:fe.dueDate||null,description:fe.description||null,status:1},documents:E,recipients:T})});if(!e.ok){let t="batch_create_failed";try{const n=await e.json();null!==n&&void 0!==n&&n.error&&(t=String(n.error))}catch(l){try{t=await e.text()}catch(c){}}throw console.error("Batch full create failed:",e.status,t),new Error(t||"batch_create_failed")}const t=await e.json(),n=null!==(a=null!==(i=null!==(s=null===t||void 0===t?void 0:t.id)&&void 0!==s?s:null===t||void 0===t?void 0:t.batchId)&&void 0!==i?i:null===t||void 0===t?void 0:t.toba_batchid)&&void 0!==a?a:null===t||void 0===t?void 0:t.ID;if(k="string"===typeof n?n:Number.isFinite(Number(n))?String(n):void 0,console.log("\u2705 DEBUG: Full batch creation success:",{createJson:t,finalBatchId:k}),!k)throw new Error("batch_id_missing");I=!0,R={documentsInserted:Number(null===t||void 0===t?void 0:t.documentsInserted)||void 0,recipientsInserted:Number(null===t||void 0===t?void 0:t.recipientsInserted)||void 0}}const N=g?E.filter(e=>!w.has((e.url||"").trim())):I?[]:E;if(console.log("\ud83d\udd0d DEBUG: Documents to post:",{isCreating:!g,totalDocs:E.length,docsToPost:N.length,batchId:k}),N.length>0){const e=await fetch("".concat(u,"/api/batches/").concat(k,"/documents"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documents:N})});if(!e.ok){const t=await e.text().catch(()=>"");throw console.error("Documents insert failed:",e.status,t),new Error("docs_insert_failed: ".concat(e.status," - ").concat(t))}{const t=await e.json().catch(()=>null);console.log("\u2705 DEBUG: Documents API success:",t)}}const O=g?T.filter(e=>!y.has((e.email||"").trim().toLowerCase())):I?[]:T;if(console.log("\ud83d\udd0d DEBUG: Recipients to post:",{isCreating:!g,totalRecipients:T.length,recipientsToPost:O.length,batchId:k,sampleRecipient:O[0]}),O.length>0){const e=await fetch("".concat(u,"/api/batches/").concat(k,"/recipients"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipients:O})});if(!e.ok){const t=await e.text().catch(()=>"");throw console.error("Recipients insert failed:",e.status,t),new Error("recipients_insert_failed: ".concat(e.status," - ").concat(t))}{const t=await e.json().catch(()=>null);console.log("\u2705 DEBUG: Recipients API success:",t)}try{const e=await fetch("".concat(u,"/api/batches/").concat(k,"/recipients"),{cache:"no-store"}),t=await e.json();Array.isArray(t)&&0!==t.length||(console.warn("Recipients verification returned empty for batch",k),await(0,ct.vc)("Verification warning","Recipients not linked to batch (verification returned empty)"))}catch(o){console.warn("Recipients verification failed",o)}}if(fe.notifyByEmail&&x.length>0){const e=[];try{const t=(0,P.Gi)(),n=fe.selectedDocuments;for(const r of n)try{const n=r.title||"document",a="sharepoint"===r.source||/sharepoint\.com\//i.test(r.url);let i=r.url;if(a)try{const e=await xr(["Files.Read.All","Sites.Read.All"]),n=encodeURIComponent(r.url);i="".concat(t,"/api/proxy/graph?url=").concat(n,"&token=").concat(encodeURIComponent(e),"&download=1")}catch(d){}else i="".concat(t,"/api/proxy?url=").concat(encodeURIComponent(r.url));const{contentBytes:s,contentType:o}=await kr(i);e.push({name:n,contentBytes:s,contentType:o})}catch(o){}}catch(o){}try{e.length>0?await Tr(x,S,C,e):await Er(x,S,C,void 0)}catch(o){console.warn("Email send failed (non-blocking)",o)}}const M=g?"updated":"created",F=!g&&I?" (".concat(null!==(e=R.documentsInserted)&&void 0!==e?e:0," doc").concat(1===(null!==(t=R.documentsInserted)&&void 0!==t?t:0)?"":"s",", ").concat(null!==(n=R.recipientsInserted)&&void 0!==n?n:0," recipient").concat(1===(null!==(r=R.recipientsInserted)&&void 0!==r?r:0)?"":"s",")"):"";Sr(),await(0,ct.Q$)("Batch ".concat(M),"\n<strong>".concat(fe.name,"</strong>").concat(F?'<div class="small muted">'.concat(F.replace(/[()]/g,""),"</div>"):"")+(fe.notifyByEmail?'<div class="small muted">Email notification sent</div>':""),{showDenyButton:!0,confirmButtonText:"Great!",denyButtonText:"Create another"}),me({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),Ee({}),ke(""),v(null),b(new Set),A(new Set)}catch(o){console.error("Save batch failed",o),await(0,ct.Z2)("Batch save failed",(null===o||void 0===o?void 0:o.message)||"Failed to save batch or send notifications")}finally{Sr()}}}),"audit"===f&&(0,x.jsx)("div",{children:(0,x.jsx)(Xh,{})}),"analytics"===f&&(0,x.jsx)(zr,{})]}),z&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(B,{open:K,onClose:()=>Y(!1),title:"Assign to Users & Groups",width:800,children:(0,x.jsx)(jr,{onSelectionChange:e=>me((0,d.A)((0,d.A)({},fe),{},{selectedUsers:e.users,selectedGroups:e.groups}))})}),(0,x.jsx)(B,{open:X,onClose:()=>Q(!1),title:"Documents",width:920,children:(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[(0,x.jsxs)("div",{style:{display:"grid",gap:16},children:[$&&(0,x.jsxs)("div",{className:"small",style:{background:"#fff8e1",border:"1px solid #ffe0b2",padding:8,borderRadius:6},children:["Importing to Library... ",te,"/",Z,(0,x.jsx)("div",{className:"progressBar","aria-hidden":"true",style:{marginTop:6},children:(0,x.jsx)("i",{style:{width:"".concat(Z?Math.round(te/Z*100):0,"%")}})}),re.length>0&&(0,x.jsx)("div",{style:{marginTop:6,maxHeight:120,overflowY:"auto",display:"grid",gap:4},children:re.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,x.jsx)("span",{className:"badge",style:{background:"failed"===e.status?"#f8d7da":"deduped"===e.status?"#e2e3e5":"#d4edda",color:"#333"},children:e.status})]},t))})]}),(0,x.jsx)($h,{onAdd:e=>me(t=>(0,d.A)((0,d.A)({},t),{},{selectedDocuments:ue(t.selectedDocuments,e)}))}),(0,x.jsx)(sp,{canUpload:!!(c||null!==u&&void 0!==u&&u.uploadDocuments),onDocumentSelect:async e=>{try{const a=(0,P.Gi)()||"",i=await xr(["Sites.Read.All","Files.Read.All"]);J(!0),ee(e.length),ne(0),ae([]);const s=[];let o=0,l=0;for(const c of e){var t;const e=null===c||void 0===c||null===(t=c.parentReference)||void 0===t?void 0:t.driveId,d=null===c||void 0===c?void 0:c.id,u=c.name;if(a&&e&&d&&i)try{var n;const t=await fetch("".concat(a,"/api/library/save-graph"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:JSON.stringify({driveId:e,itemId:d,name:u})}),r=await t.json().catch(()=>null),l=null!==r&&void 0!==r&&r.url?"".concat(a).concat(r.url):void 0,h={title:u,url:c.webUrl,version:1,requiresSignature:!1,driveId:e,itemId:d,source:"sharepoint",localFileId:null!==(n=null===r||void 0===r?void 0:r.id)&&void 0!==n?n:null,localUrl:l||null};s.push(h),ae(e=>[...e,{name:u,status:null!==r&&void 0!==r&&r.deduped?"deduped":"saved"}]),null!==r&&void 0!==r&&r.deduped&&o++}catch(r){s.push({title:u,url:c.webUrl,version:1,requiresSignature:!1,driveId:e,itemId:d,source:"sharepoint",localFileId:null,localUrl:null}),ae(e=>[...e,{name:u,status:"failed"}]),l++}finally{ne(e=>e+1)}else s.push({title:u,url:c.webUrl,version:1,requiresSignature:!1,driveId:e,itemId:d,source:"sharepoint"}),ne(e=>e+1),ae(e=>[...e,{name:u,status:"failed"}]),l++}me(e=>(0,d.A)((0,d.A)({},e),{},{selectedDocuments:ue(e.selectedDocuments,s)})),(0,ct.P0)("Imported ".concat(s.length-l," \u2022 deduped ").concat(o).concat(l?" \u2022 failed ".concat(l):""),l?"warning":"success")}catch(a){me(t=>(0,d.A)((0,d.A)({},t),{},{selectedDocuments:ue(t.selectedDocuments,e.map(e=>{var t;return{title:e.name,url:e.webUrl,version:1,requiresSignature:!1,driveId:null===e||void 0===e||null===(t=e.parentReference)||void 0===t?void 0:t.driveId,itemId:null===e||void 0===e?void 0:e.id,source:"sharepoint"}}))}))}finally{J(!1)}}})]}),(0,x.jsxs)("div",{className:"card",style:{padding:12},children:[(0,x.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700},children:"Selected Documents"}),(0,x.jsxs)("div",{className:"small muted",children:[fe.selectedDocuments.length," item(s)"]})]})}),0===fe.selectedDocuments.length?(0,x.jsx)("div",{className:"small muted",style:{marginTop:6},children:"No documents selected yet."}):(0,x.jsx)("div",{style:{marginTop:8,maxHeight:440,overflowY:"auto",display:"grid",gap:6},children:fe.selectedDocuments.map((e,t)=>(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[(0,x.jsxs)("div",{style:{minWidth:0},children:[(0,x.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title}),(0,x.jsxs)("div",{className:"small",style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:["sharepoint"===e.source&&(0,x.jsx)("span",{className:"badge",children:"sharepoint"}),e.localUrl&&(0,x.jsx)("span",{className:"badge",children:"local"}),"sharepoint"===e.source&&e.localUrl&&(0,x.jsx)("span",{className:"badge",title:"Server backup created",children:"backed up"}),(e.localUrl||e.url)&&(0,x.jsx)("a",{href:e.localUrl||e.url,target:"_blank",rel:"noreferrer",className:"small",children:"View \u2197"})]})]}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>ye(t),title:"Remove from batch",children:"\u2715"})]},t))})]})]})})]}),I&&(0,x.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,x.jsxs)("div",{className:"card",style:{width:520,maxWidth:"90%",padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,x.jsx)("h3",{style:{margin:0},children:"System Health"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>R(!1),children:"Close"})]}),!N&&(0,x.jsx)("div",{className:"small muted",children:"Running checks..."}),N&&(0,x.jsxs)("div",{style:{display:"grid",gap:8},children:[N.map((e,t)=>(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",padding:8,border:"1px solid #eee",borderRadius:6},children:[(0,x.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:e.ok?"#28a745":"#dc3545"}}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("div",{style:{fontWeight:600},children:e.name}),e.detail&&(0,x.jsx)("div",{className:"small muted",style:{whiteSpace:"pre-wrap"},children:e.detail})]})]},t)),(0,x.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{F(!0),await xr(["User.Read"]),await xr(["User.Read.All"]),await xr(["Group.Read.All"]),await xr(["Sites.Read.All"]),await xr(["Files.ReadWrite.All"]),await xr(["Mail.Send"]),(0,ct.P0)("Requested missing permissions","info")}finally{F(!1);try{O(await Nh())}catch(e){}}},disabled:M,children:"Grant Missing Permissions"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{O(await Nh())}catch(e){}},children:"Re-run"})]})]})]})}),(0,x.jsx)(Mh,{isVisible:q,onClose:()=>V(!1)})]})},dp=()=>{const{login:t}=(0,_.As)(),r=__webpack_require__(2074).Zp(),{externalSupport:a,loaded:i}=k(),[s,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(()=>{try{return localStorage.getItem("landing_variant")||"regular"}catch(e){return"regular"}});return(0,e.useEffect)(()=>{const e=e=>{e.key&&"landing_variant"!==e.key||(()=>{try{c(localStorage.getItem("landing_variant")||"regular")}catch(e){}})()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]),(0,x.jsx)("div",{className:"container",style:{display:"flex",justifyContent:"center"},children:(0,x.jsx)("div",{className:"card hero ".concat("compact"===l?"compact":""),style:{maxWidth:920,width:"100%"},children:(0,x.jsxs)("div",{className:"hero-grid",style:{alignItems:"center"},children:[(0,x.jsxs)("div",{className:"hero-text",style:{textAlign:"left"},children:[(0,x.jsx)("div",{className:"eyebrow",children:"Welcome to"}),(0,x.jsx)("h1",{className:"hero-title",style:{fontSize:32,lineHeight:1.2},children:"Sunbeth Document Acknowledgement"}),(0,x.jsx)("p",{className:"hero-lead",style:{marginTop:12},children:"Read, understand, and acknowledge the policies and updates that keep our people and business safe."}),(0,x.jsxs)("ul",{className:"features",style:{marginTop:14},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Clear workflows"})," \u2014 Step-by-step acknowledgement and progress tracking."]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Secure"})," \u2014 Single sign-on with your corporate account."]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Compliant"})," \u2014 Keep a verifiable record of acknowledgements."]})]}),(0,x.jsxs)("div",{style:{marginTop:22,display:"flex",gap:10},children:[(0,x.jsx)("button",{className:"btn sm",onClick:()=>{i&&!a?(s||o(!0),t()):r("/login")},disabled:i&&!a&&s,"aria-busy":i&&!a&&s,children:i&&!a&&s?"Opening Microsoft sign-in\u2026":"Sign in to get started"}),(0,x.jsx)(n.N_,{to:"/about",children:(0,x.jsx)("button",{className:"btn ghost sm",type:"button",children:"Learn more"})})]})]}),(0,x.jsx)("div",{className:"hero-visual",style:{display:"flex",justifyContent:"center"},children:(0,x.jsx)("img",{src:"/images/landing_image.png",alt:"Sunbeth Document Acknowledgement",style:{width:"100%",maxWidth:420,borderRadius:10,boxShadow:"0 4px 24px rgba(0,0,0,0.10)"}})})]})})})},up=()=>(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("div",{className:"card",style:{maxWidth:920,margin:"0 auto"},children:[(0,x.jsx)("div",{className:"title",children:"About this Portal"}),(0,x.jsx)("div",{className:"small",style:{marginTop:8},children:"A quick overview of how Sunbeth\u2019s Document Acknowledgement works."}),(0,x.jsx)("hr",{style:{margin:"14px 0",border:"none",borderTop:"1px solid #f2f2f2"}}),(0,x.jsxs)("div",{style:{color:"#333",lineHeight:1.55},children:[(0,x.jsx)("p",{children:"This portal helps employees read and acknowledge mandatory company documents like corporate policies, health and safety guidance, and periodic updates."}),(0,x.jsxs)("ul",{className:"features",children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Simple workflow"})," \u2014 Read each document and acknowledge with a click."]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Progress tracking"})," \u2014 See your overall completion by batch."]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Secure sign-in"})," \u2014 Authentication via Microsoft Entra (Azure AD)."]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Compliance"})," \u2014 Acknowledgements are recorded in Dataverse."]})]}),(0,x.jsx)("p",{children:"When you\u2019re ready, sign in with your corporate account to view your assigned batches."})]})]})}),hp=()=>{const{login:t}=(0,_.As)(),n=(0,F.Zp)(),{externalSupport:r,loaded:a}=k(),[i,s]=e.useState(!1);return e.useEffect(()=>{!a||r||i||(s(!0),Promise.resolve().then(()=>t()))},[a,r,t,i]),(0,x.jsx)("div",{className:"wrap centered",children:(0,x.jsx)("div",{className:"grid",style:{maxWidth:980,margin:"0 auto"},children:(0,x.jsx)("main",{children:(0,x.jsxs)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, var(--primary) 0%, var(--primary-500, #0a6b55) 100%)",color:"#fff",padding:"20px 22px"},children:[(0,x.jsx)("div",{style:{fontWeight:800,fontSize:18},children:"Sign in to Sunbeth"}),(0,x.jsx)("div",{className:"small",style:{opacity:.9},children:"Choose your account type"})]}),(0,x.jsxs)("div",{style:{padding:18},children:[i&&(0,x.jsx)("div",{className:"small",style:{marginBottom:12,background:"#f5fbf9",border:"1px solid #d1f0e6",color:"#0a6b55",padding:8,borderRadius:8},children:"Opening Microsoft sign-in\u2026"}),(0,x.jsxs)("div",{style:{display:"grid",gap:14},children:[(0,x.jsx)("div",{className:"card",style:{boxShadow:"none",border:"1px solid #eef1ee"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"title",style:{margin:0},children:"Internal Employee"}),(0,x.jsx)("div",{className:"small",style:{color:"var(--muted)"},children:"Sign in with Microsoft 365 (SSO)"})]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>t(),disabled:i,"aria-busy":i,children:i?"Opening\u2026":"Sign in with Microsoft"})]})}),r&&(0,x.jsx)("div",{className:"card",style:{boxShadow:"none",border:"1px solid #eef1ee"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"title",style:{margin:0},children:"External User"}),(0,x.jsx)("div",{className:"small",style:{color:"var(--muted)"},children:"Sign in with email and password"})]}),(0,x.jsx)("button",{className:"btn accent sm",onClick:()=>n("/login/external"),children:"Continue as External"})]})}),(0,x.jsx)("div",{className:"small",style:{color:"var(--muted-2)"},children:"Need help? Contact IT Support."})]})]})]})})})})},pp=()=>{const[t,r]=(0,e.useState)(""),[a,i]=(0,e.useState)(""),[s,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(null),[h]=(0,n.ok)(),p=(0,F.Zp)(),{login:f}=(0,A.N)();e.useEffect(()=>{const e=h.get("email");e&&!t&&r(e)},[h]);return(0,x.jsx)("div",{className:"wrap centered",children:(0,x.jsx)("div",{className:"grid",style:{maxWidth:980,margin:"0 auto"},children:(0,x.jsx)("main",{children:(0,x.jsxs)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[(0,x.jsxs)("div",{style:{background:"linear-gradient(135deg, var(--primary) 0%, var(--primary-500, #0a6b55) 100%)",color:"#fff",padding:"20px 22px"},children:[(0,x.jsx)("div",{style:{fontWeight:800,fontSize:18},children:"External User Sign-in"}),(0,x.jsx)("div",{className:"small",style:{opacity:.9},children:"Secure access with email and password"})]}),(0,x.jsxs)("div",{style:{padding:18},children:[(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(null),c(!0);try{const e=await fetch("/api/external-users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})}),n=await e.json().catch(()=>({}));if(!e.ok)throw new Error((null===n||void 0===n?void 0:n.error)||"Login failed");if(null!==n&&void 0!==n&&n.mfaRequired)return void p("/mfa?email=".concat(encodeURIComponent(t)));f({email:(null===n||void 0===n?void 0:n.email)||t,name:(null===n||void 0===n?void 0:n.name)||null}),p("/")}catch(n){const e=String((null===n||void 0===n?void 0:n.message)||"Login failed");u(e.replace(/_/g," "))}finally{c(!1)}},style:{display:"grid",gap:12},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"email",children:"Email address"}),(0,x.jsx)("input",{id:"email",type:"email",className:"form-control",placeholder:"you@example.com",value:t,onChange:e=>r(e.target.value),required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"small",htmlFor:"password",children:"Password"}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,x.jsx)("input",{id:"password",type:s?"text":"password",className:"form-control",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:a,onChange:e=>i(e.target.value),required:!0}),(0,x.jsx)("button",{type:"button",className:"btn ghost sm",onClick:()=>o(e=>!e),"aria-pressed":s,children:s?"Hide":"Show"})]})]}),d&&(0,x.jsx)("div",{className:"small",role:"alert",style:{color:"#b91c1c",background:"#fef2f2",border:"1px solid #fee2e2",padding:10,borderRadius:8},children:d}),(0,x.jsx)("button",{className:"btn",type:"submit",disabled:l,children:l?"Signing in\u2026":"Sign in"})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:12},children:[(0,x.jsx)(n.N_,{to:"/reset-password",className:"small",children:"Forgot password?"}),(0,x.jsx)(n.N_,{to:"/onboard",className:"small",children:"Set your password"})]}),(0,x.jsx)("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #f2f2f2"}}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,x.jsx)("div",{className:"small",style:{color:"var(--muted-2)"},children:"Are you an internal employee?"}),(0,x.jsx)("button",{className:"btn ghost sm",onClick:()=>p("/login"),children:"Use Microsoft sign-in \u2197"})]})]})]})})})})},fp=()=>{const{account:t,logout:n}=(0,_.As)(),{isAuthenticated:r,logout:a}=(0,A.N)(),i=(0,F.Zp)();return e.useEffect(()=>{(async()=>{try{t&&await n(),r&&a()}finally{i("/",{replace:!0})}})()},[t,r,n,a,i]),(0,x.jsx)("div",{className:"container",style:{maxWidth:420,margin:"0 auto",padding:24},children:(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsx)("div",{className:"title",children:"Signing you out\u2026"}),(0,x.jsx)("div",{className:"muted small",children:"Please wait."})]})})};function mp(){const[t,r]=(0,e.useState)([]),[a,i]=(0,e.useState)(!0),[s,o]=(0,e.useState)(null),l=(0,S.ec)(),c=(0,P.Gi)()||"";(0,e.useEffect)(()=>{(async()=>{i(!0),o(null);try{var e,t;let a=null;try{const e=await fetch("".concat(c,"/api/tenant/modules"),{cache:"no-store"});e.ok&&(a=await e.json())}catch(n){}if(!a||!Array.isArray(null===(e=a)||void 0===e?void 0:e.modules)){const e=await fetch("".concat(c,"/api/modules"),{cache:"no-store"});a=await e.json()}r(Array.isArray(null===(t=a)||void 0===t?void 0:t.modules)?a.modules:[])}catch(a){o("Failed to load modules")}finally{i(!1)}})()},[c]);const d=l.canSeeAdmin,u=t.filter(e=>!1!==e.enabled);return(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{children:"Modules"}),a&&(0,x.jsx)("div",{className:"small muted",children:"Loading modules\u2026"}),s&&(0,x.jsx)("div",{className:"small",style:{color:"crimson"},children:s}),!a&&0===u.length&&(0,x.jsx)("div",{className:"small muted",children:"No modules are enabled for your account."}),(0,x.jsx)("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:16},children:u.map(e=>{const t=e.homeRoute||"/";return(0,x.jsxs)("div",{className:"card",style:{padding:16},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[(0,x.jsx)("div",{style:{fontWeight:700},children:e.title}),(0,x.jsxs)("div",{className:"small muted",children:["v",e.version]})]}),(0,x.jsx)("div",{className:"small muted",style:{margin:"6px 0 12px 0"},children:e.name}),(0,x.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,x.jsx)(n.N_,{to:t,className:"btn sm",children:"Open"}),d&&(0,x.jsx)(n.N_,{to:e.adminRoute,className:"btn ghost sm",children:"Admin"})]})]},e.name)})})]})}const gp=e.lazy(()=>__webpack_require__.e(845).then(__webpack_require__.bind(__webpack_require__,5845))),vp=()=>{const{account:t}=(0,_.As)(),{isAuthenticated:n,user:r}=(0,A.N)(),{externalSupport:a,loaded:i}=k(),s=e.lazy(()=>__webpack_require__.e(217).then(__webpack_require__.bind(__webpack_require__,1217))),o=e.lazy(()=>__webpack_require__.e(102).then(__webpack_require__.bind(__webpack_require__,102))),l=e.lazy(()=>__webpack_require__.e(942).then(__webpack_require__.bind(__webpack_require__,7942))),c=e=>{let{children:t}=e;return i?a?(0,x.jsx)(x.Fragment,{children:t}):(0,x.jsx)(F.C5,{to:"/",replace:!0}):null};return(0,x.jsxs)(F.BV,{children:[(0,x.jsx)(F.qh,{path:"/",element:t||n?(0,x.jsx)(yt,{}):(0,x.jsx)(dp,{})}),(0,x.jsx)(F.qh,{path:"/login",element:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(hp,{})})}),(0,x.jsx)(F.qh,{path:"/login/external",element:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(c,{children:(0,x.jsx)(pp,{})})})}),(0,x.jsx)(F.qh,{path:"/onboard",element:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(c,{children:(0,x.jsx)(s,{})})})}),(0,x.jsx)(F.qh,{path:"/mfa",element:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(c,{children:(0,x.jsx)(l,{})})})}),(0,x.jsx)(F.qh,{path:"/reset-password",element:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(c,{children:(0,x.jsx)(o,{})})})}),(0,x.jsx)(F.qh,{path:"/about",element:(0,x.jsx)(up,{})}),(0,x.jsx)(F.qh,{path:"/modules",element:(0,x.jsx)(wp,{children:(0,x.jsx)(mp,{})})}),(0,x.jsx)(F.qh,{path:"/batch/:id",element:(0,x.jsx)(wp,{children:(0,x.jsx)(bt,{})})}),(0,x.jsx)(F.qh,{path:"/batch/:id/completed",element:(0,x.jsx)(wp,{children:(0,x.jsx)(Nr,{})})}),(0,x.jsx)(F.qh,{path:"/document/:id/*",element:(0,x.jsx)(wp,{children:(0,x.jsx)(Ir,{})})}),(0,x.jsx)(F.qh,{path:"/summary",element:(0,x.jsx)(wp,{children:(0,x.jsx)(Rr,{})})}),(0,x.jsx)(F.qh,{path:"/admin",element:(0,x.jsx)(bp,{children:(0,x.jsx)(cp,{})})}),(0,x.jsx)(F.qh,{path:"/super-admin",element:(0,x.jsx)(bp,{children:(0,x.jsx)(e.Suspense,{fallback:null,children:(0,x.jsx)(gp,{})})})}),(0,x.jsx)(F.qh,{path:"/logout",element:(0,x.jsx)(fp,{})})]})},yp=()=>{const t=(0,F.zy)();return e.useEffect(()=>{(0,D.pq)("Route changed",{pathname:t.pathname})},[t.pathname]),null},bp=e=>{let{children:t}=e;return(0,S.ec)().canSeeAdmin?(0,x.jsx)(x.Fragment,{children:t}):(0,x.jsx)(F.C5,{to:"/",replace:!0})},wp=e=>{let{children:t}=e;const{account:n}=(0,_.As)(),{isAuthenticated:r}=(0,A.N)();return n||r?(0,x.jsx)(x.Fragment,{children:t}):(0,x.jsx)(F.C5,{to:"/",replace:!0})},_p=()=>{const[t,n]=(0,e.useState)(0),[r,a]=(0,e.useState)(""),[i,s]=(0,e.useState)(!1),o=(0,e.useRef)(null),l=(0,e.useRef)(null),c=(0,e.useRef)(null),d=(0,P.g2)(),u=(0,P.yQ)(),h=(0,P.MV)(),p=(0,P.JH)(),f=(0,P.pU)();return(0,e.useEffect)(()=>{const e=e=>{try{const t=e.detail||{};a(String(t.label||""))}catch(t){}n(e=>{const t=e+1;if(1===t){o.current=Date.now(),c.current&&(window.clearTimeout(c.current),c.current=null);const e=window.setTimeout(()=>{s(!0)},d);l.current=e}return t})},t=()=>n(e=>{const t=Math.max(0,e-1);if(0===t){const e=o.current||Date.now(),t=Date.now()-e,n=Math.max(0,u-t);if(l.current&&(window.clearTimeout(l.current),l.current=null),0===n)s(!1);else{const e=window.setTimeout(()=>s(!1),n);c.current=e}}return t}),r=()=>n(0);return window.addEventListener("sunbeth:busy:push",e),window.addEventListener("sunbeth:busy:pop",t),window.addEventListener("sunbeth:busy:reset",r),()=>{window.removeEventListener("sunbeth:busy:push",e),window.removeEventListener("sunbeth:busy:pop",t),window.removeEventListener("sunbeth:busy:reset",r),l.current&&window.clearTimeout(l.current),c.current&&window.clearTimeout(c.current)}},[]),i?(0,x.jsxs)("div",{style:{position:"fixed",inset:0,zIndex:2e3,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(2px)"},children:[(0,x.jsx)("style",{children:"\n        @keyframes sunbeth-dance {\n          0% { transform: translateY(0) rotate(0deg) scale(1); }\n          20% { transform: translateY(-6px) rotate(-6deg) scale(1.02); }\n          40% { transform: translateY(0) rotate(0deg) scale(1); }\n          60% { transform: translateY(-6px) rotate(6deg) scale(1.02); }\n          80% { transform: translateY(0) rotate(0deg) scale(1); }\n          100% { transform: translateY(0) rotate(0deg) scale(1); }\n        }\n        @keyframes sunbeth-pulse {\n          0% { box-shadow: 0 0 0 0 rgba(0,0,0,0.2); }\n          70% { box-shadow: 0 0 0 20px rgba(0,0,0,0); }\n          100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); }\n        }\n      "}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12},children:[(0,x.jsx)("div",{style:{width:120,height:120,borderRadius:20,background:"#fff",display:"grid",placeItems:"center",animation:"sunbeth-pulse 1.8s ease-out infinite",border:"6px solid ".concat(f)},children:h?(0,x.jsx)("img",{src:h,alt:p,style:{maxWidth:"80%",maxHeight:"80%",animation:"sunbeth-dance 1.6s ease-in-out infinite"}}):(0,x.jsx)("div",{style:{fontWeight:800,color:f,fontSize:18,animation:"sunbeth-dance 1.6s ease-in-out infinite"},children:p})}),(0,x.jsx)("div",{style:{color:"#fff",fontWeight:600},children:r||"Please wait..."})]})]}):null},Ap=t=>{let{children:r}=t;const{account:a,token:i,photo:s,login:o,logout:l}=(0,_.As)(),{user:c,isAuthenticated:d,logout:u}=(0,A.N)(),{externalSupport:h,loaded:p}=k(),{tenant:f}=M(),[m,g]=(0,e.useState)(()=>{try{const e=localStorage.getItem("sunbeth_theme");if("light"===e||"dark"===e)return e}catch(e){}try{const e=document.documentElement.getAttribute("data-theme");if("light"===e||"dark"===e)return e}catch(t){}try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch(n){return"light"}}),[v,y]=(0,e.useState)(()=>{try{return"true"===(localStorage.getItem("sunbeth_sticky_header")||"true")}catch(e){return!0}});(0,e.useEffect)(()=>{try{localStorage.setItem("sunbeth_theme",m)}catch(Pp){}},[m]),(0,e.useEffect)(()=>{try{localStorage.setItem("sunbeth_sticky_header",v?"true":"false")}catch(e){}},[v]);const b=(0,F.Zp)(),w=(0,F.zy)(),C=(0,e.useRef)(a),[E,T]=(0,e.useState)(null),[P,I]=(0,e.useState)(null),R=(0,e.useRef)(!1);(0,e.useEffect)(()=>{(0,D.pq)("Layout mounted");const e=async()=>{if((!a||!i)&&!d)return T(null),void I(null);try{let o=[];try{const e=(null===a||void 0===a?void 0:a.username)||(null===c||void 0===c?void 0:c.email)||void 0;o=await(0,L.d6)(i||void 0,e)}catch(r){o=[]}if(!Array.isArray(o)||0===o.length)return T(0),void I(null);let l=0;const d=[];for(const r of o)try{var e,t,n;const s=(null===a||void 0===a?void 0:a.username)||(null===c||void 0===c?void 0:c.email)||void 0,o=await(0,L.Pg)(r.toba_batchid,i||void 0,void 0,s),u=null!==(e=o.total)&&void 0!==e?e:0,h=null!==(t=o.acknowledged)&&void 0!==t?t:0;l+=Math.max(0,u-h),(null!==(n=o.percent)&&void 0!==n?n:0)<100&&d.push({due:r.toba_duedate})}catch(s){}if(T(l),d.length){const e=d.map(e=>e.due).filter(Boolean);if(e.length){const t=e.reduce((e,t)=>new Date(t)<new Date(e)?t:e);I(t)}else I(null)}else I(null)}catch(o){T(null),I(null)}};e();const t=()=>e();return window.addEventListener("sunbeth:progressUpdated",t),()=>{window.removeEventListener("sunbeth:progressUpdated",t)}},[a,i,d,null===c||void 0===c?void 0:c.email]),(0,e.useEffect)(()=>{const e=(null===a||void 0===a?void 0:a.username)||(null===c||void 0===c?void 0:c.email);e&&!R.current&&(R.current=!0,(async()=>{try{await vt(e)}catch(t){}})())},[null===a||void 0===a?void 0:a.username,null===c||void 0===c?void 0:c.email]);const N=(0,S.ec)();(0,e.useEffect)(()=>{if(p&&!h&&d){try{u()}catch(e){}try{b("/",{replace:!0})}catch(t){}}},[p,h,d,u,b]),(0,e.useEffect)(()=>{const e=C.current,t=a;!e&&t&&"/about"===w.pathname&&b("/",{replace:!0}),e&&!t&&"/"!==w.pathname&&b("/",{replace:!0}),C.current=a},[a,w.pathname,b]),(0,e.useEffect)(()=>{a&&"/about"===w.pathname&&b("/",{replace:!0})},[a,w.pathname,b]);const O=!(!a&&!d||"/"!==w.pathname&&!w.pathname.startsWith("/dashboard"));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(_p,{}),(0,x.jsxs)("header",{className:v?"sticky":"",children:[(0,x.jsxs)("div",{className:"brand",children:[(0,x.jsx)("img",{src:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",alt:"Sunbeth",onError:e=>{e.target.style.opacity="0.18",e.target.alt="Logo"}}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"h1",style:{color:"#fff"},children:"Sunbeth Document Acknowledgement"}),(0,x.jsx)("div",{className:"small",style:{color:"#fff",opacity:.9},children:"Employee Acknowledgment Portal"}),!1]})]}),a?(0,x.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[N.isSuperAdmin&&(0,x.jsx)("div",{title:"Super Admin (from REACT_APP_SUPER_ADMINS)",style:{background:"#fee2e2",color:"#991b1b",padding:"6px 8px",borderRadius:6,fontSize:13,fontWeight:700,display:"flex",alignItems:"center",gap:6},children:(0,x.jsx)("span",{children:"\u26a1 Super Admin"})}),(0,x.jsxs)("button",{className:"btn ghost sm","aria-label":"Toggle theme",onClick:()=>{const e="light"===m?"dark":"light";g(e);try{document.documentElement.setAttribute("data-theme",e),window.dispatchEvent(new CustomEvent("sunbeth:themeChanged"))}catch(t){}},children:["light"===m?"Dark":"Light"," Mode"]}),(0,x.jsx)("button",{className:"btn ghost sm","aria-label":"Toggle sticky header",onClick:()=>y(e=>!e),children:v?"Unpin Header":"Pin Header"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",padding:"6px 8px",background:"rgba(255,255,255,0.04)",borderRadius:6},children:[(0,x.jsx)("div",{style:{width:36,height:36,borderRadius:18,overflow:"hidden",background:"#fff"},children:s?(0,x.jsx)("img",{src:s,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"avatar"}):(0,x.jsx)("div",{style:{width:"100%",height:"100%",background:"#ccc"}})}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,x.jsx)("div",{style:{fontWeight:700,color:"#fff"},children:a.name}),(0,x.jsx)("div",{style:{color:"#ddd",fontSize:13},children:a.username})]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>l(),children:"Sign out"})]})]}):d?(0,x.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[(0,x.jsxs)("button",{className:"btn ghost sm","aria-label":"Toggle theme",onClick:()=>{const e="light"===m?"dark":"light";g(e);try{document.documentElement.setAttribute("data-theme",e),window.dispatchEvent(new CustomEvent("sunbeth:themeChanged"))}catch(t){}},children:["light"===m?"Dark":"Light"," Mode"]}),(0,x.jsx)("button",{className:"btn ghost sm","aria-label":"Toggle sticky header",onClick:()=>y(e=>!e),children:v?"Unpin Header":"Pin Header"}),(0,x.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",padding:"6px 8px",background:"rgba(255,255,255,0.04)",borderRadius:6},children:[(0,x.jsx)("div",{style:{width:36,height:36,borderRadius:18,overflow:"hidden",background:"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",color:"#111",fontWeight:700},children:((null===c||void 0===c?void 0:c.name)||(null===c||void 0===c?void 0:c.email)||"U").slice(0,1).toUpperCase()}),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,x.jsx)("div",{style:{fontWeight:700,color:"#fff"},children:(null===c||void 0===c?void 0:c.name)||"External User"}),(0,x.jsx)("div",{style:{color:"#ddd",fontSize:13},children:null===c||void 0===c?void 0:c.email})]}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>u(),children:"Sign out"})]})]}):(0,x.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[(0,x.jsx)("a",{href:"/about",className:"small",style:{color:"#fff",textDecoration:"none",opacity:.95},children:"About"}),(0,x.jsxs)("button",{className:"btn ghost sm","aria-label":"Toggle theme",onClick:()=>{const e="light"===m?"dark":"light";g(e);try{document.documentElement.setAttribute("data-theme",e),window.dispatchEvent(new CustomEvent("sunbeth:themeChanged"))}catch(t){}},children:["light"===m?"Dark":"Light"," Mode"]}),(0,x.jsx)("button",{className:"btn ghost sm","aria-label":"Toggle sticky header",onClick:()=>y(e=>!e),children:v?"Unpin Header":"Pin Header"}),(0,x.jsx)("button",{className:"btn sm",onClick:()=>o(),children:"Sign in"})]})]}),(0,x.jsxs)("div",{className:"wrap ".concat(a?"":"landing-centered"," ").concat(O?"":"centered"),children:[(0,x.jsxs)("div",{className:"grid",children:[(0,x.jsx)("main",{children:r}),O&&(0,x.jsx)("aside",{children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{fontWeight:700,color:"var(--primary)"},children:"Batch Overview"}),(0,x.jsx)("div",{className:"muted small",children:"Rollout"})]}),(0,x.jsxs)("div",{style:{textAlign:"right"},children:[(0,x.jsx)("div",{style:{fontWeight:700,fontSize:18},children:null!==E&&void 0!==E?E:"\u2014"}),(0,x.jsxs)("div",{className:"muted small",children:["You have ",null!==E&&void 0!==E?E:0," pending items"]})]})]}),(0,x.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),(0,x.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:N.canSeeAdmin&&(0,x.jsx)(n.N_,{to:"/admin",children:(0,x.jsx)("button",{className:"btn full sm",children:"Admin View"})})}),(0,x.jsx)("div",{style:{height:12}}),(0,x.jsxs)("div",{className:"muted small",children:["Due by: ",P||"\u2014"]}),(0,x.jsx)("div",{style:{height:6}}),(0,x.jsx)("div",{className:"muted small",children:"Assigned to: All staff"})]})})]}),(0,x.jsx)("footer",{children:"\xa9 2025 Sunbeth Global Concept. All Rights Reserved."})]})]})};const Sp=()=>{const{applyTheme:t}=M(),n=(0,P.Gi)()||"",r=(0,F.zy)();return e.useEffect(()=>{let e=!1;const a=new AbortController,i=async()=>{const i=(s=r.pathname).startsWith("/document")||s.startsWith("/batch")||s.startsWith("/summary")?"docack":s.startsWith("/admin")?"admin":s.startsWith("/super-admin")?"super-admin":s.startsWith("/modules")?"modules":void 0;var s;const o=i?"?module=".concat(encodeURIComponent(i)):"";try{var l,c;const r=await fetch("".concat(n,"/api/theme/effective").concat(o),{cache:"no-store",signal:a.signal});if(!r.ok)return;const i=await r.json(),s=function(){try{const e=localStorage.getItem("sunbeth_theme");if("light"===e||"dark"===e)return e}catch(e){}try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch(t){return"light"}}(),d=(null===i||void 0===i||null===(l=i.theme)||void 0===l?void 0:l[s])||(null===i||void 0===i||null===(c=i.theme)||void 0===c?void 0:c.light)||null;e||t(d||null)}catch(d){}};i();const s=(()=>{try{return window.matchMedia("(prefers-color-scheme: dark)")}catch(e){return null}})(),o=()=>{try{localStorage.getItem("sunbeth_theme")||i()}catch(e){}};s&&"function"===typeof s.addEventListener&&s.addEventListener("change",o);const l=()=>i();try{window.addEventListener("sunbeth:themeChanged",l)}catch(Pp){}const c=e=>{"sunbeth_theme"===e.key&&i()};try{window.addEventListener("storage",c)}catch(d){}return()=>{e=!0,a.abort(),s&&"function"===typeof s.removeEventListener&&s.removeEventListener("change",o);try{window.removeEventListener("sunbeth:themeChanged",l)}catch(t){}try{window.removeEventListener("storage",c)}catch(n){}}},[n,r.pathname,t]),null},Cp=()=>{const e=(0,x.jsx)(O,{children:(0,x.jsx)(A.b,{children:(0,x.jsx)(_.OJ,{children:(0,x.jsx)(S.Si,{children:(0,x.jsx)(T,{children:(0,x.jsxs)(n.Kd,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[(0,x.jsx)(yp,{}),(0,x.jsx)(Sp,{}),(0,x.jsx)(Ap,{children:(0,x.jsx)(vp,{})})]})})})})})});return(0,x.jsx)(y,{instance:w.msalInstance,children:e})};class xp extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){(0,D.z3)("Unhandled render error",{err:e,info:t})}render(){var e;return this.state.hasError?(0,x.jsxs)("div",{style:{padding:20,background:"#fff0f0",color:"#600"},children:[(0,x.jsx)("h2",{children:"Application error"}),(0,x.jsx)("pre",{style:{whiteSpace:"pre-wrap"},children:null===(e=this.state.error)||void 0===e?void 0:e.message})]}):this.props.children}}const Ep=()=>window.__sunbethLogs||[],Tp=()=>{const[t,n]=(0,e.useState)(Ep());(0,e.useEffect)(()=>{const e=setInterval(()=>n(Ep()),700);return()=>clearInterval(e)},[]);return(0,x.jsxs)("div",{style:{position:"fixed",right:10,bottom:10,width:420,maxHeight:340,overflow:"auto",background:"rgba(0,0,0,0.85)",color:"#fff",fontSize:12,padding:10,borderRadius:6,zIndex:9999,display:(()=>{try{return!1}catch(e){}return!1})()?"block":"none"},children:[(0,x.jsxs)("div",{style:{marginBottom:8,padding:8,background:"rgba(200,0,0,0.12)",borderRadius:4},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,x.jsx)("strong",{children:"Last Error"}),(0,x.jsx)("button",{onClick:()=>{var e;const t=Ep().filter(e=>"error"===e.level).slice(-1)[0];null===(e=navigator.clipboard)||void 0===e||e.writeText(JSON.stringify(t,null,2))},children:"Copy"})]}),(0,x.jsx)("div",{style:{fontSize:12,color:"#ffd1d1"},children:(()=>{const e=Ep().filter(e=>"error"===e.level).slice(-1)[0];return e?"".concat(e.ts," ").concat(e.msg):"No errors recorded"})()})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,x.jsx)("strong",{children:"Debug Console"}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("label",{style:{marginRight:8},children:[(0,x.jsx)("input",{type:"checkbox",checked:!0===window.__sunbethDevUser,onChange:e=>{window.__sunbethDevUser=e.target.checked,n(Ep())}})," Show dev controls"]}),(0,x.jsx)("button",{onClick:()=>{var e;null===(e=navigator.clipboard)||void 0===e||e.writeText(JSON.stringify(Ep(),null,2))},style:{marginRight:6},children:"Copy"}),(0,x.jsx)("button",{onClick:()=>{window.__sunbethLogs=[],n([])},children:"Clear"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{style:{marginBottom:8},children:[(0,x.jsx)("strong",{children:"MSAL Events"}),(window.__sunbethMsalEvents||[]).slice().reverse().slice(0,6).map((e,t)=>(0,x.jsxs)("div",{style:{fontSize:11,color:"#cfc"},children:[e.ts," \u2014 ",e.type," ",e.payload?JSON.stringify(e.payload):""]},t))]}),t.slice().reverse().map((e,t)=>(0,x.jsxs)("div",{style:{marginBottom:6,borderBottom:"1px solid rgba(255,255,255,0.06)",paddingBottom:6},children:[(0,x.jsxs)("div",{style:{color:"#9ad",fontSize:11},children:[e.ts," ",(0,x.jsxs)("span",{style:{color:"#f7c"},children:["[",e.level,"]"]})]}),(0,x.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e.msg}),e.meta&&(0,x.jsx)("pre",{style:{color:"#ddd",fontSize:11},children:JSON.stringify(e.meta,null,2)})]},t))]})]})},kp=()=>{const[t,n]=(0,e.useState)(""),[r,a]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{const e=e=>{var t;const r=(null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.message)||(null===e||void 0===e?void 0:e.detail)||String(e);n(r),a(!0),window.setTimeout(()=>a(!1),2e3)};return window.addEventListener("sunbeth:toast",e),()=>window.removeEventListener("sunbeth:toast",e)},[]),(0,x.jsx)(wt,{message:t,show:r})};(0,D.b)(),(0,D.pq)("index.tsx initializing app"),window.addEventListener("unhandledrejection",e=>{try{const t=null===e||void 0===e?void 0:e.reason,n=(null===t||void 0===t?void 0:t.errorCode)||(null===t||void 0===t?void 0:t.code),r=((null===t||void 0===t?void 0:t.message)||"").toString();if("state_not_found"===n||/state_not_found/i.test(r))return;(0,D.z3)("Unhandled promise rejection",t||e)}catch(t){}}),window.addEventListener("error",e=>{try{(0,D.z3)("Window error",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error})}catch(t){}}),(0,D.pq)("Diagnostics initialized"),(()=>{try{const e=window;if(e.__sunbethBusyFetchInstalled)return;const t=window.fetch.bind(window),n=e=>/\.(css|js|png|jpg|jpeg|svg|ico|map)(\?|#|$)/i.test(e)||/\/static\//i.test(e),r=(e,t)=>{try{const r=e.toLowerCase(),a=t.toUpperCase();if(n(r))return"";if(r.includes("/api/proxy/graph"))return"Fetching from SharePoint...";if(r.includes("/api/proxy"))return"Fetching document...";if(/\/api\/batches\/[^/]+\/documents/i.test(r)&&"GET"===a)return"Loading documents...";if(/\/api\/batches\/[^/]+\/documents/i.test(r)&&"POST"===a)return"Saving documents...";if(/\/api\/batches\/[^/]+\/recipients/i.test(r)&&"POST"===a)return"Saving recipients...";if(/\/api\/batches\/[^/]+\/completions/i.test(r))return"Loading completion summary...";if(/\/api\/batches\/?(\?|$)/i.test(r)&&"GET"===a)return"Loading batches...";if(/\/api\/batches\/full/i.test(r)&&"POST"===a)return"Creating your batch...";if(/\/api\/batches\/[^/]+(\?|$)/i.test(r)&&"PUT"===a)return"Updating batch...";if(/\/api\/recipients/i.test(r)&&"GET"===a)return"Loading recipients...";if(/\/api\/documents/i.test(r)&&"GET"===a)return"Loading documents...";if(/\/api\//i.test(r)){if("GET"===a)return"Loading...";if("POST"===a)return"Saving...";if("PUT"===a||"PATCH"===a)return"Updating...";if("DELETE"===a)return"Deleting..."}return""}catch(r){return""}};window.fetch=async(e,n)=>{const a=((null===n||void 0===n?void 0:n.method)||(null===e||void 0===e?void 0:e.method)||"GET").toString(),i="string"===typeof e?e:e instanceof URL?e.href:e.url,s=Boolean(null===n||void 0===n?void 0:n.busySilence),o=null===n||void 0===n?void 0:n.busyLabel,l=null!==o&&void 0!==o?o:r(i,a);!s&&l&&Ar(l);try{return await t(e,n)}finally{!s&&l&&Sr()}},e.__sunbethBusyFetchInstalled=!0,(0,D.pq)("Busy network tracking installed")}catch(e){(0,D.R8)("Failed to install busy network tracking",e)}})();try{window.__sunbethRunDiagnostics=Nh}catch(Ip){}try{(0,D.pq)("env:summary",{brand:(0,P.JH)(),sqliteEnabled:(0,P.Kr)(),apiBase:(0,P.Gi)()||"unset",hrEmailsConfigured:(0,P.O2)().length,clientIdPresent:!!(0,P.fp)(),tenantIdPresent:!!(0,P.EO)()})}catch(Rp){}(async()=>{try{await w.msalInstance.initialize()}catch(n){}try{const e="true"===({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ADMIN_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_ADMIN_LIGHT:"false",REACT_APP_ADMIN_MODAL_SELECTORS:"true",REACT_APP_API_BASE:"https://sunbeth-ack-portal-backend.vercel.app/",REACT_APP_BRAND_COLOR:"#0a3d33",REACT_APP_BRAND_LOGO_URL:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",REACT_APP_BRAND_NAME:"Sunbeth Document Acknowledgement Portal",REACT_APP_CLIENT_ID:"a8337154-a8a8-400d-8817-c03ade433449",REACT_APP_DATAVERSE_URL:"https://org7b4bdebc.crm4.dynamics.com",REACT_APP_ENABLE_SQLITE:"true",REACT_APP_FLOW_CREATE_USER_ACK_URL:"https://your-flow-url",REACT_APP_HR_EMAILS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_MANAGERS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_SUPER_ADMINS:"oluwatoba.ogunsakin@sunbeth.net",REACT_APP_TENANT_ID:"3493b8fa-b849-45bc-b23e-7d0384e4fa46",REACT_APP_USE_MOCK:"false"}.REACT_APP_ENABLE_MGT||"").toLowerCase(),t="undefined"!==typeof window;if(e&&t){const e=(await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,9955))).msalInstance;if("function"===typeof(null===e||void 0===e?void 0:e.getLogger)){const{Providers:e}=await __webpack_require__.e(575).then(__webpack_require__.bind(__webpack_require__,575)),{Msal2Provider:t}=await __webpack_require__.e(964).then(__webpack_require__.bind(__webpack_require__,5964));e.globalProvider=new t({clientId:"a8337154-a8a8-400d-8817-c03ade433449",authority:"https://login.microsoftonline.com/".concat("3493b8fa-b849-45bc-b23e-7d0384e4fa46"),redirectUri:"undefined"!==typeof window?window.location.origin:"/",loginType:"popup",scopes:["User.Read","Group.Read.All","openid","profile"]})}else(0,D.pq)("MGT provider skipped: incompatible msal-browser version (no getLogger). Set REACT_APP_ENABLE_MGT=false or upgrade MGT.")}}catch(r){}t.createRoot(document.getElementById("root")).render((0,x.jsx)(e.StrictMode,{children:(0,x.jsxs)(xp,{children:[(0,x.jsx)(Cp,{}),(0,x.jsx)(Tp,{}),(0,x.jsx)(kp,{})]})}))})()})()})();