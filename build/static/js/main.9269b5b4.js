/*! For license information please see main.9269b5b4.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,d=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var C=Array.isArray,S=Object.prototype.hasOwnProperty,T={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,r){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,o)&&!E.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:n,type:e,key:a,ref:s,props:i,_owner:T.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return a=a(c=e),e=""===i?"."+I(c,0):i,C(a)?(o="",null!=e&&(o=e.replace(k,"$&/")+"/"),R(a,t,o,"",function(e){return e})):null!=a&&(A(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,o+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+e)),t.push(a)),1;if(c=0,i=""===i?".":i+":",C(e))for(var l=0;l<e.length;l++){var d=i+I(s=e[l],l);c+=R(s,t,o,d,a)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),l=0;!(s=e.next()).done;)c+=R(s=s.value,t,o,d=i+I(s,l++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function x(e,t,n){if(null==e)return e;var r=[],o=0;return R(e,r,"","",function(e){return t.call(n,e,o++)}),r}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},P={transition:null},j={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:P,ReactCurrentOwner:T};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:x,forEach:function(e,t,n){x(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return x(e,function(){t++}),t},toArray:function(e){return x(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=a,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=m({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=T.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)S.call(t,l)&&!E.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];o.children=c}return{$$typeof:n,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,c=e[s],l=s+1,d=e[l];if(0>i(c,n))l<o&&0>i(d,c)?(e[r]=d,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<o&&0>i(d,n)))break e;e[r]=d,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],d=[],u=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(d);null!==t;){if(null===t.callback)o(d);else{if(!(t.startTime<=e))break;o(d),t.sortIndex=t.expirationTime,n(l,t)}t=r(d)}}function C(e){if(g=!1,w(e),!m)if(null!==r(l))m=!0,P(S);else{var t=r(d);null!==t&&j(C,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(A),A=-1),f=!0;var i=p;try{for(w(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!R());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(l)&&o(l),w(n)}else o(l);h=r(l)}if(null!==h)var c=!0;else{var u=r(d);null!==u&&j(C,u.startTime-n),c=!1}return c}finally{h=null,p=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,E=!1,_=null,A=-1,k=5,I=-1;function R(){return!(t.unstable_now()-I<k)}function x(){if(null!==_){var e=t.unstable_now();I=e;var n=!0;try{n=_(!0,e)}finally{n?T():(E=!1,_=null)}}else E=!1}if("function"===typeof b)T=function(){b(x)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,O=N.port2;N.port1.onmessage=x,T=function(){O.postMessage(null)}}else T=function(){v(x,0)};function P(e){_=e,E||(E=!0,T())}function j(e,n){A=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,P(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(d,e),null===r(l)&&e===r(d)&&(g?(y(A),A=-1):g=!0,j(C,i-a))):(e.sortIndex=s,n(l,e),m||f||(m=!0,P(S))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},245:(e,t,n)=>{n.r(t),n.d(t,{msalInstance:()=>Fa});var r=n(555),o=n(623),i=n(385);const a="AAD",s="OIDC",c="none";var l=n(823);const d="client_info_decoding_error",u="client_info_empty_error",h="token_parsing_error",p="null_or_empty_token",f="endpoints_resolution_error",m="network_error",g="openid_config_error",v="hash_not_deserialized",y="invalid_state",b="state_mismatch",w="state_not_found",C="nonce_mismatch",S="auth_time_not_found",T="max_age_transpired",E="multiple_matching_tokens",_="multiple_matching_accounts",A="multiple_matching_appMetadata",k="request_cannot_be_made",I="cannot_remove_empty_scope",R="cannot_append_scopeset",x="empty_input_scopeset",N="device_code_polling_cancelled",O="device_code_expired",P="device_code_unknown_error",j="no_account_in_silent_request",M="invalid_cache_record",L="invalid_cache_environment",D="no_account_found",U="no_crypto_object",B="unexpected_credential_type",H="invalid_assertion",F="invalid_client_credential",q="token_refresh_required",K="user_timeout_reached",z="token_claims_cnf_required_for_signedjwt",W="authorization_code_missing_from_server_response",G="binding_key_not_removed",V="end_session_endpoint_not_supported",Y="key_id_missing",Q="no_network_connectivity",$="user_canceled",J="missing_tenant_id_error",X="method_not_implemented",Z="nested_app_auth_bridge_disabled",ee={[d]:"The client info could not be parsed/decoded correctly",[u]:"The client info was empty",[h]:"Token cannot be parsed",[p]:"The token is null or empty",[f]:"Endpoints cannot be resolved",[m]:"Network request failed",[g]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[v]:"The hash parameters could not be deserialized",[y]:"State was not the expected format",[b]:"State mismatch error",[w]:"State not found",[C]:"Nonce mismatch error",[S]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[T]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[E]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[_]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[A]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[k]:"Token request cannot be made without authorization code or refresh token.",[I]:"Cannot remove null or empty scope from ScopeSet",[R]:"Cannot append ScopeSet",[x]:"Empty input ScopeSet cannot be processed",[N]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[O]:"Device code is expired.",[P]:"Device code stopped polling for unknown reasons.",[j]:"Please pass an account object, silent flow is not supported without account information",[M]:"Cache record object was null or undefined.",[L]:"Invalid environment when attempting to create cache entry",[D]:"No account found in cache for given key.",[U]:"No crypto object detected.",[B]:"Unexpected credential type.",[H]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[F]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[q]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[K]:"User defined timeout for device code polling reached",[z]:"Cannot generate a POP jwt if the token_claims are not populated",[W]:"Server response does not contain an authorization code to proceed",[G]:"Could not remove the credential's binding key from storage.",[V]:"The provided authority does not support logout",[Y]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Q]:"No network connectivity. Check your internet connection.",[$]:"User cancelled the flow.",[J]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[X]:"This method has not been implemented",[Z]:"The nested app auth bridge is disabled"};class te extends l.lR{constructor(e,t){super(e,t?"".concat(ee[e],": ").concat(t):ee[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,te.prototype)}}function ne(e,t){return new te(e,t)}const re={createNewGuid:()=>{throw ne(X)},base64Decode:()=>{throw ne(X)},base64Encode:()=>{throw ne(X)},base64UrlEncode:()=>{throw ne(X)},encodeKid:()=>{throw ne(X)},async getPublicKeyThumbprint(){throw ne(X)},async removeTokenBindingKey(){throw ne(X)},async clearKeystore(){throw ne(X)},async signJwt(){throw ne(X)},async hashString(){throw ne(X)}},oe="@azure/msal-common",ie="14.16.1";function ae(e,t){const n=function(e){if(!e)throw ne(p);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw ne(h);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw ne(h)}}function se(e,t){if(0===t||Date.now()-3e5>e+t)throw ne(T)}function ce(){return Math.round((new Date).getTime()/1e3)}function le(e,t){const n=Number(e)||0;return ce()+t>n}function de(e){return[ye(e),be(e),we(e),Ce(e),Se(e)].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function ue(e,t,n,r,o){return{credentialType:i.aG.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:o}}function he(e,t,n,r,o,a,s,c,l,d,u,h,p,f,m){var g,v;const y={homeAccountId:e,credentialType:i.aG.ACCESS_TOKEN,secret:n,cachedAt:ce().toString(),expiresOn:s.toString(),extendedExpiresOn:c.toString(),environment:t,clientId:r,realm:o,target:a,tokenType:u||i.IO.BEARER};if(h&&(y.userAssertionHash=h),d&&(y.refreshOn=d.toString()),f&&(y.requestedClaims=f,y.requestedClaimsHash=m),(null===(g=y.tokenType)||void 0===g?void 0:g.toLowerCase())!==i.IO.BEARER.toLowerCase())switch(y.credentialType=i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case i.IO.POP:const e=ae(n,l);if(null===e||void 0===e||null===(v=e.cnf)||void 0===v||!v.kid)throw ne(z);y.keyId=e.cnf.kid;break;case i.IO.SSH:y.keyId=p}return y}function pe(e,t,n,r,o,a,s){const c={credentialType:i.aG.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n};return a&&(c.userAssertionHash=a),o&&(c.familyId=o),s&&(c.expiresOn=s.toString()),c}function fe(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function me(e){return!!e&&(fe(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===i.aG.ACCESS_TOKEN||e.credentialType===i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function ge(e){return!!e&&(fe(e)&&e.hasOwnProperty("realm")&&e.credentialType===i.aG.ID_TOKEN)}function ve(e){return!!e&&(fe(e)&&e.credentialType===i.aG.REFRESH_TOKEN)}function ye(e){return[e.homeAccountId,e.environment].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function be(e){const t=e.credentialType===i.aG.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function we(e){return(e.target||"").toLowerCase()}function Ce(e){return(e.requestedClaimsHash||"").toLowerCase()}function Se(e){return e.tokenType&&e.tokenType.toLowerCase()!==i.IO.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function Te(){return ce()+i.u0.REFRESH_TIME_SECONDS}function Ee(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function _e(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Ae(e){return e.expiresAt<=ce()}const ke="redirect_uri_empty",Ie="claims_request_parsing_error",Re="authority_uri_insecure",xe="url_parse_error",Ne="empty_url_error",Oe="empty_input_scopes_error",Pe="invalid_prompt_value",je="invalid_claims",Me="token_request_empty",Le="logout_request_empty",De="invalid_code_challenge_method",Ue="pkce_params_missing",Be="invalid_cloud_discovery_metadata",He="invalid_authority_metadata",Fe="untrusted_authority",qe="missing_ssh_jwk",Ke="missing_ssh_kid",ze="missing_nonce_authentication_header",We="invalid_authentication_header",Ge="cannot_set_OIDCOptions",Ve="cannot_allow_native_broker",Ye="authority_mismatch",Qe={[ke]:"A redirect URI is required for all calls, and none has been set.",[Ie]:"Could not parse the given claims request object.",[Re]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[xe]:"URL could not be parsed into appropriate segments.",[Ne]:"URL was empty or null.",[Oe]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Pe]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[je]:"Given claims parameter must be a stringified JSON object.",[Me]:"Token request was empty and not found in cache.",[Le]:"The logout request was null or undefined.",[De]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Ue]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Be]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[He]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Fe]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[qe]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Ke]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[ze]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[We]:"Invalid authentication header provided",[Ge]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ve]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[Ye]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class $e extends l.lR{constructor(e){super(e,Qe[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,$e.prototype)}}function Je(e){return new $e(e)}class Xe{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,o]=e.split(/=(.+)/g,2);n&&o&&(t[r(n)]=r(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Ze{constructor(e){const t=e?Xe.trimArrayEntries([...e]):[],n=t?Xe.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||i.YM.EMPTY_STRING).split(" ");return new Ze(t)}static createSearchScopes(e){const t=new Ze(e);return t.containsOnlyOIDCScopes()?t.removeScope(i.YM.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Je(Oe)}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Ze(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return i._A.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(t){throw ne(R)}}removeScope(e){if(!e)throw ne(I);this.scopes.delete(e.trim())}removeOIDCScopes(){i._A.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ne(x);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw ne(x);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return i.YM.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function et(e,t){if(!e)throw ne(u);try{const n=t(e);return JSON.parse(n)}catch(n){throw ne(d)}}function tt(e){if(!e)throw ne(d);const t=e.split(i.LR.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?i.YM.EMPTY_STRING:t[1]}}function nt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const rt=["isHomeTenant"],ot=["isHomeTenant"];function it(e,t){return!!e&&!!t&&e===t.split(".")[1]}function at(e,t,n,r){if(r){const{oid:t,sub:n,tid:o,name:i,tfp:a,acr:s}=r,c=o||a||s||"";return{tenantId:c,localAccountId:t||n||"",name:i,isHomeTenant:it(c,e)}}return{tenantId:n,localAccountId:t,isHomeTenant:it(n,e)}}function st(e,t,n,o){let i=e;if(t){const{isHomeTenant:n}=t,o=nt(t,rt);i=(0,r.A)((0,r.A)({},e),o)}if(n){const t=at(e.homeAccountId,e.localAccountId,e.tenantId,n),{isHomeTenant:a}=t,s=nt(t,ot);return i=(0,r.A)((0,r.A)((0,r.A)({},i),s),{},{idTokenClaims:n,idToken:o}),i}return i}const ct=0,lt=1,dt=2,ut=3;function ht(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class pt{generateAccountId(){return[this.homeAccountId,this.environment].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return pt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){var r,o,s,c,l,d,u,h;const p=new pt;let f;t.authorityType===lt?p.authorityType=i.Qd.ADFS_ACCOUNT_TYPE:t.protocolMode===a?p.authorityType=i.Qd.MSSTS_ACCOUNT_TYPE:p.authorityType=i.Qd.GENERIC_ACCOUNT_TYPE,e.clientInfo&&n&&(f=et(e.clientInfo,n)),p.clientInfo=e.clientInfo,p.homeAccountId=e.homeAccountId,p.nativeAccountId=e.nativeAccountId;const m=e.environment||t&&t.getPreferredCache();if(!m)throw ne(L);p.environment=m,p.realm=(null===(r=f)||void 0===r?void 0:r.utid)||ht(e.idTokenClaims)||"",p.localAccountId=(null===(o=f)||void 0===o?void 0:o.uid)||(null===(s=e.idTokenClaims)||void 0===s?void 0:s.oid)||(null===(c=e.idTokenClaims)||void 0===c?void 0:c.sub)||"";const g=(null===(l=e.idTokenClaims)||void 0===l?void 0:l.preferred_username)||(null===(d=e.idTokenClaims)||void 0===d?void 0:d.upn),v=null!==(u=e.idTokenClaims)&&void 0!==u&&u.emails?e.idTokenClaims.emails[0]:null;if(p.username=g||v||"",p.name=(null===(h=e.idTokenClaims)||void 0===h?void 0:h.name)||"",p.cloudGraphHostName=e.cloudGraphHostName,p.msGraphHost=e.msGraphHost,e.tenantProfiles)p.tenantProfiles=e.tenantProfiles;else{const t=at(e.homeAccountId,p.localAccountId,p.realm,e.idTokenClaims);p.tenantProfiles=[t]}return p}static createFromAccountInfo(e,t,n){var r;const o=new pt;return o.authorityType=e.authorityType||i.Qd.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from((null===(r=e.tenantProfiles)||void 0===r?void 0:r.values())||[]),o}static generateHomeAccountId(e,t,n,r,o){if(t!==lt&&t!==dt){if(e)try{const t=et(e,r.base64Decode);if(t.uid&&t.utid)return"".concat(t.uid,".").concat(t.utid)}catch(i){}n.warning("No client info in response")}return(null===o||void 0===o?void 0:o.sub)||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},o=t.idTokenClaims||{};r=n.iat===o.iat&&n.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function ft(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function mt(e){if(!e||e.indexOf("=")<0)return null;try{const t=ft(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.error||n.error_description||n.state)return n}catch(t){throw ne(v)}return null}class gt{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Je(Ne);e.includes("#")||(this._urlString=gt.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Xe.endsWith(t,"?")?t=t.slice(0,-1):Xe.endsWith(t,"?/")&&(t=t.slice(0,-2)),Xe.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw Je(xe)}if(!e.HostNameAndPort||!e.PathSegments)throw Je(xe);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Je(Re)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return gt.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==i.v2.COMMON&&n[0]!==i.v2.ORGANIZATIONS||(n[0]=e),gt.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Je(xe);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Je(xe);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===i.YM.FORWARD_SLASH){const n=new gt(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new gt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!mt(e)}}const vt={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},yt={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},bt=new Set;function wt(e,t,n,r){if(null===r||void 0===r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){const o=Ct(t,e);if(o)return null===r||void 0===r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),o.aliases;null===r||void 0===r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function Ct(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}yt.metadata.forEach(e=>{e.aliases.forEach(e=>{bt.add(e)})});const St="cache_quota_exceeded",Tt="cache_error_unknown",Et={[St]:"Exceeded cache storage capacity.",[Tt]:"Unexpected error occurred when using cache storage."};class _t extends Error{constructor(e,t){const n=t||(Et[e]?Et[e]:Et[Tt]);super("".concat(e,": ").concat(n)),Object.setPrototypeOf(this,_t.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function At(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new _t(St):new _t(e.name,e.message):new _t(Tt)}class kt{constructor(e,t,n,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(oe,ie),this.staticAuthorityOptions=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(t||{},e),e,t)}getAccountInfoFilteredBy(e,t){const n=this.getAllAccounts(t,e);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null===n||void 0===n?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,o){let i,a=null;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;const s=this.getIdToken(e,r,t,n.tenantId);return s&&(i=ae(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,o))?null:(a=st(e,n,i,null===s||void 0===s?void 0:s.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const a=this.getTokenKeys();if(n){const e=i.get(n);if(!e)return[];i=new Map([[n,e]])}const s=[];return i.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(o,a,e,t,r);n&&s.push(n)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw ne(M);try{e.account&&this.setAccount(e.account,t),e.idToken&&!1!==(null===n||void 0===n?void 0:n.idToken)&&this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==(null===n||void 0===n?void 0:n.accessToken)&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==(null===n||void 0===n?void 0:n.refreshToken)&&this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){var r;throw null===(r=this.commonLogger)||void 0===r||r.error("CacheManager.saveCacheRecord: failed"),o instanceof l.lR?o:At(o)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=Ze.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){Ze.fromString(r.target).intersectingScopeSets(o)&&this.removeAccessToken(e,t)}}),this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{var o;if(!this.isAccountKey(n,e.homeAccountId))return;const i=this.getAccount(n,t,this.commonLogger);if(!i)return;if(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId))return;if(e.username&&!this.matchUsername(i.username,e.username))return;if(e.environment&&!this.matchEnvironment(i,e.environment))return;if(e.realm&&!this.matchRealm(i,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const a={localAccountId:null===e||void 0===e?void 0:e.localAccountId,name:null===e||void 0===e?void 0:e.name},s=null===(o=i.tenantProfiles)||void 0===o?void 0:o.filter(e=>this.tenantProfileMatchesFilter(e,a));s&&0===s.length||r.push(i)}),r}isAccountKey(e,t,n){return!(e.split(i.LR.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(n&&!e.toLowerCase().includes(n.toLowerCase())))}isCredentialKey(e){if(e.split(i.LR.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(i.aG.ID_TOKEN.toLowerCase())&&-1===t.indexOf(i.aG.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(i.aG.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(i.aG.REFRESH_TOKEN.toLowerCase())>-1){const e="".concat(i.aG.REFRESH_TOKEN).concat(i.LR.CACHE_KEY_SEPARATOR).concat(this.clientId).concat(i.LR.CACHE_KEY_SEPARATOR),n="".concat(i.aG.REFRESH_TOKEN).concat(i.LR.CACHE_KEY_SEPARATOR).concat(i.hB).concat(i.LR.CACHE_KEY_SEPARATOR);if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===i.IO.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}async removeAllAccounts(e){const t=this.getAccountKeys(),n=[];t.forEach(t=>{n.push(this.removeAccount(t,e))}),await Promise.all(n)}async removeAccount(e,t){const n=this.getAccount(e,t,this.commonLogger);n&&(await this.removeAccountContext(n,t),this.removeItem(e,t))}async removeAccountContext(e,t){const n=this.getTokenKeys(),r=e.generateAccountId();n.idToken.forEach(e=>{0===e.indexOf(r)&&this.removeIdToken(e,t)}),n.accessToken.forEach(e=>{0===e.indexOf(r)&&this.removeAccessToken(e,t)}),n.refreshToken.forEach(e=>{0===e.indexOf(r)&&this.removeRefreshToken(e,t)}),this.getKeys().forEach(e=>{e.includes(r)&&this.removeItem(e,t)})}updateOutdatedCachedAccount(e,t,n,o){if(t&&t.isSingleTenant()){var i;null===(i=this.commonLogger)||void 0===i||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const a=this.getAccountKeys().filter(e=>e.startsWith(t.homeAccountId)),s=[];a.forEach(e=>{const t=this.getCachedAccountEntity(e,n);t&&s.push(t)});const c=s.find(e=>it(e.realm,e.homeAccountId))||s[0];c.tenantProfiles=s.map(e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:it(e.realm,e.homeAccountId)}));const l=kt.toObject(new pt,(0,r.A)({},c)),d=l.generateAccountKey();return a.forEach(t=>{t!==d&&this.removeOutdatedAccount(e,n)}),this.setAccount(l,n),null===o||void 0===o||o.verbose("Updated an outdated account entity in the cache"),l}return t}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),!n||n.credentialType.toLowerCase()!==i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==i.IO.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}readAccountFromCache(e,t){const n=pt.generateAccountCacheKey(e);return this.getAccount(n,t,this.commonLogger)}getIdToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getIdToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.aG.ID_TOKEN,clientId:this.clientId,realm:r},s=this.getIdTokensByFilter(a,t,n),c=s.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let n=s;if(!r){const t=new Map;s.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),o&&t&&o.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){const o=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return o.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,(0,r.A)({clientId:this.clientId},e)))return;const o=this.getIdTokenCredential(n,t);o&&this.credentialMatchesFilter(o,e)&&i.set(n,o)}),i}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getAccessToken called");const a=Ze.createSearchScopes(t.scopes),s=t.authenticationScheme||i.IO.BEARER,c=s&&s.toLowerCase()!==i.IO.BEARER.toLowerCase()?i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME:i.aG.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:r||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];d.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const n=this.getAccessTokenCredential(e,t.correlationId);n&&this.credentialMatchesFilter(n,l)&&u.push(n)}});const h=u.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),u.forEach(e=>{this.removeAccessToken(de(e),t.correlationId)}),o&&t.correlationId&&o.addFields({multiMatchedAT:u.length},t.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const o=this.getAccessTokenCredential(n,t);o&&this.credentialMatchesFilter(o,e)&&r.push(o)}),r}getRefreshToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const a=t?i.hB:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:i.aG.REFRESH_TOKEN,clientId:this.clientId,familyId:a},c=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,s)&&l.push(t)}});const d=l.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&o&&n&&o.addFields({multiMatchedRT:d},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),o=r.length;if(o<1)return null;if(o>1)throw ne(A);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==i.hB)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!==typeof e||(null===t||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){var o;const a=new gt(r).getUrlComponents().HostNameAndPort;n=wt(a,null===(o=e.cloudDiscoveryMetadata)||void 0===o?void 0:o.metadata,i.E_.CONFIG,t)||wt(a,yt.metadata,i.E_.HARDCODED_VALUES,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==i.aG.ACCESS_TOKEN&&e.credentialType!==i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Ze.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(i.GU)}isAuthorityMetadata(e){return-1!==e.indexOf(i.u0.CACHE_KEY)}generateAuthorityMetadataCacheKey(e){return"".concat(i.u0.CACHE_KEY,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class It extends kt{setAccount(){throw ne(X)}getAccount(){throw ne(X)}getCachedAccountEntity(){throw ne(X)}setIdTokenCredential(){throw ne(X)}getIdTokenCredential(){throw ne(X)}setAccessTokenCredential(){throw ne(X)}getAccessTokenCredential(){throw ne(X)}setRefreshTokenCredential(){throw ne(X)}getRefreshTokenCredential(){throw ne(X)}setAppMetadata(){throw ne(X)}getAppMetadata(){throw ne(X)}setServerTelemetry(){throw ne(X)}getServerTelemetry(){throw ne(X)}setAuthorityMetadata(){throw ne(X)}getAuthorityMetadata(){throw ne(X)}getAuthorityMetadataKeys(){throw ne(X)}setThrottlingCache(){throw ne(X)}getThrottlingCache(){throw ne(X)}removeItem(){throw ne(X)}getKeys(){throw ne(X)}getAccountKeys(){throw ne(X)}getTokenKeys(){throw ne(X)}updateCredentialCacheKey(){throw ne(X)}removeOutdatedAccount(){throw ne(X)}}const Rt={tokenRenewalOffsetSeconds:i.F0,preventCorsPreflight:!1},xt={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:o.$.Info,correlationId:i.YM.EMPTY_STRING},Nt={claimsBasedCachingEnabled:!1},Ot={async sendGetRequestAsync(){throw ne(X)},async sendPostRequestAsync(){throw ne(X)}},Pt={sku:i.YM.SKU,version:ie,cpu:i.YM.EMPTY_STRING,os:i.YM.EMPTY_STRING},jt={clientSecret:i.YM.EMPTY_STRING,clientAssertion:void 0},Mt={azureCloudInstance:c,tenant:"".concat(i.YM.DEFAULT_COMMON_TENANT)},Lt={application:{appName:"",appVersion:""}};function Dt(e){return e.authOptions.authority.options.protocolMode===s}const Ut={sendGetRequestAsync:()=>Promise.reject(ne(X)),sendPostRequestAsync:()=>Promise.reject(ne(X))},Bt="acquireTokenByCode",Ht="acquireTokenByRefreshToken",Ft="acquireTokenSilent",qt="acquireTokenSilentAsync",Kt="acquireTokenPopup",zt="acquireTokenPreRedirect",Wt="acquireTokenRedirect",Gt="cryptoOptsGetPublicKeyThumbprint",Vt="cryptoOptsSignJwt",Yt="silentCacheClientAcquireToken",Qt="silentIframeClientAcquireToken",$t="awaitConcurrentIframe",Jt="silentRefreshClientAcquireToken",Xt="ssoSilent",Zt="standardInteractionClientGetDiscoveredAuthority",en="fetchAccountIdWithNativeBroker",tn="nativeInteractionClientAcquireToken",nn="networkClientSendPostRequestAsync",rn="refreshTokenClientExecutePostToTokenEndpoint",on="authorizationCodeClientExecutePostToTokenEndpoint",an="refreshTokenClientExecuteTokenRequest",sn="refreshTokenClientAcquireToken",cn="refreshTokenClientAcquireTokenWithCachedRefreshToken",ln="refreshTokenClientAcquireTokenByRefreshToken",dn="refreshTokenClientCreateTokenRequestBody",un="acquireTokenFromCache",hn="silentFlowClientAcquireCachedToken",pn="silentFlowClientGenerateResultFromCacheRecord",fn="acquireTokenBySilentIframe",mn="initializeBaseRequest",gn="initializeSilentRequest",vn="initializeClientApplication",yn="silentIframeClientTokenHelper",bn="silentHandlerInitiateAuthRequest",wn="silentHandlerMonitorIframeForHash",Cn="silentHandlerLoadFrame",Sn="silentHandlerLoadFrameSync",Tn="standardInteractionClientCreateAuthCodeClient",En="standardInteractionClientGetClientConfiguration",_n="standardInteractionClientInitializeAuthorizationRequest",An="standardInteractionClientInitializeAuthorizationCodeRequest",kn="getAuthCodeUrl",In="handleCodeResponseFromServer",Rn="handleCodeResponse",xn="updateTokenEndpointAuthority",Nn="authClientAcquireToken",On="authClientExecuteTokenRequest",Pn="authClientCreateTokenRequestBody",jn="authClientCreateQueryString",Mn="popTokenGenerateCnf",Ln="popTokenGenerateKid",Dn="handleServerTokenResponse",Un="deserializeResponse",Bn="authorityFactoryCreateDiscoveredInstance",Hn="authorityResolveEndpointsAsync",Fn="authorityGetCloudDiscoveryMetadataFromNetwork",qn="authorityUpdateCloudDiscoveryMetadata",Kn="authorityGetEndpointMetadataFromNetwork",zn="authorityUpdateEndpointMetadata",Wn="authorityUpdateMetadataWithRegionalInformation",Gn="regionDiscoveryDetectRegion",Vn="regionDiscoveryGetRegionFromIMDS",Yn="regionDiscoveryGetCurrentVersion",Qn="acquireTokenByCodeAsync",$n="handleRedirectPromise",Jn="handleNativeRedirectPromise",Xn="nativeMessageHandlerHandshake",Zn="removeHiddenIframe",er="clearTokensAndKeysWithClaims",tr="cacheManagerGetRefreshToken",nr="generatePkceCodes",rr="generateCodeVerifier",or="generateCodeChallengeFromVerifier",ir="sha256Digest",ar="getRandomValues",sr=(new Map([[Bt,"ATByCode"],[Ht,"ATByRT"],[Ft,"ATS"],[qt,"ATSAsync"],[Kt,"ATPopup"],[Wt,"ATRedirect"],[Gt,"CryptoGetPKThumb"],[Vt,"CryptoSignJwt"],[Yt,"SltCacheClientAT"],[Qt,"SltIframeClientAT"],[Jt,"SltRClientAT"],[Xt,"SsoSlt"],[Zt,"StdIntClientGetDiscAuth"],[en,"FetchAccIdWithNtvBroker"],[tn,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[nn,"NetClientSendPost"],[rn,"RTClientExecPost"],[on,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[an,"RTClientExecTReq"],[sn,"RTClientAT"],[cn,"RTClientATWithCachedRT"],[ln,"RTClientATByRT"],[dn,"RTClientCreateTReqBody"],[un,"ATFromCache"],[hn,"SltFlowClientATCached"],[pn,"SltFlowClientGenResFromCache"],[fn,"ATBySltIframe"],[mn,"InitBaseReq"],[gn,"InitSltReq"],[vn,"InitClientApplication"],[yn,"SIClientTHelper"],[bn,"SHandlerInitAuthReq"],[wn,"SltHandlerMonitorIframeForHash"],[Cn,"SHandlerLoadFrame"],[Sn,"SHandlerLoadFrameSync"],[Tn,"StdIntClientCreateAuthCodeClient"],[En,"StdIntClientGetClientConf"],[_n,"StdIntClientInitAuthReq"],[An,"StdIntClientInitAuthCodeReq"],[kn,"GetAuthCodeUrl"],[In,"HandleCodeResFromServer"],[Rn,"HandleCodeResp"],[xn,"UpdTEndpointAuth"],[Nn,"AuthClientAT"],[On,"AuthClientExecTReq"],[Pn,"AuthClientCreateTReqBody"],[jn,"AuthClientCreateQueryStr"],[Mn,"PopTGenCnf"],[Ln,"PopTGenKid"],[Dn,"HandleServerTRes"],[Un,"DeserializeRes"],[Bn,"AuthFactCreateDiscInst"],[Hn,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Fn,"AuthGetCDMetaFromNet"],[qn,"AuthUpdCDMeta"],[Kn,"AuthUpdCDMetaFromNet"],[zn,"AuthUpdEndpointMeta"],[Wn,"AuthUpdMetaWithRegInfo"],[Gn,"RegDiscDetectReg"],[Vn,"RegDiscGetRegFromIMDS"],[Yn,"RegDiscGetCurrentVer"],[Qn,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[$n,"HandleRedirectPromise"],[Jn,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Xn,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[Zn,"RemoveHiddenIframe"],[er,"ClearTAndKeysWithClaims"],[tr,"CacheManagerGetRT"],[nr,"GenPkceCodes"],[rr,"GenCodeVerifier"],[or,"GenCodeChallengeFromVerifier"],[ir,"Sha256Digest"],[ar,"GetRandomValues"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]);class cr{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class lr{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:sr,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new cr}}startPerformanceMeasurement(){return new cr}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var dr=n(648);class ur{navigateInternal(e,t){return ur.defaultNavigateWindow(e,t)}navigateExternal(e,t){return ur.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(e=>{setTimeout(()=>{e(!0)},t.timeout)})}}class hr extends l.lR{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,hr.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function pr(e,t,n){return new hr(e,t,n)}const fr="pkce_not_created",mr="crypto_nonexistent",gr="empty_navigate_uri",vr="hash_empty_error",yr="no_state_in_hash",br="hash_does_not_contain_known_properties",wr="unable_to_parse_state",Cr="state_interaction_type_mismatch",Sr="interaction_in_progress",Tr="popup_window_error",Er="empty_window_error",_r="user_cancelled",Ar="monitor_popup_timeout",kr="monitor_window_timeout",Ir="redirect_in_iframe",Rr="block_iframe_reload",xr="block_nested_popups",Nr="iframe_closed_prematurely",Or="silent_logout_unsupported",Pr="no_account_error",jr="silent_prompt_value_error",Mr="no_token_request_cache_error",Lr="unable_to_parse_token_request_cache_error",Dr="no_cached_authority_error",Ur="auth_request_not_set_error",Br="invalid_cache_type",Hr="non_browser_environment",Fr="database_not_open",qr="no_network_connectivity",Kr="post_request_failed",zr="get_request_failed",Wr="failed_to_parse_response",Gr="unable_to_load_token",Vr="crypto_key_not_found",Yr="auth_code_required",Qr="auth_code_or_nativeAccountId_required",$r="spa_code_and_nativeAccountId_present",Jr="database_unavailable",Xr="unable_to_acquire_token_from_native_platform",Zr="native_handshake_timeout",eo="native_extension_not_installed",to="native_connection_not_established",no="uninitialized_public_client_application",ro="native_prompt_not_supported",oo="invalid_base64_string",io="invalid_pop_token_request",ao="failed_to_build_headers",so="failed_to_parse_headers",co="For more visit: aka.ms/msaljs/browser-errors",lo={[fr]:"The PKCE code challenge and verifier could not be generated.",[mr]:"The crypto object or function is not available.",[gr]:"Navigation URI is empty. Please check stack trace for more info.",[vr]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(co),[yr]:"Hash does not contain state. Please verify that the request originated from msal.",[br]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(co),[wr]:"Unable to parse state. Please verify that the request originated from msal.",[Cr]:"Hash contains state but the interaction type does not match the caller.",[Sr]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(co),[Tr]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Er]:"window.open returned null or undefined window object.",[_r]:"User cancelled the flow.",[Ar]:"Token acquisition in popup failed due to timeout.  ".concat(co),[kr]:"Token acquisition in iframe failed due to timeout.  ".concat(co),[Ir]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Rr]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(co),[xr]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Nr]:"The iframe being monitored was closed prematurely.",[Or]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Pr]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[jr]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Mr]:"No token request found in cache.",[Lr]:"The cached token request could not be parsed.",[Dr]:"No cached authority found.",[Ur]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Br]:"Invalid cache type",[Hr]:"Login and token requests are not supported in non-browser environments.",[Fr]:"Database is not open!",[qr]:"No network connectivity. Check your internet connection.",[Kr]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[zr]:"Network request failed. Please check the network trace to determine root cause.",[Wr]:"Failed to parse network response. Check network trace.",[Gr]:"Error loading token to cache.",[Vr]:"Cryptographic Key or Keypair not found in browser storage.",[Yr]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Qr]:"An authorization code or nativeAccountId must be provided to this flow.",[$r]:"Request cannot contain both spa code and native account id.",[Jr]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Xr]:"Unable to acquire token from native platform.  ".concat(co),[Zr]:"Timed out while attempting to establish connection to browser extension",[eo]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[to]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(co),[no]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(co),[ro]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[oo]:"Invalid base64 encoded string.",[io]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[ao]:"Failed to build request headers object.",[so]:"Failed to parse response headers"};class uo extends l.lR{constructor(e,t){super(e,lo[e],t),Object.setPrototypeOf(this,uo.prototype),this.name="BrowserAuthError"}}function ho(e,t){return new uo(e,t)}class po{async sendGetRequestAsync(e,t){let n,r={},o=0;const i=fo(t);try{n=await fetch(e,{method:dr.CC.GET,headers:i})}catch(a){throw ho(window.navigator.onLine?zr:qr)}r=mo(n.headers);try{return o=n.status,{headers:r,body:await n.json(),status:o}}catch(a){throw pr(ho(Wr),o,r)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=fo(t);let o,i=0,a={};try{o=await fetch(e,{method:dr.CC.POST,headers:r,body:n})}catch(s){throw ho(window.navigator.onLine?Kr:qr)}a=mo(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(s){throw pr(ho(Wr),i,a)}}}function fo(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(t){throw ho(ao)}}function mo(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(t){throw ho(so)}}function go(e){return encodeURIComponent(yo(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function vo(e){return bo(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function yo(e){return bo((new TextEncoder).encode(e))}function bo(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}const wo="SHA-256",Co=new Uint8Array([1,0,1]),So="0123456789abcdef",To=new Uint32Array(1),Eo={name:"RSASSA-PKCS1-v1_5",hash:wo,modulusLength:2048,publicExponent:Co};async function _o(e,t,n){null===t||void 0===t||t.addQueueMeasurement(ir,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(wo,r)}function Ao(e){return window.crypto.getRandomValues(e)}function ko(){return window.crypto.getRandomValues(To),To[0]}function Io(){const e=Date.now(),t=1024*ko()+(1023&ko()),n=new Uint8Array(16),r=Math.trunc(t/2**30),o=t&2**30-1,i=ko();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let a="";for(let s=0;s<n.length;s++)a+=So.charAt(n[s]>>>4),a+=So.charAt(15&n[s]),3!==s&&5!==s&&7!==s&&9!==s||(a+="-");return a}async function Ro(e){return window.crypto.subtle.exportKey(dr.jb,e)}async function xo(e){const t=await _o(e);return vo(new Uint8Array(t))}var No=n(854),Oo=n(552);function Po(){return window.parent!==window}function jo(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Mo(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(dr.Q1.POPUP_NAME_PREFIX,".")))throw ho(xr)}function Lo(){if("undefined"===typeof window)throw ho(Hr)}function Do(e){if(!e)throw ho(no)}function Uo(e){Lo(),function(){if(gt.hashContainsKnownProperties(window.location.hash)&&Po())throw ho(Rr)}(),Mo(),Do(e)}function Bo(e,t){if(Uo(e),function(e){if(Po()&&!e)throw ho(Ir)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===dr.Al.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw(0,No.jz)(Oo.jE)}function Ho(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}const Fo=1e4;const qo="3.30.0";class Ko{static loggerCallback(e,t){switch(e){case o.$.Error:return void console.error(t);case o.$.Info:return void console.info(t);case o.$.Verbose:return void console.debug(t);case o.$.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,n;let l;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:l,system:d,telemetry:u}=e;const h={clientId:i.YM.EMPTY_STRING,authority:"".concat(i.YM.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:i.YM.EMPTY_STRING,authorityMetadata:i.YM.EMPTY_STRING,redirectUri:"undefined"!==typeof window?jo():"",postLogoutRedirectUri:i.YM.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:a,OIDCOptions:{serverResponseType:i.zL.FRAGMENT,defaultScopes:[i.YM.OPENID_SCOPE,i.YM.PROFILE_SCOPE,i.YM.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:c,tenant:i.YM.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},p={cacheLocation:dr.Al.SessionStorage,temporaryCacheLocation:dr.Al.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!l||l.cacheLocation!==dr.Al.LocalStorage),claimsBasedCachingEnabled:!1},f={loggerCallback:()=>{},logLevel:o.$.Info,piiLoggingEnabled:!1},m=(0,r.A)((0,r.A)({},Rt),{},{loggerOptions:f,networkClient:t?new po:Ut,navigationClient:new ur,loadFrameTimeout:0,windowHashTimeout:(null===d||void 0===d?void 0:d.loadFrameTimeout)||6e4,iframeHashTimeout:(null===d||void 0===d?void 0:d.loadFrameTimeout)||Fo,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null===d||void 0===d?void 0:d.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:dr.Q1.DEFAULT_POLL_INTERVAL_MS}),g=(0,r.A)((0,r.A)((0,r.A)({},m),d),{},{loggerOptions:(null===d||void 0===d?void 0:d.loggerOptions)||f}),v={application:{appName:i.YM.EMPTY_STRING,appVersion:i.YM.EMPTY_STRING},client:new lr};(null===n||void 0===n?void 0:n.protocolMode)!==s&&null!==n&&void 0!==n&&n.OIDCOptions&&new o.V(g.loggerOptions).warning(JSON.stringify(Je(Ge)));if(null!==n&&void 0!==n&&n.protocolMode&&n.protocolMode!==a&&null!==g&&void 0!==g&&g.allowNativeBroker)throw Je(Ve);return{auth:(0,r.A)((0,r.A)((0,r.A)({},h),n),{},{OIDCOptions:(0,r.A)((0,r.A)({},h.OIDCOptions),null===n||void 0===n?void 0:n.OIDCOptions)}),cache:(0,r.A)((0,r.A)({},p),l),system:g,telemetry:(0,r.A)((0,r.A)({},v),u)}}(e,this.browserEnvironment);try{l=window[dr.Al.SessionStorage]}catch(m){}const d=null===(t=l)||void 0===t?void 0:t.getItem(dr.L$),u=null===(n=l)||void 0===n||null===(n=n.getItem(dr.P3))||void 0===n?void 0:n.toLowerCase(),h="true"===u||"false"!==u&&void 0,p=(0,r.A)({},this.config.system.loggerOptions),f=d&&Object.keys(o.$).includes(d)?o.$[d]:void 0;f&&(p.loggerCallback=Ko.loggerCallback,p.logLevel=f),void 0!==h&&(p.piiLoggingEnabled=h),this.logger=new o.V(p,"@azure/msal-browser",qo),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class zo extends Ko{getModuleName(){return zo.MODULE_NAME}getId(){return zo.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}zo.MODULE_NAME="",zo.ID="StandardOperatingContext";const Wo="missing_kid_error",Go="missing_alg_error",Vo={[Wo]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Go]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Yo extends l.lR{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Yo.prototype)}}function Qo(e){return new Yo(e,Vo[e])}class $o{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Qo(Wo);if(!e.alg)throw Qo(Go);const t=new $o({typ:e.typ||i.Lz.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}function Jo(e){return(new TextDecoder).decode(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw ho(oo)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}(e))}class Xo{constructor(){this.dbName=dr.$u,this.version=dr.G8,this.tableName=dr.WJ,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(ho(Jr)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ho(Fr));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(ho(Fr));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),n()}),o.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ho(Fr));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(ho(Fr));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ho(Fr));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(dr.$u),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class Zo{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class ei{constructor(e){this.inMemoryCache=new Zo,this.indexedDBCache=new Xo,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof uo&&e.errorCode===Jr))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class ti{constructor(e,t,n){this.logger=e,function(e){if(!window)throw ho(Hr);if(!window.crypto)throw ho(mr);if(!e&&!window.crypto.subtle)throw ho(mr,"crypto_subtle_undefined")}(null!==n&&void 0!==n&&n),this.cache=new ei(this.logger),this.performanceClient=t}createNewGuid(){return Io()}base64Encode(e){return yo(e)}base64Decode(e){return Jo(e)}base64UrlEncode(e){return go(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var t;const n=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(Gt,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(Eo,e,t)}(ti.EXTRACTABLE,ti.POP_KEY_USAGES),o=await Ro(r.publicKey),i=ni({e:o.e,kty:o.kty,n:o.n}),a=await this.hashString(i),s=await Ro(r.privateKey),c=await async function(e,t,n){return window.crypto.subtle.importKey(dr.jb,e,Eo,t,n)}(s,!1,["sign"]);return await this.cache.setItem(a,{privateKey:c,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),a}async removeTokenBindingKey(e){await this.cache.removeItem(e);return!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,o){var i;const a=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(Vt,o),s=await this.cache.getItem(t);if(!s)throw ho(Vr);const c=await Ro(s.publicKey),l=ni(c),d=go(JSON.stringify({kid:t})),u=go($o.getShrHeaderString((0,r.A)((0,r.A)({},null===n||void 0===n?void 0:n.header),{},{alg:c.alg,kid:d})));e.cnf={jwk:JSON.parse(l)};const h=go(JSON.stringify(e)),p="".concat(u,".").concat(h),f=(new TextEncoder).encode(p),m=await async function(e,t){return window.crypto.subtle.sign(Eo,e,t)}(s.privateKey,f),g=vo(new Uint8Array(m)),v="".concat(p,".").concat(g);return a&&a.end({success:!0}),v}async hashString(e){return xo(e)}}function ni(e){return JSON.stringify(e,Object.keys(e).sort())}ti.POP_KEY_USAGES=["sign","verify"],ti.EXTRACTABLE=!0;const ri=(e,t,n,r,o)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,o);if(o){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},o)}try{const r=e(...arguments);return null===i||void 0===i||i.end({success:!0}),n.trace("Returning result from ".concat(t)),r}catch(a){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(a))}catch(a){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},a),a}},oi=(e,t,n,r,o)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,o);if(o){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},o)}return null===r||void 0===r||r.setPreQueueTime(t,o),e(...arguments).then(e=>(n.trace("Returning result from ".concat(t)),null===i||void 0===i||i.end({success:!0}),e)).catch(e=>{n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},e),e})};class ii{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Gn,this.correlationId);let r=e;if(r)t.region_source=i.jZ.ENVIRONMENT_VARIABLE;else{const e=ii.IMDS_OPTIONS;try{const n=await oi(this.getRegionFromIMDS.bind(this),Vn,this.logger,this.performanceClient,this.correlationId)(i.YM.IMDS_VERSION,e);if(n.status===i.Kk.httpSuccess&&(r=n.body,t.region_source=i.jZ.IMDS),n.status===i.Kk.httpBadRequest){const n=await oi(this.getCurrentVersion.bind(this),Yn,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=i.jZ.FAILED_AUTO_DETECTION,null;const o=await oi(this.getRegionFromIMDS.bind(this),Vn,this.logger,this.performanceClient,this.correlationId)(n,e);o.status===i.Kk.httpSuccess&&(r=o.body,t.region_source=i.jZ.IMDS)}}catch(o){return t.region_source=i.jZ.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=i.jZ.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var n;return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Vn,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(i.YM.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,i.YM.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Yn,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(i.YM.IMDS_ENDPOINT,"?format=json"),e);return t.status===i.Kk.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(n){return null}}}ii.IMDS_OPTIONS={headers:{Metadata:"true"}};class ai{constructor(e,t,n,r,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new ii(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(i.YM.CIAM_AUTH_URL))return ut;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case i.YM.ADFS:return lt;case i.YM.DSTS:return dt}return ct}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new gt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ne(f)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ne(f)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ne(f)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ne(V);return this.replacePath(this.metadata.end_session_endpoint)}throw ne(f)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ne(f)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ne(f)}canReplaceTenant(e){return 1===e.PathSegments.length&&!ai.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===ct&&this.protocolMode===a}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new gt(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{let i=r[o];if(0===o&&this.canReplaceTenant(n)){const e=new gt(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(e)),i=e)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===lt||this.protocolMode!==a&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e,t;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Hn,this.correlationId);const n=this.getCurrentMetadataEntity(),r=await oi(this.updateCloudDiscoveryMetadata.bind(this),qn,this.logger,this.performanceClient,this.correlationId)(n);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network);const o=await oi(this.updateEndpointMetadata.bind(this),zn,this.logger,this.performanceClient,this.correlationId)(n);this.updateCachedMetadata(n,r,{source:o}),null===(t=this.performanceClient)||void 0===t||t.addFields({cloudDiscoverySource:r,authorityEndpointSource:o},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Te(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==i.E_.CACHE&&(null===n||void 0===n?void 0:n.source)!==i.E_.CACHE&&(e.expiresAt=Te(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(zn,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){var r;if(n.source===i.E_.HARDCODED_VALUES)if(null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion&&n.metadata){Ee(e,await oi(this.updateMetadataWithRegionalInformation.bind(this),Wn,this.logger,this.performanceClient,this.correlationId)(n.metadata),!1),e.canonical_authority=this.canonicalAuthority}return n.source}let o=await oi(this.getEndpointMetadataFromNetwork.bind(this),Kn,this.logger,this.performanceClient,this.correlationId)();var a;if(o)return null!==(a=this.authorityOptions.azureRegionConfiguration)&&void 0!==a&&a.azureRegion&&(o=await oi(this.updateMetadataWithRegionalInformation.bind(this),Wn,this.logger,this.performanceClient,this.correlationId)(o)),Ee(e,o,!0),i.E_.NETWORK;throw ne(g,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Ee(e,t,!1),{source:i.E_.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Ee(e,t,!1),{source:i.E_.HARDCODED_VALUES,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Ae(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:i.E_.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new gt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Je(He)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Kn,this.correlationId);const t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(n));try{const e=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return r?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(r)),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in vt?vt[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Wn,this.correlationId);const r=null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(r){var o;if(r!==i.YM.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=i._2.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,ai.replaceWithRegionalInformation(e,r);const t=await oi(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Gn,this.logger,this.performanceClient,this.correlationId)(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=i._2.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=t,ai.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=i._2.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(qn,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await oi(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Fn,this.logger,this.performanceClient,this.correlationId)();if(r)return _e(e,r,!0),i.E_.NETWORK;throw Je(Fe)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||i.YM.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||i.YM.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||i.YM.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),_e(e,t,!1),i.E_.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,Ct(yt.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),_e(e,t,!1),i.E_.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=Ae(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),i.E_.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===ut)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),ai.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=Ct(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Je(Be)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),ai.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Fn,this.correlationId);const t="".concat(i.YM.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),n={};let r=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,n);let o,a;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))o=e.body,a=o.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(o.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),o=e.body,o.error===i.YM.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(o.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(o.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Ct(a,this.hostnameAndPort)}catch(o){if(o instanceof l.lR)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(o.errorCode,"\nError Description: ").concat(o.errorMessage));else{const e=o;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=ai.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&gt.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==c){const e=t.tenant?t.tenant:i.YM.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(e,"/")}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return i.YM.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ne(f)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return bt.has(e)}static isPublicCloudAuthority(e){return i.YM.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const o=new gt(e);o.validateAsUri();const a=o.getUrlComponents();let s="".concat(t,".").concat(a.HostNameAndPort);this.isPublicCloudAuthority(a.HostNameAndPort)&&(s="".concat(t,".").concat(i.YM.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const c=gt.constructAuthorityUriFromObject((0,r.A)((0,r.A)({},o.getUrlComponents()),{},{HostNameAndPort:s})).urlString;return n?"".concat(c,"?").concat(n):c}static replaceWithRegionalInformation(e,t){const n=(0,r.A)({},e);return n.authorization_endpoint=ai.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=ai.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=ai.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new gt(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(i.YM.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(i.YM.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function si(e){return e.endsWith(i.YM.FORWARD_SLASH)?e:"".concat(e).concat(i.YM.FORWARD_SLASH)}ai.reservedTenantDomains=new Set(["{tenant}","{tenantid}",i.v2.COMMON,i.v2.CONSUMERS,i.v2.ORGANIZATIONS]);const ci="no_tokens_found",li="native_account_unavailable",di="refresh_token_expired",ui="bad_token",hi=["interaction_required","consent_required","login_required",ui],pi=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],fi={[ci]:"No refresh token found in the cache. Please sign-in.",[li]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[di]:"Refresh token has expired.",[ui]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class mi extends l.lR{constructor(e,t,n,r,o,a,s,c){super(e,t,n),Object.setPrototypeOf(this,mi.prototype),this.timestamp=r||i.YM.EMPTY_STRING,this.traceId=o||i.YM.EMPTY_STRING,this.correlationId=a||i.YM.EMPTY_STRING,this.claims=s||i.YM.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function gi(e,t,n){const r=!!e&&hi.indexOf(e)>-1,o=!!n&&pi.indexOf(n)>-1,i=!!t&&hi.some(e=>t.indexOf(e)>-1);return r||i||o}function vi(e){return new mi(e,fi[e])}class yi{static setRequestState(e,t,n){const r=yi.generateLibraryState(e,n);return t?"".concat(r).concat(i.YM.RESOURCE_DELIM).concat(t):r}static generateLibraryState(e,t){if(!e)throw ne(U);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw ne(U);if(!t)throw ne(y);try{const n=t.split(i.YM.RESOURCE_DELIM),r=n[0],o=n.length>1?n.slice(1).join(i.YM.RESOURCE_DELIM):i.YM.EMPTY_STRING,a=e.base64Decode(r),s=JSON.parse(a);return{userRequestState:o||i.YM.EMPTY_STRING,libraryState:s}}catch(n){throw ne(y)}}}const bi="home_account_id",wi="UPN";class Ci{constructor(){if(!window.localStorage)throw(0,No.jz)(Oo.xz)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}class Si{constructor(){if(!window.sessionStorage)throw(0,No.jz)(Oo.xz)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}function Ti(e,t){if(!t)return null;try{return yi.parseRequestState(e,t).libraryState.meta}catch(n){throw ne(y)}}const Ei=864e5;class _i{getItem(e){const t="".concat(encodeURIComponent(e)),n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[o,...i]=decodeURIComponent(e).trim().split("="),a=i.join("=");if(o===t)return a}return""}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=Lax;");if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*Ei);return n.toUTCString()}(n);o+="expires=".concat(e,";")}r&&(o+="Secure;"),document.cookie=o}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}}class Ai extends kt{constructor(e,t,n,r,o,i){super(e,n,r,o),this.cacheConfig=t,this.logger=r,this.internalStorage=new Zo,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new _i,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=i}setupBrowserStorage(e){try{switch(e){case dr.Al.LocalStorage:return new Ci;case dr.Al.SessionStorage:return new Si;case dr.Al.MemoryStorage:}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=dr.Al.MemoryStorage,new Zo}migrateCacheEntries(){const e=this.browserStorage.getItem(dr.dh.VERSION);e&&this.logger.info("MSAL.js was last initialized with version ".concat(e)),e!==qo&&this.browserStorage.setItem(dr.dh.VERSION,qo);const t="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ID_TOKEN),n="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.CLIENT_INFO),r="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ERROR),o="".concat(i.YM.CACHE_PREFIX,".").concat(i.Gd.ERROR_DESC),a=[this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(r),this.browserStorage.getItem(o)];[i.Gd.ID_TOKEN,i.Gd.CLIENT_INFO,i.Gd.ERROR,i.Gd.ERROR_DESC].forEach((e,t)=>{const n=a[t];n&&this.setTemporaryCache(e,n,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),t=this.getItem(dr.dh.ACCOUNT_KEYS),n=this.getItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId));if(t&&n)return void this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");this.browserStorage.getKeys().forEach(t=>{if(this.isCredentialKey(t)){const n=this.getItem(t);if(n){const r=this.validateAndParseJson(n);if(r&&r.hasOwnProperty("credentialType"))switch(r.credentialType){case i.aG.ID_TOKEN:if(ge(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: ".concat(t," found, saving key to token key map"));const n=r,o=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(o,i.aG.ID_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: ".concat(t));break;case i.aG.ACCESS_TOKEN:case i.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(me(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: ".concat(t," found, saving key to token key map"));const n=r,o=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(o,i.aG.ACCESS_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ".concat(t));break;case i.aG.REFRESH_TOKEN:if(ve(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: ".concat(t," found, saving key to token key map"));const n=r,o=this.updateCredentialCacheKey(t,n,e);return void this.addTokenKey(o,i.aG.REFRESH_TOKEN,e)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ".concat(t))}}}if(this.isAccountKey(t)){const n=this.getItem(t);if(n){const r=this.validateAndParseJson(n);r&&pt.isAccountEntity(r)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: ".concat(t," found, saving key to account key map")),this.addAccountKeyToMap(t,e))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,n){let r=[];for(let i=0;i<=20;i++)try{this.browserStorage.setItem(e,t),i>0&&this.removeAccessTokenKeys(r.slice(0,i),n);break}catch(o){const a=At(o);if(!(a.errorCode===St&&i<20))throw a;if(r.length||(r=e==="".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken),r.length<=i)throw a;this.removeAccessToken(r[i],n,!1)}}getAccount(e,t,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,r,t,n)}getCachedAccountEntity(e,t){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&pt.isAccountEntity(r)?kt.toObject(new pt,r):null}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addAccountKeyToMap(n,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(dr.dh.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const n=this.getAccountKeys();-1===n.indexOf(e)?(n.push(e),this.setItem(dr.dh.ACCOUNT_KEYS,JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(dr.dh.ACCOUNT_KEYS);this.setItem(dr.dh.ACCOUNT_KEYS,JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,i.aG.ID_TOKEN,t)}removeAccessToken(e,t){var n;let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),null===(n=this.performanceClient)||void 0===n||n.incrementFields({accessTokensRemoved:1},t),r&&this.removeTokenKey(e,i.aG.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys();let r=0;if(e.forEach(e=>{const t=n.accessToken.indexOf(e);t>-1&&(n.accessToken.splice(t,1),r++)}),r>0)return this.logger.info("removed ".concat(r," accessToken keys from tokenKeys map")),void this.setTokenKeys(n,t)}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,i.aG.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId));if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId),JSON.stringify(e),t):this.removeItem("".concat(dr.dh.TOKEN_KEYS,".").concat(this.clientId))}addTokenKey(e,t,n){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case i.aG.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case i.aG.ACCESS_TOKEN:const n=r.accessToken.indexOf(e);-1!==n&&r.accessToken.splice(n,1),this.logger.trace("access token ".concat(-1===n?"added to":"updated in"," map")),r.accessToken.push(e);break;case i.aG.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),ne(B)}this.setTokenKeys(r,n)}removeTokenKey(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getTokenKeys();switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case i.aG.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ".concat(e," from map"));const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case i.aG.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ".concat(e," from map"));const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case i.aG.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ".concat(e," from map"));const a=r.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),ne(B)}this.setTokenKeys(r,n)}getIdTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&ge(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.ID_TOKEN,t)}getAccessTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,i.aG.ACCESS_TOKEN,t),null;const r=this.validateAndParseJson(n);return r&&me(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,i.aG.REFRESH_TOKEN,t),null;const r=this.validateAndParseJson(n);return r&&ve(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=de(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,i.aG.REFRESH_TOKEN,t)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(o=n)&&0===r.indexOf(i.GU)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,o}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[i.GU,t,n].join(i.LR.CACHE_KEY_SEPARATOR).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(i.gT.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(i.u0.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(dr.H3.WRAPPER_SKU,e),this.internalStorage.setItem(dr.H3.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(dr.H3.WRAPPER_SKU)||i.YM.EMPTY_STRING,this.internalStorage.getItem(dr.H3.WRAPPER_VER)||i.YM.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(t);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const t=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT),n=this.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const r=this.getAccountInfoFilteredBy({localAccountId:n},e);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(r,e),r):null}const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(i.Gd.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(n,JSON.stringify(o),t),this.setItem(r,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(i.Xw.THROTTLING_PREFIX));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===dr.Al.LocalStorage){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(i.YM.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(i.YM.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(er,t);const n=this.getTokenKeys();let r=0;n.accessToken.forEach(e=>{const n=this.getAccessTokenCredential(e,t);null!==n&&void 0!==n&&n.requestedClaimsHash&&e.includes(n.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(e,t),r++)}),r>0&&this.logger.warning("".concat(r," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Xe.startsWith(e,i.YM.CACHE_PREFIX)||Xe.startsWith(e,i.Gd.ADAL_ID_TOKEN)?e:"".concat(i.YM.CACHE_PREFIX,".").concat(this.clientId,".").concat(e)}generateAuthorityKey(e){const{libraryState:{id:t}}=yi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.AUTHORITY,".").concat(t))}generateNonceKey(e){const{libraryState:{id:t}}=yi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.NONCE_IDTOKEN,".").concat(t))}generateStateKey(e){const{libraryState:{id:t}}=yi.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(dr._p.REQUEST_STATE,".").concat(t))}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)}updateCacheEntries(e,t,n,r,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,n,!1),o){const e={credential:o.homeAccountId,type:bi};this.setTemporaryCache(dr._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(r){const e={credential:r,type:wi};this.setTemporaryCache(dr._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(dr._p.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(dr._p.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(dr._p.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(dr._p.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(dr._p.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(dr._p.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ".concat(n)),this.resetRequestCache(n||i.YM.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(-1===t.indexOf(dr._p.REQUEST_STATE))return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const r=Ti(this.cryptoImpl,n);r&&r.interactionType===e&&(this.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ".concat(n)),this.resetRequestCache(n))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=yo(JSON.stringify(e));this.setTemporaryCache(dr._p.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(dr._p.REQUEST_PARAMS,!0);if(!t)throw ho(Mr);let n;try{n=JSON.parse(Jo(t))}catch(r){throw this.logger.errorPii("Attempted to parse: ".concat(t)),this.logger.error("Parsing cached token request threw with error: ".concat(r)),ho(Lr)}if(this.removeTemporaryItem(this.generateCacheKey(dr._p.REQUEST_PARAMS)),!n.authority){const t=this.generateAuthorityKey(e),r=this.getTemporaryCache(t);if(!r)throw ho(Dr);n.authority=r}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(dr._p.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e="".concat(i.YM.CACHE_PREFIX,".").concat(dr._p.INTERACTION_STATUS_KEY);return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t="".concat(i.YM.CACHE_PREFIX,".").concat(dr._p.INTERACTION_STATUS_KEY);if(e){if(this.getInteractionInProgress())throw ho(Sr);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(i.Gd.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(i.Gd.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(i.Gd.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(i.Gd.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const e=ae(n,Jo);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,n){const r=de(t);if(e!==r){const o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(r,o,n),this.logger.verbose("Updated an outdated ".concat(t.credentialType," cache key")),r;this.logger.error("Attempted to update an outdated ".concat(t.credentialType," cache key but no item matching the outdated key was found in storage"))}return e}async hydrateCache(e,t){var n,r,o;const i=ue(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(r=e.account)||void 0===r?void 0:r.environment,e.idToken,this.clientId,e.tenantId);let a;t.claims&&(a=await this.cryptoImpl.hashString(t.claims));const s={idToken:i,accessToken:he(null===(o=e.account)||void 0===o?void 0:o.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,Jo,void 0,e.tokenType,void 0,t.sshKid,t.claims,a)};return this.saveCacheRecord(s,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof _t&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(r){}throw r}}}var ki=n(498);class Ii{constructor(e){this.eventCallbacks=new Map,this.logger=e||new o.V({})}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||Io();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,n,r){if("undefined"!==typeof window){const o={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.eventCallbacks.forEach((t,n)=>{let[r,i]=t;(0===i.length||i.includes(e))&&(this.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e)),r.apply(null,[o]))})}}}class Ri extends l.lR{constructor(e,t,n,r,o){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=o,Object.setPrototypeOf(this,Ri.prototype)}}class xi{static generateThrottlingStorageKey(e){return"".concat(i.Xw.THROTTLING_PREFIX,".").concat(JSON.stringify(e))}static preProcess(e,t,n){const r=xi.generateThrottlingStorageKey(t),o=e.getThrottlingCache(r);if(o){var a;if(o.throttleTime<Date.now())return void e.removeItem(r,n);throw new Ri((null===(a=o.errorCodes)||void 0===a?void 0:a.join(" "))||i.YM.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n,r){if(xi.checkResponseStatus(n)||xi.checkResponseForRetryAfter(n)){const o={throttleTime:xi.calculateThrottleTime(parseInt(n.headers[i.OK.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(xi.generateThrottlingStorageKey(t),o,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(i.OK.RETRY_AFTER)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||i.Xw.DEFAULT_THROTTLE_TIME_SECONDS),n+i.Xw.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,n,r){const o={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i,n.correlationId)}}const Ni="client_id",Oi="redirect_uri",Pi="response_type",ji="token_type",Mi="req_cnf",Li="return_spa_code",Di="x-client-xtra-sku",Ui="brk_client_id",Bi="brk_redirect_uri";class Hi{static validateRedirectUri(e){if(!e)throw Je(ke)}static validatePrompt(e){const t=[];for(const n in i._M)t.push(i._M[n]);if(t.indexOf(e)<0)throw Je(Pe)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw Je(je)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Je(Ue);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([i.iF.PLAIN,i.iF.S256].indexOf(e)<0)throw Je(De)}}class Fi{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Pi,encodeURIComponent(i.YM.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Pi,encodeURIComponent("".concat(i.YM.TOKEN_RESPONSE_TYPE," ").concat(i.YM.ID_TOKEN_RESPONSE_TYPE)))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||i.p.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.aZ;!t||n.includes("openid")||e.includes("openid")||n.push("openid");const r=t?[...e||[],...n]:e||[],o=new Ze(r);this.parameters.set("scope",encodeURIComponent(o.printScopes()))}addClientId(e){this.parameters.set(Ni,encodeURIComponent(e))}addRedirectUri(e){Hi.validateRedirectUri(e),this.parameters.set(Oi,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Hi.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(i.OK.CCS_HEADER,encodeURIComponent("UPN:".concat(e)))}addCcsOid(e){this.parameters.set(i.OK.CCS_HEADER,encodeURIComponent("Oid:".concat(e.uid,"@").concat(e.utid)))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){const n=this.addClientCapabilitiesToClaims(e,t);Hi.validateClaims(n),this.parameters.set("claims",encodeURIComponent(n))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){null!==e&&void 0!==e&&e.appName&&this.parameters.set("x-app-name",e.appName),null!==e&&void 0!==e&&e.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){Hi.validatePrompt(e),this.parameters.set("".concat("prompt"),encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Hi.validateCodeChallengeParams(e,t),!e||!t)throw Je(Ue);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set(i.JR,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(e=>{let[t,n]=e;!this.parameters.has(t)&&n&&this.parameters.set(t,n)})}addClientCapabilitiesToClaims(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw Je(je)}else n={};return t&&t.length>0&&(n.hasOwnProperty(i.Fq.ACCESS_TOKEN)||(n[i.Fq.ACCESS_TOKEN]={}),n[i.Fq.ACCESS_TOKEN][i.Fq.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(i.Tq.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(i.Tq.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(ji,i.IO.POP),this.parameters.set(Mi,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(ji,i.IO.SSH),this.parameters.set(Mi,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability",i.Xw.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Ui]=e.brokerClientId,t[Bi]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,n)=>{e.push("".concat(n,"=").concat(t))}),function(e,t,n){if(!t)return;const r=e.get(Ni);r&&e.has(Ui)&&(null===n||void 0===n||n.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(Oi)},t))}(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}async function qi(e,t,n,r,o,i,a){null===a||void 0===a||a.addQueueMeasurement(Bn,i);const s=ai.transformCIAMAuthority(si(e)),c=new ai(s,t,n,r,o,i,a);try{return await oi(c.resolveEndpointsAsync.bind(c),Hn,o,a,i)(),c}catch(l){throw ne(f)}}class Ki{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:i,cacheOptions:a,storageInterface:s,networkInterface:c,cryptoInterface:l,clientCredentials:d,libraryInfo:u,telemetry:h,serverTelemetryManager:p,persistencePlugin:f,serializableCache:m}=e;const g=(0,r.A)((0,r.A)({},xt),i);return{authOptions:(v=t,(0,r.A)({clientCapabilities:[],azureCloudOptions:Mt,skipAuthorityMetadataCache:!1,instanceAware:!1},v)),systemOptions:(0,r.A)((0,r.A)({},Rt),n),loggerOptions:g,cacheOptions:(0,r.A)((0,r.A)({},Nt),a),storageInterface:s||new It(t.clientId,re,new o.V(g)),networkInterface:c||Ot,cryptoInterface:l||re,clientCredentials:d||jt,libraryInfo:(0,r.A)((0,r.A)({},Pt),u),telemetry:(0,r.A)((0,r.A)({},Lt),h),serverTelemetryManager:p||null,persistencePlugin:f||null,serializableCache:m||null};var v}(e),this.logger=new o.V(this.config.loggerOptions,oe,ie),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[i.OK.CONTENT_TYPE]=i.YM.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case bi:try{const n=tt(e.credential);t[i.OK.CCS_HEADER]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case wi:t[i.OK.CCS_HEADER]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,n,r,o,i){var a;i&&(null===(a=this.performanceClient)||void 0===a||a.addQueueMeasurement(i,o));const s=await this.sendPostRequest(r,e,{body:t,headers:n},o);return this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,r){let o;xi.preProcess(this.cacheManager,e,r);try{var a,s;o=await oi(this.networkClient.sendPostRequestAsync.bind(this.networkClient),nn,this.logger,this.performanceClient,r)(t,n);const e=o.headers||{};null===(a=this.performanceClient)||void 0===a||a.addFields({refreshTokenSize:(null===(s=o.body.refresh_token)||void 0===s?void 0:s.length)||0,httpVerToken:e[i.OK.X_MS_HTTP_VERSION]||"",requestId:e[i.OK.X_MS_REQUEST_ID]||""},r)}catch(d){if(d instanceof hr){const e=d.responseHeaders;var c;if(e)null===(c=this.performanceClient)||void 0===c||c.addFields({httpVerToken:e[i.OK.X_MS_HTTP_VERSION]||"",requestId:e[i.OK.X_MS_REQUEST_ID]||"",contentTypeHeader:e[i.OK.CONTENT_TYPE]||void 0,contentLengthHeader:e[i.OK.CONTENT_LENGTH]||void 0,httpStatus:d.httpStatus},r);throw d.error}throw d instanceof l.lR?d:ne(m)}return xi.postProcess(this.cacheManager,e,o,r),o}async updateAuthority(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(xn,t);const r="https://".concat(e,"/").concat(this.authority.tenant,"/"),o=await qi(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const t=new Fi(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}const zi="sw";class Wi{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Mn,e.correlationId);const r=await oi(this.generateKid.bind(this),Mn,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Ln,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:zi}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,o){const{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:s,shrNonce:c,shrOptions:l}=n,d=a?new gt(a):void 0,u=null===d||void 0===d?void 0:d.getUrlComponents();return this.cryptoUtils.signJwt((0,r.A)({at:e,ts:ce(),m:null===i||void 0===i?void 0:i.toUpperCase(),u:null===u||void 0===u?void 0:u.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:null===u||void 0===u?void 0:u.AbsolutePath,q:null!==u&&void 0!==u&&u.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0},o),t,l,n.correlationId)}}class Gi{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Vi{constructor(e,t,n,r,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?ne(w,"Cached State"):ne(w,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(o){throw ne(y,e.state)}try{r=decodeURIComponent(t)}catch(o){throw ne(y,e.state)}if(n!==r)throw ne(b);if(e.error||e.error_description||e.suberror){const t=function(e){var t,n;const r="code=",o=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(r);return o&&o>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(o+5):void 0}(e);if(gi(e.error,e.error_description,e.suberror))throw new mi(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Ri(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var n;const r="Error(s): ".concat(e.error_codes||i.YM.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||i.YM.NOT_AVAILABLE," - Description: ").concat(e.error_description||i.YM.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||i.YM.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||i.YM.NOT_AVAILABLE),o=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,a=new Ri(e.error,r,e.suberror,o,e.status);if(t&&e.status&&e.status>=i.t3.SERVER_ERROR_RANGE_START&&e.status<=i.t3.SERVER_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(a));if(t&&e.status&&e.status>=i.t3.CLIENT_ERROR_RANGE_START&&e.status<=i.t3.CLIENT_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(a));if(gi(e.error,e.error_description,e.suberror))throw new mi(e.error,e.error_description,e.suberror,e.timestamp||i.YM.EMPTY_STRING,e.trace_id||i.YM.EMPTY_STRING,e.correlation_id||i.YM.EMPTY_STRING,e.claims||i.YM.EMPTY_STRING,o);throw a}}async handleServerTokenResponse(e,t,n,r,o,a,s,c,l){var d;let u,h;if(null===(d=this.performanceClient)||void 0===d||d.addQueueMeasurement(Dn,e.correlation_id),e.id_token){if(u=ae(e.id_token||i.YM.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&u.nonce!==o.nonce)throw ne(C);if(r.maxAge||0===r.maxAge){const e=u.auth_time;if(!e)throw ne(S);se(e,r.maxAge)}}this.homeAccountIdentifier=pt.generateHomeAccountId(e.client_info||i.YM.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),o&&o.state&&(h=yi.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||r.sshKid||void 0;const p=this.generateCacheRecord(e,t,n,r,u,a,o);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new Gi(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),s&&!c&&p.account){const e=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,r.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Vi.generateAuthenticationResult(this.cryptoObj,t,p,!1,r,u,h,void 0,l)}await this.cacheStorage.saveCacheRecord(p,r.correlationId,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return Vi.generateAuthenticationResult(this.cryptoObj,t,p,!1,r,u,h,e,l)}generateCacheRecord(e,t,n,r,o,i,a){const s=t.getPreferredCache();if(!s)throw ne(L);const c=ht(o);let l,d;e.id_token&&o&&(l=ue(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),d=Yi(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,o,e.client_info,s,c,a,void 0,this.logger));let u=null;if(e.access_token){const o=e.scope?Ze.fromString(e.scope):new Ze(r.scopes||[]),a=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,d=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+a,p=h+l,f=d&&d>0?n+d:void 0;u=he(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=pe(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:s,familyId:e.foci}),{account:d,idToken:l,accessToken:u,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,n,r,o,a,s,c,l){var d,u,h,p,f;let m,g,v=i.YM.EMPTY_STRING,y=[],b=null,w=i.YM.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==i.IO.POP||o.popKid)v=n.accessToken.secret;else{const t=new Wi(e),{secret:r,keyId:i}=n.accessToken;if(!i)throw ne(Y);v=await t.signPopToken(r,i,o)}y=Ze.fromString(n.accessToken.target).asArray(),b=new Date(1e3*Number(n.accessToken.expiresOn)),m=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&(g=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(w=n.appMetadata.familyId===i.hB?i.hB:"");const C=(null===a||void 0===a?void 0:a.oid)||(null===a||void 0===a?void 0:a.sub)||"",S=(null===a||void 0===a?void 0:a.tid)||"";null!==c&&void 0!==c&&c.spa_accountid&&n.account&&(n.account.nativeAccountId=null===c||void 0===c?void 0:c.spa_accountid);const T=n.account?st(n.account.getAccountInfo(),void 0,a,null===(d=n.idToken)||void 0===d?void 0:d.secret):null;return{authority:t.canonicalAuthority,uniqueId:C,tenantId:S,scopes:y,account:T,idToken:(null===n||void 0===n||null===(u=n.idToken)||void 0===u?void 0:u.secret)||"",idTokenClaims:a||{},accessToken:v,fromCache:r,expiresOn:b,extExpiresOn:m,refreshOn:g,correlationId:o.correlationId,requestId:l||i.YM.EMPTY_STRING,familyId:w,tokenType:(null===(h=n.accessToken)||void 0===h?void 0:h.tokenType)||i.YM.EMPTY_STRING,state:s?s.userRequestState:i.YM.EMPTY_STRING,cloudGraphHostName:(null===(p=n.account)||void 0===p?void 0:p.cloudGraphHostName)||i.YM.EMPTY_STRING,msGraphHost:(null===(f=n.account)||void 0===f?void 0:f.msGraphHost)||i.YM.EMPTY_STRING,code:null===c||void 0===c?void 0:c.spa_code,fromNativeBroker:!1}}}function Yi(e,t,n,r,o,i,a,s,c,l,d,u){null===u||void 0===u||u.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let p=null;h&&(p=e.getAccount(h,o,u));const f=p||pt.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:null===l||void 0===l?void 0:l.cloud_graph_host_name,msGraphHost:null===l||void 0===l?void 0:l.msgraph_host,nativeAccountId:d},t,r),m=f.tenantProfiles||[],g=c||f.realm;if(g&&!m.find(e=>e.tenantId===g)){const e=at(n,f.localAccountId,g,i);m.push(e)}return f.tenantProfiles=m,f}async function Qi(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class $i extends Ki{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes}async getAuthCodeUrl(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(kn,e.correlationId);const n=await oi(this.createAuthCodeUrlQueryString.bind(this),jn,this.logger,this.performanceClient,e.correlationId)(e);return gt.appendQueryString(this.authority.authorizationEndpoint,n)}async acquireToken(e,t){var n,r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Nn,e.correlationId),!e.code)throw ne(k);const o=ce(),a=await oi(this.executeTokenRequest.bind(this),On,this.logger,this.performanceClient,e.correlationId)(this.authority,e),s=null===(r=a.headers)||void 0===r?void 0:r[i.OK.X_MS_REQUEST_ID],c=new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return c.validateTokenResponse(a.body),oi(c.handleServerTokenResponse.bind(c),Dn,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,o,e,t,void 0,void 0,void 0,s)}handleFragmentResponse(e,t){if(new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw ne(W);return e}getLogoutUri(e){if(!e)throw Je(Le);const t=this.createLogoutUrlQueryString(e);return gt.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var n,r;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(On,t.correlationId);const o=this.createTokenQueryParameters(t),a=gt.appendQueryString(e.tokenEndpoint,o),s=await oi(this.createTokenRequestBody.bind(this),Pn,this.logger,this.performanceClient,t.correlationId)(t);let c;if(t.clientInfo)try{const e=et(t.clientInfo,this.cryptoUtils.base64Decode);c={credential:"".concat(e.uid).concat(i.LR.CLIENT_INFO_SEPARATOR).concat(e.utid),type:bi}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}const l=this.createTokenRequestHeaders(c||t.ccsCredential),d={clientId:(null===(r=t.tokenBodyParameters)||void 0===r?void 0:r.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return oi(this.executePostToTokenEndpoint.bind(this),on,this.logger,this.performanceClient,t.correlationId)(a,s,l,d,t.correlationId,on)}async createTokenRequestBody(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Pn,e.correlationId);const r=new Fi(e.correlationId,this.performanceClient);if(r.addClientId(e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Ni])||this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):Hi.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.oidcDefaultScopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!Dt(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await Qi(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(r.addGrantType(i.$x.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),e.authenticationScheme===i.IO.POP){const t=new Wi(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await oi(t.generateCnf.bind(t),Mn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}r.addPopToken(n)}else if(e.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw Je(qe);r.addSshJwk(e.sshJwk)}let o;if((!Xe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=et(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:"".concat(t.uid).concat(i.LR.CLIENT_INFO_SEPARATOR).concat(t.utid),type:bi}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case bi:try{const e=tt(o.credential);r.addCcsOid(e)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case wi:r.addCcsUpn(o.credential)}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Li]||r.addExtraQueryParameters({[Li]:"1"}),r.createQueryString()}async createAuthCodeUrlQueryString(e){var t,n;const r=e.correlationId||this.config.cryptoInterface.createNewGuid();null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(jn,r);const o=new Fi(r,this.performanceClient);o.addClientId(e.embeddedClientId||(null===(n=e.extraQueryParameters)||void 0===n?void 0:n[Ni])||this.config.authOptions.clientId);const a=[...e.scopes||[],...e.extraScopesToConsent||[]];if(o.addScopes(a,!0,this.oidcDefaultScopes),o.addRedirectUri(e.redirectUri),o.addCorrelationId(r),o.addResponseMode(e.responseMode),o.addResponseTypeCode(),o.addLibraryInfo(this.config.libraryInfo),Dt(this.config)||o.addApplicationTelemetry(this.config.telemetry.application),o.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&o.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&o.addPrompt(e.prompt),e.domainHint&&o.addDomainHint(e.domainHint),e.prompt!==i._M.SELECT_ACCOUNT)if(e.sid&&e.prompt===i._M.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),o.addSid(e.sid);else if(e.account){const t=this.extractAccountSid(e.account);let n=this.extractLoginHint(e.account);if(n&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),n=null),n){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),o.addLoginHint(n);try{const t=tt(e.account.homeAccountId);o.addCcsOid(t)}catch(s){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t&&e.prompt===i._M.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),o.addSid(t);try{const t=tt(e.account.homeAccountId);o.addCcsOid(t)}catch(s){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),o.addLoginHint(e.loginHint),o.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),o.addLoginHint(e.account.username);try{const t=tt(e.account.homeAccountId);o.addCcsOid(t)}catch(s){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),o.addLoginHint(e.loginHint),o.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&o.addNonce(e.nonce),e.state&&o.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&o.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,o),e.nativeBroker&&(o.addNativeBroker(),e.authenticationScheme===i.IO.POP)){const t=new Wi(this.cryptoUtils);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await oi(t.generateCnf.bind(t),Mn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}o.addPopToken(n)}return o.createQueryString()}createLogoutUrlQueryString(e){const t=new Fi(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}extractLoginHint(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}}function Ji(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[n,r]],[2,[o,i]]]);let s=[];if(null!==t&&void 0!==t&&t.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:o}=e;if(n>=t.length)return;t[n]=[r,o].join("|")}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(",")}class Xi{constructor(e,t){this.cacheOutcome=i.Rv.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||i.YM.EMPTY_STRING,this.wrapperVer=e.wrapperVer||i.YM.EMPTY_STRING,this.telemetryCacheKey=i.gT.CACHE_KEY+i.LR.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(i.gT.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!==n&&void 0!==n&&n.length&&t.push("broker_error=".concat(n));const r=t.join(i.gT.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(i.gT.VALUE_SEPARATOR);return[i.gT.SCHEMA_VERSION,o,r].join(i.gT.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Xi.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(i.gT.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(i.gT.VALUE_SEPARATOR),o=e.errors.length,a=[o,t<o?i.gT.OVERFLOW_TRUE:i.gT.OVERFLOW_FALSE].join(i.gT.VALUE_SEPARATOR);return[i.gT.SCHEMA_VERSION,e.cacheHits,n,r,a].join(i.gT.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=i.gT.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof l.lR?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(i.gT.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Xi.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||i.YM.EMPTY_STRING,a=e.failedRequests[2*t+1]||i.YM.EMPTY_STRING,s=e.errors[t]||i.YM.EMPTY_STRING;if(r+=o.toString().length+a.toString().length+s.length+3,!(r<i.gT.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||i.YM.EMPTY_STRING),e.push(this.regionSource||i.YM.EMPTY_STRING),e.push(this.regionOutcome||i.YM.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return Ji(e)}}class Zi{constructor(e,t,n,r,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||Io(),this.logger=r.clone(dr.Q1.MSAL_SKU,qo,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){pt.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(pt.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch(n){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return gt.getAbsoluteUrl(t,jo())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Xi(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Zt,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=null!==n&&void 0!==n&&n.length?"true"===n:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(gt.getDomainFromUrl(o),t.environment):o,s=ai.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await oi(qi,Bn,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Je(Ye);return c}}async function ea(e,t,n){e.addQueueMeasurement(nr,n);const r=ri(ta,rr,t,e,n)(e,t,n);return{verifier:r,challenge:await oi(na,or,t,e,n)(r,e,t,n)}}function ta(e,t,n){try{const r=new Uint8Array(32);ri(Ao,ar,t,e,n)(r);return vo(r)}catch(r){throw ho(fr)}}async function na(e,t,n,r){t.addQueueMeasurement(or,r);try{const o=await oi(_o,ir,n,t,r)(e,t,r);return vo(new Uint8Array(o))}catch(o){throw ho(fr)}}async function ra(e,t,n,o){n.addQueueMeasurement(mn,e.correlationId);const a=e.authority||t.auth.authority,s=[...e&&e.scopes||[]],c=(0,r.A)((0,r.A)({},e),{},{correlationId:e.correlationId,authority:a,scopes:s});if(c.authenticationScheme){if(c.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw Je(qe);if(!e.sshKid)throw Je(Ke)}o.verbose('Authentication Scheme set to "'.concat(c.authenticationScheme,'" as configured in Auth request'))}else c.authenticationScheme=i.IO.BEARER,o.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Xe.isEmptyObj(e.claims)&&(c.requestedClaimsHash=await xo(e.claims)),c}async function oa(e,t,n,o,i){o.addQueueMeasurement(gn,e.correlationId);const a=await oi(ra,mn,i,o,e.correlationId)(e,n,o,i);return(0,r.A)((0,r.A)((0,r.A)({},e),a),{},{account:t,forceRefresh:e.forceRefresh||!1})}class ia extends Zi{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(An,this.correlationId);const t=await oi(ea,nr,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n=(0,r.A)((0,r.A)({},e),{},{redirectUri:e.redirectUri,code:i.YM.EMPTY_STRING,codeVerifier:t.verifier});return e.codeChallenge=t.challenge,e.codeChallengeMethod=i.YM.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t=(0,r.A)({correlationId:this.correlationId||Io()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(e.postLogoutRedirectUri,jo())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,jo())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=gt.getAbsoluteUrl(jo(),jo())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Tn,this.correlationId);const t=await oi(this.getClientConfiguration.bind(this),En,this.logger,this.performanceClient,this.correlationId)(e);return new $i(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:o,account:a}=e;this.performanceClient.addQueueMeasurement(En,this.correlationId);const s=await oi(this.getDiscoveredAuthority.bind(this),Zt,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:o,account:a}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:dr.Q1.MSAL_SKU,version:qo,cpu:i.YM.EMPTY_STRING,os:i.YM.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(_n,this.correlationId);const n=this.getRedirectUri(e.redirectUri),o={interactionType:t},a=yi.setRequestState(this.browserCrypto,e&&e.state||i.YM.EMPTY_STRING,o),s=await oi(ra,mn,this.logger,this.performanceClient,this.correlationId)((0,r.A)((0,r.A)({},e),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),c=(0,r.A)((0,r.A)({},s),{},{redirectUri:n,state:a,nonce:e.nonce||Io(),responseMode:this.config.auth.OIDCOptions.serverResponseType});if(e.loginHint||e.sid)return c;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(l.homeAccountId),this.correlationId),c.account=l),!c.loginHint&&!l){const e=this.browserStorage.getLegacyLoginHint();e&&(c.loginHint=e)}return c}}function aa(e){if(null==e)throw new TypeError("Cannot destructure "+e)}var sa=n(335);const ca="user_switch",la={[ca]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class da extends l.lR{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,da.prototype),this.name="NativeAuthError",this.ext=n}}function ua(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function ha(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return vi(li);case"USER_INTERACTION_REQUIRED":return new mi(e,t);case"USER_CANCEL":return ho(_r);case"NO_NETWORK":return ho(qr)}return new da(e,la[e]||t,n)}class pa extends Ki{constructor(e,t){super(e,t)}async acquireToken(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(sn,e.correlationId);const r=ce(),o=await oi(this.executeTokenRequest.bind(this),an,this.logger,this.performanceClient,e.correlationId)(e,this.authority),a=null===(n=o.headers)||void 0===n?void 0:n[i.OK.X_MS_REQUEST_ID],s=new Vi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(o.body),oi(s.handleServerTokenResponse.bind(s),Dn,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,a)}async acquireTokenByRefreshToken(e){var t;if(!e)throw Je(Me);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ln,e.correlationId),!e.account)throw ne(j);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await oi(this.acquireTokenWithCachedRefreshToken.bind(this),cn,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){const t=n instanceof mi&&n.errorCode===ci,r=n instanceof Ri&&n.errorCode===i.I.INVALID_GRANT_ERROR&&n.subError===i.I.CLIENT_MISMATCH_ERROR;if(t||r)return oi(this.acquireTokenWithCachedRefreshToken.bind(this),cn,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return oi(this.acquireTokenWithCachedRefreshToken.bind(this),cn,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(cn,e.correlationId);const o=ri(this.cacheManager.getRefreshToken.bind(this.cacheManager),tr,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!o)throw vi(ci);if(o.expiresOn&&le(o.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw vi(di);const a=(0,r.A)((0,r.A)({},e),{},{refreshToken:o.secret,authenticationScheme:e.authenticationScheme||i.IO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:bi}});try{return await oi(this.acquireToken.bind(this),sn,this.logger,this.performanceClient,e.correlationId)(a)}catch(s){if(s instanceof mi&&s.subError===ui){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=de(o);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw s}}async executeTokenRequest(e,t){var n,r;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(an,e.correlationId);const o=this.createTokenQueryParameters(e),i=gt.appendQueryString(t.tokenEndpoint,o),a=await oi(this.createTokenRequestBody.bind(this),dn,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),c={clientId:(null===(r=e.tokenBodyParameters)||void 0===r?void 0:r.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return oi(this.executePostToTokenEndpoint.bind(this),rn,this.logger,this.performanceClient,e.correlationId)(i,a,s,c,e.correlationId,rn)}async createTokenRequestBody(e){var t,n,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(dn,e.correlationId);const o=e.correlationId,a=new Fi(o,this.performanceClient);if(a.addClientId(e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[Ni])||this.config.authOptions.clientId),e.redirectUri&&a.addRedirectUri(e.redirectUri),a.addScopes(e.scopes,!0,null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes),a.addGrantType(i.$x.REFRESH_TOKEN_GRANT),a.addClientInfo(),a.addLibraryInfo(this.config.libraryInfo),a.addApplicationTelemetry(this.config.telemetry.application),a.addThrottling(),this.serverTelemetryManager&&!Dt(this.config)&&a.addServerTelemetry(this.serverTelemetryManager),a.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&a.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;a.addClientAssertion(await Qi(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),a.addClientAssertionType(t.assertionType)}if(e.authenticationScheme===i.IO.POP){const t=new Wi(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await oi(t.generateCnf.bind(t),Mn,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}a.addPopToken(n)}else if(e.authenticationScheme===i.IO.SSH){if(!e.sshJwk)throw Je(qe);a.addSshJwk(e.sshJwk)}if((!Xe.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&a.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case bi:try{const t=tt(e.ccsCredential.credential);a.addCcsOid(t)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case wi:a.addCcsUpn(e.ccsCredential.credential)}return e.embeddedClientId&&a.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&a.addExtraQueryParameters(e.tokenBodyParameters),a.createQueryString()}}class fa extends Ki{constructor(e,t){super(e,t)}async acquireToken(e){try{var t;const[n,o]=await this.acquireCachedToken((0,r.A)((0,r.A)({},e),{},{scopes:null!==(t=e.scopes)&&void 0!==t&&t.length?e.scopes:[...i.aZ]}));if(o===i.Rv.PROACTIVELY_REFRESHED){this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");new pa(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})}return n}catch(n){if(n instanceof te&&n.errorCode===q){return new pa(this.config,this.performanceClient).acquireTokenByRefreshToken(e)}throw n}}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(hn,e.correlationId);let n=i.Rv.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Xe.isEmptyObj(e.claims))throw this.setCacheOutcome(i.Rv.FORCE_REFRESH_OR_CLAIMS,e.correlationId),ne(q);if(!e.account)throw ne(j);const r=e.account.tenantId||function(e){var t;const n=null===(t=new gt(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case i.v2.COMMON:case i.v2.ORGANIZATIONS:case i.v2.CONSUMERS:return;default:return n}}(e.authority),o=this.cacheManager.getTokenKeys(),a=this.cacheManager.getAccessToken(e.account,e,o,r,this.performanceClient);if(!a)throw this.setCacheOutcome(i.Rv.NO_CACHED_ACCESS_TOKEN,e.correlationId),ne(q);if(s=a.cachedAt,Number(s)>ce()||le(a.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(i.Rv.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),ne(q);var s;a.refreshOn&&le(a.refreshOn,0)&&(n=i.Rv.PROACTIVELY_REFRESHED);const c=e.authority||this.authority.getPreferredCache(),l={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:a,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(c)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await oi(this.generateResultFromCacheRecord.bind(this),pn,this.logger,this.performanceClient,e.correlationId)(l,e),n]}setCacheOutcome(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),e!==i.Rv.NOT_APPLICABLE&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var n;let r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(pn,t.correlationId),e.idToken&&(r=ae(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var o;const e=null===(o=r)||void 0===o?void 0:o.auth_time;if(!e)throw ne(S);se(e,t.maxAge)}return Vi.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class ma extends ia{async acquireToken(e){this.performanceClient.addQueueMeasurement(Yt,e.correlationId);const t=this.initializeServerTelemetryManager(dr.sA.acquireTokenSilent_silentFlow),n=await oi(this.getClientConfiguration.bind(this),En,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new fa(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await oi(r.acquireCachedToken.bind(r),hn,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(o){throw o instanceof uo&&o.errorCode===Vr&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(null===t||void 0===t?void 0:t.account)}}const ga=["prompt"],va=["scopes"];class ya extends Zi{constructor(e,t,n,r,o,i,a,s,c,l,d,u){var h;super(e,t,n,r,o,i,s,c,u),this.apiId=a,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=d,this.silentCacheClient=new ma(e,this.nativeStorageManager,n,r,o,i,s,c,u),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const p=this.nativeMessageHandler.getExtensionId()===dr.JD.PREFERRED_EXTENSION_ID?"chrome":null!==(h=this.nativeMessageHandler.getExtensionId())&&void 0!==h&&h.length?"unknown":void 0;this.skus=Xi.makeExtraSkuString({libraryName:dr.Q1.MSAL_SKU,libraryVersion:qo,extensionName:p,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=(0,r.A)((0,r.A)({},e.extraParameters),{},{[Di]:this.skus})}async acquireToken(e){this.performanceClient.addQueueMeasurement(tn,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(tn,e.correlationId),n=ce();try{const o=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,o);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(r){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const i=Object.assign({},(aa(o),o)),a={method:dr.Ct.GetToken,request:i},s=await this.nativeMessageHandler.sendMessage(a),c=this.validateNativeResponse(s);return await this.handleNativeResponse(c,o,n).then(e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),e)).catch(e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(r){throw r instanceof da&&this.serverTelemetryManager.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Ze.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ne(D);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!n)throw ne(D);try{const e=this.createSilentCacheRequest(t,n),o=await this.silentCacheClient.acquireToken(e),i=(0,r.A)((0,r.A)({},n),{},{idTokenClaims:null===o||void 0===o?void 0:o.idTokenClaims,idToken:null===o||void 0===o?void 0:o.idToken});return(0,r.A)((0,r.A)({},o),{},{account:i})}catch(o){throw o}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=Object.assign({},(aa(e),e));delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n),o={method:dr.Ct.GetToken,request:r};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(s){if(s instanceof da&&(this.serverTelemetryManager.setNativeBrokerErrorCode(s.errorCode),ua(s)))throw s}this.browserStorage.setTemporaryCache(dr._p.NATIVE_REQUEST,JSON.stringify(r),!0);const i={apiId:dr.sA.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null===e||void 0===e||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:r}=n,o=nt(n,ga);r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(dr._p.NATIVE_REQUEST));const i={method:dr.Ct.GetToken,request:o},a=ce();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a);this.browserStorage.setInteractionInProgress(!1);const n=await t;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),n}catch(s){throw this.browserStorage.setInteractionInProgress(!1),s}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){var r;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=ae(e.id_token,Jo),i=this.createHomeAccountIdentifier(e,o);if(i!==(null===(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))||void 0===r?void 0:r.homeAccountId)&&e.account.id!==t.accountId)throw ha(ca);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=Yi(this.browserStorage,a,i,Jo,this.correlationId,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,o,s,a.canonicalAuthority,n);return this.cacheAccount(s),this.cacheNativeTokens(e,t,i,o,e.access_token,c.tenantId,n),c}createHomeAccountIdentifier(e,t){return pt.generateHomeAccountId(e.client_info||i.YM.EMPTY_STRING,ct,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Ze.fromString(e.scope):Ze.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===i.IO.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Wi(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw ne(Y);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,o,a){const s=this.addTelemetryFromNativeResponse(e),c=e.scope?Ze.fromString(e.scope):Ze.fromString(t.scope),l=e.account.properties||{},d=l.UID||n.oid||n.sub||i.YM.EMPTY_STRING,u=l.TenantId||n.tid||i.YM.EMPTY_STRING,h=st(r.getAccountInfo(),void 0,n,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const p=await this.generatePopAccessToken(e,t),f=t.tokenType===i.IO.POP?i.IO.POP:i.IO.BEARER;return{authority:o,uniqueId:d,tenantId:u,scopes:c.asArray(),account:h,idToken:e.id_token,idTokenClaims:n,accessToken:p,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(a+e.expires_in)),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(e=>{this.logger.error("Error occurred while removing account context from browser storage. ".concat(e))})}cacheNativeTokens(e,t,n,r,o,a,s){const c=ue(n,t.authority,e.id_token||"",t.clientId,r.tid||""),l=s+(t.tokenType===i.IO.POP?i.YM.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),d=this.generateScopes(e,t),u={idToken:c,accessToken:he(n,t.authority,o,t.clientId,r.tid||a,d.printScopes(),l,0,Jo,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(u,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw(0,l.pz)(sa.W,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new gt(t);n.validateAsUri();const{scopes:o}=e,a=nt(e,va),s=new Ze(o||[]);s.appendScopes(i.aZ);const c=(0,r.A)((0,r.A)({},a),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case dr.sA.ssoSilent:case dr.sA.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),i._M.NONE}if(e.prompt)switch(e.prompt){case i._M.NONE:case i._M.CONSENT:case i._M.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e.prompt," is not compatible with native flow")),ho(ro)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:(0,r.A)((0,r.A)({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(c.signPopToken&&e.popKid)throw ho(io);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=dr.JD.MATS_TELEMETRY,e.authenticationScheme===i.IO.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Wi(this.browserCrypto);let r;if(c.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{const o=await oi(n.generateCnf.bind(n),Mn,this.logger,this.performanceClient,e.correlationId)(t,this.logger);r=o.reqCnfString,c.keyId=o.kid,c.signPopToken=!0}c.reqCnf=r}return this.addRequestSKUs(c),c}handleExtraBrokerParams(e){var t;const n=e.extraParameters&&e.extraParameters.hasOwnProperty(Ui)&&e.extraParameters.hasOwnProperty(Bi)&&e.extraParameters.hasOwnProperty(Ni);if(!e.embeddedClientId&&!n)return;let r="";const o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Bi],r=e.extraParameters[Ni]),e.extraParameters={child_client_id:r,child_redirect_uri:o},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:r,embeddedRedirectUri:o},e.correlationId)}}class ba{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(Xn)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:dr.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:Io(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: ".concat(JSON.stringify(t))),this.messageChannel.port1.postMessage(t),new Promise((e,n)=>{this.resolvers.set(t.responseId,{resolve:e,reject:n})})}static async createProvider(e,t,n){e.trace("NativeMessageHandler - createProvider called.");try{const r=new ba(e,t,n,dr.JD.PREFERRED_EXTENSION_ID);return await r.sendHandshakeRequest(),r}catch(r){const o=new ba(e,t,n);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:dr.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:Io(),body:{method:dr.Ct.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(ho(Zr)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===dr.JD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===dr.Ct.HandshakeRequest){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace("NativeMessageHandler.onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(ho(eo))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===dr.Ct.Response){if(!n)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)n.reject(ha(e.code,e.description,e.ext));else{if(!e.result)throw(0,l.pz)(sa.W,"Event does not contain result.");e.result.code&&e.result.description?n.reject(ha(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===dr.Ct.HandshakeResponse){if(!r)return void this.logger.trace("NativeMessageHandler.onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(o)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(o):r&&r.reject(o)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,r){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case i.IO.BEARER:case i.IO.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class wa{constructor(e,t,n,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=o}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(Rn,t.correlationId);try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(r){throw r instanceof Ri&&r.subError===_r?ho(_r):r}return oi(this.handleCodeResponseFromServer.bind(this),In,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(In,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await oi(this.authModule.updateAuthority.bind(this.authModule),xn,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await oi(this.authModule.acquireToken.bind(this.authModule),Nn,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:bi}:e.loginHint?{credential:e.loginHint,type:wi}:null}}function Ca(e,t,n){const r=mt(e);if(!r)throw ft(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),ho(br)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),ho(vr));return r}class Sa extends ia{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e){try{var t;const n={popupName:this.generatePopupName(e.scopes||i.aZ,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(t=e.popupWindowParent)&&void 0!==t?t:window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(n){return Promise.reject(n)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null===e||void 0===e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null===e||void 0===e?void 0:e.popupWindowParent)&&void 0!==t?t:window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");const n=this.initializeServerTelemetryManager(dr.sA.acquireTokenPopup),o=await oi(this.initializeAuthorizationRequest.bind(this),_n,this.logger,this.performanceClient,this.correlationId)(e,dr.X8.Popup);Ho(o.authority);try{const i=await oi(this.initializeAuthorizationCodeRequest.bind(this),An,this.logger,this.performanceClient,this.correlationId)(o),a=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),s=ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let c;s&&(c=this.performanceClient.startMeasurement(en,e.correlationId));const l=await a.getAuthCodeUrl((0,r.A)((0,r.A)({},o),{},{nativeBroker:s})),d=new wa(a,this.browserStorage,i,this.logger,this.performanceClient),u=this.initiateAuthRequest(l,t);this.eventHandler.emitEvent(ki.B.POPUP_OPENED,dr.X8.Popup,{popupWindow:u},null);const h=await this.monitorPopupForHash(u,t.popupWindowParent),p=ri(Ca,Un,this.logger,this.performanceClient,this.correlationId)(h,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(xi.removeThrottle(this.browserStorage,this.config.auth.clientId,i),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw ho(to);const e=new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,p.accountId,this.nativeStorage,o.correlationId),{userRequestState:t}=yi.parseRequestState(this.browserCrypto,o.state);return await e.acquireToken((0,r.A)((0,r.A)({},o),{},{state:t,prompt:void 0}))}return await d.handleCodeResponse(p,o)}catch(a){var i;throw null===(i=t.popup)||void 0===i||i.close(),a instanceof l.lR&&(a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a)),a}}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ki.B.LOGOUT_START,dr.X8.Popup,e);const o=this.initializeServerTelemetryManager(dr.sA.logoutPopup);try{await this.clearCacheOnLogout(e.account);const l=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:n,account:e.account||void 0});try{l.authority.endSessionEndpoint}catch(u){var i;if(null!==(i=e.account)&&void 0!==i&&i.homeAccountId&&e.postLogoutRedirectUri&&l.authority.protocolMode===s){var a,c;if(this.browserStorage.removeAccount(null===(a=e.account)||void 0===a?void 0:a.homeAccountId,this.correlationId),this.eventHandler.emitEvent(ki.B.LOGOUT_SUCCESS,dr.X8.Popup,e),r){const e={apiId:dr.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=gt.getAbsoluteUrl(r,jo());await this.navigationClient.navigateInternal(t,e)}return void(null===(c=t.popup)||void 0===c||c.close())}}const d=l.getLogoutUri(e);this.eventHandler.emitEvent(ki.B.LOGOUT_SUCCESS,dr.X8.Popup,e);const h=this.openPopup(d,t);if(this.eventHandler.emitEvent(ki.B.POPUP_OPENED,dr.X8.Popup,{popupWindow:h},null),await this.monitorPopupForHash(h,t.popupWindowParent).catch(()=>{}),r){const e={apiId:dr.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=gt.getAbsoluteUrl(r,jo());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(h){var d;throw null===(d=t.popup)||void 0===d||d.close(),h instanceof l.lR&&(h.setCorrelationId(this.correlationId),o.cacheFailedRequest(h)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(ki.B.LOGOUT_FAILURE,dr.X8.Popup,null,h),this.eventHandler.emitEvent(ki.B.LOGOUT_END,dr.X8.Popup),h}this.eventHandler.emitEvent(ki.B.LOGOUT_END,dr.X8.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),ho(gr)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(ho(_r));let o="";try{o=e.location.href}catch(c){}if(!o||"about:blank"===o)return;clearInterval(r);let a="";const s=this.config.auth.OIDCOptions.serverResponseType;e&&(a=s===i.zL.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw ho(Er);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),ho(Tr)}}openSizedPopup(e,t){var n,r,o,i;let{popupName:a,popupWindowAttributes:s,popupWindowParent:c}=t;const l=c.screenLeft?c.screenLeft:c.screenX,d=c.screenTop?c.screenTop:c.screenY,u=c.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=c.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let p=null===(n=s.popupSize)||void 0===n?void 0:n.width,f=null===(r=s.popupSize)||void 0===r?void 0:r.height,m=null===(o=s.popupPosition)||void 0===o?void 0:o.top,g=null===(i=s.popupPosition)||void 0===i?void 0:i.left;return(!p||p<0||p>u)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),p=dr.Q1.POPUP_WIDTH),(!f||f<0||f>h)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),f=dr.Q1.POPUP_HEIGHT),(!m||m<0||m>h)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),m=Math.max(0,h/2-dr.Q1.POPUP_HEIGHT/2+d)),(!g||g<0||g>u)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,u/2-dr.Q1.POPUP_WIDTH/2+l)),c.open(e,a,"width=".concat(p,", height=").concat(f,", top=").concat(m,", left=").concat(g,", scrollbars=yes"))}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(dr.X8.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return"".concat(dr.Q1.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(dr.Q1.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class Ta{constructor(e,t,n,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=o}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(dr._p.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(dr._p.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const n={apiId:dr.sA.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"===typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),ho(gr)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const n=this.browserStorage.generateStateKey(t),r=this.browserStorage.getTemporaryCache(n);if(!r)throw ne(w,"Cached State");let o;try{o=this.authModule.handleFragmentResponse(e,r)}catch(c){throw c instanceof Ri&&c.subError===_r?ho(_r):c}const i=this.browserStorage.generateNonceKey(r),a=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=o.code,o.cloud_instance_host_name&&await oi(this.authModule.updateAuthority.bind(this.authModule),xn,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(o.cloud_instance_host_name,this.authCodeRequest.correlationId),o.nonce=a||void 0,o.state=r,o.client_info)this.authCodeRequest.clientInfo=o.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const s=await this.authModule.acquireToken(this.authCodeRequest,o);return this.browserStorage.cleanRequestByState(t),s}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(dr._p.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: ".concat(e))}return null}}class Ea extends ia{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await oi(this.initializeAuthorizationRequest.bind(this),_n,this.logger,this.performanceClient,this.correlationId)(e,dr.X8.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const n=this.initializeServerTelemetryManager(dr.sA.acquireTokenRedirect),o=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(ki.B.RESTORE_FROM_BFCACHE,dr.X8.Redirect))};try{const i=await oi(this.initializeAuthorizationCodeRequest.bind(this),An,this.logger,this.performanceClient,this.correlationId)(t),a=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new Ta(a,this.browserStorage,i,this.logger,this.performanceClient),c=await a.getAuthCodeUrl((0,r.A)((0,r.A)({},t),{},{nativeBroker:ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii("Redirect start page: ".concat(l)),window.addEventListener("pageshow",o),await s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof l.lR&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;const n=this.initializeServerTelemetryManager(dr.sA.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[r,o]=this.getRedirectResponse(e||"");if(!r)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(dr.X8.Redirect),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null===t||void 0===t?void 0:t.type}()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(dr._p.ORIGIN_URI,!0)||i.YM.EMPTY_STRING,s=gt.removeHashFromUrl(a);if(s===gt.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(a);return await this.handleResponse(r,n)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(r,n);if(!Po()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(dr._p.URL_HASH,o,!0);const e={apiId:dr.sA.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(a&&"null"!==a)this.logger.verbose("Navigating to loginRequestUrl: ".concat(a)),t=await this.navigationClient.navigateInternal(a,e);else{const n=function(){const e=new gt(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(dr._p.ORIGIN_URI,n,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(n,e)}if(!t)return await this.handleResponse(r,n)}return null}catch(r){throw r instanceof l.lR&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.browserStorage.cleanRequestByInteractionType(dr.X8.Redirect),r}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===i.zL.QUERY?window.location.search:window.location.hash);let n=mt(t);if(n){try{!function(e,t,n){if(!e.state)throw ho(yr);const r=Ti(t,e.state);if(!r)throw ho(wr);if(r.interactionType!==n)throw ho(Cr)}(n,this.browserCrypto,dr.X8.Redirect)}catch(a){return a instanceof l.lR&&this.logger.error("Interaction type validation failed due to ".concat(a.errorCode,": ").concat(a.errorMessage)),[null,""]}return(r=window).location.hash="","function"===typeof r.history.replaceState&&r.history.replaceState(null,"","".concat(r.location.origin).concat(r.location.pathname).concat(r.location.search)),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}var r;const o=this.browserStorage.getTemporaryCache(dr._p.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(dr._p.URL_HASH)),o&&(n=mt(o),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,o]):[null,""]}async handleResponse(e,t){const n=e.state;if(!n)throw ho(yr);const o=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw ho(to);const t=new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:i}=yi.parseRequestState(this.browserCrypto,n);return t.acquireToken((0,r.A)((0,r.A)({},o),{},{state:i,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(n)})}const i=this.browserStorage.getCachedAuthority(n);if(!i)throw ho(Dr);const a=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});xi.removeThrottle(this.browserStorage,this.config.auth.clientId,o);return new Ta(a,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,n)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(dr.sA.logout);try{this.eventHandler.emitEvent(ki.B.LOGOUT_START,dr.X8.Redirect,e),await this.clearCacheOnLogout(t.account);const a={apiId:dr.sA.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},c=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null===e||void 0===e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(c.authority.protocolMode===s)try{c.authority.endSessionEndpoint}catch(i){var r,o;if(null!==(r=t.account)&&void 0!==r&&r.homeAccountId)return this.browserStorage.removeAccount(null===(o=t.account)||void 0===o?void 0:o.homeAccountId,this.correlationId),void this.eventHandler.emitEvent(ki.B.LOGOUT_SUCCESS,dr.X8.Redirect,t)}const l=c.getLogoutUri(t);if(this.eventHandler.emitEvent(ki.B.LOGOUT_SUCCESS,dr.X8.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(l,a);if(!1!==e.onRedirectNavigate(l))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(l,a);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(a){throw a instanceof l.lR&&(a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a)),this.eventHandler.emitEvent(ki.B.LOGOUT_FAILURE,dr.X8.Redirect,null,a),this.eventHandler.emitEvent(ki.B.LOGOUT_END,dr.X8.Redirect),a}this.eventHandler.emitEvent(ki.B.LOGOUT_END,dr.X8.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return gt.getAbsoluteUrl(t,jo())}}async function _a(e,t,n,r,o){if(t.addQueueMeasurement(bn,r),!e)throw n.info("Navigate url is empty"),ho(gr);return o?oi(ka,Cn,n,t,r)(e,o,t,r):ri(Ia,Sn,n,t,r)(e)}async function Aa(e,t,n,r,o,a,s){return r.addQueueMeasurement(wn,a),new Promise((r,a)=>{t<Fo&&o.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(Fo,"ms). This may result in timeouts."));const c=window.setTimeout(()=>{window.clearInterval(l),a(ho(kr))},t),l=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(a){}if(!t||"about:blank"===t)return;let o="";n&&(o=s===i.zL.QUERY?n.location.search:n.location.hash),window.clearTimeout(c),window.clearInterval(l),r(o)},n)}).finally(()=>{ri(xa,Zn,o,r,a)(e)})}function ka(e,t,n,r){return n.addQueueMeasurement(Cn,r),new Promise((n,r)=>{const o=Ra();window.setTimeout(()=>{o?(o.src=e,n(o)):r("Unable to load iframe")},t)})}function Ia(e){const t=Ra();return t.src=e,t}function Ra(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function xa(e){document.body===e.parentNode&&document.body.removeChild(e)}class Na extends ia{constructor(e,t,n,r,o,i,a,s,c,l,d){super(e,t,n,r,o,i,s,l,d),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Qt,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t=(0,r.A)({},e);t.prompt?t.prompt!==i._M.NONE&&t.prompt!==i._M.NO_SESSION&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(t.prompt," with ").concat(i._M.NONE)),t.prompt=i._M.NONE):t.prompt=i._M.NONE;const n=await oi(this.initializeAuthorizationRequest.bind(this),_n,this.logger,this.performanceClient,e.correlationId)(t,dr.X8.Silent);Ho(n.authority);const o=this.initializeServerTelemetryManager(this.apiId);let a;try{return a=await oi(this.createAuthCodeClient.bind(this),Tn,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await oi(this.silentTokenHelper.bind(this),yn,this.logger,this.performanceClient,e.correlationId)(a,n)}catch(s){if(s instanceof l.lR&&(s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s)),!a||!(s instanceof l.lR)||s.errorCode!==dr.Q1.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);const n=await oi(this.initializeAuthorizationRequest.bind(this),_n,this.logger,this.performanceClient,e.correlationId)(t,dr.X8.Silent);return await oi(this.silentTokenHelper.bind(this),yn,this.logger,this.performanceClient,this.correlationId)(a,n)}}logout(){return Promise.reject(ho(Or))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(yn,n);const o=await oi(this.initializeAuthorizationCodeRequest.bind(this),An,this.logger,this.performanceClient,n)(t),a=await oi(e.getAuthCodeUrl.bind(e),kn,this.logger,this.performanceClient,n)((0,r.A)((0,r.A)({},t),{},{nativeBroker:ba.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)})),s=new wa(e,this.browserStorage,o,this.logger,this.performanceClient),c=await oi(_a,bn,this.logger,this.performanceClient,n)(a,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,d=await oi(Aa,wn,this.logger,this.performanceClient,n)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,l),u=ri(Ca,Un,this.logger,this.performanceClient,this.correlationId)(d,l,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw ho(to);const e=new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,n),{userRequestState:o}=yi.parseRequestState(this.browserCrypto,t.state);return oi(e.acquireToken.bind(e),tn,this.logger,this.performanceClient,n)((0,r.A)((0,r.A)({},t),{},{state:o,prompt:t.prompt||i._M.NONE}))}return oi(s.handleCodeResponse.bind(s),Rn,this.logger,this.performanceClient,n)(u,t)}}class Oa extends ia{async acquireToken(e){this.performanceClient.addQueueMeasurement(Jt,e.correlationId);const t=await oi(ra,mn,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=(0,r.A)((0,r.A)({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const o=this.initializeServerTelemetryManager(dr.sA.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return oi(i.acquireTokenByRefreshToken.bind(i),ln,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e),e})}logout(){return Promise.reject(ho(Or))}async createRefreshTokenClient(e){const t=await oi(this.getClientConfiguration.bind(this),En,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new pa(t,this.performanceClient)}}class Pa{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw ho(Hr);const r=e.correlationId||Io(),o=t.id_token?ae(t.id_token,Jo):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new ai(ai.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Io()):void 0,s=this.loadAccount(e,n.clientInfo||t.client_info||"",r,o,a),c=this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,r),l=this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n,r),d=this.loadRefreshToken(t,s.homeAccountId,s.environment,r);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:d},o,a)}loadAccount(e,t,n,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=pt.createFromAccountInfo(e.account);return this.storage.setAccount(t,n),t}if(!o||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),ho(Gr);const i=pt.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,r),a=null===r||void 0===r?void 0:r.tid,s=Yi(this.storage,o,i,Jo,n,r,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(s,n),s}loadIdToken(e,t,n,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=ue(t,n,e.id_token,this.config.auth.clientId,r);return this.storage.setIdTokenCredential(i,o),i}loadAccessToken(e,t,n,r,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Ze.fromString(t.scope):new Ze(e.scopes),c=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+(new Date).getTime()/1e3,d=he(n,r,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,Jo);return this.storage.setAccessTokenCredential(d,a),d}loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=pe(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(o,r),o}generateAuthenticationResult(e,t,n,r){var o,i,a;let s,c="",l=[],d=null;null!==t&&void 0!==t&&t.accessToken&&(c=t.accessToken.secret,l=Ze.fromString(t.accessToken.target).asArray(),d=new Date(1e3*Number(t.accessToken.expiresOn)),s=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));const u=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:l,account:u.getAccountInfo(),idToken:(null===(o=t.idToken)||void 0===o?void 0:o.secret)||"",idTokenClaims:n||{},accessToken:c,fromCache:!0,expiresOn:d,correlationId:e.correlationId||"",requestId:"",extExpiresOn:s,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null===t||void 0===t||null===(a=t.accessToken)||void 0===a?void 0:a.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}class ja extends $i{constructor(e){super(e),this.includeRedirectUri=!1}}class Ma extends ia{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw ho(Yr);const t=await oi(this.initializeAuthorizationRequest.bind(this),_n,this.logger,this.performanceClient,e.correlationId)(e,dr.X8.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const o=(0,r.A)((0,r.A)({},t),{},{code:e.code}),i=await oi(this.getClientConfiguration.bind(this),En,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new ja(i);this.logger.verbose("Auth code client created");const s=new wa(a,this.browserStorage,o,this.logger,this.performanceClient);return await oi(s.handleCodeResponseFromServer.bind(s),In,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(o){throw o instanceof l.lR&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),o}}logout(){return Promise.reject(ho(Or))}}function La(e){const t=null===e||void 0===e?void 0:e.idTokenClaims;return null!==t&&void 0!==t&&t.tfp||null!==t&&void 0!==t&&t.acr?"B2C":null!==t&&void 0!==t&&t.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===(null===t||void 0===t?void 0:t.tid)?"MSA":"AAD":void 0}function Da(e,t){try{Uo(e)}catch(n){throw t.end({success:!1},n),n}}class Ua{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new ti(this.logger,this.performanceClient):re,this.eventHandler=new Ii(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ai(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw Je(Be)}return{canonicalAuthority:e.authority?si(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth),this.performanceClient):((e,t)=>{const n={cacheLocation:dr.Al.MemoryStorage,temporaryCacheLocation:dr.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Ai(e,n,re,t)})(this.config.auth.clientId,this.logger);const t={cacheLocation:dr.Al.MemoryStorage,temporaryCacheLocation:dr.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ai(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new Pa(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const n=new Ua(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(ki.B.INITIALIZE_END);const t=(null===e||void 0===e?void 0:e.correlationId)||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(vn,t);if(this.eventHandler.emitEvent(ki.B.INITIALIZE_START),n)try{this.nativeExtensionProvider=await ba.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(o){this.logger.verbose(o)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await oi(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),er,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(ki.B.INITIALIZE_END),r.end({allowNativeBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Do(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),r=n&&ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,o=r?null===n||void 0===n?void 0:n.correlationId:this.browserStorage.getTemporaryCache(dr._p.CORRELATION_ID,!0)||"",i=this.performanceClient.startMeasurement(Wt,o);let a;if(this.eventHandler.emitEvent(ki.B.HANDLE_REDIRECT_START,dr.X8.Redirect),r&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=oi(e.handleRedirectPromise.bind(e),Jn,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.createRedirectClient(o);a=oi(t.handleRedirectPromise.bind(t),$n,this.logger,this.performanceClient,i.event.correlationId)(e,i)}return a.then(e=>{if(e){t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ki.B.LOGIN_SUCCESS,dr.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:La(e.account)})}else i.event.errorCode?i.end({success:!1}):i.discard();return this.eventHandler.emitEvent(ki.B.HANDLE_REDIRECT_END,dr.X8.Redirect),e}).catch(e=>{const n=e;throw t.length>0?this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Redirect,null,n):this.eventHandler.emitEvent(ki.B.LOGIN_FAILURE,dr.X8.Redirect,null,n),this.eventHandler.emitEvent(ki.B.HANDLE_REDIRECT_END,dr.X8.Redirect),i.end({success:!1},n),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(zt,t);n.add({accountType:La(e.account),scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=e=>{const t="function"===typeof r?r(e):void 0;return!1!==t?n.end({success:!0}):n.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const r="function"===typeof e?e(t):void 0;return!1!==r?n.end({success:!0}):n.discard(),r}}const o=this.getAllAccounts().length>0;try{let r;if(Bo(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_START,dr.X8.Redirect,e):this.eventHandler.emitEvent(ki.B.LOGIN_START,dr.X8.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)){r=new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(n=>{if(n instanceof da&&ua(n)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(n instanceof mi){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(i){throw n.end({success:!1},i),o?this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Redirect,null,i):this.eventHandler.emitEvent(ki.B.LOGIN_FAILURE,dr.X8.Redirect,null,i),i}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Kt,t);n.add({scenarioId:e.scenarioId,accountType:La(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Da(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(a){return Promise.reject(a)}const o=this.getAllAccounts();let i;if(o.length>0?this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_START,dr.X8.Popup,e):this.eventHandler.emitEvent(ki.B.LOGIN_START,dr.X8.Popup,e),this.canUseNative(e))i=this.acquireTokenNative((0,r.A)((0,r.A)({},e),{},{correlationId:t}),dr.sA.acquireTokenPopup).then(e=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:La(e.account)}),e)).catch(n=>{if(n instanceof da&&ua(n)){this.nativeExtensionProvider=void 0;return this.createPopupClient(t).acquireToken(e)}if(n instanceof mi){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e)}throw this.browserStorage.setInteractionInProgress(!1),n});else{i=this.createPopupClient(t).acquireToken(e)}return i.then(e=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ki.B.LOGIN_SUCCESS,dr.X8.Popup,e):this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:La(e.account)}),e)).catch(e=>(o.length>0?this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Popup,null,e):this.eventHandler.emitEvent(ki.B.LOGIN_FAILURE,dr.X8.Popup,null,e),n.end({success:!1},e),Promise.reject(e)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t,n;const o=this.getRequestCorrelationId(e),i=(0,r.A)((0,r.A)({},e),{},{prompt:e.prompt,correlationId:o});let a;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Xt,o),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({scenarioId:e.scenarioId,accountType:La(e.account)}),Da(this.initialized,this.ssoSilentMeasurement),null===(n=this.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(ki.B.SSO_SILENT_START,dr.X8.Silent,i),this.canUseNative(i))a=this.acquireTokenNative(i,dr.sA.ssoSilent).catch(e=>{if(e instanceof da&&ua(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(i.correlationId).acquireToken(i)}throw e});else{a=this.createSilentIframeClient(i.correlationId).acquireToken(i)}return a.then(e=>{var t;return this.eventHandler.emitEvent(ki.B.SSO_SILENT_SUCCESS,dr.X8.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:La(e.account)}),e}).catch(e=>{var t;throw this.eventHandler.emitEvent(ki.B.SSO_SILENT_FAILURE,dr.X8.Silent,null,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(Bt,t);Da(this.initialized,n),this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_BY_CODE_START,dr.X8.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw ho($r);if(e.code){const o=e.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync((0,r.A)((0,r.A)({},e),{},{correlationId:t})).then(e=>(this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_BY_CODE_SUCCESS,dr.X8.Silent,e),this.hybridAuthCodeResponses.delete(o),n.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:La(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_BY_CODE_FAILURE,dr.X8.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(o,i)),await i}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId)){const o=await this.acquireTokenNative((0,r.A)((0,r.A)({},e),{},{correlationId:t}),dr.sA.acquireTokenByCode,e.nativeAccountId).catch(e=>{throw e instanceof da&&ua(e)&&(this.nativeExtensionProvider=void 0),e});return n.end({accountType:La(o.account),success:!0}),o}throw ho(Xr)}throw ho(Qr)}catch(o){throw this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_BY_CODE_FAILURE,dr.X8.Silent,null,o),n.end({success:!1},o),o}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Qn,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const n=this.createSilentAuthCodeClient(e.correlationId);return await n.acquireToken(e).then(e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e}).catch(e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(un,e.correlationId),t){case dr.nN.Default:case dr.nN.AccessToken:case dr.nN.AccessTokenAndRefreshToken:const t=this.createSilentCacheClient(e.correlationId);return oi(t.acquireToken.bind(t),Yt,this.logger,this.performanceClient,e.correlationId)(e);default:throw ne(q)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Ht,e.correlationId),t){case dr.nN.Default:case dr.nN.AccessTokenAndRefreshToken:case dr.nN.RefreshToken:case dr.nN.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return oi(t.acquireToken.bind(t),Jt,this.logger,this.performanceClient,e.correlationId)(e);default:throw ne(q)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(fn,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return oi(t.acquireToken.bind(t),Qt,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect((0,r.A)({correlationId:t},e))}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Bo(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);Uo(this.initialized),this.browserStorage.setInteractionInProgress(!0);return this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,o){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(r,o):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const o=n.getAccountInfoFilteredBy(e,r);return o?(t.verbose("getAccount: Account matching provided filter found, returning"),o):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const o=n.getAccountInfoFilteredBy({username:e},r);return o?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),o):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=n.getAccountInfoFilteredBy({homeAccountId:e},r);return o?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),o):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const o=n.getAccountInfoFilteredBy({localAccountId:e},r);return o?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),o):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=pt.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw ho(to);return new ya(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case i._M.NONE:case i._M.CONSENT:case i._M.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = ".concat(e.prompt," is not compatible with native flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Sa(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Ea(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Na(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new ma(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Oa(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Ma(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dr.sA.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Lo(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{var t;null!==(t=e.key)&&void 0!==t&&t.includes(i.Gd.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(ki.B.ACTIVE_ACCOUNT_CHANGED);const n=e.newValue||e.oldValue;if(!n)return;const r=JSON.parse(n);if("object"!==typeof r||!pt.isAccountEntity(r))return;const o=kt.toObject(new pt,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(ki.B.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(ki.B.ACCOUNT_REMOVED,void 0,o))}catch(e){return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Io():i.YM.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect((0,r.A)({correlationId:t},e||dr.uq))}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup((0,r.A)({correlationId:t},e||dr.uq))}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Ft,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Da(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const o=e.account||this.getActiveAccount();if(!o)throw ho(Pr);n.add({accountType:La(o)});const a={clientId:this.config.auth.clientId,authority:e.authority||i.YM.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(a),c=this.activeSilentTokenRequests.get(s);if("undefined"===typeof c){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const i=oi(this.acquireTokenSilentAsync.bind(this),qt,this.logger,this.performanceClient,t)((0,r.A)((0,r.A)({},e),{},{correlationId:t}),o).then(t=>(this.activeSilentTokenRequests.delete(s),n.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t)).catch(e=>{throw this.activeSilentTokenRequests.delete(s),n.end({success:!1},e),e});return this.activeSilentTokenRequests.set(s,i),(0,r.A)((0,r.A)({},await i),{},{state:e.state})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),(0,r.A)((0,r.A)({},await c),{},{state:e.state})}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(qt,e.correlationId),this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_START,dr.X8.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await oi(oa,gn,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||dr.nN.Default;return this.acquireTokenSilentNoIframe(r,o).catch(async e=>{const t=function(e,t){const n=!(e instanceof mi&&e.subError!==ui),r=e.errorCode===dr.Q1.INVALID_GRANT_ERROR||e.errorCode===q,o=n&&r||e.errorCode===ci||e.errorCode===di,i=dr.JE.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(o!==dr.nN.Skip){const[t,n]=this.activeIframeRequest;this.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(n),r.correlationId);const i=this.performanceClient.startMeasurement($t,r.correlationId);i.add({awaitIframeCorrelationId:n});const a=await t;if(i.end({success:a}),a)return this.logger.verbose("Parallel iframe request with correlationId: ".concat(n," succeeded. Retrying cache and/or RT redemption"),r.correlationId),this.acquireTokenSilentNoIframe(r,o);throw this.logger.info("Iframe request with correlationId: ".concat(n," failed. Interaction is required.")),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),oi(this.acquireTokenBySilentIframe.bind(this),fn,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),oi(this.acquireTokenBySilentIframe.bind(this),fn,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_SUCCESS,dr.X8.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_FAILURE,dr.X8.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return ba.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,dr.sA.acquireTokenSilent_silentFlow).catch(async e=>{if(e instanceof da&&ua(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ne(q);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),oi(this.acquireTokenFromCache.bind(this),un,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===dr.nN.AccessToken)throw n;return this.eventHandler.emitEvent(ki.B.ACQUIRE_TOKEN_NETWORK_START,dr.X8.Silent,e),oi(this.acquireTokenByRefreshToken.bind(this),Ht,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}class Ba{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new zo(e);return await n.initialize(),Ua.createController(n,t)}(e);return new Ba(e,t)}constructor(e,t){this.controller=t||new Ua(new zo(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var Ha=n(661);const Fa=(()=>{try{if("undefined"===typeof window)return!1;const e=window;return!(!e.crypto||!e.crypto.subtle&&!e.msCrypto)}catch(e){return!1}})()?new Ba({auth:{clientId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLIENT_ID,authority:"https://login.microsoftonline.com/".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_TENANT_ID),redirectUri:"undefined"!==typeof window?window.location.origin:"/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,t,n)=>{try{if(n)return;e===o.$.Error?(0,Ha.z3)("msal",t):e===o.$.Warning?(0,Ha.R8)("msal",t):(0,Ha.pq)("msal",t)}catch(r){}},piiLoggingEnabled:!1,logLevel:o.$.Warning}}}):(()=>{const e=()=>{};return{addEventCallback:e,handleRedirectPromise:async()=>null,setActiveAccount:e,getAllAccounts:()=>[],loginPopup:async()=>{throw new Error("MSAL disabled in this environment")},loginRedirect:async()=>{throw new Error("MSAL disabled in this environment")},acquireTokenSilent:async()=>{throw new Error("MSAL disabled in this environment")},acquireTokenPopup:async()=>{throw new Error("MSAL disabled in this environment")},logoutPopup:async()=>{}}})();try{Fa.addEventCallback(e=>{try{const t=e&&e.eventType||"msal_event",n=e&&e.payload||{};(0,Ha.pq)("msal:event",{type:t,payload:n})}catch(t){try{(0,Ha.z3)("msal:event logging failed",t)}catch(n){}}})}catch(qa){}},335:(e,t,n)=>{n.d(t,{W:()=>r,z:()=>o});const r="unexpected_error",o="post_request_failed"},385:(e,t,n)=>{n.d(t,{$x:()=>g,E_:()=>E,F0:()=>M,Fq:()=>u,GU:()=>w,Gd:()=>l,I:()=>I,IO:()=>A,JR:()=>C,Kk:()=>x,LR:()=>y,Lz:()=>j,OK:()=>c,Qd:()=>v,Rv:()=>P,Tq:()=>R,Xw:()=>k,YM:()=>o,_2:()=>O,_A:()=>s,_M:()=>h,aG:()=>b,aZ:()=>a,gT:()=>_,hB:()=>S,iF:()=>p,jZ:()=>N,p:()=>m,t3:()=>i,u0:()=>T,v2:()=>d,zL:()=>f});var r=n(555);const o={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},i={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},a=[o.OPENID_SCOPE,o.PROFILE_SCOPE,o.OFFLINE_ACCESS_SCOPE],s=[...a,o.EMAIL_SCOPE],c={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},l={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},d={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},u={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},h={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},p={PLAIN:"plain",S256:"S256"},f={QUERY:"query",FRAGMENT:"fragment"},m=(0,r.A)((0,r.A)({},f),{},{FORM_POST:"form_post"}),g={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},v={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},y={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},b={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},w="appmetadata",C="client_info",S="1",T={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},E={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},_={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},A={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},k={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},I={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},R={username:"username",password:"password"},x={httpSuccess:200,httpBadRequest:400},N={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},O={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},P={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},j={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},M=300},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},498:(e,t,n)=>{n.d(t,{B:()=>r});const r={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"}},552:(e,t,n)=>{n.d(t,{dg:()=>o,jE:()=>i,xz:()=>r});const r="storage_not_supported",o="stubbed_public_client_application_called",i="in_mem_redirect_unavailable"},555:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>s})},579:(e,t,n)=>{e.exports=n(153)},623:(e,t,n)=>{n.d(t,{$:()=>r,V:()=>i});var r,o=n(385);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(r||(r={}));class i{constructor(e,t,n){this.level=r.Info;const a=e||i.createDefaultLoggerOptions();this.localCallback=a.loggerCallback||(()=>{}),this.piiLoggingEnabled=a.piiLoggingEnabled||!1,this.level="number"===typeof a.logLevel?a.logLevel:r.Info,this.correlationId=a.correlationId||o.YM.EMPTY_STRING,this.packageName=t||o.YM.EMPTY_STRING,this.packageVersion=n||o.YM.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:r.Info}}clone(e,t,n){return new i({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=(new Date).toUTCString(),o="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(o," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(r[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!1,correlationId:t||o.YM.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!0,correlationId:t||o.YM.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!1,correlationId:t||o.YM.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!0,correlationId:t||o.YM.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!1,correlationId:t||o.YM.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!0,correlationId:t||o.YM.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!1,correlationId:t||o.YM.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!0,correlationId:t||o.YM.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!1,correlationId:t||o.YM.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!0,correlationId:t||o.YM.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},648:(e,t,n)=>{n.d(t,{$u:()=>y,Al:()=>s,CC:()=>c,Ct:()=>a,G8:()=>b,H3:()=>u,JD:()=>i,JE:()=>S,L$:()=>T,P3:()=>E,Q1:()=>o,T$:()=>f,WJ:()=>w,X8:()=>p,_p:()=>l,dh:()=>d,f7:()=>v,jb:()=>g,nN:()=>C,sA:()=>h,uq:()=>m});var r=n(385);const o={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},i={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},a={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},s={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},c={GET:"GET",POST:"POST"},l={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},d={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},u={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},h={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var p;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(p||(p={}));const f={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},m={scopes:r.aZ},g="jwk",v={React:"@azure/msal-react",Angular:"@azure/msal-angular"},y="msal.db",b=1,w="".concat(y,".keys"),C={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},S=[C.Default,C.Skip,C.RefreshTokenAndNetwork],T="msal.browser.log.level",E="msal.browser.log.pii"},661:(e,t,n)=>{n.d(t,{R8:()=>a,b:()=>r,pq:()=>i,z3:()=>s});const r=()=>{window.__sunbethLogs||(window.__sunbethLogs=[])},o=(e,t,n)=>{try{const o={ts:(new Date).toISOString(),level:e,msg:t,meta:n};"error"===e?console.error("[sunbeth]",t,n):"warn"===e?console.warn("[sunbeth]",t,n):console.log("[sunbeth]",t,n);const i=window;i.__sunbethLogs||r(),i.__sunbethLogs.push(o),i.__sunbethLogs.length>200&&i.__sunbethLogs.shift()}catch(o){}},i=(e,t)=>o("info",e,t),a=(e,t)=>o("warn",e,t),s=(e,t)=>o("error",e,t)},730:(e,t,n)=>{var r=n(43),o=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!u.call(f,e)||!u.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var L,D=Object.assign;function U(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var B=!1;function H(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var o=l.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s]){var c="\n"+o[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function F(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case S:return"Portal";case _:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case x:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function K(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return D({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var n=z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+z(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return D({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:z(n)}}function ie(e,t){var n=z(t.value),r=z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Te=null,Ee=null;function _e(e){if(e=wo(e)){if("function"!==typeof Se)throw Error(i(280));var t=e.stateNode;t&&(t=So(t),Se(e.stateNode,e.type,t))}}function Ae(e){Te?Ee?Ee.push(e):Ee=[e]:Te=e}function ke(){if(Te){var e=Te,t=Ee;if(Ee=Te=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ie(e,t){return e(t)}function Re(){}var xe=!1;function Ne(e,t,n){if(xe)return e(t,n);xe=!0;try{return Ie(e,t,n)}finally{xe=!1,(null!==Te||null!==Ee)&&(Re(),ke())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=So(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Pe=!1;if(d)try{var je={};Object.defineProperty(je,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(de){Pe=!1}function Me(e,t,n,r,o,i,a,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(d){this.onError(d)}}var Le=!1,De=null,Ue=!1,Be=null,He={onError:function(e){Le=!0,De=e}};function Fe(e,t,n,r,o,i,a,s,c){Le=!1,De=null,Me.apply(He,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ke(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(qe(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var a=o.alternate;if(null===a){if(null!==(r=o.return)){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return ze(o),e;if(a===r)return ze(o),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=a;else{for(var s=!1,c=o.child;c;){if(c===n){s=!0,n=o,r=a;break}if(c===r){s=!0,r=o,n=a;break}c=c.sibling}if(!s){for(c=a.child;c;){if(c===n){s=!0,n=a,r=o;break}if(c===r){s=!0,r=a,n=o;break}c=c.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ve=o.unstable_scheduleCallback,Ye=o.unstable_cancelCallback,Qe=o.unstable_shouldYield,$e=o.unstable_requestPaint,Je=o.unstable_now,Xe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~o;0!==s?r=ut(s):0!==(i&=a)&&(r=ut(i))}else 0!==(a=n&~o)?r=ut(a):0!==i&&(r=ut(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Ct,St,Tt,Et,_t,At=!1,kt=[],It=null,Rt=null,xt=null,Nt=new Map,Ot=new Map,Pt=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":xt=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Lt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=wo(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Dt(e){var t=bo(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ke(n)))return e.blockedOn=t,void _t(e.priority,function(){Tt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wo(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Bt(e,t,n){Ut(e)&&n.delete(t)}function Ht(){At=!1,null!==It&&Ut(It)&&(It=null),null!==Rt&&Ut(Rt)&&(Rt=null),null!==xt&&Ut(xt)&&(xt=null),Nt.forEach(Bt),Ot.forEach(Bt)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ht)))}function qt(e){function t(t){return Ft(t,e)}if(0<kt.length){Ft(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Ft(It,e),null!==Rt&&Ft(Rt,e),null!==xt&&Ft(xt,e),Nt.forEach(t),Ot.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Dt(n),null===n.blockedOn&&Pt.shift()}var Kt=w.ReactCurrentBatchConfig,zt=!0;function Wt(e,t,n,r){var o=bt,i=Kt.transition;Kt.transition=null;try{bt=1,Vt(e,t,n,r)}finally{bt=o,Kt.transition=i}}function Gt(e,t,n,r){var o=bt,i=Kt.transition;Kt.transition=null;try{bt=4,Vt(e,t,n,r)}finally{bt=o,Kt.transition=i}}function Vt(e,t,n,r){if(zt){var o=Qt(e,t,n,r);if(null===o)zr(e,t,r,Yt,n),Mt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return It=Lt(It,e,t,n,r,o),!0;case"dragenter":return Rt=Lt(Rt,e,t,n,r,o),!0;case"mouseover":return xt=Lt(xt,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Nt.set(i,Lt(Nt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ot.set(i,Lt(Ot.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<jt.indexOf(e)){for(;null!==o;){var i=wo(o);if(null!==i&&Ct(i),null===(i=Qt(e,t,n,r))&&zr(e,t,r,Yt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else zr(e,t,r,null,n)}}var Yt=null;function Qt(e,t,n,r){if(Yt=null,null!==(e=bo(e=Ce(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ke(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,o="value"in Jt?Jt.value:Jt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=on(ln),un=D({},ln,{view:0,detail:0}),hn=on(un),pn=D({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(an=e.screenX-cn.screenX,sn=e.screenY-cn.screenY):sn=an=0,cn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(D({},pn,{dataTransfer:0})),gn=on(D({},un,{relatedTarget:0})),vn=on(D({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=D({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),wn=on(D({},ln,{data:0})),Cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function _n(){return En}var An=D({},un,{key:function(e){if(e.key){var t=Cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=on(An),In=on(D({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=on(D({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),xn=on(D({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=D({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=on(Nn),Pn=[9,13,27,32],jn=d&&"CompositionEvent"in window,Mn=null;d&&"documentMode"in document&&(Mn=document.documentMode);var Ln=d&&"TextEvent"in window&&!Mn,Dn=d&&(!jn||Mn&&8<Mn&&11>=Mn),Un=String.fromCharCode(32),Bn=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Kn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ae(r),0<(t=Gr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Vn=null;function Yn(e){Ur(e,0)}function Qn(e){if(V(Co(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Vn=Gn=null)}function nr(e){if("value"===e.propertyName&&Qn(Vn)){var t=[];Wn(t,Vn,e,Ce(e)),Ne(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Vn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Vn)}function ir(e,t){if("click"===e)return Qn(t)}function ar(e,t){if("input"===e||"change"===e)return Qn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!u.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=dr(n,i);var a=dr(n,r);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Cr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:Cr("Animation","AnimationEnd"),animationiteration:Cr("Animation","AnimationIteration"),animationstart:Cr("Animation","AnimationStart"),transitionend:Cr("Transition","TransitionEnd")},Tr={},Er={};function _r(e){if(Tr[e])return Tr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Tr[e]=n[t];return e}d&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Ar=_r("animationend"),kr=_r("animationiteration"),Ir=_r("animationstart"),Rr=_r("transitionend"),xr=new Map,Nr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){xr.set(e,t),c(t,[e])}for(var Pr=0;Pr<Nr.length;Pr++){var jr=Nr[Pr];Or(jr.toLowerCase(),"on"+(jr[0].toUpperCase()+jr.slice(1)))}Or(Ar,"onAnimationEnd"),Or(kr,"onAnimationIteration"),Or(Ir,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Rr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Dr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,a,s,c,l){if(Fe.apply(this,arguments),Le){if(!Le)throw Error(i(198));var d=De;Le=!1,De=null,Ue||(Ue=!0,Be=d)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==i&&o.isPropagationStopped())break e;Dr(o,s,l),i=c}else for(a=0;a<r.length;a++){if(c=(s=r[a]).instance,l=s.currentTarget,s=s.listener,c!==i&&o.isPropagationStopped())break e;Dr(o,s,l),i=c}}}if(Ue)throw e=Be,Ue=!1,Be=null,e}function Br(e,t){var n=t[go];void 0===n&&(n=t[go]=new Set);var r=e+"__bubble";n.has(r)||(Kr(t,e,2,!1),n.add(r))}function Hr(e,t,n){var r=0;t&&(r|=4),Kr(n,e,r,t)}var Fr="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Fr]){e[Fr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Hr(t,!1,e),Hr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fr]||(t[Fr]=!0,Hr("selectionchange",!1,t))}}function Kr(e,t,n,r){switch($t(t)){case 1:var o=Wt;break;case 4:o=Gt;break;default:o=Vt}n=o.bind(null,t,n,e),o=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function zr(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&((c=a.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=bo(s)))return;if(5===(c=a.tag)||6===c){r=i=a;continue e}s=s.parentNode}}r=r.return}Ne(function(){var r=i,o=Ce(n),a=[];e:{var s=xr.get(e);if(void 0!==s){var c=dn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=kn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Rn;break;case Ar:case kr:case Ir:c=vn;break;case Rr:c=xn;break;case"scroll":c=hn;break;case"wheel":c=On;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=In}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==s?s+"Capture":null:s;d=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Oe(f,h))&&d.push(Wr(f,m,p)))),u)break;f=f.return}0<d.length&&(s=new c(s,l,null,n,o),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===we||!(l=n.relatedTarget||n.fromElement)||!bo(l)&&!l[mo])&&(c||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?bo(l):null)&&(l!==(u=qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(d=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=In,m="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==c?s:Co(c),p=null==l?s:Co(l),(s=new d(m,f+"leave",c,n,o)).target=u,s.relatedTarget=p,m=null,bo(o)===r&&((d=new d(h,f+"enter",l,n,o)).target=p,d.relatedTarget=u,m=d),u=m,c&&l)e:{for(h=l,f=0,p=d=c;p;p=Vr(p))f++;for(p=0,m=h;m;m=Vr(m))p++;for(;0<f-p;)d=Vr(d),f--;for(;0<p-f;)h=Vr(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Vr(d),h=Vr(h)}d=null}else d=null;null!==c&&Yr(a,s,c,d,!1),null!==l&&null!==u&&Yr(a,u,l,d,!0)}if("select"===(c=(s=r?Co(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var g=$n;else if(zn(s))if(Jn)g=ar;else{g=or;var v=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ir);switch(g&&(g=g(e,r))?Wn(a,g,n,o):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?Co(r):window,e){case"focusin":(zn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,o);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(a,n,o)}var y;if(jn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qn?Hn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Dn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(y=en()):(Xt="value"in(Jt=o)?Jt.value:Jt.textContent,qn=!0)),0<(v=Gr(r,b)).length&&(b=new wn(b,e,null,n,o),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Fn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:(Bn=!0,Un);case"textInput":return(e=t.data)===Un&&Bn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!jn&&Hn(e,t)?(e=en(),Zt=Xt=Jt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(o=new wn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=y))}Ur(a,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Oe(e,n))&&r.unshift(Wr(e,i,o)),null!=(i=Oe(e,t))&&r.push(Wr(e,i,o))),e=e.return}return r}function Vr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==l&&(s=l,o?null!=(c=Oe(n,i))&&a.unshift(Wr(n,c,s)):o||null!=(c=Oe(n,i))&&a.push(Wr(n,c,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace($r,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,io="function"===typeof Promise?Promise:void 0,ao="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof io?function(e){return io.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout(function(){throw e})}function co(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);qt(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),po="__reactFiber$"+ho,fo="__reactProps$"+ho,mo="__reactContainer$"+ho,go="__reactEvents$"+ho,vo="__reactListeners$"+ho,yo="__reactHandles$"+ho;function bo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mo]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[po])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function wo(e){return!(e=e[po]||e[mo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Co(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function So(e){return e[fo]||null}var To=[],Eo=-1;function _o(e){return{current:e}}function Ao(e){0>Eo||(e.current=To[Eo],To[Eo]=null,Eo--)}function ko(e,t){Eo++,To[Eo]=e.current,e.current=t}var Io={},Ro=_o(Io),xo=_o(!1),No=Io;function Oo(e,t){var n=e.type.contextTypes;if(!n)return Io;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Po(e){return null!==(e=e.childContextTypes)&&void 0!==e}function jo(){Ao(xo),Ao(Ro)}function Mo(e,t,n){if(Ro.current!==Io)throw Error(i(168));ko(Ro,t),ko(xo,n)}function Lo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(i(108,K(e)||"Unknown",o));return D({},n,r)}function Do(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Io,No=Ro.current,ko(Ro,e),ko(xo,xo.current),!0}function Uo(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Lo(e,t,No),r.__reactInternalMemoizedMergedChildContext=e,Ao(xo),Ao(Ro),ko(Ro,e)):Ao(xo),ko(xo,n)}var Bo=null,Ho=!1,Fo=!1;function qo(e){null===Bo?Bo=[e]:Bo.push(e)}function Ko(){if(!Fo&&null!==Bo){Fo=!0;var e=0,t=bt;try{var n=Bo;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Bo=null,Ho=!1}catch(o){throw null!==Bo&&(Bo=Bo.slice(e+1)),Ve(Ze,Ko),o}finally{bt=t,Fo=!1}}return null}var zo=[],Wo=0,Go=null,Vo=0,Yo=[],Qo=0,$o=null,Jo=1,Xo="";function Zo(e,t){zo[Wo++]=Vo,zo[Wo++]=Go,Go=e,Vo=t}function ei(e,t,n){Yo[Qo++]=Jo,Yo[Qo++]=Xo,Yo[Qo++]=$o,$o=e;var r=Jo;e=Xo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var i=32-at(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Jo=1<<32-at(t)+o|n<<o|r,Xo=i+e}else Jo=1<<i|n<<o|r,Xo=e}function ti(e){null!==e.return&&(Zo(e,1),ei(e,1,0))}function ni(e){for(;e===Go;)Go=zo[--Wo],zo[Wo]=null,Vo=zo[--Wo],zo[Wo]=null;for(;e===$o;)$o=Yo[--Qo],Yo[Qo]=null,Xo=Yo[--Qo],Yo[Qo]=null,Jo=Yo[--Qo],Yo[Qo]=null}var ri=null,oi=null,ii=!1,ai=null;function si(e,t){var n=Nl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ci(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,oi=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$o?{id:Jo,overflow:Xo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ri=e,oi=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function di(e){if(ii){var t=oi;if(t){var n=t;if(!ci(e,t)){if(li(e))throw Error(i(418));t=lo(n.nextSibling);var r=ri;t&&ci(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ii=!1,ri=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ri=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ii)return ui(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oi)){if(li(e))throw pi(),Error(i(418));for(;t;)si(e,t),t=lo(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oi=lo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oi=null}}else oi=ri?lo(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=oi;e;)e=lo(e.nextSibling)}function fi(){oi=ri=null,ii=!1}function mi(e){null===ai?ai=[e]:ai.push(e)}var gi=w.ReactCurrentBatchConfig;function vi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=o.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function wi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Pl(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Dl(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===T?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&bi(i)===t.type)?((r=o(t,n.props)).ref=vi(e,t,n),r.return=e,r):((r=jl(n.type,n.key,n.props,null,e.mode,r)).ref=vi(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ul(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function u(e,t,n,r,i){return null===t||7!==t.tag?((t=Ml(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case C:return(n=jl(t.type,t.key,t.props,null,e.mode,n)).ref=vi(e,null,t),n.return=e,n;case S:return(t=Ul(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Ml(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===o?l(e,t,n,r):null;case S:return n.key===o?d(e,t,n,r):null;case O:return p(e,t,(o=n._init)(n._payload),r)}if(te(n)||M(n))return null!==o?null:u(e,t,n,r,null);yi(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case C:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case S:return d(t,e=e.get(null===r.key?n:r.key)||null,r,o);case O:return f(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||M(r))return u(t,e=e.get(n)||null,r,o,null);yi(t,r)}return null}function m(o,i,s,c){for(var l=null,d=null,u=i,m=i=0,g=null;null!==u&&m<s.length;m++){u.index>m?(g=u,u=null):g=u.sibling;var v=p(o,u,s[m],c);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(o,u),i=a(v,i,m),null===d?l=v:d.sibling=v,d=v,u=g}if(m===s.length)return n(o,u),ii&&Zo(o,m),l;if(null===u){for(;m<s.length;m++)null!==(u=h(o,s[m],c))&&(i=a(u,i,m),null===d?l=u:d.sibling=u,d=u);return ii&&Zo(o,m),l}for(u=r(o,u);m<s.length;m++)null!==(g=f(u,o,m,s[m],c))&&(e&&null!==g.alternate&&u.delete(null===g.key?m:g.key),i=a(g,i,m),null===d?l=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(o,e)}),ii&&Zo(o,m),l}function g(o,s,c,l){var d=M(c);if("function"!==typeof d)throw Error(i(150));if(null==(c=d.call(c)))throw Error(i(151));for(var u=d=null,m=s,g=s=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(o,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(o,m),s=a(b,s,g),null===u?d=b:u.sibling=b,u=b,m=v}if(y.done)return n(o,m),ii&&Zo(o,g),d;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(o,y.value,l))&&(s=a(y,s,g),null===u?d=y:u.sibling=y,u=y);return ii&&Zo(o,g),d}for(m=r(o,m);!y.done;g++,y=c.next())null!==(y=f(m,o,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===u?d=y:u.sibling=y,u=y);return e&&m.forEach(function(e){return t(o,e)}),ii&&Zo(o,g),d}return function e(r,i,a,c){if("object"===typeof a&&null!==a&&a.type===T&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case C:e:{for(var l=a.key,d=i;null!==d;){if(d.key===l){if((l=a.type)===T){if(7===d.tag){n(r,d.sibling),(i=o(d,a.props.children)).return=r,r=i;break e}}else if(d.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&bi(l)===d.type){n(r,d.sibling),(i=o(d,a.props)).ref=vi(r,d,a),i.return=r,r=i;break e}n(r,d);break}t(r,d),d=d.sibling}a.type===T?((i=Ml(a.props.children,r.mode,c,a.key)).return=r,r=i):((c=jl(a.type,a.key,a.props,null,r.mode,c)).ref=vi(r,i,a),c.return=r,r=c)}return s(r);case S:e:{for(d=a.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=o(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Ul(a,r.mode,c)).return=r,r=i}return s(r);case O:return e(r,i,(d=a._init)(a._payload),c)}if(te(a))return m(r,i,a,c);if(M(a))return g(r,i,a,c);yi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,a)).return=r,r=i):(n(r,i),(i=Dl(a,r.mode,c)).return=r,r=i),s(r)):n(r,i)}}var Ci=wi(!0),Si=wi(!1),Ti=_o(null),Ei=null,_i=null,Ai=null;function ki(){Ai=_i=Ei=null}function Ii(e){var t=Ti.current;Ao(Ti),e._currentValue=t}function Ri(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xi(e,t){Ei=e,Ai=_i=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ni(e){var t=e._currentValue;if(Ai!==e)if(e={context:e,memoizedValue:t,next:null},null===_i){if(null===Ei)throw Error(i(308));_i=e,Ei.dependencies={lanes:0,firstContext:e}}else _i=_i.next=e;return t}var Oi=null;function Pi(e){null===Oi?Oi=[e]:Oi.push(e)}function ji(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Pi(t)):(n.next=o.next,o.next=n),t.interleaved=n,Mi(e,r)}function Mi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Li=!1;function Di(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Hi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ic)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Mi(e,n)}return null===(o=r.interleaved)?(t.next=t,Pi(r)):(t.next=o.next,o.next=t),r.interleaved=t,Mi(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function qi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ki(e,t,n,r){var o=e.updateQueue;Li=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?i=l:a.next=l,a=c;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===s?d.firstBaseUpdate=l:s.next=l,d.lastBaseUpdate=c))}if(null!==i){var u=o.baseState;for(a=0,d=l=c=null,s=i;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){u=f.call(p,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,u,h):f)||void 0===h)break e;u=D({},u,h);break e;case 2:Li=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(l=d=p,c=u):d=d.next=p,a|=h;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(h=s).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===d&&(c=u),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=d,null!==(t=o.shared.interleaved)){o=t;do{a|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Lc|=a,e.lanes=a,e.memoizedState=u}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(i(191,o));o.call(r)}}}var Wi={},Gi=_o(Wi),Vi=_o(Wi),Yi=_o(Wi);function Qi(e){if(e===Wi)throw Error(i(174));return e}function $i(e,t){switch(ko(Yi,t),ko(Vi,e),ko(Gi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ao(Gi),ko(Gi,t)}function Ji(){Ao(Gi),Ao(Vi),Ao(Yi)}function Xi(e){Qi(Yi.current);var t=Qi(Gi.current),n=ce(t,e.type);t!==n&&(ko(Vi,e),ko(Gi,n))}function Zi(e){Vi.current===e&&(Ao(Gi),Ao(Vi))}var ea=_o(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var oa=w.ReactCurrentDispatcher,ia=w.ReactCurrentBatchConfig,aa=0,sa=null,ca=null,la=null,da=!1,ua=!1,ha=0,pa=0;function fa(){throw Error(i(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,o,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,oa.current=null===e||null===e.memoizedState?Za:es,e=n(r,o),ua){a=0;do{if(ua=!1,ha=0,25<=a)throw Error(i(301));a+=1,la=ca=null,t.updateQueue=null,oa.current=ts,e=n(r,o)}while(ua)}if(oa.current=Xa,t=null!==ca&&null!==ca.next,aa=0,la=ca=sa=null,da=!1,t)throw Error(i(300));return e}function va(){var e=0!==ha;return ha=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?sa.memoizedState=la=e:la=la.next=e,la}function ba(){if(null===ca){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=ca.next;var t=null===la?sa.memoizedState:la.next;if(null!==t)la=t,ca=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ca=e).memoizedState,baseState:ca.baseState,baseQueue:ca.baseQueue,queue:ca.queue,next:null},null===la?sa.memoizedState=la=e:la=la.next=e}return la}function wa(e,t){return"function"===typeof t?t(e):t}function Ca(e){var t=ba(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ca,o=r.baseQueue,a=n.pending;if(null!==a){if(null!==o){var s=o.next;o.next=a.next,a.next=s}r.baseQueue=o=a,n.pending=null}if(null!==o){a=o.next,r=r.baseState;var c=s=null,l=null,d=a;do{var u=d.lane;if((aa&u)===u)null!==l&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===l?(c=l=h,s=r):l=l.next=h,sa.lanes|=u,Lc|=u}d=d.next}while(null!==d&&d!==a);null===l?s=r:l.next=c,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{a=o.lane,sa.lanes|=a,Lc|=a,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sa(e){var t=ba(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{a=e(a,s.action),s=s.next}while(s!==o);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Ta(){}function Ea(e,t){var n=sa,r=ba(),o=t(),a=!sr(r.memoizedState,o);if(a&&(r.memoizedState=o,bs=!0),r=r.queue,La(ka.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Na(9,Aa.bind(null,n,r,o,t),void 0,null),null===Rc)throw Error(i(349));0!==(30&aa)||_a(n,t,o)}return o}function _a(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Aa(e,t,n,r){t.value=n,t.getSnapshot=r,Ia(t)&&Ra(e)}function ka(e,t,n){return n(function(){Ia(t)&&Ra(e)})}function Ia(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ra(e){var t=Mi(e,1);null!==t&&nl(t,e,1,-1)}function xa(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ya.bind(null,sa,e),[t.memoizedState,e]}function Na(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Oa(){return ba().memoizedState}function Pa(e,t,n,r){var o=ya();sa.flags|=e,o.memoizedState=Na(1|t,n,void 0,void 0===r?null:r)}function ja(e,t,n,r){var o=ba();r=void 0===r?null:r;var i=void 0;if(null!==ca){var a=ca.memoizedState;if(i=a.destroy,null!==r&&ma(r,a.deps))return void(o.memoizedState=Na(t,n,i,r))}sa.flags|=e,o.memoizedState=Na(1|t,n,i,r)}function Ma(e,t){return Pa(8390656,8,e,t)}function La(e,t){return ja(2048,8,e,t)}function Da(e,t){return ja(4,2,e,t)}function Ua(e,t){return ja(4,4,e,t)}function Ba(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ha(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ja(4,4,Ba.bind(null,t,e),n)}function Fa(){}function qa(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ka(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function za(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),sa.lanes|=n,Lc|=n,e.baseState=!0),t)}function Wa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=n,ia.transition=r}}function Ga(){return ba().memoizedState}function Va(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))$a(t,n);else if(null!==(n=ji(e,t,n,r))){nl(n,e,r,el()),Ja(n,t,r)}}function Ya(e,t,n){var r=tl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))$a(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,a)){var c=t.interleaved;return null===c?(o.next=o,Pi(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(l){}null!==(n=ji(e,t,o,r))&&(nl(n,e,r,o=el()),Ja(n,t,r))}}function Qa(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function $a(e,t){ua=da=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xa={readContext:Ni,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:Ni,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ni,useEffect:Ma,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4194308,4,Ba.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Va.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:xa,useDebugValue:Fa,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=xa(!1),t=e[0];return e=Wa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,o=ya();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Rc)throw Error(i(349));0!==(30&aa)||_a(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,Ma(ka.bind(null,r,a,e),[e]),r.flags|=2048,Na(9,Aa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Rc.identifierPrefix;if(ii){var n=Xo;t=":"+t+"R"+(n=(Jo&~(1<<32-at(Jo)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ni,useCallback:qa,useContext:Ni,useEffect:La,useImperativeHandle:Ha,useInsertionEffect:Da,useLayoutEffect:Ua,useMemo:Ka,useReducer:Ca,useRef:Oa,useState:function(){return Ca(wa)},useDebugValue:Fa,useDeferredValue:function(e){return za(ba(),ca.memoizedState,e)},useTransition:function(){return[Ca(wa)[0],ba().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1},ts={readContext:Ni,useCallback:qa,useContext:Ni,useEffect:La,useImperativeHandle:Ha,useInsertionEffect:Da,useLayoutEffect:Ua,useMemo:Ka,useReducer:Sa,useRef:Oa,useState:function(){return Sa(wa)},useDebugValue:Fa,useDeferredValue:function(e){var t=ba();return null===ca?t.memoizedState=e:za(t,ca.memoizedState,e)},useTransition:function(){return[Sa(wa)[0],ba().memoizedState]},useMutableSource:Ta,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=D({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:D({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var os={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),i=Bi(r,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Hi(e,i,o))&&(nl(t,e,o,r),Fi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),i=Bi(r,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Hi(e,i,o))&&(nl(t,e,o,r),Fi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),o=Bi(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Hi(e,o,r))&&(nl(t,e,r,n),Fi(t,e,r))}};function is(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(o,i))}function as(e,t,n){var r=!1,o=Io,i=t.contextType;return"object"===typeof i&&null!==i?i=Ni(i):(o=Po(t)?No:Ro.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oo(e,o):Io),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=os,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&os.enqueueReplaceState(t,t.state,null)}function cs(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Di(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=Ni(i):(i=Po(t)?No:Ro.current,o.context=Oo(e,i)),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(rs(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&os.enqueueReplaceState(o,o.state,null),Ki(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var n="",r=t;do{n+=F(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Bi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zc||(zc=!0,Wc=r),us(0,t)},n}function fs(e,t,n){(n=Bi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){us(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){us(0,t),"function"!==typeof r&&(null===Gc?Gc=new Set([this]):Gc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=_l.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bi(-1,1)).tag=2,Hi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var ys=w.ReactCurrentOwner,bs=!1;function ws(e,t,n,r){t.child=null===e?Si(t,null,n,r):Ci(t,e.child,n,r)}function Cs(e,t,n,r,o){n=n.render;var i=t.ref;return xi(t,o),r=ga(e,t,n,r,i,o),n=va(),null===e||bs?(ii&&n&&ti(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,zs(e,t,o))}function Ss(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||Ol(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=jl(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ts(e,t,i,r,o))}if(i=e.child,0===(e.lanes&o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(a,r)&&e.ref===t.ref)return zs(e,t,o)}return t.flags|=1,(e=Pl(i,r)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(cr(i,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=i,0===(e.lanes&o))return t.lanes=e.lanes,zs(e,t,o);0!==(131072&e.flags)&&(bs=!0)}}return As(e,t,n,r,o)}function Es(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ko(Pc,Oc),Oc|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ko(Pc,Oc),Oc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,ko(Pc,Oc),Oc|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,ko(Pc,Oc),Oc|=r;return ws(e,t,o,n),t.child}function _s(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,n,r,o){var i=Po(n)?No:Ro.current;return i=Oo(t,i),xi(t,o),n=ga(e,t,n,r,i,o),r=va(),null===e||bs?(ii&&r&&ti(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,zs(e,t,o))}function ks(e,t,n,r,o){if(Po(n)){var i=!0;Do(t)}else i=!1;if(xi(t,o),null===t.stateNode)Ks(e,t),as(t,n,r),cs(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var c=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=Ni(l):l=Oo(t,l=Po(n)?No:Ro.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||c!==l)&&ss(t,a,r,l),Li=!1;var h=t.memoizedState;a.state=h,Ki(t,r,a,o),c=t.memoizedState,s!==r||h!==c||xo.current||Li?("function"===typeof d&&(rs(t,n,d,r),c=t.memoizedState),(s=Li||is(t,n,s,r,h,c,l))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=l,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ui(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:ns(t.type,s),a.props=l,u=t.pendingProps,h=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=Ni(c):c=Oo(t,c=Po(n)?No:Ro.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==u||h!==c)&&ss(t,a,r,c),Li=!1,h=t.memoizedState,a.state=h,Ki(t,r,a,o);var f=t.memoizedState;s!==u||h!==f||xo.current||Li?("function"===typeof p&&(rs(t,n,p,r),f=t.memoizedState),(l=Li||is(t,n,l,r,h,f,c)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=c,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Is(e,t,n,r,i,o)}function Is(e,t,n,r,o,i){_s(e,t);var a=0!==(128&t.flags);if(!r&&!a)return o&&Uo(t,n,!1),zs(e,t,i);r=t.stateNode,ys.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Ci(t,e.child,null,i),t.child=Ci(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,o&&Uo(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Mo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mo(0,t.context,!1),$i(e,t.containerInfo)}function xs(e,t,n,r,o){return fi(),mi(o),t.flags|=256,ws(e,t,n,r),t.child}var Ns,Os,Ps,js,Ms={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ds(e,t,n){var r,o=t.pendingProps,a=ea.current,s=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),ko(ea,1&a),null===e)return di(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=o.children,e=o.fallback,s?(o=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Ll(c,o,0,null),e=Ml(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ms,e):Us(t,c));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,o,a,s){if(n)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,r=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=Ll({mode:"visible",children:r.children},o,0,null),(a=Ml(a,o,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&Ci(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ms,a);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var c=r.dgst;return r=c,Bs(e,t,s,r=ds(a=Error(i(419)),r,void 0))}if(c=0!==(s&e.childLanes),bs||c){if(null!==(r=Rc)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==a.retryLane&&(a.retryLane=o,Mi(e,o),nl(r,e,o,-1))}return ml(),Bs(e,t,s,r=ds(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=kl.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,oi=lo(o.nextSibling),ri=t,ii=!0,ai=null,null!==e&&(Yo[Qo++]=Jo,Yo[Qo++]=Xo,Yo[Qo++]=$o,Jo=e.id,Xo=e.overflow,$o=t),t=Us(t,r.children),t.flags|=4096,t)}(e,t,c,o,r,a,n);if(s){s=o.fallback,c=t.mode,r=(a=e.child).sibling;var l={mode:"hidden",children:o.children};return 0===(1&c)&&t.child!==a?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=Pl(a,l)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Pl(r,s):(s=Ml(s,c,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,c=null===(c=e.child.memoizedState)?Ls(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=Ms,o}return e=(s=e.child).sibling,o=Pl(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Us(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,n,r){return null!==r&&mi(r),Ci(t,e.child,null,n),(e=Us(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Hs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ri(e.return,t,n)}function Fs(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function qs(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Hs(e,n,t);else if(19===e.tag)Hs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ko(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Fs(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ta(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Fs(t,!0,n,null,i);break;case"together":Fs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ks(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ws(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Vs(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Po(t.type)&&jo(),Gs(t),null;case 3:return r=t.stateNode,Ji(),Ao(xo),Ao(Ro),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(al(ai),ai=null))),Os(e,t),Gs(t),null;case 5:Zi(t);var o=Qi(Yi.current);if(n=t.type,null!==e&&null!=t.stateNode)Ps(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Gs(t),null}if(e=Qi(Gi.current),hi(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[po]=t,r[fo]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(o=0;o<Mr.length;o++)Br(Mr[o],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":$(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":oe(r,a),Br("invalid",r)}for(var c in ye(n,a),o=null,a)if(a.hasOwnProperty(c)){var l=a[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,l,e),o=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,l,e),o=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":G(r),Z(r,a,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[po]=t,e[fo]=r,Ns(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),o=r;break;case"iframe":case"object":case"embed":Br("load",e),o=r;break;case"video":case"audio":for(o=0;o<Mr.length;o++)Br(Mr[o],e);o=r;break;case"source":Br("error",e),o=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),o=r;break;case"details":Br("toggle",e),o=r;break;case"input":$(e,r),o=Q(e,r),Br("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=D({},r,{value:void 0}),Br("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Br("invalid",e)}for(a in ye(n,o),l=o)if(l.hasOwnProperty(a)){var d=l[a];"style"===a?ge(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===a?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=d&&"onScroll"===a&&Br("scroll",e):null!=d&&b(e,a,d,c))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)js(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Qi(Yi.current),Qi(Gi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(a=r.nodeValue!==n)&&null!==(e=ri))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return Gs(t),null;case 13:if(Ao(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!==(1&t.mode)&&0===(128&t.flags))pi(),fi(),t.flags|=98560,a=!1;else if(a=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[po]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),a=!1}else null!==ai&&(al(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===jc&&(jc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return Ji(),Os(e,t),null===e&&qr(t.stateNode.containerInfo),Gs(t),null;case 10:return Ii(t.type._context),Gs(t),null;case 19:if(Ao(ea),null===(a=t.memoizedState))return Gs(t),null;if(r=0!==(128&t.flags),null===(c=a.rendering))if(r)Ws(a,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ta(e))){for(t.flags|=128,Ws(a,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(c=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ko(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>qc&&(t.flags|=128,r=!0,Ws(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ws(a,!0),null===a.tail&&"hidden"===a.tailMode&&!c.alternate&&!ii)return Gs(t),null}else 2*Je()-a.renderingStartTime>qc&&1073741824!==n&&(t.flags|=128,r=!0,Ws(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=a.last)?n.sibling=c:t.child=c,a.last=c)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,n=ea.current,ko(ea,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return ul(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Oc)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ys(e,t){switch(ni(t),t.tag){case 1:return Po(t.type)&&jo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ji(),Ao(xo),Ao(Ro),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(Ao(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ao(ea),null;case 4:return Ji(),null;case 10:return Ii(t.type._context),null;case 22:case 23:return ul(),null;default:return null}}Ns=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Ps=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Qi(Gi.current);var i,a=null;switch(n){case"input":o=Q(e,o),r=Q(e,r),a=[];break;case"select":o=D({},o,{value:void 0}),r=D({},r,{value:void 0}),a=[];break;case"textarea":o=re(e,o),r=re(e,r),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ye(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var c=o[d];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var l=r[d];if(c=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&l!==c&&(null!=l||null!=c))if("style"===d)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(a||(a=[]),a.push(d,n)),n=l;else"dangerouslySetInnerHTML"===d?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(a=a||[]).push(d,l)):"children"===d?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(d,""+l):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=l&&"onScroll"===d&&Br("scroll",e),a||c===l||(a=[])):(a=a||[]).push(d,l))}n&&(a=a||[]).push("style",n);var d=a;(t.updateQueue=d)&&(t.flags|=4)}},js=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qs=!1,$s=!1,Js="function"===typeof WeakSet?WeakSet:Set,Xs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){El(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){El(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&ec(t,n,i)}o=o.next}while(o!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[po],delete t[fo],delete t[go],delete t[vo],delete t[yo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var dc=null,uc=!1;function hc(e,t,n){for(n=n.child;null!==n;)pc(e,t,n),n=n.sibling}function pc(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,n)}catch(s){}switch(n.tag){case 5:$s||Zs(n,t);case 6:var r=dc,o=uc;dc=null,hc(e,t,n),uc=o,null!==(dc=r)&&(uc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(uc?(e=dc,n=n.stateNode,8===e.nodeType?co(e.parentNode,n):1===e.nodeType&&co(e,n),qt(e)):co(dc,n.stateNode));break;case 4:r=dc,o=uc,dc=n.stateNode.containerInfo,uc=!0,hc(e,t,n),dc=r,uc=o;break;case 0:case 11:case 14:case 15:if(!$s&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&ec(n,t,a),o=o.next}while(o!==r)}hc(e,t,n);break;case 1:if(!$s&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){El(n,t,s)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?($s=(r=$s)||null!==n.memoizedState,hc(e,t,n),$s=r):hc(e,t,n);break;default:hc(e,t,n)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach(function(t){var r=Il.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,uc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,uc=!0;break e}c=c.return}if(null===dc)throw Error(i(160));pc(a,s,o),dc=null,uc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(d){El(o,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),vc(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(g){El(e,e.return,g)}try{nc(5,e,e.return)}catch(g){El(e,e.return,g)}}break;case 1:mc(t,e),vc(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(mc(t,e),vc(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(g){El(e,e.return,g)}}if(4&r&&null!=(o=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===a.type&&null!=a.name&&J(o,a),be(c,s);var d=be(c,a);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];"style"===u?ge(o,h):"dangerouslySetInnerHTML"===u?ue(o,h):"children"===u?he(o,h):b(o,u,h,d)}switch(c){case"input":X(o,a);break;case"textarea":ie(o,a);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(o,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(o,!!a.multiple,a.defaultValue,!0):ne(o,!!a.multiple,a.multiple?[]:"",!1))}o[fo]=a}catch(g){El(e,e.return,g)}}break;case 6:if(mc(t,e),vc(e),4&r){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(g){El(e,e.return,g)}}break;case 3:if(mc(t,e),vc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){El(e,e.return,g)}break;case 4:default:mc(t,e),vc(e);break;case 13:mc(t,e),vc(e),8192&(o=e.child).flags&&(a=null!==o.memoizedState,o.stateNode.isHidden=a,!a||null!==o.alternate&&null!==o.alternate.memoizedState||(Fc=Je())),4&r&&fc(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?($s=(d=$s)||u,mc(t,e),$s=d):mc(t,e),vc(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xs=e,u=e.child;null!==u;){for(h=Xs=u;null!==Xs;){switch(f=(p=Xs).child,p.tag){case 0:case 11:case 14:case 15:nc(4,p,p.return);break;case 1:Zs(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){El(r,n,g)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){Cc(h);continue}}null!==f?(f.return=p,Xs=f):Cc(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{o=h.stateNode,d?"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none":(c=h.stateNode,s=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",s))}catch(g){El(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){El(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mc(t,e),vc(e),4&r&&fc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),lc(e,sc(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;cc(e,sc(e),a);break;default:throw Error(i(161))}}catch(s){El(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){Xs=e,bc(e,t,n)}function bc(e,t,n){for(var r=0!==(1&e.mode);null!==Xs;){var o=Xs,i=o.child;if(22===o.tag&&r){var a=null!==o.memoizedState||Qs;if(!a){var s=o.alternate,c=null!==s&&null!==s.memoizedState||$s;s=Qs;var l=$s;if(Qs=a,($s=c)&&!l)for(Xs=o;null!==Xs;)c=(a=Xs).child,22===a.tag&&null!==a.memoizedState?Sc(o):null!==c?(c.return=a,Xs=c):Sc(o);for(;null!==i;)Xs=i,bc(i,t,n),i=i.sibling;Xs=o,Qs=s,$s=l}wc(e)}else 0!==(8772&o.subtreeFlags)&&null!==i?(i.return=o,Xs=i):wc(e)}}function wc(e){for(;null!==Xs;){var t=Xs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$s||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$s)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&zi(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,s,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(i(163))}$s||512&t.flags&&oc(t)}catch(p){El(t,t.return,p)}}if(t===e){Xs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xs=n;break}Xs=t.return}}function Cc(e){for(;null!==Xs;){var t=Xs;if(t===e){Xs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xs=n;break}Xs=t.return}}function Sc(e){for(;null!==Xs;){var t=Xs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){El(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(c){El(t,o,c)}}var i=t.return;try{oc(t)}catch(c){El(t,i,c)}break;case 5:var a=t.return;try{oc(t)}catch(c){El(t,a,c)}}}catch(c){El(t,t.return,c)}if(t===e){Xs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xs=s;break}Xs=t.return}}var Tc,Ec=Math.ceil,_c=w.ReactCurrentDispatcher,Ac=w.ReactCurrentOwner,kc=w.ReactCurrentBatchConfig,Ic=0,Rc=null,xc=null,Nc=0,Oc=0,Pc=_o(0),jc=0,Mc=null,Lc=0,Dc=0,Uc=0,Bc=null,Hc=null,Fc=0,qc=1/0,Kc=null,zc=!1,Wc=null,Gc=null,Vc=!1,Yc=null,Qc=0,$c=0,Jc=null,Xc=-1,Zc=0;function el(){return 0!==(6&Ic)?Je():-1!==Xc?Xc:Xc=Je()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Ic)&&0!==Nc?Nc&-Nc:null!==gi.transition?(0===Zc&&(Zc=mt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nl(e,t,n,r){if(50<$c)throw $c=0,Jc=null,Error(i(185));vt(e,n,r),0!==(2&Ic)&&e===Rc||(e===Rc&&(0===(2&Ic)&&(Dc|=n),4===jc&&sl(e,Nc)),rl(e,r),1===n&&0===Ic&&0===(1&t.mode)&&(qc=Je()+500,Ho&&Ko()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,c=o[a];-1===c?0!==(s&n)&&0===(s&r)||(o[a]=pt(s,t)):c<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===Rc?Nc:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ho=!0,qo(e)}(cl.bind(null,e)):qo(cl.bind(null,e)),ao(function(){0===(6&Ic)&&Ko()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rl(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Xc=-1,Zc=0,0!==(6&Ic))throw Error(i(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var r=ht(e,e===Rc?Nc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gl(e,r);else{t=r;var o=Ic;Ic|=2;var a=fl();for(Rc===e&&Nc===t||(Kc=null,qc=Je()+500,hl(e,t));;)try{yl();break}catch(c){pl(e,c)}ki(),_c.current=a,Ic=o,null!==xc?t=0:(Rc=null,Nc=0,t=jc)}if(0!==t){if(2===t&&(0!==(o=ft(e))&&(r=o,t=il(e,o))),1===t)throw n=Mc,hl(e,0),sl(e,r),rl(e,Je()),n;if(6===t)sl(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!sr(i(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=gl(e,r))&&(0!==(a=ft(e))&&(r=a,t=il(e,a))),1===t))throw n=Mc,hl(e,0),sl(e,r),rl(e,Je()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:Cl(e,Hc,Kc);break;case 3:if(sl(e,r),(130023424&r)===r&&10<(t=Fc+500-Je())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(Cl.bind(null,e,Hc,Kc),t);break}Cl(e,Hc,Kc);break;case 4:if(sl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>o&&(o=s),r&=~a}if(r=o,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ec(r/1960))-r)){e.timeoutHandle=ro(Cl.bind(null,e,Hc,Kc),r);break}Cl(e,Hc,Kc);break;default:throw Error(i(329))}}}return rl(e,Je()),e.callbackNode===n?ol.bind(null,e):null}function il(e,t){var n=Bc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=gl(e,t))&&(t=Hc,Hc=n,null!==t&&al(t)),e}function al(e){null===Hc?Hc=e:Hc.push.apply(Hc,e)}function sl(e,t){for(t&=~Uc,t&=~Dc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function cl(e){if(0!==(6&Ic))throw Error(i(327));Sl();var t=ht(e,0);if(0===(1&t))return rl(e,Je()),null;var n=gl(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=il(e,r))}if(1===n)throw n=Mc,hl(e,0),sl(e,t),rl(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cl(e,Hc,Kc),rl(e,Je()),null}function ll(e,t){var n=Ic;Ic|=1;try{return e(t)}finally{0===(Ic=n)&&(qc=Je()+500,Ho&&Ko())}}function dl(e){null!==Yc&&0===Yc.tag&&0===(6&Ic)&&Sl();var t=Ic;Ic|=1;var n=kc.transition,r=bt;try{if(kc.transition=null,bt=1,e)return e()}finally{bt=r,kc.transition=n,0===(6&(Ic=t))&&Ko()}}function ul(){Oc=Pc.current,Ao(Pc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==xc)for(n=xc.return;null!==n;){var r=n;switch(ni(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&jo();break;case 3:Ji(),Ao(xo),Ao(Ro),ra();break;case 5:Zi(r);break;case 4:Ji();break;case 13:case 19:Ao(ea);break;case 10:Ii(r.type._context);break;case 22:case 23:ul()}n=n.return}if(Rc=e,xc=e=Pl(e.current,null),Nc=Oc=t,jc=0,Mc=null,Uc=Dc=Lc=0,Hc=Bc=null,null!==Oi){for(t=0;t<Oi.length;t++)if(null!==(r=(n=Oi[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=o,r.next=a}n.pending=r}Oi=null}return e}function pl(e,t){for(;;){var n=xc;try{if(ki(),oa.current=Xa,da){for(var r=sa.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}da=!1}if(aa=0,la=ca=sa=null,ua=!1,ha=0,Ac.current=null,null===n||null===n.return){jc=1,Mc=t,xc=null;break}e:{var a=e,s=n.return,c=n,l=t;if(t=Nc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var d=l,u=c,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,vs(f,s,c,0,t),1&f.mode&&ms(a,d,t),l=d;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ms(a,d,t),ml();break e}l=Error(i(426))}else if(ii&&1&c.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,c,0,t),mi(ls(l,c));break e}}a=l=ls(l,c),4!==jc&&(jc=2),null===Bc?Bc=[a]:Bc.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,qi(a,ps(0,l,t));break e;case 1:c=l;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gc||!Gc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,qi(a,fs(a,c,t));break e}}a=a.return}while(null!==a)}wl(n)}catch(w){t=w,xc===n&&null!==n&&(xc=n=n.return);continue}break}}function fl(){var e=_c.current;return _c.current=Xa,null===e?Xa:e}function ml(){0!==jc&&3!==jc&&2!==jc||(jc=4),null===Rc||0===(268435455&Lc)&&0===(268435455&Dc)||sl(Rc,Nc)}function gl(e,t){var n=Ic;Ic|=2;var r=fl();for(Rc===e&&Nc===t||(Kc=null,hl(e,t));;)try{vl();break}catch(o){pl(e,o)}if(ki(),Ic=n,_c.current=r,null!==xc)throw Error(i(261));return Rc=null,Nc=0,jc}function vl(){for(;null!==xc;)bl(xc)}function yl(){for(;null!==xc&&!Qe();)bl(xc)}function bl(e){var t=Tc(e.alternate,e,Oc);e.memoizedProps=e.pendingProps,null===t?wl(e):xc=t,Ac.current=null}function wl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Vs(n,t,Oc)))return void(xc=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(xc=n);if(null===e)return jc=6,void(xc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(xc=t);xc=t=e}while(null!==t);0===jc&&(jc=5)}function Cl(e,t,n){var r=bt,o=kc.transition;try{kc.transition=null,bt=1,function(e,t,n,r){do{Sl()}while(null!==Yc);if(0!==(6&Ic))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,a),e===Rc&&(xc=Rc=null,Nc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Vc||(Vc=!0,Rl(tt,function(){return Sl(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=kc.transition,kc.transition=null;var s=bt;bt=1;var c=Ic;Ic|=4,Ac.current=null,function(e,t){if(eo=zt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(C){n=null;break e}var s=0,c=-1,l=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==o&&3!==h.nodeType||(c=s+o),h!==a||0!==r&&3!==h.nodeType||(l=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++d===o&&(c=s),p===a&&++u===r&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},zt=!1,Xs=t;null!==Xs;)if(e=(t=Xs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xs=e;else for(;null!==Xs;){t=Xs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(C){El(t,t.return,C)}if(null!==(e=t.sibling)){e.return=t.return,Xs=e;break}Xs=t.return}m=tc,tc=!1}(e,n),gc(n,e),fr(to),zt=!!eo,to=eo=null,e.current=n,yc(n,e,o),$e(),Ic=c,bt=s,kc.transition=a}else e.current=n;if(Vc&&(Vc=!1,Yc=e,Qc=o),a=e.pendingLanes,0===a&&(Gc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(zc)throw zc=!1,e=Wc,Wc=null,e;0!==(1&Qc)&&0!==e.tag&&Sl(),a=e.pendingLanes,0!==(1&a)?e===Jc?$c++:($c=0,Jc=e):$c=0,Ko()}(e,t,n,r)}finally{kc.transition=o,bt=r}return null}function Sl(){if(null!==Yc){var e=wt(Qc),t=kc.transition,n=bt;try{if(kc.transition=null,bt=16>e?16:e,null===Yc)var r=!1;else{if(e=Yc,Yc=null,Qc=0,0!==(6&Ic))throw Error(i(331));var o=Ic;for(Ic|=4,Xs=e.current;null!==Xs;){var a=Xs,s=a.child;if(0!==(16&Xs.flags)){var c=a.deletions;if(null!==c){for(var l=0;l<c.length;l++){var d=c[l];for(Xs=d;null!==Xs;){var u=Xs;switch(u.tag){case 0:case 11:case 15:nc(8,u,a)}var h=u.child;if(null!==h)h.return=u,Xs=h;else for(;null!==Xs;){var p=(u=Xs).sibling,f=u.return;if(ic(u),u===d){Xs=null;break}if(null!==p){p.return=f,Xs=p;break}Xs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Xs=s;else e:for(;null!==Xs;){if(0!==(2048&(a=Xs).flags))switch(a.tag){case 0:case 11:case 15:nc(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Xs=y;break e}Xs=a.return}}var b=e.current;for(Xs=b;null!==Xs;){var w=(s=Xs).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Xs=w;else e:for(s=b;null!==Xs;){if(0!==(2048&(c=Xs).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(S){El(c,c.return,S)}if(c===s){Xs=null;break e}var C=c.sibling;if(null!==C){C.return=c.return,Xs=C;break e}Xs=c.return}}if(Ic=o,Ko(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(S){}r=!0}return r}finally{bt=n,kc.transition=t}}return!1}function Tl(e,t,n){e=Hi(e,t=ps(0,t=ls(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),rl(e,t))}function El(e,t,n){if(3===e.tag)Tl(e,e,n);else for(;null!==t;){if(3===t.tag){Tl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gc||!Gc.has(r))){t=Hi(t,e=fs(t,e=ls(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),rl(t,e));break}}t=t.return}}function _l(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Rc===e&&(Nc&n)===n&&(4===jc||3===jc&&(130023424&Nc)===Nc&&500>Je()-Fc?hl(e,0):Uc|=n),rl(e,t)}function Al(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=el();null!==(e=Mi(e,t))&&(vt(e,t,n),rl(e,n))}function kl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Al(e,n)}function Il(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Al(e,n)}function Rl(e,t){return Ve(e,t)}function xl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nl(e,t,n,r){return new xl(e,t,n,r)}function Ol(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pl(e,t){var n=e.alternate;return null===n?((n=Nl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jl(e,t,n,r,o,a){var s=2;if(r=e,"function"===typeof e)Ol(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case T:return Ml(n.children,o,a,t);case E:s=8,o|=8;break;case _:return(e=Nl(12,n,t,2|o)).elementType=_,e.lanes=a,e;case R:return(e=Nl(13,n,t,o)).elementType=R,e.lanes=a,e;case x:return(e=Nl(19,n,t,o)).elementType=x,e.lanes=a,e;case P:return Ll(n,o,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case k:s=9;break e;case I:s=11;break e;case N:s=14;break e;case O:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Nl(s,n,t,o)).elementType=e,t.type=r,t.lanes=a,t}function Ml(e,t,n,r){return(e=Nl(7,e,r,t)).lanes=n,e}function Ll(e,t,n,r){return(e=Nl(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Dl(e,t,n){return(e=Nl(6,e,null,t)).lanes=n,e}function Ul(e,t,n){return(t=Nl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Hl(e,t,n,r,o,i,a,s,c){return e=new Bl(e,t,n,s,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Nl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Di(i),e}function Fl(e){if(!e)return Io;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Po(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Po(n))return Lo(e,n,t)}return t}function ql(e,t,n,r,o,i,a,s,c){return(e=Hl(n,r,!0,e,0,i,0,s,c)).context=Fl(null),n=e.current,(i=Bi(r=el(),o=tl(n))).callback=void 0!==t&&null!==t?t:null,Hi(n,i,o),e.current.lanes=o,vt(e,o,r),rl(e,r),e}function Kl(e,t,n,r){var o=t.current,i=el(),a=tl(o);return n=Fl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bi(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Hi(o,t,a))&&(nl(e,o,a,i),Fi(e,o,a)),a}function zl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}Tc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||xo.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),fi();break;case 5:Xi(t);break;case 1:Po(t.type)&&Do(t);break;case 4:$i(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;ko(Ti,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ko(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ds(e,t,n):(ko(ea,1&ea.current),null!==(e=zs(e,t,n))?e.sibling:null);ko(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),ko(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return zs(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,ii&&0!==(1048576&t.flags)&&ei(t,Vo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ks(e,t),e=t.pendingProps;var o=Oo(t,Ro.current);xi(t,n),o=ga(null,t,r,e,o,n);var a=va();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Po(r)?(a=!0,Do(t)):a=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Di(t),o.updater=os,t.stateNode=o,o._reactInternals=t,cs(t,r,e,n),t=Is(null,t,r,!0,a,n)):(t.tag=0,ii&&a&&ti(t),ws(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ks(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Ol(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===N)return 14}return 2}(r),e=ns(r,e),o){case 0:t=As(null,t,r,e,n);break e;case 1:t=ks(null,t,r,e,n);break e;case 11:t=Cs(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,ns(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,As(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 1:return r=t.type,o=t.pendingProps,ks(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 3:e:{if(Rs(t),null===e)throw Error(i(387));r=t.pendingProps,o=(a=t.memoizedState).element,Ui(e,t),Ki(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=xs(e,t,r,n,o=ls(Error(i(423)),t));break e}if(r!==o){t=xs(e,t,r,n,o=ls(Error(i(424)),t));break e}for(oi=lo(t.stateNode.containerInfo.firstChild),ri=t,ii=!0,ai=null,n=Si(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===o){t=zs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return Xi(t),null===e&&di(t),r=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==a&&no(r,a)&&(t.flags|=32),_s(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&di(t),null;case 13:return Ds(e,t,n);case 4:return $i(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ci(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Cs(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,ko(Ti,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===o.children&&!xo.current){t=zs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var c=a.dependencies;if(null!==c){s=a.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=Bi(-1,n&-n)).tag=2;var d=a.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),d.pending=l}}a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ri(a.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ri(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ws(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,xi(t,n),r=r(o=Ni(o)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return o=ns(r=t.type,t.pendingProps),Ss(e,t,r,o=ns(r.type,o),n);case 15:return Ts(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ns(r,o),Ks(e,t),t.tag=1,Po(r)?(e=!0,Do(t)):e=!1,xi(t,n),as(t,r,o),cs(t,r,o,n),Is(null,t,r,!0,e,n);case 19:return qs(e,t,n);case 22:return Es(e,t,n)}throw Error(i(156,t.tag))};var Vl="function"===typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Ql(e){this._internalRoot=e}function $l(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xl(){}function Zl(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof o){var s=o;o=function(){var e=zl(a);s.call(e)}}Kl(t,a,e,o)}else a=function(e,t,n,r,o){if(o){if("function"===typeof r){var i=r;r=function(){var e=zl(a);i.call(e)}}var a=ql(t,r,e,0,null,!1,0,"",Xl);return e._reactRootContainer=a,e[mo]=a.current,qr(8===e.nodeType?e.parentNode:e),dl(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=zl(c);s.call(e)}}var c=Hl(e,0,!1,null,0,!1,0,"",Xl);return e._reactRootContainer=c,e[mo]=c.current,qr(8===e.nodeType?e.parentNode:e),dl(function(){Kl(t,c,n,r)}),c}(n,t,e,o,r);return zl(a)}Ql.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Kl(e,t,null,null)},Ql.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl(function(){Kl(null,e,null,null)}),t[mo]=null}},Ql.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Dt(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),rl(t,Je()),0===(6&Ic)&&(qc=Je()+500,Ko()))}break;case 13:dl(function(){var t=Mi(e,1);if(null!==t){var n=el();nl(t,e,1,n)}}),Gl(e,1)}},St=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)nl(t,e,134217728,el());Gl(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tl(e),n=Mi(e,t);if(null!==n)nl(n,e,t,el());Gl(e,t)}},Et=function(){return bt},_t=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=So(r);if(!o)throw Error(i(90));V(r),X(r,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=ll,Re=dl;var ed={usingClientEntryPoint:!1,Events:[wo,Co,So,Ae,ke,ll]},td={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{ot=rd.inject(nd),it=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$l(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$l(e))throw Error(i(299));var n=!1,r="",o=Vl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Hl(e,1,!1,null,0,n,0,r,o),e[mo]=t.current,qr(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(i(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$l(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,o=!1,a="",s=Vl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=ql(t,null,e,1,null!=n?n:null,o,0,a,s),e[mo]=t.current,qr(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Ql(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(i(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(i(40));return!!e._reactRootContainer&&(dl(function(){Zl(null,null,e,!1,function(){e._reactRootContainer=null,e[mo]=null})}),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zl(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},823:(e,t,n)=>{n.d(t,{lR:()=>a,pz:()=>s});var r=n(385),o=n(335);const i={[o.W]:"Unexpected error in authentication.",[o.z]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};o.W,i[o.W],o.z,i[o.z];class a extends Error{constructor(e,t,n){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,a.prototype),this.errorCode=e||r.YM.EMPTY_STRING,this.errorMessage=t||r.YM.EMPTY_STRING,this.subError=n||r.YM.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function s(e,t){return new a(e,t?"".concat(i[e]," ").concat(t):i[e])}},853:(e,t,n)=>{e.exports=n(234)},854:(e,t,n)=>{n.d(t,{jz:()=>s});var r=n(823),o=n(552);const i={[o.xz]:"Given storage configuration option was not supported.",[o.dg]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[o.jE]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};o.xz,i[o.xz],o.dg,i[o.dg],o.jE,i[o.jE];class a extends r.lR{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,a.prototype)}}function s(e){return new a(e,i[e])}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(i,a),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{214:"1ac0b147",340:"2c358867"}[e]+".chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="sunbeth-portal-react-ts:";n.l=(r,o,i,a)=>{if(e[r])e[r].push(o);else{var s,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[o];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var i=new Promise((n,r)=>o=e[t]=[n,r]);r.push(o[2]=i);var a=n.p+n.u(t),s=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,o[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var o,i,[a,s,c]=r,l=0;if(a.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(c)c(n)}for(t&&t(r);l<a.length;l++)i=a[l],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunksunbeth_portal_react_ts=self.webpackChunksunbeth_portal_react_ts||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r={};n.r(r),n.d(r,{hasBrowserEnv:()=>hn,hasStandardBrowserEnv:()=>fn,hasStandardBrowserWebWorkerEnv:()=>mn,navigator:()=>pn,origin:()=>gn});var o,i=n(43),a=n.t(i,2),s=n(391),c=n(950),l=n.t(c,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(o||(o={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?v(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function v(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function y(e,t,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,s=i.history,c=o.Pop,l=null,p=v();function v(){return(s.state||{idx:null}).idx}function y(){c=o.Pop;let e=v(),t=null==e?null:e-p;p=e,l&&l({action:c,location:w.location,delta:t})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:g(e);return n=n.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==p&&(p=0,s.replaceState(d({},s.state,{idx:p}),""));let w={get action(){return c},get location(){return e(i,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(u,y),l=e,()=>{i.removeEventListener(u,y),l=null}},createHref:e=>t(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c=o.Push;let r=m(w.location,e,t);n&&n(r,e),p=v()+1;let d=f(r,p),u=w.createHref(r);try{s.pushState(d,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;i.location.assign(u)}a&&l&&l({action:c,location:w.location,delta:1})},replace:function(e,t){c=o.Replace;let r=m(w.location,e,t);n&&n(r,e),p=v();let i=f(r,p),d=w.createHref(r);s.replaceState(i,"",d),a&&l&&l({action:c,location:w.location,delta:0})},go:e=>s.go(e)};return w}var b;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function w(e,t,n){return void 0===n&&(n="/"),C(e,t,n,!1)}function C(e,t,n,r){let o=M(("string"===typeof t?v(t):t).pathname||"/",n);if(null==o)return null;let i=S(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let a=null;for(let s=0;null==a&&s<i.length;++s){let e=j(o);a=O(i[s],e,r)}return a}function S(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let o=(e,o,i)=>{let a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};a.relativePath.startsWith("/")&&(h(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let s=H([r,a.relativePath]),c=n.concat(a);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),S(e.children,t,c,s)),(null!=e.path||e.index)&&t.push({path:s,score:N(s,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of T(e.path))o(e,t,r);else o(e,t)}),t}function T(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return o?[i,""]:[i];let a=T(r.join("/")),s=[];return s.push(...a.map(e=>""===e?i:[i,e].join("/"))),o&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}const E=/^:[\w-]+$/,_=3,A=2,k=1,I=10,R=-2,x=e=>"*"===e;function N(e,t){let n=e.split("/"),r=n.length;return n.some(x)&&(r+=R),t&&(r+=A),n.filter(e=>!x(e)).reduce((e,t)=>e+(E.test(t)?_:""===t?k:I),r)}function O(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],c=s===r.length-1,l="/"===i?t:t.slice(i.length)||"/",d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),u=e.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:H([i,d.pathname]),pathnameBase:F(H([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=H([i,d.pathnameBase]))}return a}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");let i=new RegExp(o,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:o}=t;if("*"===r){let e=s[n]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[n];return e[r]=o&&!c?void 0:(c||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:a,pattern:e}}function j(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return p(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function L(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function U(e,t){let n=D(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function B(e,t,n,r){let o;void 0===r&&(r=!1),"string"===typeof e?o=v(e):(o=d({},e),h(!o.pathname||!o.pathname.includes("?"),L("?","pathname","search",o)),h(!o.pathname||!o.pathname.includes("#"),L("#","pathname","hash",o)),h(!o.search||!o.search.includes("#"),L("#","search","hash",o)));let i,a=""===e||""===o.pathname,s=a?"/":o.pathname;if(null==s)i=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:o=""}="string"===typeof e?v(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:q(r),hash:K(o)}}(o,i),l=s&&"/"!==s&&s.endsWith("/"),u=(a||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!u||(c.pathname+="/"),c}const H=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],G=(new Set(W),["get",...W]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V.apply(this,arguments)}const Y=i.createContext(null);const Q=i.createContext(null);const $=i.createContext(null);const J=i.createContext(null);const X=i.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=i.createContext(null);function ee(){return null!=i.useContext(J)}function te(){return ee()||h(!1),i.useContext(J).location}function ne(e){i.useContext($).static||i.useLayoutEffect(e)}function re(){let{isDataRoute:e}=i.useContext(X);return e?function(){let{router:e}=fe(he.UseNavigateStable),t=ge(pe.UseNavigateStable),n=i.useRef(!1);return ne(()=>{n.current=!0}),i.useCallback(function(r,o){void 0===o&&(o={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,V({fromRouteId:t},o)))},[e,t])}():function(){ee()||h(!1);let e=i.useContext(Y),{basename:t,future:n,navigator:r}=i.useContext($),{matches:o}=i.useContext(X),{pathname:a}=te(),s=JSON.stringify(U(o,n.v7_relativeSplatPath)),c=i.useRef(!1);return ne(()=>{c.current=!0}),i.useCallback(function(n,o){if(void 0===o&&(o={}),!c.current)return;if("number"===typeof n)return void r.go(n);let i=B(n,JSON.parse(s),a,"path"===o.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:H([t,i.pathname])),(o.replace?r.replace:r.push)(i,o.state,o)},[t,r,s,a,e])}()}function oe(){let{matches:e}=i.useContext(X),t=e[e.length-1];return t?t.params:{}}function ie(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext($),{matches:o}=i.useContext(X),{pathname:a}=te(),s=JSON.stringify(U(o,r.v7_relativeSplatPath));return i.useMemo(()=>B(e,JSON.parse(s),a,"path"===n),[e,s,a,n])}function ae(e,t,n,r){ee()||h(!1);let{navigator:a}=i.useContext($),{matches:s}=i.useContext(X),c=s[s.length-1],l=c?c.params:{},d=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let u,p=te();if(t){var f;let e="string"===typeof t?v(t):t;"/"===d||(null==(f=e.pathname)?void 0:f.startsWith(d))||h(!1),u=e}else u=p;let m=u.pathname||"/",g=m;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=w(e,{pathname:g});let b=ue(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:H([d,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:H([d,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),s,n,r);return t&&b?i.createElement(J.Provider,{value:{location:V({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:o.Pop}},b):b}function se(){let e=function(){var e;let t=i.useContext(Z),n=me(pe.UseRouteError),r=ge(pe.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=z(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:o},n):null,null)}const ce=i.createElement(se,null);class le extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(X.Provider,{value:this.props.routeContext},i.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function de(e){let{routeContext:t,match:n,children:r}=e,o=i.useContext(Y);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(X.Provider,{value:t},r)}function ue(e,t,n,r){var o;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var a;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let s=e,c=null==(o=n)?void 0:o.errors;if(null!=c){let e=s.findIndex(e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id]));e>=0||h(!1),s=s.slice(0,Math.min(s.length,e+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<s.length;i++){let e=s[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=i),e.route.id){let{loaderData:t,errors:r}=n,o=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||o){l=!0,s=d>=0?s.slice(0,d+1):[s[0]];break}}}return s.reduceRight((e,r,o)=>{let a,u=!1,h=null,p=null;var f;n&&(a=c&&r.route.id?c[r.route.id]:void 0,h=r.route.errorElement||ce,l&&(d<0&&0===o?(f="route-fallback",!1||ve[f]||(ve[f]=!0),u=!0,p=null):d===o&&(u=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,o+1)),g=()=>{let t;return t=a?h:u?p:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(de,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===o)?i.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var he=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(he||{}),pe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(pe||{});function fe(e){let t=i.useContext(Y);return t||h(!1),t}function me(e){let t=i.useContext(Q);return t||h(!1),t}function ge(e){let t=function(){let e=i.useContext(X);return e||h(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||h(!1),n.route.id}const ve={};function ye(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function be(e){let{to:t,replace:n,state:r,relative:o}=e;ee()||h(!1);let{future:a,static:s}=i.useContext($),{matches:c}=i.useContext(X),{pathname:l}=te(),d=re(),u=B(t,U(c,a.v7_relativeSplatPath),l,"path"===o),p=JSON.stringify(u);return i.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:o}),[d,p,o,n,r]),null}function we(e){h(!1)}function Ce(e){let{basename:t="/",children:n=null,location:r,navigationType:a=o.Pop,navigator:s,static:c=!1,future:l}=e;ee()&&h(!1);let d=t.replace(/^\/*/,"/"),u=i.useMemo(()=>({basename:d,navigator:s,static:c,future:V({v7_relativeSplatPath:!1},l)}),[d,l,s,c]);"string"===typeof r&&(r=v(r));let{pathname:p="/",search:f="",hash:m="",state:g=null,key:y="default"}=r,b=i.useMemo(()=>{let e=M(p,d);return null==e?null:{location:{pathname:e,search:f,hash:m,state:g,key:y},navigationType:a}},[d,p,f,m,g,y,a]);return null==b?null:i.createElement($.Provider,{value:u},i.createElement(J.Provider,{children:n,value:b}))}function Se(e){let{children:t,location:n}=e;return ae(Te(t),n)}new Promise(()=>{});i.Component;function Te(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let o=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,Te(e.props.children,o));e.type!==we&&h(!1),e.props.index&&e.props.children&&h(!1);let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Te(e.props.children,o)),n.push(a)}),n}function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ee.apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(qo){}new Map;const ke=a.startTransition;l.flushSync,a.useId;function Ie(e){let{basename:t,children:n,future:r,window:o}=e,a=i.useRef();var s;null==a.current&&(a.current=(void 0===(s={window:o,v5Compat:!0})&&(s={}),y(function(e,t){let{pathname:n,search:r,hash:o}=e.location;return m("",{pathname:n,search:r,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:g(t)},null,s)));let c=a.current,[l,d]=i.useState({action:c.action,location:c.location}),{v7_startTransition:u}=r||{},h=i.useCallback(e=>{u&&ke?ke(()=>d(e)):d(e)},[d,u]);return i.useLayoutEffect(()=>c.listen(h),[c,h]),i.useEffect(()=>ye(r),[r]),i.createElement(Ce,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:c,future:r})}const Re="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,xe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ne=i.forwardRef(function(e,t){let n,{onClick:r,relative:o,reloadDocument:a,replace:s,state:c,target:l,to:d,preventScrollReset:u,viewTransition:p}=e,f=_e(e,Ae),{basename:m}=i.useContext($),v=!1;if("string"===typeof d&&xe.test(d)&&(n=d,Re))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=M(t.pathname,m);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:v=!0}catch(qo){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;ee()||h(!1);let{basename:r,navigator:o}=i.useContext($),{hash:a,pathname:s,search:c}=ie(e,{relative:n}),l=s;return"/"!==r&&(l="/"===s?r:H([r,s])),o.createHref({pathname:l,search:c,hash:a})}(d,{relative:o}),b=function(e,t){let{target:n,replace:r,state:o,preventScrollReset:a,relative:s,viewTransition:c}=void 0===t?{}:t,l=re(),d=te(),u=ie(e,{relative:s});return i.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:g(d)===g(u);l(e,{replace:n,state:o,preventScrollReset:a,relative:s,viewTransition:c})}},[d,l,u,r,o,n,e,a,s,c])}(d,{replace:s,state:c,target:l,preventScrollReset:u,relative:o,viewTransition:p});return i.createElement("a",Ee({},f,{href:n||y,onClick:v||a?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:l}))});var Oe,Pe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Oe||(Oe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Pe||(Pe={}));var je=n(854),Me=n(552);const Le={initialize:()=>Promise.reject((0,je.jz)(Me.dg)),acquireTokenPopup:()=>Promise.reject((0,je.jz)(Me.dg)),acquireTokenRedirect:()=>Promise.reject((0,je.jz)(Me.dg)),acquireTokenSilent:()=>Promise.reject((0,je.jz)(Me.dg)),acquireTokenByCode:()=>Promise.reject((0,je.jz)(Me.dg)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject((0,je.jz)(Me.dg)),loginPopup:()=>Promise.reject((0,je.jz)(Me.dg)),loginRedirect:()=>Promise.reject((0,je.jz)(Me.dg)),logout:()=>Promise.reject((0,je.jz)(Me.dg)),logoutRedirect:()=>Promise.reject((0,je.jz)(Me.dg)),logoutPopup:()=>Promise.reject((0,je.jz)(Me.dg)),ssoSilent:()=>Promise.reject((0,je.jz)(Me.dg)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw(0,je.jz)(Me.dg)},getLogger:()=>{throw(0,je.jz)(Me.dg)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw(0,je.jz)(Me.dg)},hydrateCache:()=>Promise.reject((0,je.jz)(Me.dg)),clearCache:()=>Promise.reject((0,je.jz)(Me.dg))};var De=n(648),Ue=n(623);const Be={instance:Le,inProgress:De.T$.None,accounts:[],logger:new Ue.V({})},He=i.createContext(Be);He.Consumer;var Fe=n(555),qe=n(498);class Ke{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case qe.B.LOGIN_START:return De.T$.Login;case qe.B.SSO_SILENT_START:return De.T$.SsoSilent;case qe.B.ACQUIRE_TOKEN_START:if(e.interactionType===De.X8.Redirect||e.interactionType===De.X8.Popup)return De.T$.AcquireToken;break;case qe.B.HANDLE_REDIRECT_START:return De.T$.HandleRedirect;case qe.B.LOGOUT_START:return De.T$.Logout;case qe.B.SSO_SILENT_SUCCESS:case qe.B.SSO_SILENT_FAILURE:if(t&&t!==De.T$.SsoSilent)break;return De.T$.None;case qe.B.LOGOUT_END:if(t&&t!==De.T$.Logout)break;return De.T$.None;case qe.B.HANDLE_REDIRECT_END:if(t&&t!==De.T$.HandleRedirect)break;return De.T$.None;case qe.B.LOGIN_SUCCESS:case qe.B.LOGIN_FAILURE:case qe.B.ACQUIRE_TOKEN_SUCCESS:case qe.B.ACQUIRE_TOKEN_FAILURE:case qe.B.RESTORE_FROM_BFCACHE:if(e.interactionType===De.X8.Redirect||e.interactionType===De.X8.Popup){if(t&&t!==De.T$.Login&&t!==De.T$.AcquireToken)break;return De.T$.None}}return null}}function ze(e,t){if(e.length!==t.length)return!1;const n=[...t];return e.every(e=>{const t=n.shift();return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username)})}const We="2.2.0",Ge="UNBLOCK_INPROGRESS",Ve="EVENT",Ye=(e,t)=>{const{type:n,payload:r}=t;let o=e.inProgress;switch(n){case Ge:e.inProgress===De.T$.Startup&&(o=De.T$.None,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case Ve:const t=r.message,i=Ke.getInteractionStatusFromEvent(t,e.inProgress);i&&(r.logger.info("MsalProvider - ".concat(t.eventType," results in setting inProgress from ").concat(e.inProgress," to ").concat(i)),o=i);break;default:throw new Error("Unknown action type: ".concat(n))}const i=r.instance.getAllAccounts();return o===e.inProgress||ze(i,e.accounts)?o!==e.inProgress?(0,Fe.A)((0,Fe.A)({},e),{},{inProgress:o}):ze(i,e.accounts)?e:(0,Fe.A)((0,Fe.A)({},e),{},{accounts:i}):(0,Fe.A)((0,Fe.A)({},e),{},{inProgress:o,accounts:i})};function Qe(e){let{instance:t,children:n}=e;(0,i.useEffect)(()=>{t.initializeWrapperLibrary(De.f7.React,We)},[t]);const r=(0,i.useMemo)(()=>t.getLogger().clone("@azure/msal-react",We),[t]),[o,a]=(0,i.useReducer)(Ye,void 0,()=>({inProgress:De.T$.Startup,accounts:t.getAllAccounts()}));(0,i.useEffect)(()=>{const e=t.addEventCallback(e=>{a({payload:{instance:t,logger:r,message:e},type:Ve})});return r.verbose("MsalProvider - Registered event callback with id: ".concat(e)),t.initialize().then(()=>{t.handleRedirectPromise().catch(()=>{}).finally(()=>{a({payload:{instance:t,logger:r},type:Ge})})}).catch(()=>{}),()=>{e&&(r.verbose("MsalProvider - Removing event callback ".concat(e)),t.removeEventCallback(e))}},[t,r]);const s={instance:t,inProgress:o.inProgress,accounts:o.accounts,logger:r};return i.createElement(He.Provider,{value:s},n)}var $e=n(823);$e.lR;var Je=n(245),Xe=n(661);const Ze="sunbeth:interactiveMode";function et(){try{const e=localStorage.getItem(Ze);if("popup"===e||"redirect"===e)return e}catch(t){}const e=({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MSAL_INTERACTIVE_FALLBACK||"").toLowerCase();return"redirect"===e||"popup"===e?e:"popup"}var tt=n(579);const nt={account:null,token:null,photo:null,login:async()=>{},logout:async()=>{},getToken:async()=>null},rt=(0,i.createContext)(nt),ot=()=>(0,i.useContext)(rt),it=e=>{let{children:t}=e;const[n,r]=(0,i.useState)(null),[o,a]=(0,i.useState)(null),[s,c]=(0,i.useState)(null),l="sunbeth:suppressAutoLogin",[d,u]=(0,i.useState)(!1);(0,i.useEffect)(()=>{try{((()=>{try{const e=window.location.hash||"",t=window.location.search||"";return/[?#&](code|error|id_token)=/.test(e)||/[?#&](code|error|id_token)=/.test(t)}catch(e){return!1}})()?Je.msalInstance.handleRedirectPromise():Promise.resolve(null)).then(e=>{if(e&&e.account){(0,Xe.pq)("AuthContext handleRedirectPromise: account present",{username:e.account.username});try{localStorage.removeItem(l)}catch(t){}Je.msalInstance.setActiveAccount(e.account),Je.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:e.account}).then(t=>{a(t.accessToken),r(e.account),(0,Xe.pq)("AuthContext redirect: token acquired, account attached")}).catch(async t=>{(0,Xe.R8)("AuthContext redirect: token acquisition failed (silent). Attempting popup fallback.",t);try{const t=await Je.msalInstance.acquireTokenPopup({scopes:["User.Read"]});a(t.accessToken),r(e.account),(0,Xe.pq)("AuthContext redirect: popup token acquired, account attached")}catch(n){(0,Xe.z3)("AuthContext redirect: popup token acquisition failed",n)}})}}).catch(e=>{(0,Xe.R8)("handleRedirectPromise error",e)})}catch(qo){}let e=!1;try{e="true"===localStorage.getItem(l)}catch(n){}if(e)return void(0,Xe.pq)("AuthContext: auto-login suppressed (skipping cached account attach)");(0,Xe.pq)("AuthContext checking MSAL accounts");const t=Je.msalInstance.getAllAccounts();t.length>0&&((0,Xe.pq)("AuthContext found existing account",{count:t.length}),Je.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:t[0]}).then(e=>{a(e.accessToken),r(t[0]),(0,Xe.pq)("AuthContext attached cached account with token")}).catch(()=>{(0,Xe.pq)("AuthContext: cached account exists but token acquisition failed; awaiting manual login")}))},[]),(0,i.useEffect)(()=>{n&&((0,Xe.pq)("AuthContext acquiring token silently",{account:n.username}),Je.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:n}).then(e=>{(0,Xe.pq)("AuthContext acquired token silently"),a(e.accessToken)}).catch(async e=>{(0,Xe.R8)("acquireTokenSilent failed, falling back to popup",e);try{const e=await Je.msalInstance.acquireTokenPopup({scopes:["User.Read"]});a(e.accessToken),(0,Xe.pq)("AuthContext acquired token via popup")}catch(t){(0,Xe.z3)("acquireTokenPopup failed",t)}}))},[n]),(0,i.useEffect)(()=>{if(!o)return;let e=!0,t=null;return(async()=>{try{const n=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:"Bearer ".concat(o)}});if(!n.ok)return void c(null);const r=await n.blob();t=URL.createObjectURL(r),e&&c(t)}catch(qo){e&&c(null)}})(),()=>{e=!1,t&&URL.revokeObjectURL(t)}},[o]);return(0,tt.jsx)(rt.Provider,{value:{account:n,token:o,photo:s,login:async()=>{try{if(d)return void(0,Xe.pq)("AuthContext: login ignored (already in progress)");u(!0),(0,Xe.pq)("AuthContext: manual login requested");try{localStorage.removeItem(l)}catch(e){}const n=et(),o=["User.Read","openid","profile"],i="popup"===n?await Je.msalInstance.loginPopup({scopes:o,prompt:"select_account"}):(await Je.msalInstance.loginRedirect({scopes:o,prompt:"select_account"}),null);(0,Xe.pq)("AuthContext loginPopup result",i);const s=Je.msalInstance.getAllAccounts();(0,Xe.pq)("AuthContext accounts after popup",{count:s.length});const c=s&&s.length?s[0]:i.account;if(!c){(0,Xe.z3)("login: no account returned");try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Sign in failed (no account returned)"}}))}catch(qo){}return}Je.msalInstance.setActiveAccount(c);let h=null;try{h=(await Je.msalInstance.acquireTokenSilent({scopes:["User.Read"],account:c})).accessToken,(0,Xe.pq)("AuthContext acquired token silently after login")}catch(qo){(0,Xe.R8)("acquireTokenSilent after login failed, attempting popup",qo);try{if("popup"!==et())return void await Je.msalInstance.acquireTokenRedirect({scopes:["User.Read"]});h=(await Je.msalInstance.acquireTokenPopup({scopes:["User.Read"]})).accessToken}catch(t){(0,Xe.z3)("acquireTokenPopup after login failed",t)}}if(!h){try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Sign in failed: could not acquire token"}}))}catch(qo){}return}a(h),r(c);try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Signed in"}}))}catch(qo){}}catch(qo){(0,Xe.z3)("login failed (popup)",qo);try{return(0,Xe.pq)("AuthContext: falling back to loginRedirect"),void await Je.msalInstance.loginRedirect({scopes:["User.Read","openid","profile"]})}catch(n){(0,Xe.z3)("loginRedirect also failed",n);try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Sign in failed"}}))}catch(o){}}}finally{u(!1)}},logout:async()=>{try{(0,Xe.pq)("AuthContext: logout requested"),await Je.msalInstance.logoutPopup(),r(null),a(null),c(null);try{localStorage.setItem(l,"true")}catch(e){}try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Signed out"}}))}catch(qo){}}catch(qo){(0,Xe.z3)("logout failed",qo);try{window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Sign out failed"}}))}catch(t){}}},getToken:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["User.Read"];(0,Xe.pq)("AuthContext getToken",{scopes:e});const t=Je.msalInstance.getActiveAccount()||Je.msalInstance.getAllAccounts()[0]||n;if(!t)throw new Error("No active account");try{return(await Je.msalInstance.acquireTokenSilent({account:t,scopes:e})).accessToken}catch(qo){const n=et();if((0,Xe.R8)("getToken: acquireTokenSilent failed, using interactive fallback",{mode:n,error:qo}),"popup"!==n)throw await Je.msalInstance.acquireTokenRedirect({scopes:e}),new Error("Interactive redirect initiated for token");await new Promise(e=>setTimeout(e,200));try{return(await Je.msalInstance.acquireTokenPopup({scopes:e})).accessToken}catch(r){await new Promise(e=>setTimeout(e,400));return(await Je.msalInstance.acquireTokenPopup({scopes:e})).accessToken}}}},children:t})};function at(e,t){return function(){return e.apply(t,arguments)}}const{toString:st}=Object.prototype,{getPrototypeOf:ct}=Object,{iterator:lt,toStringTag:dt}=Symbol,ut=(ht=Object.create(null),e=>{const t=st.call(e);return ht[t]||(ht[t]=t.slice(8,-1).toLowerCase())});var ht;const pt=e=>(e=e.toLowerCase(),t=>ut(t)===e),ft=e=>t=>typeof t===e,{isArray:mt}=Array,gt=ft("undefined");function vt(e){return null!==e&&!gt(e)&&null!==e.constructor&&!gt(e.constructor)&&wt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const yt=pt("ArrayBuffer");const bt=ft("string"),wt=ft("function"),Ct=ft("number"),St=e=>null!==e&&"object"===typeof e,Tt=e=>{if("object"!==ut(e))return!1;const t=ct(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(dt in e)&&!(lt in e)},Et=pt("Date"),_t=pt("File"),At=pt("Blob"),kt=pt("FileList"),It=pt("URLSearchParams"),[Rt,xt,Nt,Ot]=["ReadableStream","Request","Response","Headers"].map(pt);function Pt(e,t){let n,r,{allOwnKeys:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),mt(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(vt(e))return;const r=o?Object.getOwnPropertyNames(e):Object.keys(e),i=r.length;let a;for(n=0;n<i;n++)a=r[n],t.call(null,e[a],a,e)}}function jt(e,t){if(vt(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,o=n.length;for(;o-- >0;)if(r=n[o],t===r.toLowerCase())return r;return null}const Mt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Lt=e=>!gt(e)&&e!==Mt;const Dt=(Ut="undefined"!==typeof Uint8Array&&ct(Uint8Array),e=>Ut&&e instanceof Ut);var Ut;const Bt=pt("HTMLFormElement"),Ht=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Ft=pt("RegExp"),qt=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Pt(n,(n,o)=>{let i;!1!==(i=t(n,o,e))&&(r[o]=i||n)}),Object.defineProperties(e,r)};const Kt=pt("AsyncFunction"),zt=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],Mt.addEventListener("message",e=>{let{source:t,data:o}=e;t===Mt&&o===n&&r.length&&r.shift()()},!1),e=>{r.push(e),Mt.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,wt(Mt.postMessage)),Wt="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Mt):"undefined"!==typeof process&&process.nextTick||zt,Gt={isArray:mt,isArrayBuffer:yt,isBuffer:vt,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||wt(e.append)&&("formdata"===(t=ut(e))||"object"===t&&wt(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&yt(e.buffer),t},isString:bt,isNumber:Ct,isBoolean:e=>!0===e||!1===e,isObject:St,isPlainObject:Tt,isEmptyObject:e=>{if(!St(e)||vt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(qo){return!1}},isReadableStream:Rt,isRequest:xt,isResponse:Nt,isHeaders:Ot,isUndefined:gt,isDate:Et,isFile:_t,isBlob:At,isRegExp:Ft,isFunction:wt,isStream:e=>St(e)&&wt(e.pipe),isURLSearchParams:It,isTypedArray:Dt,isFileList:kt,forEach:Pt,merge:function e(){const{caseless:t,skipUndefined:n}=Lt(this)&&this||{},r={},o=(o,i)=>{const a=t&&jt(r,i)||i;Tt(r[a])&&Tt(o)?r[a]=e(r[a],o):Tt(o)?r[a]=e({},o):mt(o)?r[a]=o.slice():n&&gt(o)||(r[a]=o)};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&Pt(arguments[i],o);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Pt(t,(t,r)=>{n&&wt(t)?e[r]=at(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let o,i,a;const s={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)a=o[i],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&ct(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:ut,kindOfTest:pt,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(mt(e))return e;let t=e.length;if(!Ct(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[lt]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Bt,hasOwnProperty:Ht,hasOwnProp:Ht,reduceDescriptors:qt,freezeMethods:e=>{qt(e,(t,n)=>{if(wt(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];wt(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return mt(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:jt,global:Mt,isContextDefined:Lt,isSpecCompliantForm:function(e){return!!(e&&wt(e.append)&&"FormData"===e[dt]&&e[lt])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(St(e)){if(t.indexOf(e)>=0)return;if(vt(e))return e;if(!("toJSON"in e)){t[r]=e;const o=mt(e)?[]:{};return Pt(e,(e,t)=>{const i=n(e,r+1);!gt(i)&&(o[t]=i)}),t[r]=void 0,o}}return e};return n(e,0)},isAsyncFn:Kt,isThenable:e=>e&&(St(e)||wt(e))&&wt(e.then)&&wt(e.catch),setImmediate:zt,asap:Wt,isIterable:e=>null!=e&&wt(e[lt])};function Vt(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}Gt.inherits(Vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Gt.toJSONObject(this.config),code:this.code,status:this.status}}});const Yt=Vt.prototype,Qt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Qt[e]={value:e}}),Object.defineProperties(Vt,Qt),Object.defineProperty(Yt,"isAxiosError",{value:!0}),Vt.from=(e,t,n,r,o,i)=>{const a=Object.create(Yt);Gt.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",c=null==t&&e?e.code:t;return Vt.call(a,s,c,n,r,o),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",i&&Object.assign(a,i),a};const $t=Vt;function Jt(e){return Gt.isPlainObject(e)||Gt.isArray(e)}function Xt(e){return Gt.endsWith(e,"[]")?e.slice(0,-2):e}function Zt(e,t,n){return e?e.concat(t).map(function(e,t){return e=Xt(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const en=Gt.toFlatObject(Gt,{},null,function(e){return/^is[A-Z]/.test(e)});const tn=function(e,t,n){if(!Gt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=Gt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Gt.isUndefined(t[e])})).metaTokens,o=n.visitor||l,i=n.dots,a=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Gt.isSpecCompliantForm(t);if(!Gt.isFunction(o))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Gt.isDate(e))return e.toISOString();if(Gt.isBoolean(e))return e.toString();if(!s&&Gt.isBlob(e))throw new $t("Blob is not supported. Use a Buffer instead.");return Gt.isArrayBuffer(e)||Gt.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,o){let s=e;if(e&&!o&&"object"===typeof e)if(Gt.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(Gt.isArray(e)&&function(e){return Gt.isArray(e)&&!e.some(Jt)}(e)||(Gt.isFileList(e)||Gt.endsWith(n,"[]"))&&(s=Gt.toArray(e)))return n=Xt(n),s.forEach(function(e,r){!Gt.isUndefined(e)&&null!==e&&t.append(!0===a?Zt([n],r,i):null===a?n:n+"[]",c(e))}),!1;return!!Jt(e)||(t.append(Zt(o,n,i),c(e)),!1)}const d=[],u=Object.assign(en,{defaultVisitor:l,convertValue:c,isVisitable:Jt});if(!Gt.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!Gt.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),Gt.forEach(n,function(n,i){!0===(!(Gt.isUndefined(n)||null===n)&&o.call(t,n,Gt.isString(i)?i.trim():i,r,u))&&e(n,r?r.concat(i):[i])}),d.pop()}}(e),t};function nn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function rn(e,t){this._pairs=[],e&&tn(e,this,t)}const on=rn.prototype;on.append=function(e,t){this._pairs.push([e,t])},on.toString=function(e){const t=e?function(t){return e.call(this,t,nn)}:nn;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const an=rn;function sn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cn(e,t,n){if(!t)return e;const r=n&&n.encode||sn;Gt.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let i;if(i=o?o(t,n):Gt.isURLSearchParams(t)?t.toString():new an(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const ln=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Gt.forEach(this.handlers,function(t){null!==t&&e(t)})}},dn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},un={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:an,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},hn="undefined"!==typeof window&&"undefined"!==typeof document,pn="object"===typeof navigator&&navigator||void 0,fn=hn&&(!pn||["ReactNative","NativeScript","NS"].indexOf(pn.product)<0),mn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,gn=hn&&window.location.href||"http://localhost",vn=(0,Fe.A)((0,Fe.A)({},r),un);const yn=function(e){function t(e,n,r,o){let i=e[o++];if("__proto__"===i)return!0;const a=Number.isFinite(+i),s=o>=e.length;if(i=!i&&Gt.isArray(r)?r.length:i,s)return Gt.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a;r[i]&&Gt.isObject(r[i])||(r[i]=[]);return t(e,n,r[i],o)&&Gt.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}(r[i])),!a}if(Gt.isFormData(e)&&Gt.isFunction(e.entries)){const n={};return Gt.forEachEntry(e,(e,r)=>{t(function(e){return Gt.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const bn={transitional:dn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=Gt.isObject(e);o&&Gt.isHTMLForm(e)&&(e=new FormData(e));if(Gt.isFormData(e))return r?JSON.stringify(yn(e)):e;if(Gt.isArrayBuffer(e)||Gt.isBuffer(e)||Gt.isStream(e)||Gt.isFile(e)||Gt.isBlob(e)||Gt.isReadableStream(e))return e;if(Gt.isArrayBufferView(e))return e.buffer;if(Gt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return tn(e,new vn.classes.URLSearchParams,(0,Fe.A)({visitor:function(e,t,n,r){return vn.isNode&&Gt.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=Gt.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return tn(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),function(e,t,n){if(Gt.isString(e))try{return(t||JSON.parse)(e),Gt.trim(e)}catch(qo){if("SyntaxError"!==qo.name)throw qo}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||bn.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(Gt.isResponse(e)||Gt.isReadableStream(e))return e;if(e&&Gt.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(qo){if(n){if("SyntaxError"===qo.name)throw $t.from(qo,$t.ERR_BAD_RESPONSE,this,null,this.response);throw qo}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:vn.classes.FormData,Blob:vn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Gt.forEach(["delete","get","head","post","put","patch"],e=>{bn.headers[e]={}});const wn=bn,Cn=Gt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Sn=Symbol("internals");function Tn(e){return e&&String(e).trim().toLowerCase()}function En(e){return!1===e||null==e?e:Gt.isArray(e)?e.map(En):String(e)}function _n(e,t,n,r,o){return Gt.isFunction(r)?r.call(this,t,n):(o&&(t=n),Gt.isString(t)?Gt.isString(r)?-1!==t.indexOf(r):Gt.isRegExp(r)?r.test(t):void 0:void 0)}class An{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(e,t,n){const o=Tn(t);if(!o)throw new Error("header name must be a non-empty string");const i=Gt.findKey(r,o);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=En(e))}const i=(e,t)=>Gt.forEach(e,(e,n)=>o(e,n,t));if(Gt.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(Gt.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const t={};let n,r,o;return e&&e.split("\n").forEach(function(e){o=e.indexOf(":"),n=e.substring(0,o).trim().toLowerCase(),r=e.substring(o+1).trim(),!n||t[n]&&Cn[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(Gt.isObject(e)&&Gt.isIterable(e)){let n,r,o={};for(const t of e){if(!Gt.isArray(t))throw TypeError("Object iterator must return a key-value pair");o[r=t[0]]=(n=o[r])?Gt.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}i(o,t)}else null!=e&&o(t,e,n);return this}get(e,t){if(e=Tn(e)){const n=Gt.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(Gt.isFunction(t))return t.call(this,e,n);if(Gt.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Tn(e)){const n=Gt.findKey(this,e);return!(!n||void 0===this[n]||t&&!_n(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function o(e){if(e=Tn(e)){const o=Gt.findKey(n,e);!o||t&&!_n(0,n[o],o,t)||(delete n[o],r=!0)}}return Gt.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];e&&!_n(0,this[o],o,e,!0)||(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return Gt.forEach(this,(r,o)=>{const i=Gt.findKey(n,o);if(i)return t[i]=En(r),void delete t[o];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(o):String(o).trim();a!==o&&delete t[o],t[a]=En(r),n[a]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Gt.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&Gt.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Sn]=this[Sn]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Tn(e);t[r]||(!function(e,t){const n=Gt.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})})}(n,e),t[r]=!0)}return Gt.isArray(e)?e.forEach(r):r(e),this}}An.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Gt.reduceDescriptors(An.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),Gt.freezeMethods(An);const kn=An;function In(e,t){const n=this||wn,r=t||n,o=kn.from(r.headers);let i=r.data;return Gt.forEach(e,function(e){i=e.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Rn(e){return!(!e||!e.__CANCEL__)}function xn(e,t,n){$t.call(this,null==e?"canceled":e,$t.ERR_CANCELED,t,n),this.name="CanceledError"}Gt.inherits(xn,$t,{__CANCEL__:!0});const Nn=xn;function On(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new $t("Request failed with status code "+n.status,[$t.ERR_BAD_REQUEST,$t.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Pn=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o,i=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=r[a];o||(o=c),n[i]=s,r[i]=c;let d=a,u=0;for(;d!==i;)u+=n[d++],d%=e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),c-o<t)return;const h=l&&c-l;return h?Math.round(1e3*u/h):void 0}};const jn=function(e,t){let n,r,o=0,i=1e3/t;const a=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();o=i,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-o;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];t>=i?a(c,e):(n=c,r||(r=setTimeout(()=>{r=null,a(n)},i-t)))},()=>n&&a(n)]},Mn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const o=Pn(50,250);return jn(n=>{const i=n.loaded,a=n.lengthComputable?n.total:void 0,s=i-r,c=o(s);r=i;e({loaded:i,total:a,progress:a?i/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&i<=a?(a-i)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},Ln=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Dn=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Gt.asap(()=>e(...n))},Un=vn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,vn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(vn.origin),vn.navigator&&/(msie|trident)/i.test(vn.navigator.userAgent)):()=>!0,Bn=vn.hasStandardBrowserEnv?{write(e,t,n,r,o,i){const a=[e+"="+encodeURIComponent(t)];Gt.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),Gt.isString(r)&&a.push("path="+r),Gt.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Hn(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Fn=e=>e instanceof kn?(0,Fe.A)({},e):e;function qn(e,t){t=t||{};const n={};function r(e,t,n,r){return Gt.isPlainObject(e)&&Gt.isPlainObject(t)?Gt.merge.call({caseless:r},e,t):Gt.isPlainObject(t)?Gt.merge({},t):Gt.isArray(t)?t.slice():t}function o(e,t,n,o){return Gt.isUndefined(t)?Gt.isUndefined(e)?void 0:r(void 0,e,0,o):r(e,t,0,o)}function i(e,t){if(!Gt.isUndefined(t))return r(void 0,t)}function a(e,t){return Gt.isUndefined(t)?Gt.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,o,i){return i in t?r(n,o):i in e?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,n)=>o(Fn(e),Fn(t),0,!0)};return Gt.forEach(Object.keys((0,Fe.A)((0,Fe.A)({},e),t)),function(r){const i=c[r]||o,a=i(e[r],t[r],r);Gt.isUndefined(a)&&i!==s||(n[r]=a)}),n}const Kn=e=>{const t=qn({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:i,headers:a,auth:s}=t;if(t.headers=a=kn.from(a),t.url=cn(Hn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),Gt.isFormData(n))if(vn.hasStandardBrowserEnv||vn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(Gt.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;t.includes(n.toLowerCase())&&a.set(n,r)})}if(vn.hasStandardBrowserEnv&&(r&&Gt.isFunction(r)&&(r=r(t)),r||!1!==r&&Un(t.url))){const e=o&&i&&Bn.read(i);e&&a.set(o,e)}return t},zn="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=Kn(e);let o=r.data;const i=kn.from(r.headers).normalize();let a,s,c,l,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=r;function f(){l&&l(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=kn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());On(function(e){t(e),f()},function(e){n(e),f()},{data:u&&"text"!==u&&"json"!==u?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new $t("Request aborted",$t.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const r=t&&t.message?t.message:"Network Error",o=new $t(r,$t.ERR_NETWORK,e,m);o.event=t||null,n(o),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const o=r.transitional||dn;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new $t(t,o.clarifyTimeoutError?$t.ETIMEDOUT:$t.ECONNABORTED,e,m)),m=null},void 0===o&&i.setContentType(null),"setRequestHeader"in m&&Gt.forEach(i.toJSON(),function(e,t){m.setRequestHeader(t,e)}),Gt.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),u&&"json"!==u&&(m.responseType=r.responseType),p&&([c,d]=Mn(p,!0),m.addEventListener("progress",c)),h&&m.upload&&([s,l]=Mn(h),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(a=t=>{m&&(n(!t||t.type?new Nn(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);v&&-1===vn.protocols.indexOf(v)?n(new $t("Unsupported protocol "+v+":",$t.ERR_BAD_REQUEST,e)):m.send(o||null)})},Wn=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const o=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;r.abort(t instanceof $t?t:new Nn(t instanceof Error?t.message:t))}};let i=t&&setTimeout(()=>{i=null,o(new $t("timeout ".concat(t," of ms exceeded"),$t.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(o):e.removeEventListener("abort",o)}),e=null)};e.forEach(e=>e.addEventListener("abort",o));const{signal:s}=r;return s.unsubscribe=()=>Gt.asap(a),s}};function Gn(e,t){this.v=e,this.k=t}function Vn(e){return function(){return new Yn(e.apply(this,arguments))}}function Yn(e){var t,n;function r(t,n){try{var i=e[t](n),a=i.value,s=a instanceof Gn;Promise.resolve(s?a.v:a).then(function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return r(c,n);n=e[c](n).value}o(i.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,o){return new Promise(function(i,a){var s={key:e,arg:o,resolve:i,reject:a,next:null};n?n=n.next=s:(t=n=s,r(e,o))})},"function"!=typeof e.return&&(this.return=void 0)}function Qn(e){return new Gn(e,0)}function $n(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new Gn(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function Jn(e){var t,n,r,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Xn(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Xn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Xn=function(e){this.s=e,this.n=e.next},Xn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Xn(e)}Yn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Yn.prototype.next=function(e){return this._invoke("next",e)},Yn.prototype.throw=function(e){return this._invoke("throw",e)},Yn.prototype.return=function(e){return this._invoke("return",e)};const Zn=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,o=0;for(;o<n;)r=o+t,yield e.slice(o,r),o=r},er=function(){var e=Vn(function*(e,t){var n,r=!1,o=!1;try{for(var i,a=Jn(tr(e));r=!(i=yield Qn(a.next())).done;r=!1){const e=i.value;yield*$n(Jn(Zn(e,t)))}}catch(s){o=!0,n=s}finally{try{r&&null!=a.return&&(yield Qn(a.return()))}finally{if(o)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),tr=function(){var e=Vn(function*(e){if(e[Symbol.asyncIterator])return void(yield*$n(Jn(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield Qn(t.read());if(e)break;yield n}}finally{yield Qn(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),nr=(e,t,n,r)=>{const o=er(e,t);let i,a=0,s=e=>{i||(i=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await o.next();if(t)return s(),void e.close();let i=r.byteLength;if(n){let e=a+=i;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw s(t),t}},cancel:e=>(s(e),o.return())},{highWaterMark:2})},{isFunction:rr}=Gt,or=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(Gt.global),{ReadableStream:ir,TextEncoder:ar}=Gt.global,sr=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(qo){return!1}},cr=e=>{e=Gt.merge.call({skipUndefined:!0},or,e);const{fetch:t,Request:n,Response:r}=e,o=t?rr(t):"function"===typeof fetch,i=rr(n),a=rr(r);if(!o)return!1;const s=o&&rr(ir),c=o&&("function"===typeof ar?(l=new ar,e=>l.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var l;const d=i&&s&&sr(()=>{let e=!1;const t=new n(vn.origin,{body:new ir,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),u=a&&s&&sr(()=>Gt.isReadableStream(new r("").body)),h={stream:u&&(e=>e.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!h[e]&&(h[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new $t("Response type '".concat(e,"' is not supported"),$t.ERR_NOT_SUPPORT,n)})});const p=async(e,t)=>{const r=Gt.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(Gt.isBlob(e))return e.size;if(Gt.isSpecCompliantForm(e)){const t=new n(vn.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Gt.isArrayBufferView(e)||Gt.isArrayBuffer(e)?e.byteLength:(Gt.isURLSearchParams(e)&&(e+=""),Gt.isString(e)?(await c(e)).byteLength:void 0)})(t):r};return async e=>{let{url:o,method:a,data:s,signal:c,cancelToken:l,timeout:f,onDownloadProgress:m,onUploadProgress:g,responseType:v,headers:y,withCredentials:b="same-origin",fetchOptions:w}=Kn(e),C=t||fetch;v=v?(v+"").toLowerCase():"text";let S=Wn([c,l&&l.toAbortSignal()],f),T=null;const E=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let _;try{if(g&&d&&"get"!==a&&"head"!==a&&0!==(_=await p(y,s))){let e,t=new n(o,{method:"POST",body:s,duplex:"half"});if(Gt.isFormData(s)&&(e=t.headers.get("content-type"))&&y.setContentType(e),t.body){const[e,n]=Ln(_,Mn(Dn(g)));s=nr(t.body,65536,e,n)}}Gt.isString(b)||(b=b?"include":"omit");const t=i&&"credentials"in n.prototype,c=(0,Fe.A)((0,Fe.A)({},w),{},{signal:S,method:a.toUpperCase(),headers:y.normalize().toJSON(),body:s,duplex:"half",credentials:t?b:void 0});T=i&&new n(o,c);let l=await(i?C(T,w):C(o,c));const f=u&&("stream"===v||"response"===v);if(u&&(m||f&&E)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=l[t]});const t=Gt.toFiniteNumber(l.headers.get("content-length")),[n,o]=m&&Ln(t,Mn(Dn(m),!0))||[];l=new r(nr(l.body,65536,n,()=>{o&&o(),E&&E()}),e)}v=v||"text";let A=await h[Gt.findKey(h,v)||"text"](l,e);return!f&&E&&E(),await new Promise((t,n)=>{On(t,n,{data:A,headers:kn.from(l.headers),status:l.status,statusText:l.statusText,config:e,request:T})})}catch(A){if(E&&E(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new $t("Network Error",$t.ERR_NETWORK,e,T),{cause:A.cause||A});throw $t.from(A,A&&A.code,e,T)}}},lr=new Map,dr=e=>{let t=e?e.env:{};const{fetch:n,Request:r,Response:o}=t,i=[r,o,n];let a,s,c=i.length,l=lr;for(;c--;)a=i[c],s=l.get(a),void 0===s&&l.set(a,s=c?new Map:cr(t)),l=s;return s},ur=(dr(),{http:null,xhr:zn,fetch:{get:dr}});Gt.forEach(ur,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(qo){}Object.defineProperty(e,"adapterName",{value:t})}});const hr=e=>"- ".concat(e),pr=e=>Gt.isFunction(e)||null===e||!1===e,fr=(e,t)=>{e=Gt.isArray(e)?e:[e];const{length:n}=e;let r,o;const i={};for(let a=0;a<n;a++){let n;if(r=e[a],o=r,!pr(r)&&(o=ur[(n=String(r)).toLowerCase()],void 0===o))throw new $t("Unknown adapter '".concat(n,"'"));if(o&&(Gt.isFunction(o)||(o=o.get(t))))break;i[n||"#"+a]=o}if(!o){const e=Object.entries(i).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(hr).join("\n"):" "+hr(e[0]):"as no adapter specified";throw new $t("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return o};function mr(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Nn(null,e)}function gr(e){mr(e),e.headers=kn.from(e.headers),e.data=In.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return fr(e.adapter||wn.adapter,e)(e).then(function(t){return mr(e),t.data=In.call(e,e.transformResponse,t),t.headers=kn.from(t.headers),t},function(t){return Rn(t)||(mr(e),t&&t.response&&(t.response.data=In.call(e,e.transformResponse,t.response),t.response.headers=kn.from(t.response.headers))),Promise.reject(t)})}const vr="1.12.2",yr={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{yr[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const br={};yr.transitional=function(e,t,n){function r(e,t){return"[Axios v"+vr+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,i)=>{if(!1===e)throw new $t(r(o," has been removed"+(t?" in "+t:"")),$t.ERR_DEPRECATED);return t&&!br[o]&&(br[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}},yr.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const wr={assertOptions:function(e,t,n){if("object"!==typeof e)throw new $t("options must be an object",$t.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],a=t[i];if(a){const t=e[i],n=void 0===t||a(t,i,e);if(!0!==n)throw new $t("option "+i+" must be "+n,$t.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new $t("Unknown option "+i,$t.ERR_BAD_OPTION)}},validators:yr},Cr=wr.validators;class Sr{constructor(e){this.defaults=e||{},this.interceptors={request:new ln,response:new ln}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(qo){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=qn(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;void 0!==n&&wr.assertOptions(n,{silentJSONParsing:Cr.transitional(Cr.boolean),forcedJSONParsing:Cr.transitional(Cr.boolean),clarifyTimeoutError:Cr.transitional(Cr.boolean)},!1),null!=r&&(Gt.isFunction(r)?t.paramsSerializer={serialize:r}:wr.assertOptions(r,{encode:Cr.function,serialize:Cr.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),wr.assertOptions(t,{baseUrl:Cr.spelling("baseURL"),withXsrfToken:Cr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=o&&Gt.merge(o.common,o[t.method]);o&&Gt.forEach(["delete","get","head","post","put","patch","common"],e=>{delete o[e]}),t.headers=kn.concat(i,o);const a=[];let s=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let d,u=0;if(!s){const e=[gr.bind(this),void 0];for(e.unshift(...a),e.push(...c),d=e.length,l=Promise.resolve(t);u<d;)l=l.then(e[u++],e[u++]);return l}d=a.length;let h=t;for(;u<d;){const e=a[u++],t=a[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{l=gr.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=c.length;u<d;)l=l.then(c[u++],c[u++]);return l}getUri(e){return cn(Hn((e=qn(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Gt.forEach(["delete","get","head","options"],function(e){Sr.prototype[e]=function(t,n){return this.request(qn(n||{},{method:e,url:t,data:(n||{}).data}))}}),Gt.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,o){return this.request(qn(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Sr.prototype[e]=t(),Sr.prototype[e+"Form"]=t(!0)});const Tr=Sr;class Er{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,o){n.reason||(n.reason=new Nn(e,r,o),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Er(function(t){e=t}),cancel:e}}}const _r=Er;const Ar={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ar).forEach(e=>{let[t,n]=e;Ar[n]=t});const kr=Ar;const Ir=function e(t){const n=new Tr(t),r=at(Tr.prototype.request,n);return Gt.extend(r,Tr.prototype,n,{allOwnKeys:!0}),Gt.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(qn(t,n))},r}(wn);Ir.Axios=Tr,Ir.CanceledError=Nn,Ir.CancelToken=_r,Ir.isCancel=Rn,Ir.VERSION=vr,Ir.toFormData=tn,Ir.AxiosError=$t,Ir.Cancel=Ir.CanceledError,Ir.all=function(e){return Promise.all(e)},Ir.spread=function(e){return function(t){return e.apply(null,t)}},Ir.isAxiosError=function(e){return Gt.isObject(e)&&!0===e.isAxiosError},Ir.mergeConfig=qn,Ir.AxiosHeaders=kn,Ir.formToJSON=e=>yn(Gt.isHTMLForm(e)?new FormData(e):e),Ir.getAdapter=fr,Ir.HttpStatusCode=kr,Ir.default=Ir;const Rr=Ir,xr={role:"Employee",canSeeAdmin:!1,canEditAdmin:!1,isSuperAdmin:!1},Nr=(0,i.createContext)(xr),Or=()=>(0,i.useContext)(Nr),Pr={Admin:{groups:["Sunbeth-Portal-Admins","HR-Managers"]},Manager:{groups:["Sunbeth-Dept-Managers"]},Employee:{groups:["Sunbeth-Employees"]}},jr=e=>{const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[e];return t?t.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0):[]},Mr=jr("REACT_APP_SUPER_ADMINS"),Lr=jr("REACT_APP_ADMINS"),Dr=jr("REACT_APP_MANAGERS"),Ur=(e,t)=>{const n=e.toLowerCase();return Mr.includes(n)?"SuperAdmin":Lr.includes(n)?"Admin":Dr.includes(n)?"Manager":t.some(e=>Pr.Admin.groups.includes(e))?"Admin":t.some(e=>Pr.Manager.groups.includes(e))?"Manager":"Employee"},Br=e=>{let{children:t}=e;const{token:n,account:r}=ot(),[o,a]=(0,i.useState)("Employee");(0,i.useEffect)(()=>{if(!n||!r)return void a("Employee");let e=!0;const t=r.username;if(t){const n=Ur(t,[]);if("Employee"!==n)return void(e&&a(n))}return(async e=>{var t;return((null===(t=(await Rr.get("https://graph.microsoft.com/v1.0/me/transitiveMemberOf?$select=displayName",{headers:{Authorization:"Bearer ".concat(e)}})).data)||void 0===t?void 0:t.value)||[]).map(e=>e.displayName)})(n).then(n=>{if(!e)return;const r=Ur(t||"",n);a(r)}).catch(()=>{e&&a("Employee")}),()=>{e=!1}},[n,r]);const s=(0,i.useMemo)(()=>({role:o,canSeeAdmin:"SuperAdmin"===o||"Admin"===o||"Manager"===o,canEditAdmin:"SuperAdmin"===o||"Admin"===o,isSuperAdmin:"SuperAdmin"===o}),[o]);return(0,tt.jsx)(Nr.Provider,{value:s,children:t})},Hr=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["User.Read"];const t=Je.msalInstance.getActiveAccount()||Je.msalInstance.getAllAccounts()[0];if(!t)throw new Error("No active account for token acquisition");try{return(await Je.msalInstance.acquireTokenSilent({account:t,scopes:e})).accessToken}catch(n){if("popup"===et()){return(await Je.msalInstance.acquireTokenPopup({scopes:e})).accessToken}throw await Je.msalInstance.acquireTokenRedirect({scopes:e}),new Error("Interactive redirect initiated for Graph token")}},Fr="https://graph.microsoft.com/v1.0",qr="sunbeth:sp:siteIdOverride";function Kr(){try{const e=localStorage.getItem(qr);if(e&&e.trim())return e.trim()}catch(e){}return({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_SITE_ID||"").trim()}const zr={batches:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_BATCHES||"sunbeth_batches",documents:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_DOCUMENTS||"sunbeth_documents",recipients:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_RECIPIENTS||"sunbeth_recipients",acks:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_ACKS||"sunbeth_acks",progress:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_PROGRESS||"sunbeth_progress",businesses:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_LIST_BUSINESSES||"sunbeth_businesses"};async function Wr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["Sites.ReadWrite.All"];const r=await Hr(n);return await fetch("".concat(Fr).concat(e),(0,Fe.A)((0,Fe.A)({},t||{}),{},{headers:(0,Fe.A)({Authorization:"Bearer ".concat(r),Accept:"application/json","Content-Type":"application/json"},(null===t||void 0===t?void 0:t.headers)||{})}))}async function Gr(e){const t=Kr();if(!t)throw new Error("REACT_APP_SP_SITE_ID not set");const n=await Wr("/sites/".concat(t,"/lists?$filter=displayName eq '").concat(e.replace(/'/g,"''"),"'"));if(!n.ok)throw new Error("getListByName failed: ".concat(n.status));const r=await n.json().catch(()=>({value:[]})),o=Array.isArray(null===r||void 0===r?void 0:r.value)?r.value[0]:null;return o?{id:o.id,name:o.displayName}:null}async function Vr(e,t){const n=await Gr(e);if(!n)return[];const r=Kr(),o=t?"?$filter=".concat(encodeURIComponent(t)):"",i=await Wr("/sites/".concat(r,"/lists/").concat(n.id,"/items").concat(o,"?$expand=fields"));if(!i.ok)return[];const a=await i.json().catch(()=>({value:[]}));return Array.isArray(null===a||void 0===a?void 0:a.value)?a.value.map(e=>(0,Fe.A)({id:e.id},e.fields)):[]}async function Yr(e,t){const n=await Gr(e);if(!n)return null;const r=Kr(),o=await Wr("/sites/".concat(r,"/lists/").concat(n.id,"/items/").concat(t,"?$expand=fields"));if(!o.ok)return null;const i=await o.json().catch(()=>null);return i?(0,Fe.A)({id:i.id},i.fields):null}async function Qr(e){return Vr(zr.documents,"fields/batchId eq ".concat(e))}const $r=()=>"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SP_LISTS&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SP_SITE_ID,Jr=()=>"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE,Xr=async(e,t)=>{if(Jr()){const e="".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),"/api/batches").concat(t?"?email=".concat(encodeURIComponent(t)):""),n=await fetch(e);return n.ok?await n.json():[]}if($r()){const e=await async function(e){if(!e)return Vr(zr.batches);const t=await Vr(zr.recipients,"fields/email eq '".concat(e.replace(/'/g,"''"),"'")),n=Array.from(new Set(t.map(e=>Number(e.batchId)).filter(Boolean))),r=[];for(const o of n){const e=await Yr(zr.batches,o).catch(()=>null);e&&r.push(e)}return r}(t);return e.map(e=>({toba_batchid:String(e.id),toba_name:e.Title||e.title||"Batch",toba_startdate:e.startDate||void 0,toba_duedate:e.dueDate||void 0,toba_status:null!=e.status?String(e.status):void 0}))}const n="".concat(({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://localhost:4000").replace(/\/$/,""),"/api/batches").concat(t?"?email=".concat(encodeURIComponent(t)):""),r=await fetch(n);return r.ok?await r.json():[]},Zr=async(e,t)=>{if(Jr()){const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE,n=await fetch("".concat(t.replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/documents"));return n.ok?await n.json():[]}if($r()){return(await Qr(Number(e))).map(e=>({toba_documentid:String(e.id),toba_title:e.title||e.Title||"Document",toba_version:null!=e.version?String(e.version):void 0,toba_requiressignature:!!e.requiresSignature,toba_fileurl:e.url}))}const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://localhost:4000",r=await fetch("".concat(n.replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/documents"));return r.ok?await r.json():[]},eo=async(e,t,n,r)=>{if(Jr()){const t="".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/progress").concat(r?"?email=".concat(encodeURIComponent(r)):""),n=await fetch(t);return n.ok?await n.json():{acknowledged:0,total:0,percent:0}}if($r())return async function(e,t){const n=(await Qr(e)).length;if(0===n)return{acknowledged:0,total:0,percent:0};const r=(await Vr(zr.acks,"fields/batchId eq ".concat(e," and fields/acknowledged eq true").concat(t?" and fields/email eq '".concat(t.replace(/'/g,"''"),"'"):""))).length;return{acknowledged:r,total:n,percent:0===n?0:Math.round(r/n*100)}}(Number(e),r);const o="".concat(({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://localhost:4000").replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/progress").concat(r?"?email=".concat(encodeURIComponent(r)):""),i=await fetch(o);return i.ok?await i.json():{acknowledged:0,total:0,percent:0}},to=async(e,t,n)=>{if(Jr()){const t="".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/acks").concat(n?"?email=".concat(encodeURIComponent(n)):""),r=await fetch(t);if(!r.ok)return[];const o=await r.json();return Array.isArray(null===o||void 0===o?void 0:o.ids)?o.ids:[]}if($r())return(await async function(e,t){const n=["fields/batchId eq ".concat(e),"fields/acknowledged eq true"];return t&&n.push("fields/email eq '".concat(t.replace(/'/g,"''"),"'")),(await Vr(zr.acks,n.join(" and "))).map(e=>Number(e.documentId)).filter(Boolean)}(Number(e),n)).map(String);const r="".concat(({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"http://localhost:4000").replace(/\/$/,""),"/api/batches/").concat(encodeURIComponent(e),"/acks").concat(n?"?email=".concat(encodeURIComponent(n)):""),o=await fetch(r);if(!o.ok)return[];const i=await o.json();return Array.isArray(null===i||void 0===i?void 0:i.ids)?i.ids:[]},no=()=>{const{token:e,account:t}=ot(),[n,r]=(0,i.useState)([]),[o,a]=(0,i.useState)({}),[s,c]=(0,i.useState)(null),[l,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{d(!0);const e=await Xr(0,(null===t||void 0===t?void 0:t.username)||void 0);r(Array.isArray(e)?e:[]),c(null)}catch(e){r([]),c("Unable to load your batches.")}finally{d(!1)}})()},[e,null===t||void 0===t?void 0:t.username]),(0,i.useEffect)(()=>{Array.isArray(n)&&0!==n.length&&(async()=>{const e={};for(const a of n)try{var r,o;const n=await eo(a.toba_batchid,0,0,(null===t||void 0===t?void 0:t.username)||void 0);e[a.toba_batchid]={percent:n.percent,total:null!==(r=n.total)&&void 0!==r?r:0,acknowledged:null!==(o=n.acknowledged)&&void 0!==o?o:0}}catch(i){e[a.toba_batchid]={percent:0,total:0,acknowledged:0}}a(e)})()},[n,e,null===t||void 0===t?void 0:t.username]),(0,i.useEffect)(()=>{const e=async e=>{var t;const n=null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.batchId;if(n)try{const e=await eo(n);a(t=>{var r,o;return(0,Fe.A)((0,Fe.A)({},t),{},{[n]:{percent:e.percent,total:null!==(r=e.total)&&void 0!==r?r:0,acknowledged:null!==(o=e.acknowledged)&&void 0!==o?o:0}})})}catch(r){}};return window.addEventListener("sunbeth:progressUpdated",e),()=>{window.removeEventListener("sunbeth:progressUpdated",e)}},[e]);const u=e=>{if(!e)return"\u2014";try{return new Date(e).toLocaleDateString()}catch(t){return e}},h=Array.isArray(n)?n:[],p=(0,i.useMemo)(()=>h.filter(e=>{var t,n;return(null!==(t=null===(n=o[e.toba_batchid])||void 0===n?void 0:n.percent)&&void 0!==t?t:0)<100}).length,[h,o]),f=(0,i.useMemo)(()=>{const e=h.filter(e=>{var t,n;return(null!==(t=null===(n=o[e.toba_batchid])||void 0===n?void 0:n.percent)&&void 0!==t?t:0)<100}).map(e=>e.toba_duedate).filter(Boolean);if(!e.length)return null;return e.reduce((e,t)=>new Date(t)<new Date(e)?t:e)},[h,o]);return(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsxs)("div",{className:"title",children:["Welcome",t?", ".concat(t.name):""]}),(0,tt.jsxs)("div",{className:"muted",style:{marginTop:6},children:["You have ",(0,tt.jsx)("strong",{children:p})," pending items"]}),(null===t||void 0===t?void 0:t.username)&&(0,tt.jsxs)("div",{className:"small muted",style:{marginTop:4},children:["Signed in as: ",t.username]})]}),(0,tt.jsx)("div",{style:{textAlign:"right"},children:(0,tt.jsxs)("div",{className:"muted small",children:["Due by: ",(0,tt.jsx)("strong",{style:{color:"var(--accent)"},children:f?u(f):"\u2014"})]})})]}),(0,tt.jsx)("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #f2f2f2"}}),l?(0,tt.jsxs)("div",{style:{display:"grid",gap:10},children:[(0,tt.jsx)("div",{className:"skeleton block"}),(0,tt.jsx)("div",{className:"skeleton block"}),(0,tt.jsx)("div",{className:"skeleton block"})]}):0===h.length?(0,tt.jsx)("div",{style:{padding:12},children:(0,tt.jsx)("div",{className:"muted",children:s||"No batches assigned."})}):(0,tt.jsx)("div",{className:"batch-list",children:h.map(e=>{var t,n,r,i;return(0,tt.jsxs)("div",{className:"batch-tile",children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700},children:e.toba_name}),(0,tt.jsxs)("div",{className:"muted",style:{marginTop:6},children:["Mandatory for all staff \u2022 Due: ",u(e.toba_duedate)]}),(0,tt.jsxs)("div",{style:{marginTop:8},children:[(0,tt.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,tt.jsx)("i",{style:{width:"".concat((null===(t=o[e.toba_batchid])||void 0===t?void 0:t.percent)||0,"%")}})}),(0,tt.jsxs)("div",{className:"muted small",style:{marginTop:6},children:[(null===(n=o[e.toba_batchid])||void 0===n?void 0:n.percent)||0,"% acknowledged"]}),((t,n,r,i)=>{const a=o[e.toba_batchid]||{percent:0,total:0,acknowledged:0},s=Math.max(0,(null!==(t=a.total)&&void 0!==t?t:0)-(null!==(n=a.acknowledged)&&void 0!==n?n:0));return(0,tt.jsxs)("div",{className:"stats-row","aria-label":"batch document stats",children:[(0,tt.jsxs)("span",{className:"chip",children:[(0,tt.jsx)("strong",{children:null!==(r=a.total)&&void 0!==r?r:0})," Docs"]}),(0,tt.jsxs)("span",{className:"chip ok",children:[(0,tt.jsx)("strong",{children:null!==(i=a.acknowledged)&&void 0!==i?i:0})," Acknowledged"]}),(0,tt.jsxs)("span",{className:"chip warn",children:[(0,tt.jsx)("strong",{children:s})," Remaining"]})]})})()]})]}),(0,tt.jsxs)("div",{style:{textAlign:"right"},children:[(0,tt.jsx)("div",{children:100===((null===(r=o[e.toba_batchid])||void 0===r?void 0:r.percent)||0)?(0,tt.jsx)("span",{className:"badge done",children:"Completed"}):(0,tt.jsx)("span",{className:"badge progress",children:"In Progress"})}),(0,tt.jsx)("div",{style:{marginTop:10},children:100===((null===(i=o[e.toba_batchid])||void 0===i?void 0:i.percent)||0)?(0,tt.jsx)(Ne,{to:"/batch/".concat(e.toba_batchid,"/completed"),children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"View"})}):(0,tt.jsx)(Ne,{to:"/batch/".concat(e.toba_batchid),children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"Continue"})})})]})]},e.toba_batchid)})})]})})},ro=()=>{const{id:e}=oe(),{token:t,account:n}=ot(),[r,o]=(0,i.useState)([]),[a,s]=(0,i.useState)(null),[c,l]=(0,i.useState)(!0),[d,u]=(0,i.useState)([]);return(0,i.useEffect)(()=>{if(!e)return;(async()=>{try{l(!0);const t=await Zr(e);o(t),s(null);const r=await to(e,0,(null===n||void 0===n?void 0:n.username)||void 0);u(r)}catch(t){o([]),s("Unable to load documents for this batch.")}finally{l(!1)}})()},[t,e,null===n||void 0===n?void 0:n.username]),(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"title",children:"Batch"}),(0,tt.jsx)("div",{className:"muted small",children:"Documents assigned"})]}),(0,tt.jsx)(Ne,{to:"/",children:(0,tt.jsx)("button",{className:"btn ghost",children:"\u2190 Back"})})]}),(0,tt.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),c?(0,tt.jsxs)("div",{className:"doc-list",children:[(0,tt.jsxs)("div",{className:"doc-row",children:[(0,tt.jsxs)("div",{className:"doc-meta",children:[(0,tt.jsx)("div",{className:"skeleton circle"}),(0,tt.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,tt.jsx)("div",{className:"skeleton line",style:{width:220}}),(0,tt.jsx)("div",{className:"skeleton line",style:{width:140}})]})]}),(0,tt.jsx)("div",{className:"skeleton line",style:{width:80}})]}),(0,tt.jsxs)("div",{className:"doc-row",children:[(0,tt.jsxs)("div",{className:"doc-meta",children:[(0,tt.jsx)("div",{className:"skeleton circle"}),(0,tt.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,tt.jsx)("div",{className:"skeleton line",style:{width:240}}),(0,tt.jsx)("div",{className:"skeleton line",style:{width:120}})]})]}),(0,tt.jsx)("div",{className:"skeleton line",style:{width:80}})]})]}):0===r.length?(0,tt.jsx)("div",{style:{padding:12},children:(0,tt.jsx)("div",{className:"muted",children:a||"No documents found."})}):(0,tt.jsx)("div",{className:"doc-list",children:r.map((t,n)=>(0,tt.jsxs)("div",{className:"doc-row",children:[(0,tt.jsxs)("div",{className:"doc-meta",children:[(0,tt.jsx)("div",{className:"doc-icon",children:"PDF"}),(0,tt.jsxs)("div",{children:[(0,tt.jsxs)("div",{style:{fontWeight:700,display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsxs)("span",{children:[n+1,". ",t.toba_title]}),d.includes(t.toba_documentid)&&(0,tt.jsx)("span",{className:"badge done",children:"Acknowledged"})]}),(0,tt.jsx)("div",{className:"muted small",children:t.toba_version||""})]})]}),(0,tt.jsx)("div",{style:{textAlign:"right"},children:(0,tt.jsx)(Ne,{to:"/document/".concat(t.toba_documentid,"?batchId=").concat(e),children:(0,tt.jsx)("button",{className:"btn sm",children:d.includes(t.toba_documentid)?"View":"Read"})})})]},t.toba_documentid))})]})})},oo=()=>{const{id:e}=oe(),{account:t,token:n,getToken:r}=ot(),[o,a]=(0,i.useState)(!1),s=(0,i.useMemo)(()=>"Document ".concat(e),[e]),[c,l]=(0,i.useState)([]),[d,u]=(0,i.useState)(0),[h,p]=(0,i.useState)("\u2014"),[f,m]=(0,i.useState)(!1),[g,v]=(0,i.useState)(!1),y=re(),b=te(),w=new URLSearchParams(b.search).get("batchId")||void 0,[C,S]=i.useState(""),[T,E]=i.useState(!1);(0,i.useEffect)(()=>{(async()=>{if(w)try{const o=w,i=await Zr(o);l(i);const a=i.findIndex(t=>t.toba_documentid===e);u(a>=0?a:0);try{const e=await eo(o,0,0,(null===t||void 0===t?void 0:t.username)||void 0);p("".concat(e.percent,"%"))}catch(n){}try{const n=await to(o,0,(null===t||void 0===t?void 0:t.username)||void 0);m(n.includes(e))}catch(r){}finally{v(!0)}}catch(qo){v(!0)}})()},[w,e,n,null===t||void 0===t?void 0:t.username]);const _=c[d],A=(null===_||void 0===_?void 0:_.toba_fileurl)||(null===_||void 0===_?void 0:_.url)||"",k={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"";let I="";if(/^https?:\/\//i.test(k))I=k.replace(/\/$/,"");else{const e=(()=>{try{return localStorage.getItem("sunbeth:apiBase")||""}catch(e){return""}})();I=e&&/^https?:\/\//i.test(e)?e.replace(/\/$/,""):"http://localhost:4000"}const[R,x]=(0,i.useState)(A);(0,i.useEffect)(()=>{(async()=>{try{if(!_)return void x("");const n=(null===_||void 0===_?void 0:_.toba_driveid)||(null===_||void 0===_?void 0:_.driveId),o=(null===_||void 0===_?void 0:_.toba_itemid)||(null===_||void 0===_?void 0:_.itemId),i=(null===_||void 0===_?void 0:_.toba_source)||(null===_||void 0===_?void 0:_.source);if(I&&"sharepoint"===i&&n&&o)try{const e=await(null===r||void 0===r?void 0:r(["Files.Read.All","Sites.Read.All"]));if(e)return void x("".concat(I,"/api/proxy/graph?driveId=").concat(encodeURIComponent(n),"&itemId=").concat(encodeURIComponent(o),"&token=").concat(encodeURIComponent(e)))}catch(e){}const a=(null===_||void 0===_?void 0:_.toba_fileurl)||(null===_||void 0===_?void 0:_.url)||"",s=/\.sharepoint\.com\//i.test(a)||/graph\.microsoft\.com\//i.test(a);if(I&&s)try{const e=await(null===r||void 0===r?void 0:r(["Files.Read.All","Sites.Read.All"]));if(e)return void x("".concat(I,"/api/proxy/graph?url=").concat(encodeURIComponent(a),"&token=").concat(encodeURIComponent(e)))}catch(t){}x(I?"".concat(I,"/api/proxy?url=").concat(encodeURIComponent(a)):a)}catch(n){const e=(null===_||void 0===_?void 0:_.toba_fileurl)||(null===_||void 0===_?void 0:_.url)||"";x(I?"".concat(I,"/api/proxy?url=").concat(encodeURIComponent(e)):e)}})()},[_,I]);const N=(null===_||void 0===_?void 0:_.toba_title)||"Document ".concat(e);"string"===typeof R&&/\.pdf(\?|#|$)/i.test(R);return(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"title",children:s}),(0,tt.jsx)("div",{className:"muted small",children:"Please read and acknowledge"})]}),(0,tt.jsx)(Ne,{to:"/",children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"\u2190 Back"})})]}),(0,tt.jsxs)("div",{className:"viewer",style:{marginTop:12},children:[R?(0,tt.jsx)("iframe",{title:N,src:R,style:{width:"100%",height:"70vh",border:"1px solid #eee",borderRadius:6},sandbox:"allow-same-origin allow-scripts allow-forms allow-popups"},R):(0,tt.jsx)("div",{className:"muted small",style:{padding:12,textAlign:"center"},children:"No document URL found for this item."}),A&&(0,tt.jsx)("div",{className:"small",style:{marginTop:8,textAlign:"right"},children:(0,tt.jsx)("a",{href:A,target:"_blank",rel:"noopener noreferrer",children:"Open in new tab \u2197"})})]}),g&&!f&&(0,tt.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12,alignItems:"center"},children:[(0,tt.jsxs)("label",{className:"small",children:[(0,tt.jsx)("input",{type:"checkbox",onChange:e=>a(e.target.checked)})," I have read and understood this document."]}),(0,tt.jsx)("div",{style:{flex:1}}),(0,tt.jsx)("button",{className:"btn accent sm",id:"btnAccept",onClick:async()=>{if(!o)return;const n={userDisplay:null===t||void 0===t?void 0:t.name,userEmail:null===t||void 0===t?void 0:t.username,userPrincipalName:null===t||void 0===t?void 0:t.username,email:null===t||void 0===t?void 0:t.username,documentId:e,documentTitle:s,batchId:w||"1",batchName:"unknown",ackmethod:"Clicked Accept"};try{S("Acknowledgement submitted"),E(!0),await(async e=>{const t="true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE;if(t)try{const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,"");await fetch("".concat(t,"/api/ack"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batchId:e.batchId,documentId:e.documentId,email:(e.userPrincipalName||e.userEmail||e.user||e.userDisplay||"").toLowerCase()||e.email||""})})}catch(qo){(0,Xe.R8)("SQLite ack post failed",qo)}const n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FLOW_CREATE_USER_ACK_URL;if(!n&&!t)throw new Error("FLOW URL not configured");try{n&&((0,Xe.pq)("Sending ack to flow",{url:n}),await Rr.post(n,e,{headers:{"Content-Type":"application/json"}}));try{window.dispatchEvent(new CustomEvent("sunbeth:progressUpdated",{detail:{batchId:e.batchId,documentId:e.documentId}}))}catch(r){}}catch(qo){if((0,Xe.z3)("Failed to send ack to flow",qo),!t)throw qo}})(n);try{const e=await eo(n.batchId,0,0,(null===t||void 0===t?void 0:t.username)||void 0);if(p("".concat(e.percent,"%")),e.percent>=100)y("/summary?batchId=".concat(n.batchId));else if(d<c.length-1){const e=c[d+1].toba_documentid;y("/document/".concat(e,"?batchId=").concat(n.batchId))}else y("/batch/".concat(n.batchId))}catch(r){}setTimeout(()=>E(!1),1200)}catch(qo){y("/batch/".concat(n.batchId))}},disabled:!o,children:"I Accept"})]}),(0,tt.jsxs)("div",{style:{marginTop:12},children:[(0,tt.jsxs)("div",{className:"controls",children:[(0,tt.jsx)("button",{className:"btn ghost sm",id:"btnPrev",onClick:()=>{if(d<=0)return void y("/batch/".concat(w||""));const e=c[d-1].toba_documentid;y("/document/".concat(e,"?batchId=").concat(w))},children:"\u2190 Previous"}),(0,tt.jsx)("div",{className:"spacer"}),(0,tt.jsx)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:(0,tt.jsx)("button",{className:"btn ghost sm",id:"btnNext",onClick:()=>{if(d>=c.length-1)return void y("/batch/".concat(w||""));const e=c[d+1].toba_documentid;y("/document/".concat(e,"?batchId=").concat(w))},children:"Next \u2192"})})]}),(0,tt.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,tt.jsx)("i",{style:{width:h}})}),(0,tt.jsxs)("div",{className:"muted small",style:{marginTop:8},children:[h," complete"]})]})]})})},io=()=>{const{token:e,account:t}=ot(),n=te(),r=new URLSearchParams(n.search).get("batchId")||void 0,[o,a]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=!0;return(async()=>{if(r)try{const n=await eo(r,0,0,(null===t||void 0===t?void 0:t.username)||void 0);e&&a(n.percent)}catch(n){e&&a(null)}})(),()=>{e=!1}},[r,e,null===t||void 0===t?void 0:t.username]);const s=null!==o&&o>=100;return(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",style:{textAlign:"center"},children:[(0,tt.jsx)("div",{className:"title",children:s?"\u2705 Batch Completed":"In Progress"}),(0,tt.jsx)("div",{style:{fontWeight:700,color:"var(--primary)",marginTop:8},children:r||"\u2014"}),(0,tt.jsx)("div",{className:"small muted",style:{marginTop:8},children:s?"All documents acknowledged.":null===o?"Checking progress\u2026":"".concat(o,"% acknowledged. Keep going!")}),(0,tt.jsx)("div",{style:{height:14}}),(0,tt.jsx)(Ne,{to:"/",children:(0,tt.jsx)("button",{className:"btn",children:"Return to Dashboard"})})]})})},ao=()=>{const{id:e}=oe(),{token:t,account:n}=ot(),[r,o]=(0,i.useState)([]),[a,s]=(0,i.useState)([]);(0,i.useEffect)(()=>{e&&(async()=>{const t=await Zr(e);o(t);const r=await to(e,0,(null===n||void 0===n?void 0:n.username)||void 0);s(r)})()},[e,t,null===n||void 0===n?void 0:n.username]);const c=(0,i.useMemo)(()=>r.filter(e=>a.includes(e.toba_documentid)),[r,a]);return(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"title",children:"Completed Documents"}),(0,tt.jsx)("div",{className:"muted small",children:"You can still view previously acknowledged documents."})]}),(0,tt.jsx)(Ne,{to:"/",children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"\u2190 Back to Dashboard"})})]}),(0,tt.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),0===c.length?(0,tt.jsx)("div",{className:"muted",style:{padding:12},children:"No acknowledged documents found."}):(0,tt.jsx)("div",{className:"doc-list",children:c.map((t,n)=>(0,tt.jsxs)("div",{className:"doc-row",children:[(0,tt.jsxs)("div",{className:"doc-meta",children:[(0,tt.jsx)("div",{className:"doc-icon",children:"PDF"}),(0,tt.jsxs)("div",{children:[(0,tt.jsxs)("div",{style:{fontWeight:700},children:[n+1,". ",t.toba_title]}),(0,tt.jsx)("div",{className:"muted small",children:t.toba_version||""})]})]}),(0,tt.jsx)("div",{style:{textAlign:"right"},children:(0,tt.jsx)(Ne,{to:"/document/".concat(t.toba_documentid,"?batchId=").concat(e),children:(0,tt.jsx)("button",{className:"btn sm",children:"View"})})})]},t.toba_documentid))})]})})},so=async(e,t)=>{try{const n="https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,mail,jobTitle,department,officeLocation,businessPhones,mobilePhone&$orderby=displayName&$top=200",r=e=>e.replace(/'/g,"''"),o=null!==t&&void 0!==t&&t.search?"(startswith(displayName,'".concat(r(t.search),"') or startswith(userPrincipalName,'").concat(r(t.search),"') or startswith(mail,'").concat(r(t.search),"'))"):"";let i=o?"".concat(n,"&$filter=").concat(o):n;const a=[];for(;i;){const t=await fetch(i,{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json",ConsistencyLevel:"eventual"}});if(!t.ok){const e=await t.text().catch(()=>"");throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText).concat(e?" \u2014 "+e:""))}const n=await t.json(),r=Array.isArray(n.value)?n.value:[];a.push(...r),i=n["@odata.nextLink"]||""}let s=a;return null!==t&&void 0!==t&&t.department&&(s=s.filter(e=>(e.department||"").toLowerCase().includes(t.department.toLowerCase()))),null!==t&&void 0!==t&&t.jobTitle&&(s=s.filter(e=>(e.jobTitle||"").toLowerCase().includes(t.jobTitle.toLowerCase()))),null!==t&&void 0!==t&&t.location&&(s=s.filter(e=>(e.officeLocation||"").toLowerCase().includes(t.location.toLowerCase()))),(0,Xe.pq)("graphUserService: fetched users",{count:s.length,filters:t}),s}catch(qo){throw(0,Xe.z3)("graphUserService: failed to fetch users",qo),qo}},co=async e=>{try{let t="https://graph.microsoft.com/v1.0/groups?$select=id,displayName,description,mail,groupTypes&$orderby=displayName&$top=200";const n=[];for(;t;){const r=await fetch(t,{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json",ConsistencyLevel:"eventual"}});if(!r.ok){const e=await r.text().catch(()=>"");throw new Error("Graph API error: ".concat(r.status," ").concat(r.statusText).concat(e?" \u2014 "+e:""))}const o=await r.json(),i=Array.isArray(o.value)?o.value:[];n.push(...i),t=o["@odata.nextLink"]||null}const r=await Promise.all(n.map(async t=>{try{const n=await fetch("https://graph.microsoft.com/v1.0/groups/".concat(t.id,"/members/$count"),{headers:{Authorization:"Bearer ".concat(e),ConsistencyLevel:"eventual"}});n.ok&&(t.memberCount=parseInt(await n.text()))}catch(qo){}return t}));return(0,Xe.pq)("graphUserService: fetched groups",{count:r.length}),r}catch(qo){throw(0,Xe.z3)("graphUserService: failed to fetch groups",qo),qo}},lo=async(e,t)=>{try{const n=[];let r="https://graph.microsoft.com/v1.0/groups/".concat(t,"/members?$select=id,displayName,userPrincipalName,mail,jobTitle,department&$top=200");for(;r;){const t=await fetch(r,{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText));const o=await t.json(),i=(o.value||[]).filter(e=>"#microsoft.graph.user"===e["@odata.type"]);n.push(...i),r=o["@odata.nextLink"]||null}return(0,Xe.pq)("graphUserService: fetched group members",{groupId:t,count:n.length}),n}catch(qo){throw(0,Xe.z3)("graphUserService: failed to fetch group members",qo),qo}},uo=async e=>{try{const t=await fetch("https://graph.microsoft.com/v1.0/users?$select=department,jobTitle,officeLocation&$top=999",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("Graph API error: ".concat(t.status," ").concat(t.statusText));const n=(await t.json()).value,r=[...new Set(n.map(e=>e.department).filter(Boolean))].sort(),o=[...new Set(n.map(e=>e.jobTitle).filter(Boolean))].sort(),i=[...new Set(n.map(e=>e.officeLocation).filter(Boolean))].sort();return(0,Xe.pq)("graphUserService: fetched organization structure",{departments:r.length,jobTitles:o.length,locations:i.length}),{departments:r,jobTitles:o,locations:i}}catch(qo){return(0,Xe.z3)("graphUserService: failed to fetch organization structure",qo),{departments:[],jobTitles:[],locations:[]}}},ho=e=>{let{title:t,value:n,change:r,color:o="var(--primary)",icon:i="\ud83d\udcca"}=e;return(0,tt.jsxs)("div",{className:"card",style:{padding:20,textAlign:"center",background:"linear-gradient(135deg, #fff 0%, #f8f9fa 100%)"},children:[(0,tt.jsx)("div",{style:{fontSize:24,marginBottom:8},children:i}),(0,tt.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:o,marginBottom:4},children:n}),(0,tt.jsx)("div",{style:{fontSize:14,color:"#666",marginBottom:4},children:t}),r&&(0,tt.jsx)("div",{style:{fontSize:12,color:r.startsWith("+")?"#28a745":r.startsWith("-")?"#dc3545":"#666",fontWeight:500},children:r})]})},po=e=>{let{data:t,type:n,height:r=200}=e;return(0,tt.jsxs)("div",{style:{height:r,border:"1px solid #e0e0e0",borderRadius:8,padding:16,background:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,color:"#666"},children:["\ud83d\udcc8 ","line"===n?"Trend":"Bar"," Chart (",t.length," data points)",(0,tt.jsx)("div",{className:"small",style:{marginLeft:8},children:"Interactive charts with Chart.js/D3 would render here"})]})},fo=e=>{let{data:t,columns:n}=e;return(0,tt.jsx)("div",{style:{overflowX:"auto"},children:(0,tt.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,tt.jsx)("thead",{children:(0,tt.jsx)("tr",{style:{backgroundColor:"#f8f9fa"},children:n.map(e=>(0,tt.jsx)("th",{style:{padding:12,textAlign:"left",borderBottom:"2px solid #dee2e6",fontWeight:600},children:e.label},e.key))})}),(0,tt.jsx)("tbody",{children:t.map((e,t)=>(0,tt.jsx)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:n.map(t=>(0,tt.jsx)("td",{style:{padding:12},children:t.format?t.format(e[t.key]):e[t.key]},t.key))},t))})]})})};const mo=e=>{let{onFilterChange:t,liveOptions:n}=e;const[r,o]=(0,i.useState)({dateRange:"30d",businessId:"all",department:"all",group:"all",status:"all",batchType:"all"}),a=(e,n)=>{const i=(0,Fe.A)((0,Fe.A)({},r),{},{[e]:n});o(i),t(i)};return(0,tt.jsxs)("div",{style:{display:"flex",gap:16,padding:16,backgroundColor:"#f8f9fa",borderRadius:8,marginBottom:24,flexWrap:"wrap"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Date Range:"}),(0,tt.jsxs)("select",{value:r.dateRange,onChange:e=>a("dateRange",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,tt.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,tt.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,tt.jsx)("option",{value:"1y",children:"Last year"})]})]}),n&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Business:"}),(0,tt.jsxs)("select",{value:r.businessId,onChange:e=>a("businessId",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"all",children:"All Businesses"}),n.businesses.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Department:"}),(0,tt.jsxs)("select",{value:r.department,onChange:e=>a("department",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"all",children:"All Departments"}),n.departments.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Group:"}),(0,tt.jsxs)("select",{value:r.group,onChange:e=>a("group",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"all",children:"All Groups"}),n.groups.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Status:"}),(0,tt.jsxs)("select",{value:r.status,onChange:e=>a("status",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"all",children:"All Statuses"}),(0,tt.jsx)("option",{value:"completed",children:"Completed"}),(0,tt.jsx)("option",{value:"pending",children:"Pending"}),(0,tt.jsx)("option",{value:"overdue",children:"Overdue"})]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",style:{display:"block",marginBottom:4},children:"Batch Type:"}),(0,tt.jsxs)("select",{value:r.batchType,onChange:e=>a("batchType",e.target.value),className:"form-control",children:[(0,tt.jsx)("option",{value:"all",children:"All Types"}),(0,tt.jsx)("option",{value:"policy",children:"Policy Updates"}),(0,tt.jsx)("option",{value:"training",children:"Training Materials"}),(0,tt.jsx)("option",{value:"compliance",children:"Compliance Documents"})]})]}),(0,tt.jsx)("div",{style:{alignSelf:"end"},children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"\ud83d\udcca Export Report"})})]})},go=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(null),[o,a]=(0,i.useState)({}),[s,c]=(0,i.useState)({businesses:[],departments:[],groups:[]}),[l,d]=(0,i.useState)([]),[u,h]=(0,i.useState)([]),p="true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE,f=p?{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""):"",m=async()=>{t(!0);try{if(p)try{const e=[],n=o.businessId;n&&"all"!==n&&e.push("businessId=".concat(encodeURIComponent(n)));const i=o.department;i&&"all"!==i&&e.push("department=".concat(encodeURIComponent(i)));const a=o.group;a&&"all"!==a&&e.push("primaryGroup=".concat(encodeURIComponent(a)));const s=e.length?"?".concat(e.join("&")):"",[l,u,p,m,g,v,y]=await Promise.all([fetch("".concat(f,"/api/stats").concat(s)).then(e=>e.json()),fetch("".concat(f,"/api/recipients").concat(s)).then(e=>e.json()),fetch("".concat(f,"/api/businesses")).then(e=>e.json()).catch(()=>[]),fetch("".concat(f,"/api/compliance").concat(s)).then(e=>e.json()).catch(()=>[]),fetch("".concat(f,"/api/doc-stats").concat(s)).then(e=>e.json()).catch(()=>[]),fetch("".concat(f,"/api/trends").concat(s)).then(e=>e.json()).catch(()=>({completions:[],newBatches:[],activeUsers:[]})),fetch("".concat(f,"/api/activity/recent?limit=20")).then(e=>e.json()).catch(()=>[])]);d(Array.isArray(u)?u:[]),h(Array.isArray(y)?y:[]);const b=new Set,w=new Set;for(const t of Array.isArray(u)?u:[])t.department&&b.add(String(t.department)),t.primaryGroup&&w.add(String(t.primaryGroup));const C=Array.isArray(p)?p.map(e=>({id:String(e.id||e.toba_businessid||""),name:String(e.name||e.toba_name||"")})):[];c({businesses:C,departments:Array.from(b).sort(),groups:Array.from(w).sort()});const S={kpis:(0,Fe.A)((0,Fe.A)({},l),{},{lastUpdated:(new Date).toISOString()}),compliance:Array.isArray(m)?m:[],trends:Array.isArray(v.completions)?v.completions.map((e,t)=>{var n,r,o,i;return{date:e.date,completions:Number(e.count||0),newBatches:Number((null===(n=v.newBatches)||void 0===n||null===(r=n[t])||void 0===r?void 0:r.count)||0),activeUsers:Number((null===(o=v.activeUsers)||void 0===o||null===(i=o[t])||void 0===i?void 0:i.count)||0)}}):[],documents:Array.isArray(g)?g:[]};return r(S),void t(!1)}catch(qo){return r({kpis:{totalBatches:0,activeBatches:0,totalUsers:0,completionRate:0,overdueBatches:0,avgCompletionTime:0,lastUpdated:(new Date).toISOString()},compliance:[],trends:[],documents:[]}),void t(!1)}r({kpis:{totalBatches:0,activeBatches:0,totalUsers:0,completionRate:0,overdueBatches:0,avgCompletionTime:0,lastUpdated:(new Date).toISOString()},compliance:[],trends:[],documents:[]}),t(!1)}catch(e){console.error("Failed to load analytics data:",e),t(!1)}};return(0,i.useEffect)(()=>{m()},[o]),e?(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",style:{textAlign:"center",padding:40},children:[(0,tt.jsx)("div",{style:{fontSize:24,marginBottom:16},children:"\ud83d\udcca"}),(0,tt.jsx)("div",{children:"Loading analytics dashboard..."}),(0,tt.jsx)("div",{className:"small muted",style:{marginTop:8},children:p?"Fetching data from local SQLite API":"Fetching data from Microsoft Graph and configured backend"})]})}):n?(0,tt.jsxs)("div",{className:"container",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("h1",{style:{margin:0,fontSize:28,color:"var(--primary)"},children:"\ud83d\udcca Analytics Dashboard"}),(0,tt.jsxs)("p",{className:"small muted",children:["Last updated: ",new Date(n.kpis.lastUpdated).toLocaleString()]})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>m(),children:"\ud83d\udd04 Refresh"}),(0,tt.jsx)("button",{className:"btn ghost sm",children:"\ud83d\udccb Schedule Report"}),(0,tt.jsx)("button",{className:"btn sm",children:"\ud83d\udce4 Export Dashboard"})]})]}),(0,tt.jsx)(mo,{onFilterChange:a,liveOptions:s}),(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:32},children:[(0,tt.jsx)(ho,{title:"Total Batches",value:n.kpis.totalBatches,change:"+5 this month",icon:"\ud83d\udccb"}),(0,tt.jsx)(ho,{title:"Active Batches",value:n.kpis.activeBatches,color:"#17a2b8",icon:"\u26a1"}),(0,tt.jsx)(ho,{title:"Assigned Recipients",value:Number(n.kpis.totalUsers).toLocaleString(),color:"#28a745",icon:"\ud83d\udc65"}),(0,tt.jsx)(ho,{title:"Completion Rate",value:"".concat(n.kpis.completionRate,"%"),color:"#ffc107",icon:"\u2705"}),(0,tt.jsx)(ho,{title:"Overdue Batches",value:n.kpis.overdueBatches,color:"#dc3545",icon:"\u26a0\ufe0f"}),(0,tt.jsx)(ho,{title:"Avg. Completion Time",value:"".concat(n.kpis.avgCompletionTime," days"),color:"#6f42c1",icon:"\u23f1\ufe0f"})]}),(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:24,marginBottom:32},children:[(0,tt.jsxs)("div",{className:"card",style:{padding:20},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udcc8 Completion Trends (30 days)"}),(0,tt.jsx)(po,{data:n.trends,type:"line",height:250})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:20},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83c\udfaf Compliance Status"}),(0,tt.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#d4edda",borderRadius:6},children:[(0,tt.jsx)("span",{children:"Compliant"}),(0,tt.jsxs)("strong",{style:{color:"#155724"},children:[n.kpis.completionRate,"%"]})]}),(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#fff3cd",borderRadius:6},children:[(0,tt.jsx)("span",{children:"Pending"}),(0,tt.jsxs)("strong",{style:{color:"#856404"},children:[Math.max(0,100-n.kpis.completionRate),"%"]})]}),(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#f8d7da",borderRadius:6},children:[(0,tt.jsx)("span",{children:"Overdue"}),(0,tt.jsxs)("strong",{style:{color:"#721c24"},children:[n.kpis.overdueBatches,"%"]})]})]})]})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83c\udfe2 Department Compliance Overview"}),0===n.compliance.length?(0,tt.jsx)("div",{className:"small muted",children:"No live compliance breakdown yet."}):(0,tt.jsx)(fo,{data:n.compliance,columns:[{key:"department",label:"Department"},{key:"totalUsers",label:"Total Users",format:e=>e.toLocaleString()},{key:"completed",label:"Completed",format:e=>e.toLocaleString()},{key:"pending",label:"Pending",format:e=>e.toLocaleString()},{key:"overdue",label:"Overdue",format:e=>e.toLocaleString()},{key:"completionRate",label:"Completion Rate",format:e=>(0,tt.jsxs)("span",{style:{color:e>=90?"#28a745":e>=75?"#ffc107":"#dc3545",fontWeight:"bold"},children:[e,"%"]})}]})]}),l&&l.length>0&&(0,tt.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udc65 Recipients (Filtered)"}),(0,tt.jsx)(fo,{data:l.map(e=>({displayName:e.displayName||e.toba_DisplayName||e.email||e.toba_Email,email:e.email||e.toba_Email,department:e.department||e.toba_Department||"\u2014",group:e.primaryGroup||e.toba_PrimaryGroup||"\u2014"})),columns:[{key:"displayName",label:"Name"},{key:"email",label:"Email"},{key:"department",label:"Department"},{key:"group",label:"Group"}]})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:20,marginBottom:32},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udcc4 Document Performance"}),0===n.documents.length?(0,tt.jsx)("div",{className:"small muted",children:"No live document stats yet."}):(0,tt.jsx)(fo,{data:n.documents,columns:[{key:"documentName",label:"Document"},{key:"batchName",label:"Batch"},{key:"totalAssigned",label:"Assigned",format:e=>e.toLocaleString()},{key:"acknowledged",label:"Acknowledged",format:e=>e.toLocaleString()},{key:"pending",label:"Pending",format:e=>e.toLocaleString()},{key:"avgTimeToComplete",label:"Avg. Time",format:e=>"".concat(e," days")}]})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:20},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18},children:"\ud83d\udd04 Recent Activity"}),(0,tt.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[p&&0===u.length&&(0,tt.jsx)("div",{className:"small muted",children:"No recent activity yet."}),u.map((e,t)=>{const n=e.type||("acknowledged"===e.action?"success":(e.action,"info")),r=function(e){if(!e)return"";const t=Date.parse(e);if(isNaN(t))return new Date(e).toLocaleString();const n=Date.now()-t,r=Math.floor(n/1e3);if(r<60)return"".concat(r,"s ago");const o=Math.floor(r/60);if(o<60)return"".concat(o," min ago");const i=Math.floor(o/60);if(i<24)return"".concat(i," hr").concat(1===i?"":"s"," ago");const a=Math.floor(i/24);return"".concat(a," day").concat(1===a?"":"s"," ago")}(e.timestamp),o=e.user||"System",i=e.document||e.batch||"";return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:12,backgroundColor:"#f8f9fa",borderRadius:6,borderLeft:"4px solid ".concat("success"===n?"#28a745":"warning"===n?"#ffc107":"info"===n?"#17a2b8":"#6c757d")},children:[(0,tt.jsx)("div",{style:{fontSize:12,color:"#666",minWidth:70},children:r}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("strong",{children:o})," ",e.action," ",i&&(0,tt.jsx)("em",{children:i})]}),(0,tt.jsx)("div",{style:{fontSize:10,padding:"2px 6px",backgroundColor:"success"===n?"#d4edda":"warning"===n?"#fff3cd":"info"===n?"#d1ecf1":"#e2e3e5",color:"success"===n?"#155724":"warning"===n?"#856404":"info"===n?"#0c5460":"#383d41",borderRadius:4,textTransform:"uppercase",fontWeight:"bold"},children:n})]},t)})]})]})]}):(0,tt.jsx)("div",{className:"container",children:(0,tt.jsx)("div",{className:"card",children:(0,tt.jsx)("div",{style:{color:"#dc3545"},children:"Failed to load analytics data"})})})},vo=e=>{let{open:t,onClose:n,title:r,children:o,width:a=640,maxWidth:s="90%"}=e;const c=(0,i.useRef)(null),l=(0,i.useMemo)(()=>"undefined"!==typeof window&&window.innerWidth<768,[]);return(0,i.useEffect)(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,n]),(0,i.useEffect)(()=>{if(!t)return;const e=c.current;if(!e)return;const n=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=n[0],o=n[n.length-1];r&&r.focus();const i=e=>{"Tab"===e.key&&0!==n.length&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),null===o||void 0===o||o.focus()):document.activeElement===o&&(e.preventDefault(),null===r||void 0===r||r.focus()))};return e.addEventListener("keydown",i),()=>e.removeEventListener("keydown",i)},[t]),t?(0,tt.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:n,children:(0,tt.jsxs)("div",{ref:c,className:"card",style:{width:l?"100%":a,maxWidth:l?"100%":s,height:l?"95vh":"auto",maxHeight:"95vh",overflowY:"auto",padding:16},onClick:e=>e.stopPropagation(),children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,tt.jsx)("h3",{style:{margin:0},children:r||"Modal"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:n,"aria-label":"Close",children:"Close"})]}),(0,tt.jsx)("div",{children:o})]})}):null};async function yo(){const e=[];try{const a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLIENT_ID,s={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_TENANT_ID,c="true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE,l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE;e.push({name:"Env: REACT_APP_CLIENT_ID",ok:!!a,detail:a||"MISSING"}),e.push({name:"Env: REACT_APP_TENANT_ID",ok:!!s,detail:s||"MISSING"}),e.push({name:"Env: REACT_APP_ENABLE_SQLITE",ok:!0,detail:c?"true (enabled)":"false (disabled)"}),e.push({name:"Env: REACT_APP_API_BASE",ok:!c||!!l,detail:l||"MISSING (required if SQLite enabled)"});const d=Je.msalInstance.getAllAccounts();e.push({name:"MSAL: getAllAccounts",ok:Array.isArray(d)&&d.length>0,detail:"accounts=".concat(d.length)});let u=d&&d[0];if(!u)return e.push({name:"MSAL: No signed-in account",ok:!1,detail:"No account found. Please sign in."}),e;e.push({name:"MSAL: account",ok:!0,detail:u.username||u.homeAccountId||"unknown"});let h=null;try{h=await Hr(["User.Read"]),e.push({name:"Graph token",ok:!0,detail:"token length=".concat(h.length)})}catch(qo){e.push({name:"Graph token",ok:!1,detail:String(qo)})}try{const t=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(h)}});if(t.ok){const n=await t.json();e.push({name:"Graph: GET /me",ok:!0,detail:"id=".concat(n.id," displayName=").concat(n.displayName)})}else e.push({name:"Graph: GET /me",ok:!1,detail:"status=".concat(t.status)})}catch(qo){(0,Xe.z3)("Graph /me fetch failed",qo),e.push({name:"Graph: GET /me",ok:!1,detail:String(qo)})}try{const t=await Hr(["Group.Read.All"]),n=await fetch("https://graph.microsoft.com/v1.0/groups?$top=1",{headers:{Authorization:"Bearer ".concat(t)}});e.push({name:"Graph: GET /groups",ok:n.ok,detail:n.ok?"ok":"status=".concat(n.status)})}catch(qo){e.push({name:"Graph: GET /groups",ok:!1,detail:"Group.Read.All not consented?"})}try{const t=await Hr(["User.Read.All"]),n=await fetch("https://graph.microsoft.com/v1.0/users?$top=1",{headers:{Authorization:"Bearer ".concat(t)}});e.push({name:"Graph: GET /users",ok:n.ok,detail:n.ok?"ok":"status=".concat(n.status)})}catch(qo){e.push({name:"Graph: GET /users",ok:!1,detail:"User.Read.All not consented?"})}try{const o=await Hr(["Sites.Read.All","Files.Read.All"]),i=await fetch("https://graph.microsoft.com/v1.0/sites?search=*",{headers:{Authorization:"Bearer ".concat(o)}}),a=i.ok;if(e.push({name:"Graph: GET /sites",ok:a,detail:a?"ok":"status=".concat(i.status)}),a)try{var t,n;const r=await i.json(),a=null===r||void 0===r||null===(t=r.value)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.id;if(a){const t=await fetch("https://graph.microsoft.com/v1.0/sites/".concat(a,"/drives?$top=1"),{headers:{Authorization:"Bearer ".concat(o)}});e.push({name:"Graph: GET site drives",ok:t.ok,detail:t.ok?"ok":"status=".concat(t.status)})}}catch(r){}}catch(qo){e.push({name:"Graph: SharePoint access",ok:!1,detail:"Sites.Read.All and Files.Read.All not consented?"})}try{const t=await Hr(["Files.ReadWrite.All","Sites.Read.All"]);e.push({name:"Graph: Upload scope check",ok:!!t,detail:"Files.ReadWrite.All acquired"})}catch(o){e.push({name:"Graph: Upload scope check",ok:!1,detail:"Files.ReadWrite.All not consented?"})}try{const t=await Hr(["Mail.Send"]);e.push({name:"Graph: Mail.Send scope",ok:!!t,detail:"Mail.Send acquired"})}catch(i){e.push({name:"Graph: Mail.Send scope",ok:!1,detail:"Mail.Send not consented?"})}if(c&&l)try{const t=await fetch("".concat(l.replace(/\/$/,""),"/api/health"));t.ok?e.push({name:"SQLite API: Health check",ok:!0,detail:"API responding"}):e.push({name:"SQLite API: Health check",ok:!1,detail:"status=".concat(t.status)})}catch(qo){e.push({name:"SQLite API: Health check",ok:!1,detail:"Connection failed: ".concat(String(qo))})}else c?e.push({name:"SQLite API: Health check",ok:!1,detail:"Enabled but REACT_APP_API_BASE not configured"}):e.push({name:"SQLite API: Skipped",ok:!0,detail:"Disabled"})}catch(a){(0,Xe.z3)("Health check failed",a),e.push({name:"Health check",ok:!1,detail:String(a)})}try{const t=e.filter(e=>!e.ok&&e.name.startsWith("Graph"));if(t.length){const n=t.map(e=>e.name.includes("groups")?"Group.Read.All":e.name.includes("/users")?"User.Read.All":e.name.includes("Upload")?"Files.ReadWrite.All":e.name.includes("/sites")||e.name.includes("drives")?"Sites.Read.All":e.name.includes("Mail.Send")?"Mail.Send":"User.Read").filter((e,t,n)=>n.indexOf(e)===t);e.push({name:"Grant these scopes",ok:!1,detail:n.join(", ")})}}catch(s){}return e}try{window.__sunbethRunDiagnostics=yo}catch(Ko){}const bo=async(e,t,n,r,o,i,a)=>{const s=r||(n instanceof File?n.name:"upload-".concat(Date.now())),c=o?"".concat(o.replace(/^\/+|\/+$/g,""),"/").concat(encodeURIComponent(s)):encodeURIComponent(s);return n.size&&n.size<=4194304?await(async()=>{const r=a&&"root"!==a?"items/".concat(a,":/").concat(encodeURIComponent(s),":/content"):"root:/".concat(c,":/content"),o=await fetch("https://graph.microsoft.com/v1.0/drives/".concat(t,"/").concat(r),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":n.type||"application/octet-stream"},body:n});if(!o.ok){const e=await o.text().catch(()=>"");throw new Error("Simple upload failed: ".concat(o.status," ").concat(o.statusText," \u2014 ").concat(e))}return await o.json()})():await(async()=>{var r;const o=a&&"root"!==a?"items/".concat(a,":/").concat(encodeURIComponent(s),":/createUploadSession"):"root:/".concat(c,":/createUploadSession"),l=await fetch("https://graph.microsoft.com/v1.0/drives/".concat(t,"/").concat(o),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({item:{"@microsoft.graph.conflictBehavior":"rename",name:s}})});if(!l.ok){const e=await l.text().catch(()=>"");throw new Error("Create upload session failed: ".concat(l.status," ").concat(l.statusText," \u2014 ").concat(e))}const d=(await l.json()).uploadUrl,u=null!==(r=n.size)&&void 0!==r?r:0;let h=0,p=0;for(;p<u;){const e=Math.min(p+5242880,u),t=n.slice(p,e),r="bytes ".concat(p,"-").concat(e-1,"/").concat(u),o=await fetch(d,{method:"PUT",headers:{"Content-Length":String(e-p),"Content-Range":r},body:t});if(!o.ok&&202!==o.status){const e=await o.text().catch(()=>"");throw new Error("Chunk upload failed: ".concat(o.status," ").concat(o.statusText," \u2014 ").concat(e))}if(h=e,i&&i(Math.round(h/u*100)),201===o.status||200===o.status){return await o.json()}p=e}throw new Error("Upload session did not return a completed item.")})()},wo=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root";try{const r="root"===n?"https://graph.microsoft.com/v1.0/drives/".concat(t,"/root/children"):"https://graph.microsoft.com/v1.0/drives/".concat(t,"/items/").concat(n,"/children"),o="".concat(r,"?$select=id,name,folder,file,webUrl,size,createdDateTime,lastModifiedDateTime,parentReference&$top=200"),i=await fetch(o,{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("SharePoint API error: ".concat(i.status," ").concat(i.statusText));return(await i.json()).value||[]}catch(qo){throw(0,Xe.z3)("sharepointService: failed to fetch folder items",qo),qo}};const Co=new class{constructor(){this.logs=[],this.stepStartTimes=new Map}startStep(e,t,n){this.stepStartTimes.set(e,Date.now()),this.log("info",e,"Started: ".concat(t),n)}endStep(e,t,n){const r=this.stepStartTimes.get(e),o=r?Date.now()-r:void 0;this.stepStartTimes.delete(e),this.log("success",e,"Completed: ".concat(t),n,o)}log(e,t,n,r,o){const i={timestamp:(new Date).toISOString(),level:e,step:t,message:n,data:r,duration:o};this.logs.push(i);const a="[".concat(e.toUpperCase(),"] ").concat(t,": ").concat(n);switch(e){case"error":console.error(a,r);break;case"warn":console.warn(a,r);break;case"debug":console.debug(a,r);break;case"success":console.info("\u2705 ".concat(a).concat(o?" (".concat(o,"ms)"):""),r);break;default:console.info(a,r)}try{window.dispatchEvent(new CustomEvent("sunbeth:batchLog",{detail:i}))}catch(qo){}}error(e,t,n){this.log("error",e,t,{error:(null===n||void 0===n?void 0:n.message)||n})}warn(e,t,n){this.log("warn",e,t,n)}info(e,t,n){this.log("info",e,t,n)}debug(e,t,n){this.log("debug",e,t,n)}success(e,t,n){this.log("success",e,t,n)}getLogs(){return[...this.logs]}getLogsForStep(e){return this.logs.filter(t=>t.step===e)}clearLogs(){this.logs=[],this.stepStartTimes.clear()}exportLogs(){return JSON.stringify(this.logs,null,2)}},So=e=>{let{isVisible:t,onClose:n}=e;const[r,o]=(0,i.useState)([]),[a,s]=(0,i.useState)("all"),[c,l]=(0,i.useState)("all"),[d,u]=(0,i.useState)(!0),h=(0,i.useRef)(null);(0,i.useEffect)(()=>{const e=e=>{o(t=>[...t,e.detail])};return window.addEventListener("sunbeth:batchLog",e),o(Co.getLogs()),()=>{window.removeEventListener("sunbeth:batchLog",e)}},[]),(0,i.useEffect)(()=>{d&&h.current&&h.current.scrollIntoView({behavior:"smooth"})},[r,d]);const p=r.filter(e=>("all"===a||e.level===a)&&("all"===c||e.step===c)),f=Array.from(new Set(r.map(e=>e.step))).sort(),m=e=>{switch(e){case"error":return"#ff4444";case"warn":return"#ffaa00";case"success":return"#44aa44";case"debug":return"#888888";default:return"#4488ff"}},g=e=>{switch(e){case"error":return"\u274c";case"warn":return"\u26a0\ufe0f";case"success":return"\u2705";case"debug":return"\ud83d\udd0d";default:return"\u2139\ufe0f"}};return t?(0,tt.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,tt.jsxs)("div",{style:{backgroundColor:"#1e1e1e",color:"#ffffff",borderRadius:"8px",padding:"20px",width:"90%",maxWidth:"1200px",height:"80%",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #333"},children:[(0,tt.jsx)("h2",{style:{margin:0,color:"#ffffff"},children:"Batch Creation Debug Console"}),(0,tt.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,tt.jsx)("button",{onClick:()=>{o([]),Co.clearLogs()},style:{padding:"8px 16px",backgroundColor:"#ff4444",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear Logs"}),(0,tt.jsx)("button",{onClick:()=>{const e=JSON.stringify(r,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="batch-creation-logs-".concat((new Date).toISOString(),".json"),o.click(),URL.revokeObjectURL(n)},style:{padding:"8px 16px",backgroundColor:"#4488ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Export Logs"}),(0,tt.jsx)("button",{onClick:n,style:{padding:"8px 16px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})]})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{style:{marginRight:"8px"},children:"Level:"}),(0,tt.jsxs)("select",{value:a,onChange:e=>s(e.target.value),style:{padding:"4px 8px",backgroundColor:"#333",color:"white",border:"1px solid #555",borderRadius:"4px"},children:[(0,tt.jsx)("option",{value:"all",children:"All"}),(0,tt.jsx)("option",{value:"info",children:"Info"}),(0,tt.jsx)("option",{value:"success",children:"Success"}),(0,tt.jsx)("option",{value:"warn",children:"Warning"}),(0,tt.jsx)("option",{value:"error",children:"Error"}),(0,tt.jsx)("option",{value:"debug",children:"Debug"})]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{style:{marginRight:"8px"},children:"Step:"}),(0,tt.jsxs)("select",{value:c,onChange:e=>l(e.target.value),style:{padding:"4px 8px",backgroundColor:"#333",color:"white",border:"1px solid #555",borderRadius:"4px"},children:[(0,tt.jsx)("option",{value:"all",children:"All Steps"}),f.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]}),(0,tt.jsx)("div",{style:{marginLeft:"auto"},children:(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,tt.jsx)("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked)}),"Auto-scroll"]})}),(0,tt.jsxs)("div",{style:{color:"#ccc"},children:["Showing ",p.length," of ",r.length," logs"]})]}),(0,tt.jsxs)("div",{style:{flex:1,backgroundColor:"#0d1117",border:"1px solid #333",borderRadius:"4px",padding:"10px",overflow:"auto",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"13px",lineHeight:"1.4"},children:[0===p.length?(0,tt.jsx)("div",{style:{color:"#888",textAlign:"center",padding:"20px"},children:"No logs to display"}):p.map((e,t)=>(0,tt.jsxs)("div",{style:{marginBottom:"8px",padding:"8px",backgroundColor:"error"===e.level?"rgba(255,68,68,0.1)":"warn"===e.level?"rgba(255,170,0,0.1)":"success"===e.level?"rgba(68,170,68,0.1)":"rgba(68,136,255,0.05)",border:"1px solid ".concat(m(e.level),"20"),borderRadius:"4px",borderLeft:"4px solid ".concat(m(e.level))},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,tt.jsx)("span",{children:g(e.level)}),(0,tt.jsx)("span",{style:{color:m(e.level),fontWeight:"bold"},children:e.level.toUpperCase()}),(0,tt.jsxs)("span",{style:{color:"#888",fontSize:"11px"},children:["[",e.step,"]"]}),e.duration&&(0,tt.jsxs)("span",{style:{color:"#888",fontSize:"11px"},children:["(",e.duration,"ms)"]})]}),(0,tt.jsx)("span",{style:{color:"#666",fontSize:"11px"},children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,tt.jsx)("div",{style:{color:"#e6e6e6",marginBottom:"4px"},children:e.message}),e.data&&(0,tt.jsxs)("details",{style:{marginTop:"8px"},children:[(0,tt.jsx)("summary",{style:{color:"#888",cursor:"pointer",fontSize:"11px",userSelect:"none"},children:"Show Data"}),(0,tt.jsx)("pre",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#161b22",border:"1px solid #333",borderRadius:"4px",overflow:"auto",fontSize:"11px",color:"#c9d1d9"},children:JSON.stringify(e.data,null,2)})]})]},t)),(0,tt.jsx)("div",{ref:h})]})]})}):null},To=e=>{let{canEdit:t}=e;const{account:n}=ot(),r="admin_settings",[o,a]=(0,i.useState)({enableUpload:!1,requireSig:!1,autoReminder:!0,reminderDays:3,allowBulkAssignment:!0,requireApproval:!1});(0,i.useEffect)(()=>{try{const e=localStorage.getItem(r);if(e){const t=JSON.parse(e);a((0,Fe.A)((0,Fe.A)({},o),t))}}catch(e){}},[]);return(0,tt.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(0,tt.jsx)("h3",{style:{margin:0,fontSize:16},children:"System Settings"}),(0,tt.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:o.enableUpload,onChange:e=>a((0,Fe.A)((0,Fe.A)({},o),{},{enableUpload:e.target.checked})),disabled:!t}),(0,tt.jsx)("span",{className:"small",children:"Enable document upload"})]}),(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:o.requireSig,onChange:e=>a((0,Fe.A)((0,Fe.A)({},o),{},{requireSig:e.target.checked})),disabled:!t}),(0,tt.jsx)("span",{className:"small",children:"Require digital signatures"})]}),(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:o.autoReminder,onChange:e=>a((0,Fe.A)((0,Fe.A)({},o),{},{autoReminder:e.target.checked})),disabled:!t}),(0,tt.jsx)("span",{className:"small",children:"Auto-send reminders"})]}),(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:o.allowBulkAssignment,onChange:e=>a((0,Fe.A)((0,Fe.A)({},o),{},{allowBulkAssignment:e.target.checked})),disabled:!t}),(0,tt.jsx)("span",{className:"small",children:"Allow bulk assignments"})]})]}),(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("span",{className:"small",children:"Reminder frequency:"}),(0,tt.jsxs)("select",{value:o.reminderDays,onChange:e=>a((0,Fe.A)((0,Fe.A)({},o),{},{reminderDays:parseInt(e.target.value)})),disabled:!t,children:[(0,tt.jsx)("option",{value:1,children:"Daily"}),(0,tt.jsx)("option",{value:3,children:"Every 3 days"}),(0,tt.jsx)("option",{value:7,children:"Weekly"}),(0,tt.jsx)("option",{value:14,children:"Bi-weekly"})]})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8,alignItems:"center",flexWrap:"wrap"},children:[t&&(0,tt.jsx)("button",{className:"btn",onClick:()=>{if(t)try{localStorage.setItem(r,JSON.stringify(o)),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Settings saved"}}))}catch(qo){console.warn(qo)}},children:"Save Settings"}),!t&&(0,tt.jsx)("span",{className:"small muted",children:"Read-only access"}),t&&(0,tt.jsx)("button",{className:"btn ghost",onClick:async()=>{try{var e;if("true"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE||!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE)return void window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Enable SQLite (REACT_APP_ENABLE_SQLITE=true) and set REACT_APP_API_BASE to seed."}}));if(null===n||void 0===n||!n.username)return void window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Sign in first to seed data for your account."}}));const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),r=await fetch("".concat(t,"/api/seed?email=").concat(encodeURIComponent(n.username)),{method:"POST"});if(!r.ok)throw new Error("Seed failed");const o=await r.json().catch(()=>({}));window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"SQLite seeded. BatchId: ".concat(null!==(e=null===o||void 0===o?void 0:o.batchId)&&void 0!==e?e:"n/a")}}))}catch(qo){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"SQLite seed failed"}}))}},title:"Seed SQLite with a demo batch, docs, and recipients for your account",children:"Seed SQLite (for me)"}),t&&(0,tt.jsx)("button",{className:"btn ghost",onClick:async()=>{try{await Hr(["User.Read"]),await Hr(["Group.Read.All"]),await Hr(["Sites.Read.All","Files.ReadWrite.All"]),await Hr(["Mail.Send"]),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Core Graph permissions granted (if consented)"}}))}catch(qo){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Grant permissions failed"}}))}},title:"Request common Microsoft Graph permissions in one go",children:"Grant Core Permissions"})]})]})},Eo=e=>{let{onSelectionChange:t}=e;const{getToken:n,login:r,account:o}=ot(),[a,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)(null),[d,u]=(0,i.useState)("users"),[h,p]=(0,i.useState)([]),[f,m]=(0,i.useState)([]),[g,v]=(0,i.useState)({departments:[],jobTitles:[],locations:[]}),[y,b]=(0,i.useState)({}),[w,C]=(0,i.useState)(""),[S,T]=(0,i.useState)(new Set),[E,_]=(0,i.useState)(new Set),[A,k]=(0,i.useState)(1),[I,R]=(0,i.useState)(1),x=50,N=async()=>{s(!0),l(null);try{const e=await n(["User.Read.All","Group.Read.All"]);if(!e)throw new Error("No token available");const[t,r,o]=await Promise.all([so(e,y),co(e),uo(e)]);p(t),m(r),v(o)}catch(e){console.error("Failed to load user/group data:",e);const t="string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:"",n=t.includes("No active account")?"Please sign in to continue.":"Ask your admin to grant Microsoft Graph permissions (User.Read.All and Group.Read.All) to this app.";l("".concat(t||"Failed to load user data."," ").concat(n).trim()),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to load user data. ".concat(n)}}))}finally{s(!1)}};(0,i.useEffect)(()=>{N(),k(1),R(1)},[y]),(0,i.useEffect)(()=>{const e=setTimeout(()=>{b(e=>(0,Fe.A)((0,Fe.A)({},e),{},{search:w||void 0}))},300);return()=>clearTimeout(e)},[w]),(0,i.useEffect)(()=>{t({users:Array.from(S).map(e=>h.find(t=>t.id===e)).filter(Boolean),groups:Array.from(E).map(e=>f.find(t=>t.id===e)).filter(Boolean)})},[S,E,h,f]);return(0,tt.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:8,padding:16},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:16},children:"Assign to Users & Groups"}),(0,tt.jsxs)("div",{style:{marginBottom:12},children:[!o&&(0,tt.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#fff3cd",padding:8,borderRadius:6,border:"1px solid #ffeeba"},children:[(0,tt.jsx)("span",{children:"You're not signed in."}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>r().then(()=>N()),children:"Sign in"})]}),c&&(0,tt.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#f8d7da",padding:8,borderRadius:6,border:"1px solid #f5c6cb",marginTop:8},children:[(0,tt.jsx)("span",{style:{flex:1},children:c}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>N(),children:"Retry"})]})]}),(0,tt.jsx)("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"1px solid #e0e0e0"},children:["users","groups","structure"].map(e=>(0,tt.jsx)("button",{className:d===e?"btn sm":"btn ghost sm",onClick:()=>u(e),children:"users"===e?"Users (".concat(h.length,")"):"groups"===e?"Groups (".concat(f.length,")"):"Filters"},e))}),a&&(0,tt.jsx)("div",{className:"small muted",children:"Loading..."}),"structure"===d&&(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Search:"}),(0,tt.jsx)("input",{type:"text",placeholder:"Name, email...",value:w,onChange:e=>C(e.target.value),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4}})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Department:"}),(0,tt.jsxs)("select",{value:y.department||"",onChange:e=>b((0,Fe.A)((0,Fe.A)({},y),{},{department:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,tt.jsx)("option",{value:"",children:"All Departments"}),g.departments.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Job Title:"}),(0,tt.jsxs)("select",{value:y.jobTitle||"",onChange:e=>b((0,Fe.A)((0,Fe.A)({},y),{},{jobTitle:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,tt.jsx)("option",{value:"",children:"All Titles"}),g.jobTitles.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Location:"}),(0,tt.jsxs)("select",{value:y.location||"",onChange:e=>b((0,Fe.A)((0,Fe.A)({},y),{},{location:e.target.value||void 0})),style:{width:"100%",padding:6,border:"1px solid #ddd",borderRadius:4},children:[(0,tt.jsx)("option",{value:"",children:"All Locations"}),g.locations.map(e=>(0,tt.jsx)("option",{value:e,children:e},e))]})]})]}),"users"===d&&(0,tt.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[(0,tt.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>T(new Set(h.map(e=>e.id))),children:"Select All"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>T(new Set),children:"Clear"}),(0,tt.jsxs)("span",{className:"small muted",children:["Selected: ",S.size]})]}),h.slice(0,A*x).map(e=>(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0"},children:[(0,tt.jsx)("input",{type:"checkbox",checked:S.has(e.id),onChange:()=>(e=>{const t=new Set(S);t.has(e)?t.delete(e):t.add(e),T(t)})(e.id)}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("div",{style:{fontWeight:500},children:e.displayName}),(0,tt.jsx)("div",{className:"small muted",children:e.userPrincipalName}),e.department&&(0,tt.jsxs)("div",{className:"small muted",children:[e.department," \u2022 ",e.jobTitle]})]})]},e.id)),A*x<h.length&&(0,tt.jsxs)("div",{style:{padding:8,textAlign:"center"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>k(e=>e+1),children:"Load more"}),(0,tt.jsxs)("div",{className:"small muted",style:{marginTop:6},children:[Math.min(A*x,h.length)," of ",h.length]})]})]}),"groups"===d&&(0,tt.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[(0,tt.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>_(new Set(f.map(e=>e.id))),children:"Select All"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>_(new Set),children:"Clear"}),(0,tt.jsxs)("span",{className:"small muted",children:["Selected: ",E.size]})]}),f.slice(0,I*x).map(e=>(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0"},children:[(0,tt.jsx)("input",{type:"checkbox",checked:E.has(e.id),onChange:()=>(e=>{const t=new Set(E);t.has(e)?t.delete(e):t.add(e),_(t)})(e.id)}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("div",{style:{fontWeight:500},children:e.displayName}),e.description&&(0,tt.jsx)("div",{className:"small muted",children:e.description}),(0,tt.jsxs)("div",{className:"small muted",children:[e.memberCount||0," members"]})]})]},e.id)),I*x<f.length&&(0,tt.jsxs)("div",{style:{padding:8,textAlign:"center"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>R(e=>e+1),children:"Load more"}),(0,tt.jsxs)("div",{className:"small muted",style:{marginTop:6},children:[Math.min(I*x,f.length)," of ",f.length]})]})]})]})},_o=e=>{let{onDocumentSelect:t}=e;const{getToken:n,login:r,account:o}=ot(),[a,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)([]),[d,u]=(0,i.useState)(""),[h,p]=(0,i.useState)([]),[f,m]=(0,i.useState)(""),[g,v]=(0,i.useState)([]),[y,b]=(0,i.useState)(new Set),[w,C]=(0,i.useState)(""),[S,T]=(0,i.useState)("browse"),[E,_]=(0,i.useState)(!1),[A,k]=(0,i.useState)(null),[I,R]=(0,i.useState)([]),[x,N]=(0,i.useState)([]),[O,P]=(0,i.useState)("root"),[j,M]=(0,i.useState)([{id:"root",name:"Root"}]),[L,D]=(0,i.useState)(null),[U,B]=(0,i.useState)(!1),H=52428800,F=async()=>{s(!0),D(null);try{const e=await n(["Sites.Read.All","Files.Read.All"]);if(!e)throw new Error("No token available");const t=await(async e=>{try{const t=await fetch("https://graph.microsoft.com/v1.0/sites?search=*&$select=id,displayName,webUrl,description&$top=50",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw new Error("SharePoint API error: ".concat(t.status," ").concat(t.statusText));const n=(await t.json()).value;return(0,Xe.pq)("sharepointService: fetched sites",{count:n.length}),n}catch(qo){throw(0,Xe.z3)("sharepointService: failed to fetch sites",qo),qo}})(e);l(t)}catch(e){console.error("Failed to load SharePoint sites:",e),D("Failed to load SharePoint sites. Ensure you are signed in and have granted Sites.Read.All and Files.Read.All.")}finally{s(!1)}},q=async e=>{s(!0),D(null);try{const t=await n(["Sites.Read.All","Files.Read.All"]);if(!t)throw new Error("No token available");const r=await(async(e,t)=>{const n=t,r=async()=>{const r="https://graph.microsoft.com/v1.0/sites/".concat(n,"/lists?$filter=drive ne null&$select=id,displayName,webUrl&$expand=drive($select=id,driveType,name,webUrl)"),o=await fetch(r,{headers:{Authorization:"Bearer ".concat(e)}});if(!o.ok){const e=await o.text().catch(()=>"");throw new Error("Lists fallback failed: ".concat(o.status," ").concat(o.statusText).concat(e?" \u2014 "+e:""))}const i=((await o.json()).value||[]).filter(e=>e.drive&&("documentLibrary"===e.drive.driveType||e.drive.id)).map(e=>{var t,n,r,o;return{id:(null===(t=e.drive)||void 0===t?void 0:t.id)||e.id,name:(null===(n=e.drive)||void 0===n?void 0:n.name)||e.displayName,displayName:e.displayName||(null===(r=e.drive)||void 0===r?void 0:r.name),description:"",webUrl:e.webUrl,driveType:(null===(o=e.drive)||void 0===o?void 0:o.driveType)||"documentLibrary"}});return(0,Xe.pq)("sharepointService: fetched document libraries (lists fallback)",{siteId:t,count:i.length}),i};try{const i="https://graph.microsoft.com/v1.0/sites/".concat(n,"/drives?$select=id,name,webUrl,driveType&$top=200"),a=await fetch(i,{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok){const e=await a.text().catch(()=>"");(0,Xe.pq)("sharepointService: drives listing not ok, attempting lists fallback",{status:a.status});try{return await r()}catch(o){throw new Error("Drives listing failed: ".concat(a.status," \u2014 ").concat(e||a.statusText,". Fallback error: ").concat(o.message))}}let s=((await a.json()).value||[]||[]).filter(e=>"documentLibrary"===e.driveType).map(e=>({id:e.id,name:e.name,displayName:e.name,description:"",webUrl:e.webUrl,driveType:e.driveType}));return 0===s.length&&((0,Xe.pq)("sharepointService: drives empty, attempting lists fallback"),s=await r()),(0,Xe.pq)("sharepointService: fetched document libraries (drives)",{siteId:t,count:s.length}),s}catch(qo){(0,Xe.z3)("sharepointService: failed to fetch document libraries",qo);try{return await r()}catch(i){throw qo}}})(t,e);p(r)}catch(t){console.error("Failed to load document libraries:",t);const e="string"===typeof(null===t||void 0===t?void 0:t.message)?t.message:"";D("Failed to load document libraries.".concat(e?" "+e:""))}finally{s(!1)}},K=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root";s(!0),D(null);try{const r=await n(["Sites.Read.All","Files.Read.All"]);if(!r)throw new Error("No token available");const o=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root",r=arguments.length>3?arguments[3]:void 0;try{let o="root"===n?"https://graph.microsoft.com/v1.0/drives/".concat(t,"/root/children"):"https://graph.microsoft.com/v1.0/drives/".concat(t,"/items/").concat(n,"/children");o+="?$select=id,name,webUrl,size,createdDateTime,lastModifiedDateTime,file,createdBy,lastModifiedBy,parentReference",o+="&$expand=thumbnails&$top=200",r&&(o="https://graph.microsoft.com/v1.0/drives/".concat(t,"/search(q='").concat(encodeURIComponent(r),"')"),o+="?$select=id,name,webUrl,size,createdDateTime,lastModifiedDateTime,file,createdBy,lastModifiedBy,parentReference");const i=await fetch(o,{headers:{Authorization:"Bearer ".concat(e)}});if(!i.ok)throw new Error("SharePoint API error: ".concat(i.status," ").concat(i.statusText));const a=(await i.json()).value.filter(e=>e.file),s=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/html"],c=a.filter(e=>e.file&&s.includes(e.file.mimeType));return(0,Xe.pq)("sharepointService: fetched documents",{driveId:t,folderId:n,count:c.length,searchQuery:r}),c}catch(qo){throw(0,Xe.z3)("sharepointService: failed to fetch documents",qo),qo}}(r,e,t,w);v(o)}catch(r){console.error("Failed to load documents:",r),D("Failed to load documents.")}finally{s(!1)}};(0,i.useEffect)(()=>{F()},[]),(0,i.useEffect)(()=>{d&&(q(d),m(""),v([]))},[d]),(0,i.useEffect)(()=>{f&&(K(f,"root"),(async()=>{try{const e=await n(["Sites.Read.All","Files.Read.All"]);if(!e)throw new Error("No token available");const t=await wo(e,f,"root");N(t),P("root"),M([{id:"root",name:"Root"}])}catch(qo){console.error("Failed to load folder items",qo)}})())},[f,w]),(0,i.useEffect)(()=>{f&&"browse"===S&&K(f,O||"root")},[O,S]),(0,i.useEffect)(()=>{const e=Array.from(y).map(e=>g.find(t=>t.id===e)).filter(Boolean);t(e)},[y,g]);const z=async(e,t)=>{try{const r=await n(["Sites.Read.All","Files.Read.All"]);if(!r)throw new Error("No token available");const o=await wo(r,f,e);N(o),P(e),M(n=>{const r=n.findIndex(t=>t.id===e);return r>=0?n.slice(0,r+1):[...n,{id:e,name:t}]})}catch(qo){console.error("Failed to navigate folder",qo)}},W=async e=>{const t=e?Array.from(e):[];if(t.length&&f){_(!0),k(0),R([]);try{const e=await n(["Files.ReadWrite.All","Sites.Read.All"]);if(!e)throw new Error("No token available");const o=[];for(let n=0;n<t.length;n++){const i=t[n];if(i.size>H)R(e=>[...e,{name:i.name,progress:0,error:"File exceeds ".concat(Math.round(50),"MB limit")}]);else{R(e=>[...e,{name:i.name,progress:0}]);try{const t=await bo(e,f,i,i.name,void 0,e=>{k(e),R(t=>{const n=[...t],r=n.findIndex(e=>e.name===i.name);return r>=0&&(n[r]=(0,Fe.A)((0,Fe.A)({},n[r]),{},{progress:e})),n})},O);o.push(t),v(e=>[{id:t.id,name:t.name,webUrl:t.webUrl,size:t.size||i.size,createdDateTime:t.createdDateTime||(new Date).toISOString(),lastModifiedDateTime:t.lastModifiedDateTime||(new Date).toISOString(),file:t.file||{mimeType:i.type||"application/octet-stream"},parentReference:t.parentReference},...e]),b(e=>new Set(e).add(t.id))}catch(r){const e="string"===typeof(null===r||void 0===r?void 0:r.message)?r.message:"Upload failed";R(t=>{const n=[...t],r=n.findIndex(e=>e.name===i.name);return r>=0&&(n[r]=(0,Fe.A)((0,Fe.A)({},n[r]),{},{error:e})),n})}}}window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Uploaded ".concat(o.length," file(s)")}})),T("browse")}catch(qo){console.error("Upload failed",qo),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Upload failed"}}))}finally{_(!1),k(null)}}};return(0,tt.jsxs)("div",{style:{border:"1px solid #e0e0e0",borderRadius:8,padding:16},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:16},children:"SharePoint Documents"}),(0,tt.jsxs)("div",{style:{marginBottom:12},children:[!o&&(0,tt.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#fff3cd",padding:8,borderRadius:6,border:"1px solid #ffeeba"},children:[(0,tt.jsx)("span",{children:"You're not signed in."}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>r().then(()=>F()),children:"Sign in"})]}),L&&(0,tt.jsxs)("div",{className:"small",style:{display:"flex",gap:8,alignItems:"center",background:"#f8d7da",padding:8,borderRadius:6,border:"1px solid #f5c6cb",marginTop:8},children:[(0,tt.jsx)("span",{style:{flex:1},children:L}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>F(),children:"Retry"})]})]}),(0,tt.jsx)("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"1px solid #e0e0e0"},children:["browse","upload"].map(e=>(0,tt.jsx)("button",{className:S===e?"btn sm":"btn ghost sm",onClick:()=>T(e),children:"browse"===e?"Browse":"Upload"},e))}),a&&(0,tt.jsx)("div",{className:"small muted",children:"Loading..."}),(0,tt.jsxs)("div",{style:{marginBottom:16},children:[(0,tt.jsx)("label",{className:"small",children:"SharePoint Site:"}),(0,tt.jsxs)("select",{value:d,onChange:e=>u(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,tt.jsx)("option",{value:"",children:"Select a site..."}),c.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.displayName},e.id))]})]}),d&&(0,tt.jsxs)("div",{style:{marginBottom:16},children:[(0,tt.jsx)("label",{className:"small",children:"Document Library:"}),(0,tt.jsxs)("select",{value:f,onChange:e=>m(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,tt.jsx)("option",{value:"",children:"Select a library..."}),h.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.displayName},e.id))]})]}),f&&"browse"===S&&(0,tt.jsx)("div",{style:{marginBottom:16},children:(0,tt.jsx)("input",{type:"text",placeholder:"Search documents...",value:w,onChange:e=>C(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4}})}),"browse"===S&&(0,tt.jsxs)("div",{style:{maxHeight:300,overflowY:"auto"},children:[f&&(0,tt.jsx)("div",{className:"small",style:{marginBottom:8},children:j.map((e,t)=>(0,tt.jsxs)("span",{children:[t>0&&" / ",(0,tt.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),z(e.id,e.name)},children:e.name})]},e.id))}),f&&x.filter(e=>e.folder).map(e=>{var t,n;return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 8px",borderBottom:"1px solid #f5f5f5"},children:[(0,tt.jsxs)("button",{className:"btn ghost sm",onClick:()=>z(e.id,e.name),children:["\ud83d\udcc1 ",e.name]}),(0,tt.jsxs)("span",{className:"small muted",children:[null!==(t=null===(n=e.folder)||void 0===n?void 0:n.childCount)&&void 0!==t?t:0," items"]})]},e.id)}),g.length>0&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>b(new Set(g.map(e=>e.id))),children:"Select All"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>b(new Set),children:"Clear"}),(0,tt.jsxs)("span",{className:"small muted",children:["Selected: ",y.size]})]}),g.map(e=>(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,borderBottom:"1px solid #f0f0f0"},children:[(0,tt.jsx)("input",{type:"checkbox",checked:y.has(e.id),onChange:()=>(e=>{const t=new Set(y);t.has(e)?t.delete(e):t.add(e),b(t)})(e.id)}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("div",{style:{fontWeight:500},children:e.name}),(0,tt.jsxs)("div",{className:"small muted",children:[e.size?(e.size/1024).toFixed(1)+" KB":"",e.lastModifiedDateTime?" \u2022 Modified ".concat(new Date(e.lastModifiedDateTime).toLocaleDateString()):""]}),(0,tt.jsx)("a",{href:e.webUrl,target:"_blank",rel:"noopener noreferrer",className:"small",style:{color:"#0066cc"},children:"View in SharePoint \u2197"})]})]},e.id))]})]}),"upload"===S&&(0,tt.jsxs)("div",{children:[!f&&(0,tt.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Select a site and library to enable uploads."}),f&&(0,tt.jsxs)("div",{style:{marginBottom:12},children:[(0,tt.jsx)("label",{className:"small",children:"Target folder:"}),(0,tt.jsxs)("select",{value:O,onChange:e=>P(e.target.value),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4},children:[(0,tt.jsx)("option",{value:"root",children:"/ (root)"}),x.filter(e=>e.folder).map(e=>(0,tt.jsxs)("option",{value:e.id,children:["/ ",e.name]},e.id))]})]}),(0,tt.jsxs)("div",{onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),f&&!E&&B(!0)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),B(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),B(!1);const t=e.dataTransfer.files;t&&t.length>0&&W(t)},style:{border:"2px dashed "+(U?"var(--primary)":"#ccc"),background:U?"rgba(0,0,0,0.02)":"transparent",padding:16,borderRadius:8,textAlign:"center",opacity:!f||E?.6:1,pointerEvents:!f||E?"none":"auto"},children:[(0,tt.jsx)("div",{className:"small",style:{marginBottom:8},children:"Drag and drop files here"}),(0,tt.jsx)("div",{className:"small muted",children:"or"}),(0,tt.jsx)("div",{style:{marginTop:8},children:(0,tt.jsxs)("label",{className:"btn ghost sm",style:{cursor:!f||E?"not-allowed":"pointer"},children:["Browse files",(0,tt.jsx)("input",{type:"file",multiple:!0,disabled:!f||E,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.html",onChange:e=>W(e.target.files),style:{display:"none"}})]})}),(0,tt.jsx)("div",{className:"small muted",style:{marginTop:8},children:"Allowed: PDF, Word, Excel, PowerPoint, Text, HTML"})]}),E&&(0,tt.jsxs)("div",{className:"small",style:{marginTop:8},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,tt.jsx)("span",{children:"Uploading..."}),(0,tt.jsxs)("span",{children:[null!==A&&void 0!==A?A:0,"%"]})]}),(0,tt.jsx)("div",{className:"progressBar","aria-hidden":"true",style:{marginTop:6},children:(0,tt.jsx)("i",{style:{width:"".concat(null!==A&&void 0!==A?A:0,"%")}})})]}),I.length>0&&(0,tt.jsx)("div",{style:{marginTop:8},children:I.map((e,t)=>(0,tt.jsxs)("div",{className:"small",style:{display:"grid",gap:4,marginBottom:6},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[(0,tt.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),e.error?(0,tt.jsx)("span",{style:{color:"#d33"},children:e.error}):(0,tt.jsxs)("span",{children:[e.progress,"%"]})]}),!e.error&&(0,tt.jsx)("div",{className:"progressBar","aria-hidden":"true",children:(0,tt.jsx)("i",{style:{width:"".concat(e.progress,"%")}})})]},t))}),(0,tt.jsx)("div",{className:"small muted",style:{marginTop:8},children:"Files are uploaded into the selected folder. Large files use a chunked upload session."})]})]})},Ao=()=>{var e,t,n,r,o;const{role:a,canSeeAdmin:s,canEditAdmin:c}=Or(),{account:l}=ot(),[d,u]=(0,i.useState)("overview"),[h,p]=(0,i.useState)(null),[f,m]=(0,i.useState)(new Set),[g,v]=(0,i.useState)(new Set),[y,b]=(0,i.useState)("unknown"),w=async()=>{try{if(!Y)return void b("unknown");const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),t=await fetch("".concat(e,"/api/health"),{cache:"no-store"});b(t.ok?"ok":"down")}catch(e){b("down")}};(0,i.useEffect)(()=>{w()},[]);const[C,S]=(0,i.useState)(!1),[T,E]=(0,i.useState)(null),[_,A]=(0,i.useState)(!1),[k,I]=(0,i.useState)({}),R="sunbeth:admin:useModalSelectors",x="true"===({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ADMIN_LIGHT||"").toLowerCase(),N=(()=>{const e=({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ADMIN_MODAL_SELECTORS||"").toLowerCase();return"true"===e||"false"!==e})(),[O,P]=(0,i.useState)(()=>{try{const e=localStorage.getItem(R);if("true"===e)return!0;if("false"===e)return!1}catch(e){}return N}),[j,M]=(0,i.useState)(!1),[L,D]=(0,i.useState)(!1),[U,B]=(0,i.useState)(!1),H=["User.Read","User.Read.All","Group.Read.All","Mail.Send"],F=async()=>{const e={};for(const n of H)try{await Hr([n]),e[n]=!0}catch(t){e[n]=!1}I(e)};(0,i.useEffect)(()=>{x||F().catch(()=>{})},[x]);const[q,K]=(0,i.useState)({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),[z,W]=(0,i.useState)([]);(0,i.useEffect)(()=>{W(q.selectedUsers)},[q.selectedUsers]);const G=(e,t)=>{const n=(e||"").trim().toLowerCase();n&&ee(e=>(0,Fe.A)((0,Fe.A)({},e),{},{[n]:t}))},V=e=>{const t={};for(const n of z){const r=(n.mail||n.userPrincipalName||"").trim().toLowerCase();r&&(t[r]=e)}ee(t)};if(!s)return(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsx)("h2",{style:{color:"#d63384",margin:0},children:"Access Denied"}),(0,tt.jsx)("p",{children:"You do not have permission to access the Admin Panel."}),(0,tt.jsxs)("p",{className:"small muted",children:["Current role: ",a]})]})});const Y="true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE,[Q,$]=(0,i.useState)(null),[J,X]=(0,i.useState)([]),[Z,ee]=(0,i.useState)({}),[te,ne]=(0,i.useState)("");(0,i.useEffect)(()=>{Y&&(async()=>{try{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),t=await fetch("".concat(e,"/api/stats"));if(!t.ok)throw new Error("stats_failed");const n=await t.json();$(n)}catch(Ko){}})()},[Y]),(0,i.useEffect)(()=>{Y&&(async()=>{try{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),t=await fetch("".concat(e,"/api/businesses"));if(!t.ok)throw new Error("biz_failed");const n=await t.json(),r=(Array.isArray(n)?n:Array.isArray(null===n||void 0===n?void 0:n.value)?n.value:[]).map(e=>{var t,n,r,o,i,a,s,c,l,d;return{id:Number(null!==(t=null!==(n=null!==(r=e.id)&&void 0!==r?r:e.businessId)&&void 0!==n?n:e.ID)&&void 0!==t?t:e.toba_businessid),name:String(null!==(o=null!==(i=null!==(a=null!==(s=null!==(c=e.name)&&void 0!==c?c:e.Title)&&void 0!==s?s:e.title)&&void 0!==a?a:e.toba_name)&&void 0!==i?i:e.code)&&void 0!==o?o:"Business"),code:null!==(l=e.code)&&void 0!==l?l:e.toba_code,isActive:!!(null!==(d=e.isActive)&&void 0!==d?d:e.toba_isactive)}}).filter(e=>Number.isFinite(e.id)&&!!e.name);X(r)}catch(qo){console.warn("Failed to load businesses",qo),X([])}})()},[Y]);return(0,tt.jsxs)("div",{className:"container",children:[(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("h1",{style:{margin:0,fontSize:24,color:"var(--primary)"},children:"Admin Panel"}),(0,tt.jsxs)("p",{className:"small muted",children:["Role: ",a," \u2022 ",c?"Full Access":"Read Only"]})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[Y&&(0,tt.jsxs)("div",{className:"small",title:"SQLite API health",style:{display:"flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #eee",borderRadius:999},children:[(0,tt.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:"ok"===y?"#28a745":"down"===y?"#dc3545":"#ffc107"}}),(0,tt.jsxs)("span",{children:["API: ","ok"===y?"OK":"down"===y?"Down":"\u2014"]}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:w,style:{marginLeft:6},children:"Refresh"})]}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>{try{const e=[["Title","Url"],...q.selectedDocuments.map(e=>[e.title,e.url])].map(e=>e.map(e=>'"'+String(e).replace(/"/g,'""')+'"').join(",")).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="sunbeth-export.csv",r.click(),URL.revokeObjectURL(n)}catch(qo){console.warn("Export failed",qo)}},children:"Export Data"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:async()=>{S(!0),E(null);try{E(await yo())}catch(qo){E([{name:"Health check",ok:!1,detail:String(qo)}])}},children:"System Health"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>M(!0),title:"Open batch creation debug console",children:"\ud83d\udd0d Debug Logs"}),Y&&c&&(0,tt.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),t=(null===l||void 0===l?void 0:l.username)||"seed.user@sunbeth.com";if(!(await fetch("".concat(e,"/api/seed?email=").concat(encodeURIComponent(t)),{method:"POST"})).ok)throw new Error("seed_failed");window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Seeded demo data"}}))}catch(e){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Seed failed"}}))}},children:"Seed Data"})]})]}),(0,tt.jsx)("div",{style:{display:"flex",gap:4,marginBottom:24,borderBottom:"2px solid #f0f0f0"},children:[{id:"overview",label:"Overview",icon:"\ud83d\udcca"},{id:"settings",label:"Settings",icon:"\u2699\ufe0f"},{id:"manage",label:"Manage",icon:"\ud83e\uddf0"},{id:"batch",label:"Create Batch",icon:"\ud83d\udcdd"},{id:"analytics",label:"Analytics",icon:"\ud83d\udcc8"}].map(e=>(0,tt.jsxs)("button",{className:d===e.id?"btn sm":"btn ghost sm",onClick:()=>u(e.id),style:{borderRadius:"8px 8px 0 0"},children:[e.icon," ",e.label]},e.id))}),"overview"===d&&(0,tt.jsxs)("div",{children:[(0,tt.jsx)("h2",{style:{fontSize:18,marginBottom:16},children:"System Overview"}),(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,tt.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,tt.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"var(--primary)"},children:null!==(e=null===Q||void 0===Q?void 0:Q.activeBatches)&&void 0!==e?e:"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:"Active Batches"})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,tt.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#28a745"},children:null!==(t=null===Q||void 0===Q||null===(n=Q.totalUsers)||void 0===n||null===(r=n.toLocaleString)||void 0===r?void 0:r.call(n))&&void 0!==t?t:"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:"Total Users"})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,tt.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#ffc107"},children:Q?"".concat(Q.completionRate,"%"):"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:"Completion Rate"})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16,textAlign:"center"},children:[(0,tt.jsx)("div",{style:{fontSize:28,fontWeight:"bold",color:"#17a2b8"},children:null!==(o=null===Q||void 0===Q?void 0:Q.overdueBatches)&&void 0!==o?o:0}),(0,tt.jsx)("div",{className:"small muted",children:"Overdue Batches"})]})]}),(0,tt.jsxs)("div",{className:"card",style:{marginTop:16,padding:16},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700,color:"var(--primary)"},children:"Permissions Status"}),(0,tt.jsx)("div",{className:"muted small",children:"Required Microsoft Graph scopes"})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>F(),children:"Refresh"}),(0,tt.jsx)("button",{className:"btn sm",onClick:async()=>{try{A(!0);for(const t of H)try{await Hr([t])}catch(e){}await F(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Permission prompts completed"}}))}finally{A(!1)}},disabled:_,children:"Grant All"})]})]}),(0,tt.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:8},children:H.map(e=>(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8,border:"1px solid #eee",borderRadius:6},children:[(0,tt.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:k[e]?"#28a745":"#dc3545"}}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("div",{style:{fontWeight:600},children:e}),!k[e]&&(0,tt.jsxs)("button",{className:"btn ghost sm",onClick:async()=>{try{await Hr([e])}catch(t){}await F()},children:["Grant ",e]}),k[e]&&(0,tt.jsx)("div",{className:"small muted",children:"Granted"})]})]},e))})]})]}),"settings"===d&&(0,tt.jsx)(To,{canEdit:c}),"manage"===d&&(0,tt.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,tt.jsxs)("div",{className:"card",style:{padding:16},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Batches"}),(0,tt.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"View, edit, or delete batches. Deleting a batch removes its documents, recipients, and acknowledgements."}),(0,tt.jsx)(xo,{canEdit:c,onEdit:e=>(async e=>{try{if(!Y)return;const r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),o=await fetch("".concat(r,"/api/batches")),i=await o.json(),a=(Array.isArray(i)?i:[]).find(t=>String(t.toba_batchid||t.id||t.batchId||t.ID)===String(e));if(!a)throw new Error("batch_not_found");let s=[];try{const t=await fetch("".concat(r,"/api/batches/").concat(encodeURIComponent(e),"/documents"));s=await t.json()}catch(t){s=[]}let c=[];try{const t=await fetch("".concat(r,"/api/recipients")),n=await t.json();c=(Array.isArray(n)?n:[]).filter(t=>String(t.batchId)===String(e))}catch(n){c=[]}const l=(s||[]).map(e=>{var t;return{title:e.title||e.name||e.toba_title||"Document",url:e.url||e.webUrl||e.toba_fileurl,version:Number(e.version||e.toba_version||1),requiresSignature:!!(null!==(t=e.requiresSignature)&&void 0!==t?t:e.toba_requiressignature),driveId:e.driveId||e.toba_driveid||void 0,itemId:e.itemId||e.toba_itemid||void 0,source:e.source||e.toba_source||(e.driveId||e.toba_driveid?"sharepoint":void 0)}}),d=(c||[]).map(e=>({id:e.email||e.user||e.userPrincipalName||e.id||e.email,displayName:e.displayName||e.email,userPrincipalName:e.email,department:e.department,jobTitle:e.jobTitle})),h=[],f={};for(const e of c){const t=String(e.email||e.user||"").toLowerCase();t&&(f[t]=null!=e.businessId?Number(e.businessId):null)}m(new Set((c||[]).map(e=>String(e.email||e.user||"").trim().toLowerCase()).filter(Boolean))),v(new Set((s||[]).map(e=>String(e.url||e.webUrl||"").trim()).filter(Boolean))),K({name:String(a.toba_name||a.name||""),startDate:a.toba_startdate||a.startDate||"",dueDate:a.toba_duedate||a.dueDate||"",description:String(a.description||""),selectedUsers:d,selectedGroups:h,selectedDocuments:l,notifyByEmail:!0,notifyByTeams:!1}),ee(f),ne(""),p(String(e)),u("batch"),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Loaded batch into editor"}}))}catch(qo){console.error("Failed to load batch for editing",qo),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to open batch for editing"}}))}})(e)})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:16},children:"Businesses"}),(0,tt.jsx)("div",{className:"small muted",style:{marginBottom:8},children:"Create, edit, or delete businesses. Deleting a business will unassign it from any recipients mapped to it."}),(0,tt.jsx)(Ro,{canEdit:c})]})]}),"batch"===d&&(0,tt.jsxs)("div",{children:[(0,tt.jsx)("h2",{style:{fontSize:18,marginBottom:16},children:h?"Edit Batch":"Create New Batch"}),(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Batch Name:"}),(0,tt.jsx)("input",{type:"text",value:q.name,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{name:e.target.value})),placeholder:"Q1 2025 - Code of Conduct",style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Description:"}),(0,tt.jsx)("input",{type:"text",value:q.description,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{description:e.target.value})),placeholder:"Annual policy acknowledgement",style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Start Date:"}),(0,tt.jsx)("input",{type:"date",value:q.startDate,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{startDate:e.target.value})),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("label",{className:"small",children:"Due Date:"}),(0,tt.jsx)("input",{type:"date",value:q.dueDate,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{dueDate:e.target.value})),style:{width:"100%",padding:8,border:"1px solid #ddd",borderRadius:4,marginTop:4}})]})]}),(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,tt.jsx)("div",{className:"small muted",children:"Choose how you want to select recipients and documents."}),(0,tt.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:O,onChange:e=>{P(e.target.checked);try{localStorage.setItem(R,e.target.checked?"true":"false")}catch(t){}}}),"Use modal selectors"]})]}),O?(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,marginBottom:24},children:[(0,tt.jsxs)("div",{className:"card",style:{padding:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700},children:"Assign to Users & Groups"}),(0,tt.jsxs)("div",{className:"small muted",children:[q.selectedUsers.length," users, ",q.selectedGroups.length," groups selected"]})]}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>D(!0),children:"Edit selection"})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700},children:"Documents"}),(0,tt.jsxs)("div",{className:"small muted",children:[q.selectedDocuments.length," document(s) selected"]})]}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>B(!0),children:"Choose documents"})]}),(0,tt.jsxs)("div",{className:"card",style:{padding:16},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700},children:"Business Mapping"}),(0,tt.jsx)("div",{className:"small muted",children:"Assign selected users to businesses"})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,tt.jsx)("span",{className:"small muted",children:"Default:"}),(0,tt.jsxs)("select",{value:String(te),onChange:e=>ne(e.target.value?Number(e.target.value):""),children:[(0,tt.jsx)("option",{value:"",children:"\u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,tt.jsx)("span",{className:"small muted",children:"Apply to all:"}),(0,tt.jsxs)("select",{onChange:e=>V(e.target.value?Number(e.target.value):null),defaultValue:"",children:[(0,tt.jsx)("option",{value:"",children:"\u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),Y&&J.length>0?(0,tt.jsx)("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,maxHeight:200,overflowY:"auto"},children:z.map(e=>{var t;const n=(e.mail||e.userPrincipalName||"").trim().toLowerCase(),r=null!==(t=Z[n])&&void 0!==t?t:"";return(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"center"},children:[(0,tt.jsxs)("div",{style:{overflow:"hidden"},children:[(0,tt.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.displayName}),(0,tt.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})]}),(0,tt.jsxs)("select",{value:String(r),onChange:e=>G(n,e.target.value?Number(e.target.value):null),children:[(0,tt.jsx)("option",{value:"",children:"\u2014 No business \u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]})]},e.id)})}):(0,tt.jsx)("div",{className:"small muted",style:{marginTop:8},children:Y?"No businesses found.":"Enable SQLite to load businesses."})]})]}):(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:24,marginBottom:24},children:[(0,tt.jsx)(Eo,{onSelectionChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{selectedUsers:e.users,selectedGroups:e.groups}))}),(0,tt.jsx)(_o,{onDocumentSelect:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{selectedDocuments:e.map(e=>{var t;return{title:e.name,url:e.webUrl,version:1,requiresSignature:!1,driveId:null===e||void 0===e||null===(t=e.parentReference)||void 0===t?void 0:t.driveId,itemId:null===e||void 0===e?void 0:e.id,source:"sharepoint"}})}))}),(0,tt.jsxs)("div",{className:"card",style:{padding:16},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700},children:"Business Mapping"}),(0,tt.jsx)("div",{className:"small muted",children:"Assign each selected user to a business"})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,tt.jsx)("span",{className:"small muted",children:"Default:"}),(0,tt.jsxs)("select",{value:String(te),onChange:e=>ne(e.target.value?Number(e.target.value):""),children:[(0,tt.jsx)("option",{value:"",children:"\u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,tt.jsx)("span",{className:"small muted",children:"Apply to all:"}),(0,tt.jsxs)("select",{onChange:e=>V(e.target.value?Number(e.target.value):null),defaultValue:"",children:[(0,tt.jsx)("option",{value:"",children:"\u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]}),q.selectedGroups.length>0&&(0,tt.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{if(0===q.selectedGroups.length)return;const e=await Hr(["Group.Read.All","User.Read"]),t=await Promise.all(q.selectedGroups.map(t=>lo(e,t.id).catch(()=>[]))),n=[].concat(...t),r=new Map,o=e=>{const t=(e.mail||e.userPrincipalName||"").trim().toLowerCase();t&&(r.has(t)||r.set(t,e))};q.selectedUsers.forEach(o),n.forEach(o),W(Array.from(r.values())),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Loaded ".concat(n.length," member(s) from selected group(s)")}}))}catch(qo){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to expand groups for mapping"}}))}},title:"Load members of selected groups for per-user mapping",children:"Expand groups for mapping"}),(0,tt.jsxs)("span",{className:"small muted",children:["Users to map: ",z.length]})]})]}),!Y&&(0,tt.jsx)("div",{className:"small muted",children:"Enable SQLite to load businesses."}),Y&&0===J.length&&(0,tt.jsx)("div",{className:"small muted",children:"No businesses found."}),Y&&J.length>0&&(0,tt.jsx)("div",{style:{maxHeight:260,overflowY:"auto",display:"grid",gap:8},children:z.map(e=>{var t;const n=(e.mail||e.userPrincipalName||"").trim().toLowerCase(),r=null!==(t=Z[n])&&void 0!==t?t:"";return(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.displayName}),(0,tt.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})]}),(0,tt.jsxs)("select",{value:String(r),onChange:e=>G(n,e.target.value?Number(e.target.value):null),children:[(0,tt.jsx)("option",{value:"",children:"\u2014 No business \u2014"}),J.map(e=>(0,tt.jsx)("option",{value:e.id,children:e.name},e.id))]})]},e.id)})})]})]}),(0,tt.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:16,borderRadius:8},children:[(0,tt.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:16},children:"Batch Summary"}),(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"small muted",children:"Assigned Users:"}),(0,tt.jsx)("div",{style:{fontWeight:"bold"},children:q.selectedUsers.length+q.selectedGroups.reduce((e,t)=>e+(t.memberCount||0),0)})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"small muted",children:"Documents:"}),(0,tt.jsx)("div",{style:{fontWeight:"bold"},children:q.selectedDocuments.length})]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"small muted",children:"Duration:"}),(0,tt.jsx)("div",{style:{fontWeight:"bold"},children:q.startDate&&q.dueDate?Math.ceil((new Date(q.dueDate).getTime()-new Date(q.startDate).getTime())/864e5)+" days":"Not set"})]})]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:16,marginTop:16,alignItems:"center",flexWrap:"wrap"},children:[(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,tt.jsx)("input",{type:"checkbox",checked:q.notifyByEmail,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{notifyByEmail:e.target.checked}))}),(0,tt.jsx)("span",{className:"small",children:"Email notification (Microsoft Graph)"})]}),(0,tt.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,opacity:.6},title:"Requires Teams Chat.ReadWrite; coming soon",children:[(0,tt.jsx)("input",{type:"checkbox",checked:q.notifyByTeams,onChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{notifyByTeams:e.target.checked})),disabled:!0}),(0,tt.jsx)("span",{className:"small",children:"Teams message (optional)"})]})]}),(0,tt.jsxs)("div",{style:{marginTop:16,display:"flex",gap:8},children:[(0,tt.jsx)("button",{className:"btn",onClick:async()=>{try{if("true"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE||!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE)return void window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Enable SQLite (REACT_APP_ENABLE_SQLITE=true) and set REACT_APP_API_BASE."}}));const o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE.replace(/\/$/,""),i=new Map,a=new Map,s=(e,t,n)=>{const r=(e||"").trim();if(!r)return;const o=r.toLowerCase();if(i.has(o)||i.set(o,{address:r,name:t}),n){const e=a.get(o)||new Set;e.add(n),a.set(o,e)}};for(const e of q.selectedUsers)s(e.mail||e.userPrincipalName||"",e.displayName);if(q.selectedGroups.length>0)try{const e=await Hr(["Group.Read.All","User.Read"]),t=await Promise.all(q.selectedGroups.map(t=>lo(e,t.id).then(e=>({gid:t.id,members:e})).catch(()=>({gid:t.id,members:[]}))));for(const{gid:n,members:r}of t)for(const e of r)s(e.mail||e.userPrincipalName||"",e.displayName,n)}catch(qo){console.warn("Failed to expand group members for notifications",qo)}const c=Array.from(i.values()),l=new Map;for(const e of q.selectedUsers){const t=(e.mail||e.userPrincipalName||"").trim().toLowerCase();t&&l.set(t,e)}const{subject:d,bodyHtml:u}=(r={appUrl:window.location.origin,batchName:q.name,startDate:q.startDate,dueDate:q.dueDate,description:q.description},{subject:"New Acknowledgement Assigned: ".concat(r.batchName),bodyHtml:'\n    <div style="font-family:Segoe UI,Tahoma,Arial,sans-serif;font-size:14px;color:#111">\n      <p>Hello,</p>\n      <p>You have been assigned a new acknowledgement batch: <strong>'.concat(r.batchName,"</strong>.</p>\n      ").concat(r.description?"<p>".concat(r.description,"</p>"):"","\n      <ul>\n        ").concat(r.startDate?"<li><strong>Start:</strong> ".concat(new Date(r.startDate).toLocaleDateString(),"</li>"):"","\n        ").concat(r.dueDate?"<li><strong>Due:</strong> ".concat(new Date(r.dueDate).toLocaleDateString(),"</li>"):"",'\n      </ul>\n      <p>\n        Please open the portal to review and acknowledge the assigned documents:<br/>\n        <a href="').concat(r.appUrl,'" target="_blank" rel="noopener">Open Sunbeth Acknowledgement Portal</a>\n      </p>\n      <p style="color:#666">This message was sent via Microsoft Graph. Do not reply.</p>\n    </div>\n  ')});let y,b=c;if(h){const e=e=>!f.has((e||"").trim().toLowerCase());b=c.filter(t=>e(t.address))}if(q.notifyByEmail&&b.length>0&&await(async(e,t,n)=>{if(!e||0===e.length)return;const r=await Hr(["Mail.Send"]),o=((e,t)=>{const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n})(e,90);for(const i of o){const e={message:{subject:t,body:{contentType:"HTML",content:n},toRecipients:i.map(e=>({emailAddress:{address:e.address,name:e.name||e.address}}))},saveToSentItems:!0},o=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const e=await o.text().catch(()=>"");throw new Error("sendMail failed: ".concat(o.status," ").concat(o.statusText," \u2014 ").concat(e))}}})(b,d,u),h){y=h;if(!(await fetch("".concat(o,"/api/batches/").concat(encodeURIComponent(y)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:q.name,startDate:q.startDate||null,dueDate:q.dueDate||null,description:q.description||null,status:1})})).ok)throw new Error("batch_update_failed")}else{var e,t,n;const r=await fetch("".concat(o,"/api/batches"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:q.name,startDate:q.startDate||null,dueDate:q.dueDate||null,description:q.description||null,status:1})});if(!r.ok)throw new Error("batch_create_failed");const i=await r.json(),a=null!==(e=null!==(t=null!==(n=null===i||void 0===i?void 0:i.id)&&void 0!==n?n:null===i||void 0===i?void 0:i.batchId)&&void 0!==t?t:null===i||void 0===i?void 0:i.toba_batchid)&&void 0!==e?e:null===i||void 0===i?void 0:i.ID;if(y="string"===typeof a?a:Number.isFinite(Number(a))?String(a):void 0,!y)throw new Error("batch_id_missing")}const w=q.selectedDocuments.map(e=>{var t;return{title:e.title,url:e.url,version:null!==(t=e.version)&&void 0!==t?t:1,requiresSignature:!!e.requiresSignature,driveId:e.driveId||null,itemId:e.itemId||null,source:e.source||null}}),C=h?w.filter(e=>!g.has((e.url||"").trim())):w;if(C.length>0){if(!(await fetch("".concat(o,"/api/batches/").concat(y,"/documents"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documents:C})})).ok)throw new Error("docs_insert_failed")}const S=c.map(e=>{var t;const n=(e.address||"").toLowerCase(),r=l.get(n);let o;const i=a.get(n);if(i&&i.size>0){const e=i.values().next().value,t=q.selectedGroups.find(t=>t.id===e);null!==t&&void 0!==t&&t.displayName&&(o=t.displayName)}return{businessId:null!==(t=Z[n])&&void 0!==t?t:""!==te?Number(te):null,user:n,email:n,userEmail:n,userPrincipalName:n,displayName:e.name||void 0,department:(null===r||void 0===r?void 0:r.department)||void 0,jobTitle:(null===r||void 0===r?void 0:r.jobTitle)||void 0,location:(null===r||void 0===r?void 0:r.officeLocation)||void 0,primaryGroup:o||void 0}}),T=h?S.filter(e=>!f.has((e.email||"").trim().toLowerCase())):S;if(T.length>0){if(!(await fetch("".concat(o,"/api/batches/").concat(y,"/recipients"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipients:T})})).ok)throw new Error("recipients_insert_failed");try{const e=await fetch("".concat(o,"/api/batches/").concat(y,"/recipients"),{cache:"no-store"}),t=await e.json();Array.isArray(t)&&0!==t.length||(console.warn("Recipients verification returned empty for batch",y),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Warning: recipients not linked to batch (verification empty)"}})))}catch(qo){console.warn("Recipients verification failed",qo)}}const E=h?"updated":"created";window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:'Batch "'.concat(q.name,'" ').concat(E," in SQLite").concat(q.notifyByEmail?" and email sent":"",".")}})),K({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),ee({}),ne(""),p(null),m(new Set),v(new Set)}catch(qo){console.error("Save batch failed",qo),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to save batch or send notifications"}}))}var r},disabled:!q.name||!q.startDate||!q.dueDate||0===q.selectedDocuments.length||0===q.selectedUsers.length&&0===q.selectedGroups.length,children:h?"Save Changes":"Create Batch"}),(0,tt.jsx)("button",{className:"btn ghost",onClick:()=>{K({name:"",startDate:"",dueDate:"",description:"",selectedUsers:[],selectedGroups:[],selectedDocuments:[],notifyByEmail:!0,notifyByTeams:!1}),ee({}),ne(""),p(null)},children:h?"Cancel Edit":"Reset Form"}),(0,tt.jsx)("button",{className:"btn ghost",title:"Preview expanded recipients",onClick:async()=>{try{const e=new Set;for(const n of q.selectedUsers){const t=(n.mail||n.userPrincipalName||"").trim();t&&e.add(t.toLowerCase())}if(q.selectedGroups.length>0){const t=await Hr(["Group.Read.All","User.Read"]),n=await Promise.all(q.selectedGroups.map(e=>lo(t,e.id).catch(()=>[]))),r=[].concat(...n);for(const o of r){const t=(o.mail||o.userPrincipalName||"").trim();t&&e.add(t.toLowerCase())}}const t=e.size;window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Recipient preview: ".concat(t," unique addresses")}}))}catch(qo){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to preview recipients"}}))}},children:"Preview Recipients"}),(0,tt.jsx)("button",{className:"btn ghost",title:"Grant Graph permissions",onClick:async()=>{try{await Hr(["User.Read.All","Group.Read.All"]),await Hr(["Mail.Send"]),await Hr(["Sites.Read.All","Files.ReadWrite.All"]),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Permissions granted (if consented)"}}))}catch(qo){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Permission grant failed"}}))}},children:"Grant Permissions"})]})]})]}),"analytics"===d&&(0,tt.jsx)(go,{})]}),O&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(vo,{open:L,onClose:()=>D(!1),title:"Assign to Users & Groups",width:800,children:(0,tt.jsx)(Eo,{onSelectionChange:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{selectedUsers:e.users,selectedGroups:e.groups}))})}),(0,tt.jsx)(vo,{open:U,onClose:()=>B(!1),title:"SharePoint Documents",width:920,children:(0,tt.jsx)(_o,{onDocumentSelect:e=>K((0,Fe.A)((0,Fe.A)({},q),{},{selectedDocuments:e.map(e=>{var t;return{title:e.name,url:e.webUrl,version:1,requiresSignature:!1,driveId:null===e||void 0===e||null===(t=e.parentReference)||void 0===t?void 0:t.driveId,itemId:null===e||void 0===e?void 0:e.id,source:"sharepoint"}})}))})})]}),C&&(0,tt.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.3)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,tt.jsxs)("div",{className:"card",style:{width:520,maxWidth:"90%",padding:16},children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,tt.jsx)("h3",{style:{margin:0},children:"System Health"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>S(!1),children:"Close"})]}),!T&&(0,tt.jsx)("div",{className:"small muted",children:"Running checks..."}),T&&(0,tt.jsxs)("div",{style:{display:"grid",gap:8},children:[T.map((e,t)=>(0,tt.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",padding:8,border:"1px solid #eee",borderRadius:6},children:[(0,tt.jsx)("span",{style:{width:10,height:10,borderRadius:"50%",background:e.ok?"#28a745":"#dc3545"}}),(0,tt.jsxs)("div",{style:{flex:1},children:[(0,tt.jsx)("div",{style:{fontWeight:600},children:e.name}),e.detail&&(0,tt.jsx)("div",{className:"small muted",style:{whiteSpace:"pre-wrap"},children:e.detail})]})]},t)),(0,tt.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{A(!0),await Hr(["User.Read"]),await Hr(["User.Read.All"]),await Hr(["Group.Read.All"]),await Hr(["Sites.Read.All"]),await Hr(["Files.ReadWrite.All"]),await Hr(["Mail.Send"]),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Requested missing permissions"}}))}finally{A(!1);try{E(await yo())}catch(e){}}},disabled:_,children:"Grant Missing Permissions"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:async()=>{try{E(await yo())}catch(e){}},children:"Re-run"})]})]})]})}),(0,tt.jsx)(So,{isVisible:j,onClose:()=>M(!1)})]})},ko=()=>(({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE||"").replace(/\/$/,"")),Io=()=>"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_SQLITE&&!!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE,Ro=e=>{let{canEdit:t}=e;const[n,r]=(0,i.useState)([]),[o,a]=(0,i.useState)(!1),[s,c]=(0,i.useState)({name:"",code:"",isActive:!0,description:""}),[l,d]=(0,i.useState)({}),u=async()=>{if(Io())try{const e=await fetch("".concat(ko(),"/api/businesses")),t=await e.json();r(Array.isArray(t)?t:[])}catch(e){r([])}};(0,i.useEffect)(()=>{u()},[]);return Io()?(0,tt.jsxs)("div",{style:{display:"grid",gap:12},children:[(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr 1fr auto",gap:8,alignItems:"center"},children:[(0,tt.jsx)("input",{placeholder:"Name",value:s.name,onChange:e=>c((0,Fe.A)((0,Fe.A)({},s),{},{name:e.target.value}))}),(0,tt.jsx)("input",{placeholder:"Code (optional)",value:s.code,onChange:e=>c((0,Fe.A)((0,Fe.A)({},s),{},{code:e.target.value}))}),(0,tt.jsx)("input",{placeholder:"Description",value:s.description,onChange:e=>c((0,Fe.A)((0,Fe.A)({},s),{},{description:e.target.value}))}),(0,tt.jsx)("button",{className:"btn sm",onClick:async()=>{if(!t||!Io())return;const e=s.name.trim();if(e){a(!0);try{if(!(await fetch("".concat(ko(),"/api/businesses"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,code:s.code||null,isActive:!!s.isActive,description:s.description||null})})).ok)throw new Error("create_failed");c({name:"",code:"",isActive:!0,description:""}),await u(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Business created"}}))}catch(n){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to create business"}}))}finally{a(!1)}}else window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Enter a business name"}}))},disabled:!t||o,children:"Add"})]}),(0,tt.jsx)("div",{style:{maxHeight:260,overflowY:"auto",border:"1px solid #eee",borderRadius:6},children:0===n.length?(0,tt.jsx)("div",{className:"small muted",style:{padding:8},children:"No businesses."}):n.map(e=>{l[e.id];const n=null!=l[e.id];return(0,tt.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr 1fr auto auto",gap:8,alignItems:"center",padding:8,borderBottom:"1px solid #f5f5f5"},children:n?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("input",{defaultValue:e.name,onChange:t=>d(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.id]:(0,Fe.A)((0,Fe.A)({},n[e.id]),{},{name:t.target.value})}))}),(0,tt.jsx)("input",{defaultValue:e.code||"",onChange:t=>d(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.id]:(0,Fe.A)((0,Fe.A)({},n[e.id]),{},{code:t.target.value})}))}),(0,tt.jsx)("input",{defaultValue:e.description||"",onChange:t=>d(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.id]:(0,Fe.A)((0,Fe.A)({},n[e.id]),{},{description:t.target.value})}))}),(0,tt.jsxs)("label",{className:"small",style:{display:"flex",alignItems:"center",gap:6},children:[(0,tt.jsx)("input",{type:"checkbox",defaultChecked:!!e.isActive,onChange:t=>d(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.id]:(0,Fe.A)((0,Fe.A)({},n[e.id]),{},{isActive:t.target.checked})}))})," Active"]}),(0,tt.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>d(t=>{const n=(0,Fe.A)({},t);return delete n[e.id],n}),children:"Cancel"}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>(async e=>{if(!t||!Io())return;const n=l[e];if(n){a(!0);try{if(!(await fetch("".concat(ko(),"/api/businesses/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("update_failed");d(t=>{const n=(0,Fe.A)({},t);return delete n[e],n}),await u(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Business updated"}}))}catch(r){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to update business"}}))}finally{a(!1)}}})(e.id),disabled:o,children:"Save"})]})]}):(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,tt.jsx)("div",{className:"small muted",children:e.code||"\u2014"}),(0,tt.jsx)("div",{className:"small muted",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.description||"\u2014"}),(0,tt.jsx)("span",{className:"badge",style:{background:e.isActive?"#d4edda":"#e2e3e5",color:e.isActive?"#155724":"#383d41"},children:e.isActive?"Active":"Inactive"}),(0,tt.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>d(t=>(0,Fe.A)((0,Fe.A)({},t),{},{[e.id]:{}})),disabled:!t,children:"Edit"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{if(t&&Io()&&confirm("Delete this business? This will unassign it from any recipients.")){a(!0);try{if(!(await fetch("".concat(ko(),"/api/businesses/").concat(e),{method:"DELETE"})).ok)throw new Error("delete_failed");await u(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Business deleted"}}))}catch(n){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to delete business"}}))}finally{a(!1)}}})(e.id),disabled:!t,children:"Delete"})]})]})},e.id)})})]}):(0,tt.jsx)("div",{className:"small muted",children:"Enable SQLite to manage businesses."})},xo=e=>{let{canEdit:t,onEdit:n}=e;const[r,o]=(0,i.useState)([]),[a,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)({}),[d,u]=(0,i.useState)({open:!1,rows:[]}),h=async()=>{if(Io())try{const e=await fetch("".concat(ko(),"/api/batches")),t=await e.json();o(Array.isArray(t)?t:[])}catch(e){o([])}};(0,i.useEffect)(()=>{h()},[]);return Io()?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:{maxHeight:420,overflowY:"auto",border:"1px solid #eee",borderRadius:6},children:0===r.length?(0,tt.jsx)("div",{className:"small muted",style:{padding:8},children:"No batches."}):r.map(e=>{const r=!!c[e.toba_batchid];return(0,tt.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.9fr 0.9fr 0.7fr 1.4fr auto",gap:8,alignItems:"center",padding:8,borderBottom:"1px solid #f5f5f5"},children:r?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("input",{defaultValue:e.toba_name,onChange:t=>l(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.toba_batchid]:(0,Fe.A)((0,Fe.A)({},n[e.toba_batchid]||{}),{},{name:t.target.value})}))}),(0,tt.jsx)("input",{type:"date",defaultValue:e.toba_startdate||"",onChange:t=>l(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.toba_batchid]:(0,Fe.A)((0,Fe.A)({},n[e.toba_batchid]||{}),{},{startDate:t.target.value})}))}),(0,tt.jsx)("input",{type:"date",defaultValue:e.toba_duedate||"",onChange:t=>l(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.toba_batchid]:(0,Fe.A)((0,Fe.A)({},n[e.toba_batchid]||{}),{},{dueDate:t.target.value})}))}),(0,tt.jsxs)("select",{defaultValue:e.toba_status||"1",onChange:t=>l(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.toba_batchid]:(0,Fe.A)((0,Fe.A)({},n[e.toba_batchid]||{}),{},{status:t.target.value})})),children:[(0,tt.jsx)("option",{value:"1",children:"Active"}),(0,tt.jsx)("option",{value:"0",children:"Inactive"})]}),(0,tt.jsx)("input",{placeholder:"Description",onChange:t=>l(n=>(0,Fe.A)((0,Fe.A)({},n),{},{[e.toba_batchid]:(0,Fe.A)((0,Fe.A)({},n[e.toba_batchid]||{}),{},{description:t.target.value})}))}),(0,tt.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>l(t=>{const n=(0,Fe.A)({},t);return delete n[e.toba_batchid],n}),children:"Cancel"}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>(async e=>{const t=c[e];if(t){s(!0);try{const n={name:t.name,startDate:t.startDate||null,dueDate:t.dueDate||null,status:t.status?Number(t.status):1,description:t.description||null};if(!(await fetch("".concat(ko(),"/api/batches/").concat(encodeURIComponent(e)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("update_failed");l(t=>{const n=(0,Fe.A)({},t);return delete n[e],n}),await h(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Batch updated"}}))}catch(n){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to update batch"}}))}finally{s(!1)}}})(e.toba_batchid),disabled:!t||a,children:"Save"})]})]}):(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:{fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.toba_name}),(0,tt.jsx)("div",{className:"small muted",children:e.toba_startdate||"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:e.toba_duedate||"\u2014"}),(0,tt.jsx)("span",{className:"badge",style:{background:"1"===(e.toba_status||"1")?"#d4edda":"#e2e3e5",color:"1"===(e.toba_status||"1")?"#155724":"#383d41"},children:"1"===(e.toba_status||"1")?"Active":"Inactive"}),(0,tt.jsx)("div",{className:"small muted"}),(0,tt.jsxs)("div",{style:{display:"flex",gap:6,justifyContent:"flex-end"},children:[(0,tt.jsx)("a",{href:"/batch/".concat(e.toba_batchid),children:(0,tt.jsx)("button",{className:"btn ghost sm",children:"View"})}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{try{const t=await fetch("".concat(ko(),"/api/recipients")),n=await t.json(),r=(Array.isArray(n)?n:[]).filter(t=>String(t.batchId)===String(e));u({open:!0,forBatch:e,rows:r})}catch(t){u({open:!0,forBatch:e,rows:[]})}})(e.toba_batchid),children:"Recipients"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>n(e.toba_batchid),disabled:!t,children:"Edit"}),(0,tt.jsx)("button",{className:"btn ghost sm",onClick:()=>(async e=>{if(t&&Io()&&confirm("Delete this batch and all related records?")){s(!0);try{if(!(await fetch("".concat(ko(),"/api/batches/").concat(encodeURIComponent(e)),{method:"DELETE"})).ok)throw new Error("delete_failed");await h(),window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Batch deleted"}}))}catch(n){window.dispatchEvent(new CustomEvent("sunbeth:toast",{detail:{message:"Failed to delete batch"}}))}finally{s(!1)}}})(e.toba_batchid),disabled:!t||a,children:"Delete"})]})]})},e.toba_batchid)})}),(0,tt.jsx)(vo,{open:d.open,onClose:()=>u({open:!1,rows:[]}),title:"Recipients for Batch ".concat(d.forBatch||""),width:700,children:0===d.rows.length?(0,tt.jsx)("div",{className:"small muted",children:"No recipients found."}):(0,tt.jsx)("div",{style:{maxHeight:360,overflowY:"auto",display:"grid",gap:8},children:d.rows.map((e,t)=>(0,tt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.6fr 1fr 1fr 1fr",gap:8},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:500},children:e.displayName||e.email}),(0,tt.jsx)("div",{className:"small muted",children:e.email})]}),(0,tt.jsx)("div",{className:"small muted",children:e.department||"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:e.jobTitle||"\u2014"}),(0,tt.jsx)("div",{className:"small muted",children:e.primaryGroup||"\u2014"})]},t))})})]}):(0,tt.jsx)("div",{className:"small muted",children:"Enable SQLite to manage batches."})},No=()=>{const{login:e}=ot(),[t,n]=(0,i.useState)(()=>{try{return localStorage.getItem("landing_variant")||"regular"}catch(e){return"regular"}});return(0,i.useEffect)(()=>{const e=e=>{e.key&&"landing_variant"!==e.key||(()=>{try{n(localStorage.getItem("landing_variant")||"regular")}catch(e){}})()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]),(0,tt.jsx)("div",{className:"container",style:{display:"flex",justifyContent:"center"},children:(0,tt.jsx)("div",{className:"card hero ".concat("compact"===t?"compact":""),style:{maxWidth:920,width:"100%"},children:(0,tt.jsxs)("div",{className:"hero-grid",style:{alignItems:"center"},children:[(0,tt.jsxs)("div",{className:"hero-text",style:{textAlign:"left"},children:[(0,tt.jsx)("div",{className:"eyebrow",children:"Welcome to"}),(0,tt.jsx)("h1",{className:"hero-title",style:{fontSize:32,lineHeight:1.2},children:"Sunbeth Document Acknowledgement"}),(0,tt.jsx)("p",{className:"hero-lead",style:{marginTop:12},children:"Read, understand, and acknowledge the policies and updates that keep our people and business safe."}),(0,tt.jsxs)("ul",{className:"features",style:{marginTop:14},children:[(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Clear workflows"})," \u2014 Step-by-step acknowledgement and progress tracking."]}),(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Secure"})," \u2014 Single sign-on with your corporate account."]}),(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Compliant"})," \u2014 Keep a verifiable record of acknowledgements."]})]}),(0,tt.jsxs)("div",{style:{marginTop:22,display:"flex",gap:10},children:[(0,tt.jsx)("button",{className:"btn sm",onClick:()=>e(),children:"Sign in to get started"}),(0,tt.jsx)(Ne,{to:"/about",children:(0,tt.jsx)("button",{className:"btn ghost sm",type:"button",children:"Learn more"})})]})]}),(0,tt.jsx)("div",{className:"hero-visual",style:{display:"flex",justifyContent:"center"},children:(0,tt.jsx)("img",{src:"https://images.unsplash.com/photo-1551861564-1b6f7f6e3f0e?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=ae2a1a7b6c2f4a6a8f3b9f7f3a1b6e3d",alt:"Employees acknowledging documents",style:{width:"100%",maxWidth:420,borderRadius:10}})})]})})})},Oo=()=>(0,tt.jsx)("div",{className:"container",children:(0,tt.jsxs)("div",{className:"card",style:{maxWidth:920,margin:"0 auto"},children:[(0,tt.jsx)("div",{className:"title",children:"About this Portal"}),(0,tt.jsx)("div",{className:"small",style:{marginTop:8},children:"A quick overview of how Sunbeth\u2019s Document Acknowledgement works."}),(0,tt.jsx)("hr",{style:{margin:"14px 0",border:"none",borderTop:"1px solid #f2f2f2"}}),(0,tt.jsxs)("div",{style:{color:"#333",lineHeight:1.55},children:[(0,tt.jsx)("p",{children:"This portal helps employees read and acknowledge mandatory company documents like corporate policies, health and safety guidance, and periodic updates."}),(0,tt.jsxs)("ul",{className:"features",children:[(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Simple workflow"})," \u2014 Read each document and acknowledge with a click."]}),(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Progress tracking"})," \u2014 See your overall completion by batch."]}),(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Secure sign-in"})," \u2014 Authentication via Microsoft Entra (Azure AD)."]}),(0,tt.jsxs)("li",{children:[(0,tt.jsx)("strong",{children:"Compliance"})," \u2014 Acknowledgements are recorded in Dataverse."]})]}),(0,tt.jsx)("p",{children:"When you\u2019re ready, sign in with your corporate account to view your assigned batches."})]})]})}),Po=()=>{const{account:e}=ot();return(0,tt.jsxs)(Se,{children:[(0,tt.jsx)(we,{path:"/",element:e?(0,tt.jsx)(no,{}):(0,tt.jsx)(No,{})}),(0,tt.jsx)(we,{path:"/about",element:(0,tt.jsx)(Oo,{})}),(0,tt.jsx)(we,{path:"/batch/:id",element:(0,tt.jsx)(Lo,{children:(0,tt.jsx)(ro,{})})}),(0,tt.jsx)(we,{path:"/batch/:id/completed",element:(0,tt.jsx)(Lo,{children:(0,tt.jsx)(ao,{})})}),(0,tt.jsx)(we,{path:"/document/:id",element:(0,tt.jsx)(Lo,{children:(0,tt.jsx)(oo,{})})}),(0,tt.jsx)(we,{path:"/summary",element:(0,tt.jsx)(Lo,{children:(0,tt.jsx)(io,{})})}),(0,tt.jsx)(we,{path:"/admin",element:(0,tt.jsx)(Mo,{children:(0,tt.jsx)(Ao,{})})})]})},jo=()=>{const e=te();return i.useEffect(()=>{(0,Xe.pq)("Route changed",{pathname:e.pathname})},[e.pathname]),null},Mo=e=>{let{children:t}=e;return Or().canSeeAdmin?(0,tt.jsx)(tt.Fragment,{children:t}):(0,tt.jsx)(be,{to:"/",replace:!0})},Lo=e=>{let{children:t}=e;const{account:n}=ot();return n?(0,tt.jsx)(tt.Fragment,{children:t}):(0,tt.jsx)(be,{to:"/",replace:!0})},Do=e=>{let{children:t}=e;const{account:n,token:r,photo:o,login:a,logout:s}=ot(),[c,l]=(0,i.useState)(()=>{try{return localStorage.getItem("sunbeth_theme")||"light"}catch(e){return"light"}}),[d,u]=(0,i.useState)(()=>{try{return"true"===(localStorage.getItem("sunbeth_sticky_header")||"true")}catch(e){return!0}});(0,i.useEffect)(()=>{try{localStorage.setItem("sunbeth_theme",c)}catch(e){}try{document.documentElement.setAttribute("data-theme",c)}catch(t){}},[c]),(0,i.useEffect)(()=>{try{localStorage.setItem("sunbeth_sticky_header",d?"true":"false")}catch(Ko){}},[d]);const h=re(),p=te(),f=(0,i.useRef)(n),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(null);(0,i.useEffect)(()=>{(0,Xe.pq)("Layout mounted");const e=async()=>{if(!n||!r)return g(null),void y(null);try{let r=[];try{r=await Xr(0,(null===n||void 0===n?void 0:n.username)||void 0)}catch(i){r=[]}if(!Array.isArray(r)||0===r.length)return g(0),void y(null);let s=0;const c=[];for(const i of r)try{var e,t,o;const r=await eo(i.toba_batchid,0,0,(null===n||void 0===n?void 0:n.username)||void 0),a=null!==(e=r.total)&&void 0!==e?e:0,l=null!==(t=r.acknowledged)&&void 0!==t?t:0;s+=Math.max(0,a-l),(null!==(o=r.percent)&&void 0!==o?o:0)<100&&c.push({due:i.toba_duedate})}catch(a){}if(g(s),c.length){const e=c.map(e=>e.due).filter(Boolean);if(e.length){const t=e.reduce((e,t)=>new Date(t)<new Date(e)?t:e);y(t)}else y(null)}else y(null)}catch(s){g(null),y(null)}};e();const t=()=>e();return window.addEventListener("sunbeth:progressUpdated",t),()=>{window.removeEventListener("sunbeth:progressUpdated",t)}},[n,r]);const b=Or();return(0,i.useEffect)(()=>{const e=f.current,t=n;!e&&t&&"/about"===p.pathname&&h("/",{replace:!0}),e&&!t&&"/"!==p.pathname&&h("/",{replace:!0}),f.current=n},[n,p.pathname,h]),(0,i.useEffect)(()=>{n&&"/about"===p.pathname&&h("/",{replace:!0})},[n,p.pathname,h]),(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)("header",{className:d?"sticky":"",children:[(0,tt.jsxs)("div",{className:"brand",children:[(0,tt.jsx)("img",{src:"https://sunbethconcepts.sharepoint.com/:i:/r/sites/CommunicationsandCorporateAffairs/Shared%20Documents/Comms%20Intranet/Logos%20of%20Sunbeth/SGCL%20Coloured%20LOGO.png?csf=1&web=1&e=2IQ9AL",alt:"Sunbeth",onError:e=>{e.target.style.opacity="0.18",e.target.alt="Logo"}}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:"h1",style:{color:"#fff"},children:"Sunbeth Document Acknowledgement"}),(0,tt.jsx)("div",{className:"small",style:{color:"#fff",opacity:.9},children:"Employee Acknowledgment Portal"})]})]}),n?(0,tt.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[b.isSuperAdmin&&(0,tt.jsx)("div",{title:"Super Admin (from REACT_APP_SUPER_ADMINS)",style:{background:"#fee2e2",color:"#991b1b",padding:"6px 8px",borderRadius:6,fontSize:13,fontWeight:700,display:"flex",alignItems:"center",gap:6},children:(0,tt.jsx)("span",{children:"\u26a1 Super Admin"})}),(0,tt.jsxs)("button",{className:"btn ghost sm","aria-label":"Toggle theme",onClick:()=>l(e=>"light"===e?"dark":"light"),children:["light"===c?"Dark":"Light"," Mode"]}),(0,tt.jsx)("button",{className:"btn ghost sm","aria-label":"Toggle sticky header",onClick:()=>u(e=>!e),children:d?"Unpin Header":"Pin Header"}),(0,tt.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",padding:"6px 8px",background:"rgba(255,255,255,0.04)",borderRadius:6},children:[(0,tt.jsx)("div",{style:{width:36,height:36,borderRadius:18,overflow:"hidden",background:"#fff"},children:o?(0,tt.jsx)("img",{src:o,style:{width:"100%",height:"100%",objectFit:"cover"},alt:"avatar"}):(0,tt.jsx)("div",{style:{width:"100%",height:"100%",background:"#ccc"}})}),(0,tt.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,tt.jsx)("div",{style:{fontWeight:700,color:"#fff"},children:n.name}),(0,tt.jsx)("div",{style:{color:"#ddd",fontSize:13},children:n.username})]}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>s(),children:"Sign out"})]})]}):(0,tt.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:12,alignItems:"center"},children:[(0,tt.jsx)("a",{href:"/about",className:"small",style:{color:"#fff",textDecoration:"none",opacity:.95},children:"About"}),(0,tt.jsxs)("button",{className:"btn ghost sm","aria-label":"Toggle theme",onClick:()=>l(e=>"light"===e?"dark":"light"),children:["light"===c?"Dark":"Light"," Mode"]}),(0,tt.jsx)("button",{className:"btn ghost sm","aria-label":"Toggle sticky header",onClick:()=>u(e=>!e),children:d?"Unpin Header":"Pin Header"}),(0,tt.jsx)("button",{className:"btn sm",onClick:()=>a(),children:"Sign in"})]})]}),(0,tt.jsxs)("div",{className:"wrap ".concat(n?"":"landing-centered"),children:[(0,tt.jsxs)("div",{className:"grid",children:[(0,tt.jsx)("main",{children:t}),n&&(0,tt.jsx)("aside",{children:(0,tt.jsxs)("div",{className:"card",children:[(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{style:{fontWeight:700,color:"var(--primary)"},children:"Batch Overview"}),(0,tt.jsx)("div",{className:"muted small",children:"Rollout"})]}),(0,tt.jsxs)("div",{style:{textAlign:"right"},children:[(0,tt.jsx)("div",{style:{fontWeight:700,fontSize:18},children:null!==m&&void 0!==m?m:"\u2014"}),(0,tt.jsxs)("div",{className:"muted small",children:["You have ",null!==m&&void 0!==m?m:0," pending items"]})]})]}),(0,tt.jsx)("hr",{style:{margin:"12px 0",border:"none",borderTop:"1px solid #f4f4f4"}}),(0,tt.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:b.canSeeAdmin&&(0,tt.jsx)(Ne,{to:"/admin",children:(0,tt.jsx)("button",{className:"btn full sm",children:"Admin View"})})}),(0,tt.jsx)("div",{style:{height:12}}),(0,tt.jsxs)("div",{className:"muted small",children:["Due by: ",v||"\u2014"]}),(0,tt.jsx)("div",{style:{height:6}}),(0,tt.jsx)("div",{className:"muted small",children:"Assigned to: All staff"})]})})]}),(0,tt.jsx)("footer",{children:"\xa9 2025 Sunbeth Global Concept. All Rights Reserved."})]})]})},Uo=()=>{const e=(0,tt.jsx)(it,{children:(0,tt.jsx)(Br,{children:(0,tt.jsxs)(Ie,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[(0,tt.jsx)(jo,{}),(0,tt.jsx)(Do,{children:(0,tt.jsx)(Po,{})})]})})});return(0,tt.jsx)(Qe,{instance:Je.msalInstance,children:e})};class Bo extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){(0,Xe.z3)("Unhandled render error",{err:e,info:t})}render(){var e;return this.state.hasError?(0,tt.jsxs)("div",{style:{padding:20,background:"#fff0f0",color:"#600"},children:[(0,tt.jsx)("h2",{children:"Application error"}),(0,tt.jsx)("pre",{style:{whiteSpace:"pre-wrap"},children:null===(e=this.state.error)||void 0===e?void 0:e.message})]}):this.props.children}}const Ho=e=>{let{message:t,show:n}=e;return(0,tt.jsx)("div",{className:"toast".concat(n?" show":""),role:"status","aria-live":"polite",children:t})},Fo=()=>{const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{const e=e=>{var n;const o=(null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.message)||(null===e||void 0===e?void 0:e.detail)||String(e);t(o),r(!0),window.setTimeout(()=>r(!1),2e3)};return window.addEventListener("sunbeth:toast",e),()=>window.removeEventListener("sunbeth:toast",e)},[]),(0,tt.jsx)(Ho,{message:e,show:n})};(0,Xe.b)(),(0,Xe.pq)("index.tsx initializing app"),window.addEventListener("unhandledrejection",e=>{try{const t=null===e||void 0===e?void 0:e.reason,n=(null===t||void 0===t?void 0:t.errorCode)||(null===t||void 0===t?void 0:t.code),r=((null===t||void 0===t?void 0:t.message)||"").toString();if("state_not_found"===n||/state_not_found/i.test(r))return;(0,Xe.z3)("Unhandled promise rejection",t||e)}catch(qo){}}),window.addEventListener("error",e=>{try{(0,Xe.z3)("Window error",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,error:e.error})}catch(qo){}}),(0,Xe.pq)("Diagnostics initialized");try{window.__sunbethRunDiagnostics=yo}catch(zo){}(async()=>{try{await Je.msalInstance.initialize()}catch(e){}try{const e="true"===({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ENABLE_MGT||"").toLowerCase(),t="undefined"!==typeof window;if(e&&t){const e=(await Promise.resolve().then(n.bind(n,245))).msalInstance;if("function"===typeof(null===e||void 0===e?void 0:e.getLogger)){const{Providers:e}=await n.e(214).then(n.bind(n,214)),{Msal2Provider:t}=await n.e(340).then(n.bind(n,340));e.globalProvider=new t({clientId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLIENT_ID,authority:"https://login.microsoftonline.com/".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_TENANT_ID),redirectUri:"undefined"!==typeof window?window.location.origin:"/",loginType:"popup",scopes:["User.Read","Group.Read.All","openid","profile"]})}else(0,Xe.pq)("MGT provider skipped: incompatible msal-browser version (no getLogger). Set REACT_APP_ENABLE_MGT=false or upgrade MGT.")}}catch(qo){}s.createRoot(document.getElementById("root")).render((0,tt.jsx)(i.StrictMode,{children:(0,tt.jsxs)(Bo,{children:[(0,tt.jsx)(Uo,{}),!1,(0,tt.jsx)(Fo,{})]})}))})()})();
//# sourceMappingURL=main.9269b5b4.js.map